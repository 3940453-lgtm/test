mstrmojo.requiresCls("mstrmojo.plugins.VitaraCharts.v530159.VitaraHCTrellisChartInitializer"),(()=>{var t,e={7326:()=>{function t(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=a.call(r)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){u=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw n}}return o}}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=h(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:String(e)}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=a(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function a(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";var e,i={528:function(t,e,r){r.r(e),r.d(e,{default:function(){return a}});var i=r(4);function n(t){return(n="function"==typeof Symbol&&"symbol"==h(Symbol.iterator)?function(t){return h(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":h(t)})(t)}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.props||(this.props=e),this.breaks=[]}var e,r;return e=t,(r=[{key:"legendItemClick",value:function(){var t=this;return function(e,r){var n,a,s,o=this||e,l=null===(n=t.props.zonesModel)||void 0===n?void 0:n.getZones(),u=null===(a=t.props.zonesModel)||void 0===a?void 0:a.getDropZoneObjectsByName(null==l?void 0:l.BREAK_BY).length,h=null===(s=t.props.zonesModel)||void 0===s?void 0:s.getDropZoneObjectsByName(null==l?void 0:l.COLOR_BY).length;if(!+t.props.vizProps.enablePolarAxis&&(0!==u||0!==h)){o.options.animation=!0;var c=t.breaks;if(o.chart.series.forEach((function(t){c.push({})})),o.visible){var d,f,p;if(null===(d=o.xAxis)||void 0===d||null===(d=d.categoriesTree)||void 0===d||!d.includes(o.name)){var g=!0,v=o.xData;if(i.each(o.chart.series,(function(t,i){var n,a,s,l,u,h=[];if(o.points.length>1&&o.data.length&&t.visible&&null!=t&&null!==(n=t.data)&&void 0!==n&&n.length?t.points.forEach((function(t){h.push(t.x)})):t.visible&&null!=t&&null!==(a=t.data)&&void 0!==a&&a.length&&h.push(null===(s=t.points)||void 0===s||null===(s=s[0])||void 0===s?void 0:s.x),null!=h&&h.some((function(t){return v.includes(t)}))&&t.visible&&t.name!==(null!==(l=null===(u=e.target)||void 0===u?void 0:u.name)&&void 0!==l?l:r))return g=!1,!1})),!g)return}var m=o.xData.length,y=(null===(f=t.props)||void 0===f||null===(p=f.getEndClipPathValue)||void 0===p?void 0:p.call(f))||t.getEndClipPathValue();c[o.index]={from:o.xData[0]-.5,to:o.xData[m-1]+y,breakSize:.1},o.chart.xAxis[0].update({breaks:c})}else c[o.index]={},o.chart.xAxis[0].update({breaks:c})}}}},{key:"getEndClipPathValue",value:function(){return.5}}])&&function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(a)?a:String(a)),i)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},518:function(t,e,r){r.r(e),r.d(e,{default:function(){return o}});var i=r(475),n=r(519),a=r(520),s=function(){};vitaraJQ.extend(s.prototype,i.default.prototype,{COMPATIBLE_VERSIONS:["4.4.0.609","4.3.0.559"],getVersionDefaultForv4_3_0_559:function(){return n.default.getVersionDefaults()},getVersionDefaultForv4_4_0_609:function(){return a.default.getVersionDefaults()}});var o=s},519:function(t,e,r){r.r(e),r.d(e,{default:function(){return i}});var i={VERSION_DEFAULTS:{includeAttributeFormID:!1},getVersionDefaults:function(){return this.VERSION_DEFAULTS}}},520:function(t,e,r){r.r(e),r.d(e,{default:function(){return i}});var i={VERSION_DEFAULTS:{includeAttributeFormID:!0},getVersionDefaults:function(){return this.VERSION_DEFAULTS}}},475:function(t,e,r){r.r(e),r.d(e,{default:function(){return s}});var i=r(45),n=r(4),a=function(){};vitaraJQ.extend(a.prototype,{COMPATIBLE_VERSIONS:[],FUNCTION_PREFIX:"getVersionDefaultForv",getVersionDefaults:function(t){var e=this.FUNCTION_PREFIX+t.split(".").join("_");return this[e]?this[e]():{}},isOlderVersion:function(t,e){return i.utils.isOlderVersion(t,e)},addVersionDefaults:function(t){if(!t||void 0===t.version)return t;for(var e={},r=0;r<this.COMPATIBLE_VERSIONS.length;r++)if(this.isOlderVersion(t,this.COMPATIBLE_VERSIONS[r])){console.log("adding defaults for versions prior to "+this.COMPATIBLE_VERSIONS[r]);var i=this.getVersionDefaults(this.COMPATIBLE_VERSIONS[r]);n.each(i,(function(r,i){void 0===t[i]&&(e[i]=r)}))}return vitaraJQ.extend(t,e)}});var s=a},652:function(t,e,i){i.r(e),i.d(e,{VitaraHCTrellisChartMixin:function(){return v}}),i(1),i(478);var a=i(653),l=i(399),h=i(435),c=i(634),d=i(477),f=i(518),p=i(45),g=i(4),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(m,t);var e,i,d,v=o(m);function m(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(e=v.call(this,t)).scriptClass="mstrmojo.plugins.VitaraCharts.v530159.VitaraHCTrellisChart",e.cssClass="VitaraHCTrellisChart",e.NAME="Vitara Trellis Chart",e.enableDualAxis=!0,e.COLOR_PALETTE="defaultPalette",e.axisLabelBuffer=30,e.logEnvironmentInfo(),e}return e=m,(i=[{key:"validateMinCriteria",value:function(t,e){var r={valid:!0,message:""};if(this.getZoneReader().isDZSupport()){var i=this.zonesModel.getZones();return 0==this.zonesModel.getDropZoneObjectsByName(i.BREAK_BY).length?(r.valid=!1,r.message=p.utils.getCustomErrorCode("E0041")):0!=this.zonesModel.getDropZoneObjectsByName(i.VALUE).length||this.isScatter()||(r.valid=!1,r.message=p.utils.getCustomErrorCode("E0031")),r}return this.isScatter()?{valid:e>1&&t>1,message:p.utils.getCustomErrorCode("E0042")}:{valid:e>0&&t>1,message:p.utils.getCustomErrorCode("E0035")}}},{key:"enableUseAsFilter",value:function(){return!0}},{key:"getEditorName",value:function(){return"GenericTrellis"}},{key:"addVersionCompatibleDefaults",value:function(t){return t=n(u(m.prototype),"addVersionCompatibleDefaults",this).call(this,t),(new f.default).addVersionDefaults(t)}},{key:"getPropMenuDefaults",value:function(){return{legendEnable:"0",legendCompact:"1",includeAttributeFormID:"1",sharedValueAxis:"1",trellisIndividualHeight:"80",trellisIndividualWidth:"200",sortCategoryAxis:"1"}}},{key:"transformVAlign",value:function(t){return this.isLine()||this.isScatter()?this.vizParser.flipVAlignValue(t):t}},{key:"transformAlign",value:function(t){return this.isBar()?t:this.vizParser.flipAlignValue(t)}},{key:"getPropertiesToDisable",value:function(){var t=[];return(isMSTRDashBoard()||isMSTRDesktop())&&(t=["seriesByAttribute"]),t}},{key:"getSeriesElements",value:function(){return n(u(m.prototype),"getSeriesElements",this).call(this,this.renderedCharts[0])}},{key:"isBar",value:function(){return"bar"===this.vizProps.trellisChartType}},{key:"isLine",value:function(){return"line"===this.vizProps.trellisChartType||!this.vizProps.trellisChartType}},{key:"isColumn",value:function(){return"column"===this.vizProps.trellisChartType}},{key:"isScatter",value:function(){return"scatter"===this.vizProps.trellisChartType}},{key:"getDataLabelTypes",value:function(){return["labelsMin","labelsMax","labelsFirst","labelsLast"]}},{key:"getXAxisDirection",value:function(t,e){var r=!1;return e&&e.series&&g.each(e.series,(function(t){"bar"===t.type&&(r=!0)})),r||e&&"bar"===e.trellisChartType?this.flipAxisDirection(t):n(u(m.prototype),"getXAxisDirection",this).call(this,t)}},{key:"getRenderedHCInstance",value:function(t){return this.renderedCharts?void 0!==t?this.renderedCharts[t]:this.renderedCharts:null}},{key:"postChartRendering",value:function(){this.utils.reportTime(this.scriptClass,"Total trellis rendering time for "+this.numCharts+" charts"),this.reportReadyForExport()}},{key:"destroyRInstance",value:function(){this.renderedChartInstance&&(this.renderedChartInstance=null)}},{key:"endChartRendering",value:function(t){this.renderedCharts&&this.renderedCharts.length===this.numCharts-1&&n(u(m.prototype),"endChartRendering",this).call(this,t)}},{key:"vitaraPlot",value:function(t){if(this.getZoneReader().isDZSupport()){var e=this.zonesModel.getZones();if(this.isScatter()&&this.zonesModel.getDropZoneObjectsByName(e.VALUE).length<2)return void this.handleVizError('Include at least two metrics in "Value" zone to see the chart')}else if(this.isScatter()&&(this.dataHelper.numMetrics<2||this.dataHelper.numAttributes<2))return void this.handleVizError("Include at least two attributes and two metrics to see the chart.");var r=this.renderedCharts,i=g.cloneDeep(this.timeOuts);try{!0!==t&&(this.setHighchartsDefaults(),this.destroyRInstance()),vitaraD3.select(this.chartNode).selectAll(".trellis_container").remove(),this.renderedCharts=[],this.timeOuts=[],this.renderedChartInstance=new a.renderTrellisChart(this.isScatter()?c.renderBubbleChart:h.renderGenericSeriesChart,this,this.dataHelper,this.position,this.domNode,this.getOptions(l.default),this.vizProps),this.renderedChartInstance.render()}catch(t){this.handleVizError(t)}finally{if(r&&r.length>0)for(var n=Object.keys(r),s=0;s<n.length;s++)try{throw s}catch(s){setTimeout((function(){void 0!==r[n[s]]&&null!==r[n[s]]&&(r[n[s]].destroy(),r[n[s]]=null)}),10)}i&&i.length&&i.forEach((function(t){clearTimeout(t)}))}}}])&&r(e.prototype,i),d&&r(e,d),Object.defineProperty(e,"prototype",{writable:!1}),m}(VitaraMix(d.default).with());window.VitaraHCTrellisChartMixin=v},653:function(t,e,r){r.r(e),r.d(e,{renderTrellisChart:function(){return o}});var i=r(45),n=r(472),a=r(528),s=r(4),o=function(t,e,r,o,l,u,h){var c=this;this.context=e,this.initializeTrellisContainer=function(t){var e=this.context.getUniqueIdInContainer("trellis_container");vitaraJQ(this.context.chartNode).append("<div id='"+e+"' class='trellis_container'></div>");for(var r=vitaraJQ("#"+e,this.context.chartNode),i=0;i<t;i++)r.append("<div id='trellisChart"+i+"' class='trellisElement trellis_border'></div>");return vitaraJQ(".trellisElement",r)},this.getIndividualChartSizingInfo=function(t,e){var r=this.vizProps.trellisNumColumns&&this.vizProps.trellisNumColumns>t.length?t.length:this.vizProps.trellisNumColumns,i=vitaraJQ(this.context.chartNode).width()-10-(e?e.x:0),n=vitaraJQ(this.context.chartNode).height()-20-(e?e.y:0),a=this.vizProps.trellisIndividualWidth?parseInt(this.vizProps.trellisIndividualWidth):200,s=this.vizProps.trellisIndividualHeight?parseInt(this.vizProps.trellisIndividualHeight):80,o=t.length,l=r||Math.floor(i/a),u=i/(l=Math.min(t.length,l));u<a&&(u=a,l=parseInt(r)),l<1&&(u=a,l=1),vitaraJQ(".trellis_container",this.context.chartNode).width(u*l);var h=Math.ceil(o/l);return h*s<n-this.context.axisLabelBuffer&&(s=1==this.vizProps.showAllCategoryLabels?Math.floor(n/h-this.context.axisLabelBuffer):Math.floor((n-this.context.axisLabelBuffer)/h)),t.width(u-5),t.height(s),{position:{width:u,height:s,left:0,top:0},chartCount:{numRows:h,numColumns:l}}},this.getFixedOptions=function(t){if(0===t){this.getChartDataMapper();var e=this.chartDataMapper.numMetrics,r=this.chartDataMapper.numColumns,i=this.chartDataMapper.numAttributes,n=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,s=null,o=null,l=this.chartDataMapper.titles,u=r;if(this.context.isScatter()){if(!(c=this.context.validateMinCriteria(i,e)).valid)throw new Error(c.message);var h=this.chartDataMapper.stats();s=h.getMinValue(i),o=h.getMaxValue(i),n=h.getMinValue(i+1),a=h.getMaxValue(i+1)}else{var c;if(!(c=this.context.validateMinCriteria(i,e)).valid)throw new Error(c.message);var d=this.getZoneData(this.chartDataMapper).yaxis;u=1==this.vizProps.seriesByAttribute||this.chartDataMapper.seriesBy===this.chartDataMapper.MSTR_TYPE_ATTRIBUTE?1:d.length;for(var f=0;f<u;f++){var p=l.indexOf(d[f].name),g=this.chartDataMapper.stats().getMinValue(p);n>g&&(n=g);var v=this.chartDataMapper.stats().getMaxValue(p);a<v&&(a=v)}}this.fixedChartOptions={title:{style:{}},legend:{enabled:!1},xAxis:{labels:{autoRotation:!1,formatter:function(){var t=this.value;return t.length>12?t.substring(0,12)+"...":t}},min:s,max:o},yAxis:{labels:{},tickPixelInterval:10,title:{text:null}},plotOptions:{series:{dataLabels:{style:{color:"black"}},events:{legendItemClick:this.getBarColumnLegendHelper().legendItemClick()},maxPointWidth:25}}},+this.sharedValueAxis&&(this.fixedChartOptions.yAxis.min=n,this.fixedChartOptions.yAxis.max=a)}return this.fixedChartOptions},this.getOptions=function(t,e,r,i,n){var a,s=!0,o=null,l=r%i==0,u="true"===this.vizProps.showAllCategoryLabels||1==this.vizProps.showAllCategoryLabels;if("bar"===this.vizProps.trellisChartType)l=!0,s=u||r%i==0,a=-45,o=0;else{s=u||r>=i*(n-1),a=-45;var h=r>=i*(n-1);(u||h)&&(vitaraJQ(e[r]).height(vitaraJQ(e[r]).height()+this.context.axisLabelBuffer),h&&vitaraJQ(e[r]).addClass("trellis_last_row"))}var c={chart:{type:this.vizProps.trellisChartType||"line"},plotOptions:{series:{groupPadding:o,pointPadding:0}},xAxis:{labels:{enabled:s,rotation:a}},yAxis:{labels:{enabled:!+this.sharedValueAxis||l}},title:{text:t||"",align:this.vizProps.titleAlignment||"left"}};return Highcharts.merge(this.getFixedOptions(r),c)},vitaraJQ.extend(this,t.prototype,{COLOR_PALETTE:"defaultPalette",breaks:[],postChartRendering:function(){var t;this.context.renderedCharts.length>=this.numCharts-1&&!this.run&&(this.context.postChartRendering(),this.run=!0,this.context&&(null===(t=this.context.platformContext)||void 0===t?void 0:t.initContextMenu)&&this.context.platformContext.initContextMenu())},getZoneData:function(t){return this.context.getZoneData(t)},formDataElement:function(t,e,r){var i={};return i.x=t.x,i.y=t.y,i.z=t.z,i.fv=t.fv,i.value=t.value,i.mName=t.mName,i.slc=r[r.length-1].slc,i.name=r.slice(0,this.numAttributes).map((function(t){return t.t})).join(", "),"scatter"===this.vizProps.trellisChartType&&(isNaN(i.x)||null===i.x||""===i["x]"]||isNaN(i.y)||null===i.y||""===i.y)&&(i.x=void 0,i.y=void 0),i},valueMarker:"y",markMinMax:function(t,e){return this.markMinMaxOnPlayBy(t,e,"slc")},getBarColumnLegendHelper:function(){return this.BarColumnLegendHelper||(this.BarColumnLegendHelper=new a.default(c.context)),this.BarColumnLegendHelper},preRenderProcessChartOptions:function(t){return!t.yAxis.labels.enabled&&t.yAxis.title&&delete t.yAxis.title,this.context.vizParser.processYAxisMinMax(t,this.vizProps,this.chartDataMapper),this.context.vizParser.setDualAxisProperties(t,this.vizProps,this.chartDataMapper),this.setYAxisLabelFormatter(t),this.context.addDelayToTooltip(t),t},renderChartNew:function(){var t,e,r=this,a=this.readDataForSeriesAndCategoriesOnPlayBy(this.getFormSeriesUserOptions()),s=a.motion.labels?a.motion.labels:[];this.numCharts=0==s.length?1:s.length,this.context.numCharts=this.numCharts,this.vizProps.legend.enabled&&(t=this.renderLegend(a.series,Highcharts.merge(r.getChartOptions(),r.vizProps).colors,10),e=this.getLegendOffset(n.vitaraLegend.getDimensions())),delete a.motion;var o=r.initializeTrellisContainer(this.numCharts),l=r.getIndividualChartSizingInfo(o,e),u=l.chartCount.numColumns,h=l.chartCount.numRows;void 0===this.vizProps.sharedValueAxis?this.sharedValueAxis="1":this.sharedValueAxis=this.vizProps.sharedValueAxis;var c=this.fromTrellisSeriesBySLCIndexMarker(a,this.numCharts);function d(t,e){var i=r.getOptions(s[e],o,e,u,h),n=Highcharts.merge(t,r.getChartOptions(),i,r.vizProps);return r.context.isScatter()?Highcharts.merge(n,{plotOptions:{series:{marker:{enabled:!0}}}}):n}this.context.renderedCharts=[];for(var f=0;f<c.length;f++){var p=d(a,f);p.series=this.setSeriesProperties(c[f]),this.applyColorThreholds(p),p=this.setToolTipFormatter(p),(p=this.setPointSelectionEventForUseAsFilter(p)).legend.enabled=!1,this.processStyleMode(p),this.renderNode.call(this,p,o[f])}this.vizProps.legend.enabled&&n.vitaraLegend.resetLegendForTrellis(t,e,this.domNode,this.context.chartNode),i.utils.setBackgroundImage(this.context.chartNode,vitaraJQ.extend({basePath:this.context.getBackgroundImagePath()},this.vizProps))},getElementStyle:function(t){return vitaraJQ(t,this.domNode).attr("style")?vitaraJQ(t,this.domNode).attr("style"):""},setElementStyle:function(t,e){vitaraJQ(t,this.domNode).attr("style",e)},getElementWidth:function(t){return vitaraJQ(t,this.domNode).width()},setElementWidth:function(t,e){vitaraJQ(t,this.domNode).width(e)},resetLegend:function(t,e){var r,i=this.getElementStyle(".vitara-legend"),n=this.getElementStyle(".trellis_container");if(this.getElementWidth(".trellis_container")?"horizontal"===t.layout&&"middle"!==t.verticalAlign&&(i+="width:"+this.getElementWidth(".trellis_container")+"px;"):this.setElementWidth(".trellis_container",this.getElementWidth(this.domNode)-e.x-10),("horizontal"===t.layout&&"top"!==t.verticalAlign||"vertical"===t.layout&&"center"===t.align&&"bottom"===t.verticalAlign)&&this.moveDiv(".vitara-legend",this.context.chartNode),"vertical"===t.layout?(n+="display:inline-block;","center"===t.align?i+="width:"+this.getElementWidth(".trellis_container")+"px;":"middle"===t.verticalAlign?(r=(vitaraJQ(this.domNode).height()-e.height)/2)>0&&(i+="transform:translate(0,"+r+"px);"):"bottom"===t.verticalAlign&&(i+="vertical-align:bottom;")):"center"!==t.align&&"middle"===t.verticalAlign&&((r=(vitaraJQ(this.domNode).height()-e.height)/2)>0&&(i+="transform:translate(0,"+r+"px);"),i+="display:inline-block;",n+="display:inline-block;"),this.setElementStyle(".vitara-legend",i),this.setElementStyle(".trellis_container",n),"middle"===t.verticalAlign||"vertical"===t.layout&&"center"!==t.align){var a="";a+="width:"+(this.getElementWidth(".trellis_container")+e.width+10)+"px;",vitaraJQ(this.context.chartNode).append("<div class='chart_container' style='"+a+"'></div>"),"left"===t.align&&this.moveDiv(".vitara-legend",".chart_container"),this.moveDiv(".trellis_container",".chart_container"),"right"===t.align&&this.moveDiv(".vitara-legend",".chart_container")}},renderLegend:function(t,e,r){var i=[];if(t.forEach((function(t,r){i[r]=t.name,t.color&&(e[r]=t.color)})),e.length<i.length)for(var a=e.length,s=a;s<i.length;s++)e[s]=e[s%a];var o={enabled:!0,align:"center",layout:"horizontal",position:"relative",verticalAlign:"bottom",colors:e,labels:i,options:{padding:"5"},containerWidth:this.position.width-2*r,containerHeight:this.position.height-2*r},l=this.vizProps.legend;l.align=l.align?l.align:"center",l.layout=l.layout?l.layout:"horizontal",l.verticalAlign=l.verticalAlign?l.verticalAlign:"bottom","middle"===(o=vitaraJQ.extend(o,this.vizProps.legend)).verticalAlign&&"center"===o.align&&(o.verticalAlign="bottom");var u="text-align:"+o.align+";";return"vertical"===o.layout&&(u+="display:inline-block;","top"===o.verticalAlign&&(u+="vertical-align:top;")),vitaraJQ(".vitara-legend",this.domNode).length>0&&vitaraJQ(".vitara-legend",this.domNode).remove(),n.vitaraLegend.init(o,vitaraD3.select(this.domNode).select(".vitara-chart-container").append("div").attr("class","vitara-legend").attr("id","vitara-legend").attr("style",u),this.domNode,null,this.legendClickHandler.bind(this)),o},legendClickHandler:function(t){var e=!1,r=this;return s.each(this.context.renderedCharts,(function(i){var n=i.get(t);r.getBarColumnLegendHelper().legendItemClick()(n,t),n&&(e=!n.visible,n.setVisible(e))})),e},moveDiv:function(t,e){var r=document.createDocumentFragment();r.appendChild(vitaraJQ(t,this.domNode)[0]),vitaraJQ(e,this.domNode)[0].appendChild(r)},getLegendOffset:function(t){return{y:t.includeLegendHeight?t.height:0,x:t.includeLegendWidth?t.width:0,width:t.width,height:t.height}},setChartTitleClickEvent:function(t){var e=this;if(t&&t.title&&this.getChartDataMapper().filterHandlerInstance){e=this;var r=[t.title.element.textContent];t.title.element.selector=this.getChartDataMapper().filterHandlerInstance.getAttributeSelectorByName(r),t.title.on("click",(function(t){vitaraJQ(this).find("a").attr("href")||e.context.applySelections()})),t.title.attr({id:r[0]}),t.title.css({cursor:"pointer"})}},renderNode:function(t,e){var r=this;r.context.timeOuts.push(setTimeout((function(){var i=r.renderHCNode.call(r,r.preRenderProcessChartOptions(t),e);r.setChartTitleClickEvent(i),r.context.renderedCharts.push(i)}),0))},getSeriesObject:function(t){var e={};for(var r in t)"data"!==r&&(e[r]=t[r]);return e.data=[],e},getSeriesForSlice:function(t,e){for(var r=[],i=0;i<e.length;i++){var n=this.getSeriesObject(e[i]);r.push(n);for(var a=0;a<e[i].data.length;a++)e[i].data[a].slc==t&&n.data.push(e[i].data[a])}return r},fromTrellisSeriesBySLCIndexMarker:function(t,e){var r,i=[];for(r=0;r<e;r++)i.push(this.getSeriesForSlice(r,t.series));return i}}),t.call(this,r,o,l,u,h)}}},a={};function l(t){var e=a[t];if(void 0!==e)return e.exports;var r=a[t]={id:t,loaded:!1,exports:{}};return i[t].call(r.exports,r,r.exports,l),r.loaded=!0,r.exports}l.m=i,e=[],l.O=function(r,i,n,a){if(!i){var s=1/0;for(d=0;d<e.length;d++){for(var o=t(e[d],3),u=(i=o[0],n=o[1],a=o[2],!0),h=0;h<i.length;h++)(!1&a||s>=a)&&Object.keys(l.O).every((function(t){return l.O[t](i[h])}))?i.splice(h--,1):(u=!1,a<s&&(s=a));if(u){e.splice(d--,1);var c=n();void 0!==c&&(r=c)}}return r}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[i,n,a]},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,{a:e}),e},l.d=function(t,e){for(var r in e)l.o(e,r)&&!l.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},l.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":h(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==("undefined"==typeof window?"undefined":h(window)))return window}}(),l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var e={28:0};l.O.j=function(t){return 0===e[t]};var r=function(r,i){var n,a,s=t(i,3),o=s[0],u=s[1],h=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in u)l.o(u,n)&&(l.m[n]=u[n]);if(h)var d=h(l)}for(r&&r(i);c<o.length;c++)a=o[c],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(d)},i=self.webpackChunkwebpack_latest=self.webpackChunkwebpack_latest||[];i.forEach(r.bind(null,0)),i.push=r.bind(null,i.push.bind(i))}();var c=l.O(void 0,[34,42,33,35,38,41,36,47],(function(){return l(652)}));c=l.O(c)}()},2295:(t,e,r)=>{"use strict";var i=r(6486),n=(r(764),r(7326),r(1095));const a={PLAY_AXIS:"Play Axis",CATEGORY:"Category Axis",CATEGORY_ZONE:"Category",COLOR_BY:"Color By",SLICE_BY:"Slice By",VALUE:"Value",HORIZONTAL_VALUES:"Horizontal Axis",VERTICAL:"Vertical Axis",BUBBLE_SIZE:"Bubble Size",START_VALUE:"Start Value",END_VALUE:"End Value",TOOLTIP:"Tooltip",SMALL_MULTIPLE:"Small Multiples",ATTRIBUTES:"Attributes",METRICS:"Metrics",BREAK_BY:"Break By",DRILL_TARGET:"Drill Target",INTER_VALUE:"Intermediate Value(s)",LAST_VALUE:"Last Value",GROUP_BY:"Group By",NUMERATOR:"Ratio - Numerator Value",DENOMINATOR:"Ratio - Denominator Value",RING_1:"Ring 1 Value",RING_2:"Ring 2 Value",RING_3:"Ring 3 Value",TIME:"Time",TREND_BY:"Trend By",BAR:"Bar",MARKERS:"Markers",DATE:"Date",TOP_LABEL:"Main Label",SUB_LABEL:"Sub Label",THRESHOLD_METRICS:"Threshold Metrics",STACK_BY:"Stack By"};var s=r(6486),o=mstrmojo.declare(null,null,{MSTR_TYPE:{ATTRIBUTE:"attribute",METRIC:"metric",ATTRIBUTE_OR_METRIC:"attributeOrMetric"},ENUM_ZONES:a,isDZSupport:function(){return isMSTRDashBoard()||isMSTRDesktop()},getZoneElements:function(t,e){for(var r=[],i=0;i<t.length;i++)r.push({name:t[i].n,type:e});return r},getZoneAttributes:function(t){return this.getZoneElements(t.items,this.MSTR_TYPE.ATTRIBUTE)},getZoneMetrics:function(t){return this.getZoneElements(t.items,this.MSTR_TYPE.METRIC)},getAttributeNameByID:function(t){for(var e=this.dataHelper.data.data.gsi.rows,r=0;r<e.length;r++)if(e[r].did==t)return this.dataHelper.parseMSTRText(e[r].n)},getMetricNameByID:function(t){for(var e=this.dataHelper.data.data.gsi.mx,r=0;r<e.length;r++)if(e[r].did==t)return this.dataHelper.parseMSTRText(e[r].n);if(isMSTRMobile()&&isMSTRDashBoard()){var i=this.dataHelper.data.getColTitles();if(i&&i.titles&&i.titles[0]){var n=i.titles[0].es||[];for(r=0;r<n.length;r++)if(n[r].oid===t)return this.dataHelper.parseMSTRText(n[r].n)}}},getZoneElementId:function(t,e){var r=t&&t.id;return this.dataHelper&&e===this.MSTR_TYPE.ATTRIBUTE?this.dataHelper.getCompatibleAttrId(r):r},createZoneElements:function(t,e,r){t=s.uniqWith(t,s.isEqual);for(var i=[],n=0;n<t.length;n++)i.push({name:r.call(this,t[n].id),type:e,id:this.getZoneElementId(t[n],e)});return i},getElementType:function(t){var e=t&&t[0]?t[0]:void 0;return e&&e.t&&4===e.t?this.MSTR_TYPE.METRIC:this.MSTR_TYPE.ATTRIBUTE},formAttributeOrMetricZoneData:function(t){return this.getElementType(t)===this.MSTR_TYPE.ATTRIBUTE?this.formAttributeZoneData(t):this.formMetricZoneData(t)},formAttributeZoneData:function(t){return this.createZoneElements(t,this.MSTR_TYPE.ATTRIBUTE,this.getAttributeNameByID)},formMetricZoneData:function(t){return this.createZoneElements(t,this.MSTR_TYPE.METRIC,this.getMetricNameByID)},getElementsFromZoneByName:function(t,e,r){if(t&&t.getDropZoneObjectsByName){var i=t.getDropZoneObjectsByName(e);if(i.length>0)return r==this.MSTR_TYPE.ATTRIBUTE_OR_METRIC?this.formAttributeOrMetricZoneData(i):r==this.MSTR_TYPE.ATTRIBUTE?this.formAttributeZoneData(i):this.formMetricZoneData(i)}},getZoneData:function(t,e,r){return{}},getDropZoneElements:function(t,e){if(this.dataHelper||(this.dataHelper=e),!this.dataHelper)return"";var r=this;try{if(!this.isDZSupport())return this.dataHelper.getTitles();if(!t)return"";var i={};return s.each(this.ZONES,(function(e,n){s.each(r.MSTR_TYPE,(function(n,a){if(!i[e]){var o=s.filter(r.getElementsFromZoneByName(t,e,n),(function(t){return t&&void 0!==t.name}));o&&o.length>0&&(i[e]=o)}}))})),i}catch(t){return"unable to retrieve drop zone data: "+t.message}}}),l=mstrmojo.declare(o,null,{scriptClass:"mstrmojo.plugins.VitaraCharts.v530159.VitaraHCTrellisDropZoneReader",getZoneData:function(t,e,r,i){var n={},a=this.MSTR_TYPE;if(this.dataHelper=i,this.isDZSupport()){var s=t.getZones();for(var o in n.sliceby=this.getElementsFromZoneByName(t,s.BREAK_BY,a.ATTRIBUTE),n.xaxis=this.getElementsFromZoneByName(t,s.CATEGORY,a.ATTRIBUTE),n.yaxis=this.getElementsFromZoneByName(t,s.VALUE,a.METRIC),n.groupby=this.getElementsFromZoneByName(t,s.COLOR_BY,a.ATTRIBUTE),n)void 0!==n[o]&&0!=n[o].length||delete n[o];n.groupby&&!n.xaxis&&(n.xaxis=n.groupby),r.trellisChartType&&"scatter"===r.trellisChartType&&(!n.groupby&&n.xaxis&&(n.groupby=[],n.groupby[0]=n.xaxis[0]),n.yaxis&&n.yaxis.length&&(n.xaxis=[],n.xaxis[0]=n.yaxis[0],n.yaxis=n.yaxis.slice(1,2)))}else r.trellisChartType&&"scatter"===r.trellisChartType?(n.sliceby=e.getAttributeAtIndexAsZones(0),n.groupby=e.getLastAttributeAsZones(),n.xaxis=e.getMetricAtIndexAsZones(0),n.yaxis=e.getMetricAtIndexAsZones(1)):(n.sliceby=e.getAttributeAtIndexAsZones(0),1==r.seriesByAttribute?(n.groupby=e.getLastAttributeAsZones(),n.xaxis=e.getAllAttributesExceptAsZones(e.numAttributes-1).slice(1),n.xaxis&&0!=n.xaxis.length||(n.xaxis=n.groupby)):n.xaxis=e.getAllAttributesExceptAsZones(0),n.yaxis=e.getAllMetricsAsZones());return n}}),u=r(4089);function h(t){t&&this.setContext(t)}Object.assign(h.prototype,u.Z.prototype,{getCustomProperty:function(){return[this.AppearanceProperties(),this.AxisProperties(),this.BackgroundProperties(),this.DataLabelsProperties(),this.LegendProperties(),this.TooltipProperties(),this.MarkerPropertiesInfo(),this.seriesPropertiesType2({markerOptions:!0}),this.ThresholdsProperties(),this.TrellisProperties(),this.SecurityProperties(),this.getAboutChartMenu()]},getExtraAppearanceProps:function(){return[{label:"Color By Last Attribute",fields:["seriesByAttribute"]}]},getExtraDataLabelsProperties:function(){return[{fields:["labelsMax","dl_label_max","labelsLast","dl_label_last"]},{fields:["labelsMin","dl_label_min","labelsFirst","dl_label_first"]}]}}),r.g.vitaraLD||(r.g.vitaraLD=i),mstrmojo.plugins.VitaraCharts.v530159.VitaraHCTrellisChart=mstrmojo.declare(n.Z,[],{scriptClass:"mstrmojo.plugins.VitaraCharts.v530159.VitaraHCTrellisChart",cssClass:"VitaraHCTrellisChart",getVisualInstance:function(){return this.visualInstance||(this.visualInstance=new VitaraHCTrellisChartMixin(this),this.visualInstance.updateVisualProps=this.updateVisualProps),this.visualInstance},getEditorName:function(){return"GenericTrellis"},getEditor:function(t){return this.propsEditor||(this.propsEditor=new h(t)),this.propsEditor},getZoneReader:function(){return this.zoneReader||(this.zoneReader=new l),this.zoneReader},validateMinCriteria:function(t,e){var r={valid:!0,message:""};if(this.getZoneReader().isDZSupport()){var i=this.zonesModel.getZones();return 0==this.zonesModel.getDropZoneObjectsByName(i.BREAK_BY).length?(r.valid=!1,r.message=this.getUtils().getCustomErrorCode("E0041")):0!=this.zonesModel.getDropZoneObjectsByName(i.VALUE).length||this.mRendererInstance.isScatter()||(r.valid=!1,r.message=this.getUtils().getCustomErrorCode("E0031")),r}return this.mRendererInstance.isScatter()?{valid:e>1&&t>1,message:this.getUtils().getCustomErrorCode("E0042")}:{valid:e>0&&t>1,message:this.getUtils().getCustomErrorCode("E0035")}},getChartSpecificConfigProperties:function(t){return i.includes(t,"vitara-chart-container")?["catAxis","valAxis"]:this._super(t)}})}},r={};function i(t){var n=r[t];if(void 0!==n)return n.exports;var a=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=e,t=[],i.O=(e,r,n,a)=>{if(!r){var s=1/0;for(h=0;h<t.length;h++){for(var[r,n,a]=t[h],o=!0,l=0;l<r.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every(t=>i.O[t](r[l]))?r.splice(l--,1):(o=!1,a<s&&(s=a));if(o){t.splice(h--,1);var u=n();void 0!==u&&(e=u)}}return e}a=a||0;for(var h=t.length;h>0&&t[h-1][2]>a;h--)t[h]=t[h-1];t[h]=[r,n,a]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={427:0};i.O.j=e=>0===t[e];var e=(e,r)=>{var n,a,[s,o,l]=r,u=0;if(s.some(e=>0!==t[e])){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(l)var h=l(i)}for(e&&e(r);u<s.length;u++)a=s[u],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(h)},r=self.webpackChunkVitaraCharts_MicroStrategy=self.webpackChunkVitaraCharts_MicroStrategy||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var n=i.O(void 0,[445,915,89],()=>i(2295));n=i.O(n)})();
