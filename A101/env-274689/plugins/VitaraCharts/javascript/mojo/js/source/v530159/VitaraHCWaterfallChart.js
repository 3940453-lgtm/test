mstrmojo.requiresCls("mstrmojo.plugins.VitaraCharts.v530159.VitaraHCWaterfallChartInitializer"),(()=>{var t,e={158:()=>{function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,n,a,o,s=[],l=!0,u=!1;try{if(a=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=a.call(i)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){u=!0,n=t}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw n}}return s}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=a(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}}).apply(this,arguments)}function a(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function l(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t){var e=function(t,e){if("object"!=f(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==f(e)?e:String(e)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=g(t);if(e){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";var i,r={597:function(t,e,i){i.r(e),i.d(e,{renderHCWaterfallDeltaView:function(){return u}});var r=i(515),n=i(516),a=i(593),o=i(594),s=i(283),l=i(4),u=function(t,e,i,n,o,s,l){this.setWFColors(this.DEFAULT_COLORS),this.setIBCSOptions(l),a.renderWaterfall.call(this,t,e,i,n,o,s,l),r.renderHCDeltaView.call(this,t,e,i,n,o,s,l)};vitaraJQ.extend(u.prototype,a.renderWaterfall.prototype,r.renderHCDeltaView.prototype,n.waterfallStyledModeRenderer.prototype,s.labelProvider.prototype,{DEF_DATALABEL_DSP_FRMT:"default",scriptClass:"renderHCWaterfallDeltaView",getSeriesTemplate:function(){if(this.context&&this.context.getRenderedChartInstance)return l.cloneDeep(this.context.getRenderedChartInstance()[1].getRenderOptions().series[0])},setSeriesTemplate:function(t){this.seriesTemplate=t},getMetricLabel:function(t){return this.deltaFormattedDataLabel(t)},deltaFormattedDataLabel:function(t){var e=void 0!==this.getRefScale()?(t.point.high-t.point.low)/this.getRefScale():t.point.high-t.point.low,i=this.context.utils.shortenNumber({rawVal:e,fv:this.context.utils.formatMetricLike(e,t.point.fv)},this.DEF_DATALABEL_DSP_FRMT);return this.getIBCSFormattedLabel(i,t.point)},getDefaultChartOptions:function(){var t=this,e={chart:{inverted:!0,zoomType:void 0},plotOptions:{series:{dataLabels:{inside:!1,crop:!1,overflow:"allow",verticalAlign:"middle",allowOverlap:!1,padding:14,formatter:t.getDataLabelFormatter()}}},tooltip:{enabled:!0,formatter:function(){return t.deltaFormattedDataLabel(this)}}};return Highcharts.merge(this.getHCDefaultDeltaOptions(),a.renderWaterfall.prototype.getDefaultChartOptions.call(this),e)},getDataLabelFormatter:function(){var t=this;return function(){return this.point?(this.point.subtrahend?this.y!==this.point.low:this.y!==this.point.high)?"":t.getDataLabel(this):""}},setValueAxisProps:function(t){this.setYAxisMin(t)},getChartDataMapper:function(){return this.chartDataMapper||(this.chartDataMapper=new o.default(null,null,null,this,null)),this.chartDataMapper},reFormDataElement:function(t,e,i){return a.renderWaterfall.prototype.formDataElement.call(this,t,e,i)},formHCDeltaViewOptions:function(t,e,i){var r={series:[]};return(r=Highcharts.merge(this.getDefaultChartOptions(),i||{})).series=this.getChartDataMapper().formSeriesForWaterfallDelta(t[0],t[1],this.formDataElement.bind(this),this.getSeriesTemplate()),this.processChartOptions(r)},formChartOptions:function(){this.setDataRows(this.getDataForDeltaView()),this.setExtraOptions(this.getChartOptionsForDeltaView());var t=l.cloneDeep(this.getDataRows()),e=this.formHCDeltaViewOptions(t,this.getViewType(),this.getExtraOptions());this.processIBCSOptions(e,this.getIBCSOptions()),e=this.postProcessOptions(e),this.setRenderOptions(e)},setLabelPadding:function(t){l.each(t.series[0].data,(function(e,i){!e||e.high>e.low||(t.series[0].data[i].dataLabels={padding:0})}))},getMinMaxFromData:function(){return a.renderWaterfall.prototype.getMinMaxFromData.call(this)},getTargetSeriesIndex:function(){return 0},targetSeriesParser:function(t){return this.parseSeriesData(t).map((function(t){return t.v}))},updateSeriesScale:function(t,e){var i=l.cloneDeep(this.getDataRows()),r=this.getChartDataMapper().formSeriesForWaterfallDelta(i[0],i[1],this.formDataElement.bind(this),this.getSeriesTemplate(),t),n={series:r};return this.renderedChart.series[1].destroy(),this.renderedChart.series[0].destroy(),this.isEnableBridgeLine()&&(n=this.formLineSeries(n)),this.renderedChart.addSeries(r[0],!1),this.renderedChart.addSeries(r[1],!1),!0}})},594:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var r=i(234),n=i(4);function a(t){return(a="function"==typeof Symbol&&"symbol"==f(Symbol.iterator)?function(t){return f(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":f(t)})(t)}function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(n=function(t,e){if("object"!==a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===a(n)?n:String(n)),r)}var n}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,t);var e,i,r,a,c=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(r);if(a){var i=u(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return l(this,t)});function p(t,e,i,r,a){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(o=c.call(this,t,e,i,r)).columnIds=a||[],o.metricIds=n.isArray(a)?a.slice(o.numAttributes,a.length):[],o.metricTitles=o.originalTitles?o.originalTitles.slice(o.numAttributes,o.originalTitles.length):[],o}return e=p,(i=[{key:"updateRunningSum",value:function(t){this.runningSum+=t}},{key:"setRunningSum",value:function(t){this.runningSum=t}},{key:"getRunningSum",value:function(){return this.runningSum}},{key:"getPlotOptions",value:function(t,e){return vitaraJQ.extend({},!0,t,e)}},{key:"formTotalBar",value:function(t,e,i){return{data:[this.formDataElement({val:t,rSum:e,fv:"",name:i.totalBarTitle,nonAdditive:!0,isTotal:!0,subtrahend:i.subtrahend},i)],categories:[""]}}},{key:"formSubTotalBar",value:function(t){return{data:[this.formDataElement({val:this.getRunningMetricSum(),rSum:this.getRunningSum(),fv:"",name:t.totalBarTitle,nonAdditive:!1,isTotal:!1,isSubTotal:!0,subtrahend:t.subtrahend},t)],categories:[""]}}},{key:"formConnectorLineSeries",value:function(t){if(t&&t.series&&t.series[0]&&t.series[0].data){var e,i=[];return n.each(t.series[0].data,(function(t,r){e=t&&+t.subtrahend?t.low?t.low:i[i.length-1]?i[i.length-1].y:null:t.high?t.high:i[i.length-1]?i[i.length-1].y:null,i.length>0&&i[i.length-1]&&i[i.length-1].y!==e&&(i.push({x:r,y:i[i.length-1].y}),i.push(null)),null!==e&&i.push({x:r,y:e})})),t.series.push({data:i,type:"line",connectNulls:!1,dataLabels:{enabled:!1},className:"vitara-waterfall-connector-line"}),t}}},{key:"parseWFSeriesData",value:function(t){return n.map(t,(function(t){return t&&void 0!==t.high&&void 0!==t.low?t.high-t.low:null}))}},{key:"formDataElement",value:function(t,e){var i={low:t.rSum,high:t.rSum+t.val,fv:t.fv,name:t.name,mName:t.metricTitle,cName:t.attributeTitle,columnId:t.columnId,className:t.className,nonAdditive:t.nonAdditive,isTotal:t.isTotal,subtrahend:t.subtrahend,dataRow:t.dataRow,lblVal:t.lblVal,isAggregated:t.isAggregated,pointValue:t.val};return+t.subtrahend&&!t.isTotal?(i.low=t.rSum-t.val,i.high=t.rSum):(i.low=t.rSum,i.high=t.rSum+t.val),this.context&&this.context.formDataElement?this.context.formDataElement(i,t,e):i}},{key:"getBreakByAttributeTitle",value:function(){return this.breakBy&&this.breakBy[0]?this.breakBy[0].name:null}},{key:"getNewCategoryPos",value:function(t){var e=0;return n.each(t,(function(t){t.categories?e+=t.categories.length:e++})),e}},{key:"setXAxisExtraOptions",value:function(t,e){this.xAxisExtraOptions||(this.xAxisExtraOptions=[]),this.xAxisExtraOptions[t]=e}},{key:"getXAxisExtraOptions",value:function(){return this.xAxisExtraOptions}},{key:"getNewCategoryNode",value:function(t,e,i,r,n){return r?vitaraJQ.extend({},{name:t,categories:e},i):(this.setXAxisExtraOptions(n,vitaraJQ.extend({},{name:t},i)),t)}},{key:"getTValue",value:function(t){return isNaN(t)?0:+t}},{key:"isNotNumber",value:function(t){return isNaN(t)||null===t||""===t}},{key:"getNonAggregateOpts",value:function(){return this.NON_AGGREGATE_OPTS||(this.NON_AGGREGATE_OPTS=["startValue","endValue",1==this.getNumRows()?"total":void 0]),this.NON_AGGREGATE_OPTS}},{key:"formAggregateDataElement",value:function(t){var e,i,r=this.getColumnIndex(t.columnId,this.columnIds),n=this.getBreakByAttributeTitle(),a=-1===this.getNonAggregateOpts().indexOf(t.aggregation);switch(t.aggregation){case"startValue":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.FIRST);break;case"endValue":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.LAST);break;case"total":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.SUM);break;case"minValue":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.MIN);break;case"maxValue":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.MAX);break;case"xpercent":e=this.getMetricAggregate(r,this.ENUM_AGGREGATION.X_PERCENT,{xPercentValue:t.xPercent})}return i=this.isNotNumber(e)?"":e,e=this.getTValue(e),{point:this.formDataElement({val:e,isAggregated:a,rSum:t.nonAdditive?0:this.getRunningSum(),fv:this.hcFormattedMetricVal(this.dataRows[0][r]),name:t.title,metricTitle:t.title,columnId:t.columnId,attributeTitle:n,nonAdditive:t.nonAdditive,subtrahend:t.subtrahend,lblVal:i},t),val:e}}},{key:"formWfAggregateSeries",value:function(t){var e=this.formAggregateDataElement(t);return!t.nonAdditive&&this.updateRunningSum(+t.subtrahend?-e.val:e.val),{data:[e.point],categories:[""]}}},{key:"getGroupCategoryColumns",value:function(t,e,i){var r,a=[i];return Boolean(null==t||null===(r=t.options)||void 0===r?void 0:r.groupCategories)&&(a=n.filter(t.columns,(function(t){var i;return Boolean(null===(i=e[t])||void 0===i?void 0:i.breakBy)}))),a}},{key:"formWfBreakBySeries",value:function(t,e,i,r){var a=this,o={data:[],categories:[]},s=this.getBreakByAttributeTitle(),l=this.getColumnIndex(s,this.originalTitles),u=a.getCategoryAxisValueFunction(),c=a.getGroupCategoryColumns(i,e,r),p={},h={};return o.proceedBreakbyColumns=c.length>1,n.each(this.dataRows,(function(t){var d=[];n.each(c,(function(r){p[r]=p[r]||a.getPlotOptions(e[r],i.options),h[r]=void 0!==h[r]?h[r]:a.getColumnIndex(p[r].columnId,a.columnIds);var n=a.hcMetricVal(t[h[r]]),u=a.getTValue(n),c=a.isNotNumber(n)?"":u;o.data.push(a.formDataElement({rSum:a.getRunningSum(),val:u,isAggregated:!1,fv:a.hcFormattedMetricVal(t[h[r]]),name:t[l][a.TITLE_MARKER],metricTitle:p[r].title,columnId:p[r].columnId,attributeTitle:s,subtrahend:p[r].subtrahend,dataRow:t,lblVal:c},p[r])),a.updateRunningSum(p[r].subtrahend?-u:u),o.proceedBreakbyColumns&&d.push(p[r].title)})),d.length?o.categories.push(a.formNewCategoryNode({title:u(t,l),categories:d,group:i,column:r,wfPlotOptions:e})):o.categories.push(u(t,l))})),o}},{key:"getCategoryValueFromDataRows",value:function(t,e){return t[e][this.TITLE_MARKER]}},{key:"getCategoryValueFromAttrForms",value:function(t,e){if(this.ATTR_FORM_MARKERS[e]&&t[e].forms&&Object.keys(t[e].forms).length>1){var i="",r=this.TITLE_MARKER;if(n.each(this.ATTR_FORM_MARKERS[e],(function(n,a){n&&(i=i?i+" "+t[e].forms[n][r]:t[e].forms[n][r])})),i)return i}return this.getCategoryValueFromDataRows(t,e)}},{key:"hasCategoryGrouping",value:function(t,e,i){var r;if(!Boolean(null==i||null===(r=i.options)||void 0===r?void 0:r.groupCategories))return!1;var a=0;return n.each(t,(function(t){if(e[t]&&Boolean(e[t].breakBy)&&a++,a>1)return!1})),a>1}},{key:"formNewCategoryNode",value:function(t){return this.getNewCategoryNode(t.title||t.wfPlotOptions[t.column].title,t.categories,{groupId:t.group.id,hasSubtotal:t.group.options.addSubTotal,subtrahend:t.group.options.subtrahend},+t.wfPlotOptions[t.column].breakBy,t.categoryPos)}},{key:"formWfSeriesForMetrics",value:function(t,e,i,r){if(t&&e){var a=this,o={data:[],categories:[]},s=!1;return a.hasCategoryGrouping(t,e)?a.formWfSeriesForMetricsWithGrouping(t,e,i):(n.each(t,(function(t){var l;!e[t]||Boolean(e[t].breakBy)&&s||(Boolean(e[t].breakBy)?(l=a.formWfBreakBySeries(a.getPlotOptions(e[t],i.options),e,i,t),s=l.proceedBreakbyColumns):l=a.formWfAggregateSeries(a.getPlotOptions(e[t],i.options)),l&&l.data&&(o.data=o.data.concat(l.data)),l&&l.categories&&(l.proceedBreakbyColumns?o.categories=o.categories.concat(l.categories):o.categories.push(a.formNewCategoryNode({categories:l.categories,group:i,wfPlotOptions:e,column:t,categoryPos:a.getNewCategoryPos(n.concat(n.get(r,"xAxis.categories"),o.categories))}))))})),o)}}},{key:"extendSeriesOptions",value:function(t,e,i){if(t)return e&&(t.series[0].data=t.series[0].data.concat(e)),i&&(t.xAxis.categories=t.xAxis.categories.concat(i)),t}},{key:"includeTotalBar",value:function(t,e,i,r){var n=this.formTotalBar(e,i,vitaraJQ.extend(r,{nonAdditive:!0}));return this.extendSeriesOptions(t,n.data,this.getNewCategoryNode(r.totalBarTitle,n.categories,r,!1,this.getNewCategoryPos(t.xAxis.categories)))}},{key:"clearCaches",value:function(){this.xAxisExtraOptions=void 0,this.NON_AGGREGATE_OPTS=void 0}},{key:"formWaterfallSeries",value:function(t){if(this.clearCaches(),t&&t.wfPlotOptions&&t.metricGroups){var e,i,r=this,a={xAxis:{categories:[]},series:[{data:[]}]};return r.setRunningSum(0),r.metricGroupSums={},t.totalBarUnits&&t.totalBarUnits.length&&t.totalBarUnits.length>0?(e=[].concat(t.metricGroups,t.totalBarUnits)).sort((function(t,e){return t.pos-e.pos})):e=t.metricGroups,r.showAttributeFormID=t.showAttributeFormID,e&&(n.each(e,(function(e){if(0===e.type){var n=r.getRunningSum();if(i=r.formWfSeriesForMetrics(e.columns,t.wfPlotOptions,e,a),a=r.extendSeriesOptions(a,i.data,i.categories),r.metricGroupSums[e.id]=r.getRunningSum()-n,e.options&&e.options.addSubTotal){var o=+e.options.subtrahend?-r.metricGroupSums[e.id]:r.getRunningSum(),s=+e.options.subtrahend?r.getRunningSum():0;a=r.includeTotalBar(a,o,s,{totalBarTitle:e.name,subtrahend:e.options.subtrahend,groupId:e.id,isSubTotal:!0})}}else 1===e.type&&(a=r.includeTotalBar(a,r.getRunningSum(),0,{totalBarTitle:e.name,isTotal:!0}))})),t.addTotal&&(a=r.includeTotalBar(a,this.getRunningSum(),0,{totalBarTitle:t.totalBarTitle,isTotal:!0}))),a.xAxis.extraOptions=this.getXAxisExtraOptions(),a}}},{key:"mapToWaterfallSeriesTemplate",value:function(t,e){if(t&&e&&t.length===e.length){var i=this;return n.each(e,(function(r,n){function a(){e[n].high=e[n-1]?+e[n-1].subtrahend?e[n-1].low:e[n-1].high:0,e[n].low=e[n].high-t[n].y}function o(){e[n].low=e[n-1]?+e[n-1].subtrahend?e[n-1].low:e[n-1].high:0,e[n].high=e[n].low+t[n].y}+r.subtrahend?+r.isTotal?o():a():+r.isTotal?a():o(),e[n]=i.context&&i.context.reFormDataElement?i.context.reFormDataElement(r,r,r):e[n]})),e}console.error("unequal series length found","deltaSeries: ",JSON.stringify(t),"wfSeriesTemplate: ",JSON.stringify(e))}},{key:"formSeriesForWaterfallDelta",value:function(t,e,i,r,n){var a=this.formSeriesByDelta(t,e,this.getAbsoluteDelta,i);return a&&a.length?(void 0!==n&&(a[0].data=a[0].data.map((function(t){return void 0!==t.y&&(t.y=t.y*n),t}))),[{data:this.mapToWaterfallSeriesTemplate(a[0].data,r.data)}]):[]}}])&&o(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),p}(r.chartDataMapperBase)},598:function(t,e,i){i.r(e),i.d(e,{default:function(){return o}});var r=i(475),n=i(523),a=function(){};vitaraJQ.extend(a.prototype,r.default.prototype,{COMPATIBLE_VERSIONS:["4.6.5.785"],getVersionDefaultForv4_6_5_785:function(){return n.default.getVersionDefaults()}});var o=a},595:function(t,e,i){i.r(e),i.d(e,{default:function(){return n}});var r=i(4),n=function(t){return function(t){c(i,t);var e=h(i);function i(t){var r;return o(this,i),(r=e.call(this,t))._mixinName="mstrmojo.plugins.VitaraCharts.v530159.VitaraIBCSTrellisLayout",r.ENUM_IBCS_DATA_TYPES={AC:"AC",FC:"FC",PL:"PL",PY:"PY"},r.IBCS_DEFAULT_COLORS_POS={AC:"#595959",FC:"#595959",PL:"#595959",PY:"#bfbfbf"},r.IBCS_DEFAULT_COLORS_NEG={AC:"#262626",FC:"#262626",PL:"#262626",PY:"#808080"},r}return l(i,[{key:"getTrellisConfig",value:function(t){if(!this[this.CACHE_KEYS.TRELLIS_CONFIG]||t){var e={recurse:!0,renderer:this.getUnitRenderer()};this[this.CACHE_KEYS.TRELLIS_CONFIG]=this.isTypeIBCS()?this.getDeltaViewTrellisConfig(e):e}return this[this.CACHE_KEYS.TRELLIS_CONFIG]}},{key:"isInvertedAxis",value:function(t){return t&&t.chart&&void 0!==t.chart.inverted?t.chart.inverted:Boolean(+t.invertedAxis)||this.INVERTED_AXIS}},{key:"setInstanceID",value:function(t,e){t.instanceId=this.TRELLIS_INSTANCE_PREFIX+e}},{key:"getTitlesFromConfig",value:function(t){var e=[];return r.each(t.units,(function(t){t&&t.opts&&t.opts.category&&e.push(t.opts.category)})),e}},{key:"getOpenCategoryFromtrellisData",value:function(t,e){var i=r.cloneDeep(t);return r.each(this.getRenderedChartInstance(),(function(t){t.getDataRows&&t.getDataRows().title&&-1===i.indexOf(t.getDataRows().title)&&i.push(t.getDataRows().title)})),r.filter(e,(function(t){return-1===i.indexOf(t.title)}))[0]}},{key:"getTrellisDataByConfig",value:function(t,e,i){if(t)return t.units&&t.units[e]&&t.units[e].opts&&t.units[e].opts.category?r.filter(i,(function(i){return i.title===t.units[e].opts.category}))[0]:this.getOpenCategoryFromtrellisData(this.getTitlesFromConfig(t),i)}},{key:"formChartRendererInstances",value:function(){var t=this,e=this.getTrellisConfig(!0),i=this.getTrellisData();e&&(!e||e.recurse||e.units)&&r.times(e.length||i.length,(function(n){var a=e.units&&e.units[n]&&e.units[n].renderer?e.units[n].renderer:e.renderer;if(!a)return!1;var o=new a(t.getVizDataInterface(),t.getNodePosition(),null,t.getExtraOptions(),r.cloneDeep(t.getVizProps()),t.getTrellisDataByConfig(e,n,i),e.units&&e.units[n]?e.units[n].opts:null);t.setInstanceID(o,n),t.setRenderedChartInstance(o),o.formChartOptions()}))}},{key:"setCategoryAxisLabelFormatter",value:function(t){return this.setIBCSTypeAxisLabelFormatter(t),t}},{key:"setIBCSTypeAxisLabelFormatter",value:function(t){if(t&&t.xAxis){t.xAxis.labels||(t.xAxis.labels={});var e=this;t.xAxis.className="vitara-axis vitara-x-axis vitara-category-axis vitara-no-wrap-label",t.xAxis.labels.enableIBCSStyle=t.chart&&t.chart.inverted,t.xAxis.labels.indent=void 0!==t.xAxis.labels.indent||t.xAxis.labels.indent,t.xAxis.labels.indent&&(t.xAxis.labels.useHTML=!0,t.xAxis.labels.align="left"),t.xAxis.labels.formatter=function(){var i=this.formatCtx&&this.formatCtx.value&&this.formatCtx.value.parent?this.formatCtx.value.parent:this.value&&r.has(this.value,"userOptions")?this.value.userOptions:void 0;if(void 0!==i){var n=r.get(this,"axis.options.extraOptions["+this.pos+"]");"string"==typeof i&&void 0!==n&&(i=n);var a=i.name||i,o=e.isTypeIBCS()?String.fromCharCode(43):"",s=e.isTypeIBCS()?String.fromCharCode(61):"";return i.isTotal||i.isSubTotal?"<b>"+(a=i.isSubTotal?+i.subtrahend?String.fromCharCode(45)+" "+a:o+" "+a:s+" "+a)+"</b>":i.hasSubtotal&&t.xAxis.labels.indent?"<span>&nbsp&nbsp&nbsp&nbsp&nbsp"+a+"<span>":+i.subtrahend?String.fromCharCode(45)+" "+a:o+" "+a}}}}}]),i}(t)}},596:function(t,e,i){i.r(e),i.d(e,{VitaraTrellisDeltaViewHelper:function(){return u}});var r=i(515),a=i(597),s=i(4),u=function(t){return function(t){c(i,t);var e=h(i);function i(t){var r;return o(this,i),(r=e.call(this,t))._mixinName="mstrmojo.plugins.VitaraCharts.v530159.VitaraTrellisDeltaViewHelper",r}return l(i,[{key:"getDeltaUnitsCount",value:function(){return+this.getVizProps().enableDeltaView&&+this.getVizProps().enableDeltaPercentageView?2:+this.getVizProps().enableDeltaView||+this.getVizProps().enableDeltaPercentageView?1:0}},{key:"hasPrimaryWaterfallView",value:function(){return this.getWaterfallUnitsCount()>0}},{key:"hasSecondaryWaterfallView",value:function(){return this.getWaterfallUnitsCount()>1}},{key:"validateRePlot",value:function(){return!!n(g(i.prototype),"validateRePlot",this).call(this)&&this.getPrevVizProps().enableDeltaView===this.getVizProps().enableDeltaView&&this.getPrevVizProps().enableDeltaPercentageView===this.getVizProps().enableDeltaPercentageView}},{key:"getWaterfallUnitsCount",value:function(){var t=this.getDataMarkerOptions().length;return t>1?2:t}},{key:"getTColor",value:function(t){return t||void 0}},{key:"getIBCSWFViewExtraOptions",value:function(){return{chart:{inverted:!0,zoomType:void 0},plotOptions:{series:{maxPointWidth:20,dataLabels:{}}},yAxis:{gridLineWidth:0,lineWidth:0,plotLines:[{dashStyle:"solid",color:"#808080",width:3,value:0,className:"vitara-delta-axis-line"}]},xAxis:{gridLineWidth:0,lineWidth:0,labels:{groupedOptions:[{reserveSpace:!0}],align:"left",reserveSpace:!0,useHTML:!0}}}}},{key:"getIBCSDeltaViewExtraOptions",value:function(){return{yAxis:{gridLineWidth:0},xAxis:{gridLineWidth:0,lineWidth:0}}}},{key:"getValidateMarkerState",value:function(t){if(this.getVizProps()[t]){var e=this.getDataMarkerOptions();return e&&0!==e.length?-1!==s.indexOf(e,this.getVizProps()[t])?this.getVizProps()[t]:null:this.getVizProps()[t]}}},{key:"findDataTypeFromGlobal",value:function(t){return t?s.findKey(this.utils.getIBCSDataIndicatorsMap(),(function(e){var i=[];return s.each(e,(function(e){if(i.length>0)return!1;if(0===(n=e).indexOf("[")&&n.indexOf("]")===n.length-1)try{var r=new RegExp(e.slice(1,e.length-1));t.match(r)&&i.push(t)}catch(t){console.log("Invalid Regular Expression: "+e)}else t===e&&i.push(t);var n})),i.length>0})):-1}},{key:"getAvailableCategories",value:function(t){return s.difference(this.getDataMarkerOptions(),[this.getValidateMarkerState("wfAttrElemV1"),this.getValidateMarkerState("wfAttrElemV2")],t)}},{key:"getAvailableDataTypes",value:function(t,e){var i=["AC"],r=["PL","PY"];if(!t.p||!t.s)return 1===e?i:t.p?t.s?void 0:-1===i.indexOf(t.p)?i:r:-1===r.indexOf(t.s)?r:i}},{key:"getWaterfallViewOpts",value:function(){var t={selCategory:this.getValidateMarkerState("wfAttrElemV1"),category:this.getValidateMarkerState("wfAttrElemV1"),selDataType:this.getVizProps().wfAttrElemTypeV1||"",dataType:this.getVizProps().wfAttrElemTypeV1||void 0},e={selCategory:this.getValidateMarkerState("wfAttrElemV2"),category:this.getValidateMarkerState("wfAttrElemV2"),selDataType:this.getVizProps().wfAttrElemTypeV2||"",dataType:this.getVizProps().wfAttrElemTypeV2||void 0},i=this.getWaterfallUnitsCount();return t.category=void 0===t.category?this.getAvailableCategories([e.category])[0]:t.category,e.category=void 0===e.category?this.getAvailableCategories([t.category])[0]:e.category,t.dataType||(t.dataType=this.findDataTypeFromGlobal(t.category)||this.getAvailableDataTypes({p:void 0,s:e.dataType||this.findDataTypeFromGlobal(e.category)},i)[0]),e.dataType||(e.dataType=this.findDataTypeFromGlobal(e.category)||this.getAvailableDataTypes({p:t.dataType,s:void 0},i)[0]),{p:t,s:e}}},{key:"getColorByDataType",value:function(t,e,i){return e||(i?this.IBCS_DEFAULT_COLORS_POS[t]:this.IBCS_DEFAULT_COLORS_NEG[t])}},{key:"getMinuendOptions",value:function(t){return vitaraJQ.extend(t,{colors:[null,null],extraOptions:this.getIBCSWFViewExtraOptions()})}},{key:"getSubtrahendOptions",value:function(t){return vitaraJQ.extend(t,{colors:[null,null],extraOptions:this.getIBCSWFViewExtraOptions()})}},{key:"getDeltaViewOptions",value:function(t){return{category:this.getVizProps().wfAttrElemV2,dataType:this.getVizProps().wfAttrElemTypeV2,colors:[this.getTColor(this.getVizProps().pColorDelta),this.getTColor(this.getVizProps().nColorDelta)],hasPlannedview:this.isPlannedTypeEnabled(t),extraOptions:this.getIBCSDeltaViewExtraOptions()}}},{key:"isPlannedTypeEnabled",value:function(t){return t?t.p.dataType===this.ENUM_IBCS_DATA_TYPES.PL||t.s.dataType===this.ENUM_IBCS_DATA_TYPES.PL:this.getVizProps().wfAttrElemTypeV1===this.ENUM_IBCS_DATA_TYPES.PL||this.getVizProps().wfAttrElemTypeV2===this.ENUM_IBCS_DATA_TYPES.PL}},{key:"getDeltaViewTrellisConfig",value:function(t){var e={recurse:!1,units:[],isDeltaView:!0,length:this.getWaterfallUnitsCount()+this.getDeltaUnitsCount()},i=s.merge(t,e),n=this.getWaterfallViewOpts();return this.hasPrimaryWaterfallView()&&i.units.push({opts:this.getMinuendOptions(n.p)}),this.hasSecondaryWaterfallView()&&i.units.push({opts:this.getSubtrahendOptions(n.s)}),+this.getVizProps().enableDeltaView&&i.units.push({renderer:"waterfall"===this.getVizProps().deltaViewChartType?a.renderHCWaterfallDeltaView:r.renderHCDeltaView,opts:vitaraJQ.extend(this.getDeltaViewOptions(n),{chartType:"waterfall"===this.getVizProps().deltaViewChartType?2:0})}),+this.vizProps.enableDeltaPercentageView&&i.units.push({renderer:r.renderHCDeltaView,opts:vitaraJQ.extend(this.getDeltaViewOptions(n),{chartType:1})}),i}},{key:"getPrimarySeriesLimits",value:function(t){if(t&&t.getRenderOptions()&&t.getMinMaxFromData){var e={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER};return s.each(t.getMinMaxFromData(),(function(t){e.min=Math.min(e.min,t.min),e.max=Math.max(e.max,t.max)})),e}}},{key:"preRenderTrellisNodes",value:function(){n(g(i.prototype),"preRenderTrellisNodes",this).call(this),this.setChartLegendLabels(),this.setLayoutWeights()}},{key:"isIBCSEnabledWithSmallMultiples",value:function(){return!1}},{key:"getLayoutWeights",value:function(){return this[this.CACHE_KEYS.IBCS_LAYOUT_WEIGHTS]}},{key:"getAbsDeltaSeriesLimits",value:function(t){return t&&t.isWaterfallDeltaView&&t.isWaterfallDeltaView()?this.getPrimarySeriesLimits(t):n(g(i.prototype),"getAbsDeltaSeriesLimits",this).call(this,t)}},{key:"setLayoutWeights",value:function(){var t,e,i,r,n,a=this.getRenderedChartInstance()[0],o=this.getRenderedChartInstance()[1],s=this.getRenderedChartInstance()[2],l=this.getRenderedChartInstance()[3],u=[],c=1-.2*this.getPercentageDeltaViewCount();return t=this.getAbsValueRange(this.getPrimarySeriesLimits(a))+this.getChartMargin(this.getPrimarySeriesLimits(a)),e=o?this.getAbsValueRange(this.getPrimarySeriesLimits(o))+this.getChartMargin(this.getPrimarySeriesLimits(o)):0,i=s&&s.isDeltaView()?this.getAbsValueRange(this.getAbsDeltaSeriesLimits(s))+this.getChartMargin(this.getAbsDeltaSeriesLimits(s)):0,r=l&&l.isDeltaView()?this.getAbsValueRange(this.getAbsDeltaSeriesLimits(l))+this.getChartMargin(this.getAbsDeltaSeriesLimits(l)):0,n=t+e+(s&&s.isDeltaView()?i:0)+(l&&l.isDeltaView()?r:0),u[0]=this.roundVal(t/n)*c,u[1]=this.roundVal(e/n)*c,u[2]=s?s.isDeltaView()?this.roundVal(i/n)*c:.2:null,u[3]=l?l.isDeltaView()?this.roundVal(r/n)*c:.2:null,u[2]&&u[2]<.2&&(u[2]=.2,c=1-u[2]-(u[3]?u[3]:0),n-=i+r,u[0]=this.roundVal(t/n)*c,u[1]=this.roundVal(e/n)*c),this[this.CACHE_KEYS.IBCS_LAYOUT_WEIGHTS]=u,this[this.CACHE_KEYS.IBCS_LAYOUT_WEIGHTS]}},{key:"postProcessLabels",value:function(t){return s.isArray(t)?s.filter(t,(function(t){return t.formatter||t.format})):t}},{key:"getDefDataLabelOptionsForLegendLabelling",value:function(t,e,i){var r=t.plotOptions&&t.plotOptions.series&&t.plotOptions.series.dataLabels?t.plotOptions.series.dataLabels:void 0;return("legend"===e&&void 0!==r.padding||"dataLabel"===e&&i)&&((r=s.cloneDeep(r)).padding=0),r}},{key:"isLegendLabelOnTop",value:function(t){return!1}},{key:"setChartLegendLabels",value:function(){this.getRenderedChartInstance()[0]&&this.setLegendLabelsIBCSStyle(this.getRenderedChartInstance()[0].getRenderOptions()),this.getRenderedChartInstance()[1]&&this.setLegendLabelsIBCSStyle(this.getRenderedChartInstance()[1].getRenderOptions()),this.setDeltaViewLegendLabels()}},{key:"setDeltaViewLegendLabels",value:function(){var t=s.filter(this.getRenderedChartInstance(),(function(t){return t.scriptClass&&("renderHCDeltaView"===t.scriptClass||"renderHCWaterfallDeltaView"===t.scriptClass)}));if(t&&!(t.length<1)){var e=this;s.each(t,(function(i,r){delete t[r].getRenderOptions().title,e.setLegendLabelsIBCSStyle(t[r].getRenderOptions())}))}}},{key:"getAssignedChartTitle",value:function(t,e){if(!this.isCompositeMode()||this.isIBCSEnabledWithSmallMultiples())return n(g(i.prototype),"getAssignedChartTitle",this).call(this,t,e)}},{key:"getDeltaViewTitle",value:function(){if(this.getRenderedChartInstance()[0]&&this.getRenderedChartInstance()[0].getRenderOptions().series[0])return this.getRenderedChartInstance()[0].getRenderOptions().series[0].ibcsDataType}},{key:"isPrimaryWFScalingReq",value:function(){return this.getWaterfallUnitsCount()>1}},{key:"getScaleRefChartInstance",value:function(){if(null!==this.getLayoutWeights()){var t=this.isPrimaryWFScalingReq()?s.indexOf(this.getLayoutWeights(),s.min(this.getLayoutWeights().slice(0,2))):0;if(!(-1===t||t>1))return this.getRenderedChartInstance()[t]}}},{key:"isScalingReq",value:function(t){return t.getIBCSOptions&&0===t.getIBCSOptions().chartType||this.isPrimaryWFScalingReq()&&this.getScaleRefChartInstance()!==t}},{key:"scaleRenderedChart",value:function(t){if(!this.isTypeIBCS())return n(g(i.prototype),"scaleRenderedChart",this).call(this,t);var e=this;this.getScaleRefChartInstance().setRelativeScaling.call(this.getScaleRefChartInstance(),t),s.each(this.getRenderedChartInstance(),(function(t){e.isScalingReq(t)&&(t.isDeltaView&&t.isDeltaView()?t.setRelativeScaling.call(t):t&&t.updateVizPostTrellisRender&&t.updateVizPostTrellisRender())}))}}]),i}(t)}},592:function(t,e,i){i.r(e),i.d(e,{VitaraHCWaterfallChartMixin:function(){return C}}),i(1);var r=i(593),a=i(477),s=i(468),u=i(512),p=i(595),d=i(596),v=i(517),m=i(518),y=i(598),b=i(4),C=function(t){c(i,t);var e=h(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).scriptClass="mstrmojo.plugins.VitaraCharts.v530159.VitaraHCWaterfallChart",r.cssClass="VitaraHCWaterfallChart",r.NAME="Vitara Waterfall Chart",r.COLOR_PALETTE="waterfallColors",r.vitara_chart_type="waterfall",r.SMALL_MULTIPLE_OPTIONS={legend:{enabled:!1}},r.logEnvironmentInfo(),r}return l(i,[{key:"getDefaultSplitMode",value:function(){return+this.getVizProps().invertedAxis?this.getTrellisLayoutHelper().ENUM_SPLIT_MODE.HORIZONTAL:this.getTrellisLayoutHelper().ENUM_SPLIT_MODE.VERTICAL}},{key:"validateMinCriteria",value:function(t,e){return{valid:e>0,message:"Include at least 1 metric to see the chart."}}},{key:"getMetricIds",value:function(){if(!this.dataHelper)return[];var t=this.dataHelper.getColumnIds();return t.slice(this.dataHelper.getNumAttributes(),t.length)}},{key:"getMetricTitles",value:function(){if(this.dataHelper){var t=this.dataHelper.getTitles(),e=this.dataHelper.getNumAttributes();return t.slice(e,t.length)}return[]}},{key:"getEditorName",value:function(){return"Waterfall"}},{key:"getChartColors",value:function(){return this.getCustomPaletteDefaults()?this.getCustomDefaultPaletteColors():this.getDefaultColors()}},{key:"getDefaultColors",value:function(){return b.cloneDeep(this.defaultChartColors.waterfallColors)}},{key:"updatePlotOptions",value:function(t){this.propMenuPropertyState&&(this.readChartState=!1,this.propMenuPropertyState.wfPlotOptions=t)}},{key:"inlcudeAllMetricsToPlotOptions",value:function(t){var e=this.getMetricIds(),i=this.getMetricTitles(),r=b.filter(e,(function(e){return!b.has(t,e)}));return b.each(r,(function(r){t[r]={title:i[e.indexOf(r)],columnId:r,breakBy:!1,aggregation:"total",nonAdditive:!1}})),r.length&&this.updatePlotOptions(t),t}},{key:"getMetricTitlesFromIDs",value:function(t){var e=this.getMetricIds(),i=this.getMetricTitles(),r=[];return b.each(t,(function(t,n){var a=e.indexOf(t);-1!==a&&r.push(i[a])})),r}},{key:"getMetricIdsFromOptions",value:function(){var t=this.getMetricIds();return t.length?b.filter(b.keys(this.getPlotOptions()),(function(e){return-1!==b.indexOf(t,e)})):b.keys(this.getPlotOptions())}},{key:"getMetricIdsFromTitles",value:function(t){if(!t||!t.length)return t;var e=this.getMetricIds(),i=this.getMetricTitles();return b.map(t,(function(t){var r=i.indexOf(t);if(-1!==r)return e[r]}))}},{key:"getTotalBarUnits",value:function(){return this.vizProps.calculationScheme&&this.vizProps.calculationScheme.totalBarUnits?this.vizProps.calculationScheme.totalBarUnits:[]}},{key:"inlcudeAllMetricsToMetricGroups",value:function(t){var e=this.getMetricIds(),i=b.flatten(b.map(t,(function(t){return t.columns}))),r=b.filter(e,(function(t){return-1===b.indexOf(i,t)}));if(r.length<1)return t;var n=b.findIndex(t,(function(t){return t.isDefault}));return t[n=-1!==n?n:0]&&t[n].columns?(t[n].columns=b.concat(t[n].columns,r),t[n].titles=b.concat(t[n].titles,this.getMetricTitlesFromIDs(r)),t):t}},{key:"convertMetricGroups",value:function(t){var e=this;return b.map(t,(function(t){return t.columns=e.getMetricIdsFromTitles(t.titles),t}))}},{key:"getMetricGroups",value:function(){var t=null;return this.vizProps.calculationScheme&&this.vizProps.calculationScheme.metricGroups?t=this.vizProps.calculationScheme.metricGroups:(t=[{type:0,id:"defaultGroup",columns:this.getMetricIdsFromOptions(),isDefault:!0,name:"Default Group",options:{addSubTotal:!1,subtrahend:!1},pos:0}])[0].titles=this.getMetricTitlesFromIDs(t[0].columns),this.inlcudeAllMetricsToMetricGroups(t)}},{key:"getCompatibleColumnId",value:function(t,e,i){var r=i.indexOf(t);if(-1!==r)return e[r];var n=void 0;if(t&&"function"==typeof t.split){var a=t.split(":").length>1?t.split(":"):t.split(";");n=b.filter(a,(function(t){return-1!==e.indexOf(t)}))[0]}return void 0!==n?n:t}},{key:"compatabilityCheckForColumnIds",value:function(t){if(!this.utils.isBetweenVersions(t.version,"4.5.0.694","4.5.4.706"))return t;var e,i=this.platformContext.dataHelper.getBCColumnIds(),r=this.platformContext.dataHelper.getColumnIds(),n={},a=[];if(t.wfPlotOptions&&!t.wfPlotOptions.isDefault){for(var o in t.wfPlotOptions)"object"==f(t.wfPlotOptions[o])?(n[e=this.getCompatibleColumnId(o,r,i)]=t.wfPlotOptions[o],n[e].columnId=e):n[o]=t.wfPlotOptions[o];b.isEqual(t.wfPlotOptions,n)||(t.wfPlotOptions=n)}if(t.calculationScheme&&t.calculationScheme.metricGroups){a=b.cloneDeep(t.calculationScheme.metricGroups);for(var s=0;s<a.length;s++)if(a[s].columns){for(var l=0;l<a[s].columns.length;l++)a[s].columns[l]=this.getCompatibleColumnId(a[s].columns[l],r,i);a[s].titles=this.getMetricTitlesFromIDs(a[s].columns)}b.isEqual(t.calculationScheme.metricGroups,a)||(t.calculationScheme.metricGroups=a)}return t}},{key:"getPlotOptions",value:function(){var t;return t=this.vizProps.wfPlotOptions?this.vizProps.wfPlotOptions.isDefault?this.getLegacyPlotOptions():this.plotOptionsPreCleanUp(this.vizProps.wfPlotOptions):this.getLegacyPlotOptions(),this.inlcudeAllMetricsToPlotOptions(t)}},{key:"isVerticalWF",value:function(t){var e=t||this.getVizProps();return void 0!==e.invertedAxis?+e.invertedAxis:(e.invertedAxis=void 0===e.version||!this.utils.isOlderVersion(e,"4.2.0.500"),e.invertedAxis)}},{key:"hasGridLines",value:function(){return void 0===this.getVizProps().yAxisGridLines&&+this.getVizProps().yAxisGridLines}},{key:"addVersionCompatibleDefaults",value:function(t){t=n(g(i.prototype),"addVersionCompatibleDefaults",this).call(this,t);var e=new m.default;return(new y.default).addVersionDefaults(e.addVersionDefaults(t))}},{key:"sharedCatAxisSupport",value:function(){return!1}},{key:"getPropMenuDefaults",value:function(){var t=this.getPlotOptions(),e=this.getChartColors();return b.extend(n(g(i.prototype),"getPropMenuDefaults",this).call(this),this.getPropMenuDefaultsByVersion(),{wfPlotOptions:t,wfEnableTotal:"1",wfAutoComputeYStart:"0",waterfallUpColor:e[0],waterfallDownColor:e[1],waterfallTotalColor:e[2],wfTotalAlias:"Total",wfEnableBridgeLine:"1",wfTruncAxisLbls:"1",includeAttributeFormID:"1",sharedValueAxis:"1",invertedAxis:this.isVerticalWF(),barColumnLabelPosition:this.isVerticalWF()})}},{key:"getPropertiesToDisable",value:function(){var t=[];return this.dataHelper.numAttributes<1&&(t=["wfStartValue"]),t}},{key:"getDataLabelTypes",value:function(){return[]}},{key:"getFieldOptions",value:function(t,e){return 0!=this.vizProps.wfEnableTotal&&e.push({value:"total",text:"Total"}),e}},{key:"convertPlotOptions",value:function(t){var e=this.getMetricTitles(),i=this.getMetricIds(),r={};return b.each(t,(function(t,n){var a=e.indexOf(n);-1!==a&&(r[i[a]]=t,r[i[a]].columnId=i[a])})),r}},{key:"plotOptionsPreCleanUp",value:function(t){var e=this.getMetricIds(),i=this.isBreakBy(),r={};return e.forEach((function(e){var n;t[e]&&(r[e]=t[e],r[e].breakBy=r[e].breakBy?i:r[e].breakBy,(n=r[e]).breakBy||""!==n.aggregation||delete r[e])})),r=Object.keys(r).length>0?r:this.getLegacyPlotOptions(),b.isEqual(t,r)||this.updatePlotOptions(r),r}},{key:"isBreakBy",value:function(){return void 0!==this.getBreakByZone()}},{key:"getBreakByZone",value:function(){return this.getZoneData(this.getChartDataMapper()).breakby}},{key:"getLegacyPlotOptions",value:function(){var t={},e=this.getMetricIds(),i=this.getMetricTitles();if(this.isBreakBy()){if(t[e[0]]={title:i[0],columnId:e[0],breakBy:!1,aggregation:"startValue",nonAdditive:!1},e.length>1&&(t[e[1]]={title:i[1],columnId:e[1],breakBy:!0,aggregation:"",nonAdditive:!1}),e.length>2)for(var r=2;r<e.length;r++)t[e[r]]={title:i[r],columnId:e[r],breakBy:!1,aggregation:"total",nonAdditive:!1}}else e.forEach((function(r,n){t[r]={title:i[n],columnId:e[n],breakBy:!1,aggregation:"total",nonAdditive:!1}}));return t.isDefault=!0,this.updatePlotOptions(t),t}},{key:"getDataMarkerOptions",value:function(){if(this.isTrellisMode())return this.getChartDataMapper().getCategoriesByTitle(this.getTrellisDropZoneItems())}},{key:"getDataIndicatorsState",value:function(){if(this.isTrellisMode())return this.getWaterfallViewOpts?this.getWaterfallViewOpts():null}},{key:"getFetchCalls",value:function(){var t=this;return{disableBreakBy:function(){return!t.isBreakBy()},validatePlotOptions:function(e){return t.plotOptionsPreCleanUp(e)},getMetricGroups:function(){return t.getMetricGroups()},getPlotOptions:function(){return t.getPlotOptions()},getDataIndicatorOptions:function(){return t.getDataMarkerOptions()},getDataIndicatorsState:function(){return t.getDataIndicatorsState()},getTotalBarUnits:function(){return t.getTotalBarUnits()}}}},{key:"getChartSpecificMentions",value:function(t){return"deltaViewLabel"===t?["point.value"]:[this.vizProps.wfTotalAlias||"Total"]}},{key:"getIncludeGenericMentions",value:function(t){return"deltaViewLabel"!==t}},{key:"getDefaultTooltipFormat",value:function(){return"&[point.category] <br/>&[point.value]"}},{key:"getUnitRenderer",value:function(){return r.renderWaterfall}},{key:"validateIBCSMinCriteria",value:function(){return!!n(g(i.prototype),"validateIBCSMinCriteria",this).call(this)&&void 0!==this.getTrellisDropZoneItems()}},{key:"getTrellisDropZoneItems",value:function(){var t,e;if(isMSTRDashBoard()||isMSTRDesktop()||(e=this.getChartDataMapper()),(t=this.getZoneData(e))&&t.groupby)return t.groupby}},{key:"processSampleAxisOptions",value:function(t){if(t.xAxis&&t.xAxis.labels&&t.xAxis.labels.formatter){var e=t.xAxis.labels.formatter;t.xAxis.labels.formatter=function(){var t=e.call(this);return t?(t=t.replace(new RegExp("&nbsp".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"___"),b.startsWith(t,"+ ")?t=t.replace(new RegExp("+ ".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"______"):b.startsWith(t,"- ")?t=t.replace(new RegExp("- ".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"______"):b.startsWith(t,"= ")&&(t=t.replace(new RegExp("= ".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"______")),t):t}}return t}},{key:"getXAxisDirection",value:function(t,e){return 0==+(e&&void 0===e.invertedAxis?this.isVerticalWF(e):e.invertedAxis)?!this.flipAxisDirection(t):this.flipAxisDirection(t)}},{key:"isOlderVersion",value:function(){return void 0!==this.getVizProps().version&&this.utils.isOlderVersion(this.getVizProps(),"4.2.0.500")}},{key:"getPropMenuDefaultsByVersion",value:function(){return this.isOlderVersion()?{yAxisLabelHide:"0",xAxisLineWidth:0,labelsEnable:"0",yAxisGridLineWidth:1}:{yAxisLabelHide:"1",yAxisGridLineWidth:0,xAxisLineWidth:1,showXAxisLine:"1",labelsEnable:"1"}}},{key:"getChartDefaultsByVersion",value:function(){return this.isOlderVersion()?{xAxis:{lineWidth:0,gridLineWidth:0},plotOptions:{series:{maxPointWidth:this.getVizProps().seriesTypeWidth||50,dataLabels:{enabled:!1}}},yAxis:{gridLineWidth:1,labels:{enabled:!0}}}:{xAxis:{lineWidth:1,gridLineWidth:0},plotOptions:{series:{maxPointWidth:this.getVizProps().seriesTypeWidth||20,dataLabels:{enabled:!0}}},yAxis:{gridLineWidth:0,labels:{enabled:!1}}}}},{key:"processStateVersionUpdate",value:function(t){return void 0!==this.lastSavedVersion&&this.utils.isOlderVersion({version:this.lastSavedVersion},"4.2.0.500")&&(t.xAxisLineWidth=b.has(t,"xAxisLineWidth")?t.xAxisLineWidth:0,t.showXAxisLine=!!b.has(t,"showXAxisLine")&&t.showXAxisLine,t.yAxisGridLineWidth=b.has(t,"yAxisGridLineWidth")?t.yAxisGridLineWidth:1,t.yAxisLabelsEnable=!b.has(t,"yAxisLabelsEnable")||t.yAxisLabelsEnable,t.seriesMaxPointWidth=b.has(t,"seriesMaxPointWidth")?t.seriesMaxPointWidth:50,t.labelsEnable=!!b.has(t,"labelsEnable")&&t.labelsEnable),t}},{key:"getCustomLabelEditorOptions",value:function(){var t=[{value:"customLabel",text:"Data Label"}];return this.isTypeIBCS()&&t.push({value:"deltaViewLabel",text:"Delta Label"}),t}}]),i}(VitaraMix(a.default).with(s.default,u.default,p.default,v.default,d.VitaraTrellisDeltaViewHelper));window.VitaraHCWaterfallChartMixin=C},593:function(t,i,r){r.r(i),r.d(i,{renderWaterfall:function(){return v}});var n=r(45),a=r(399),o=r(436),s=r(470),l=r(516),u=r(469),c=r(594),p=r(442),h=r(443),d=r(441),g=r(4),v=function(t,e,i,r,n,a,s){o.hcCore.call(this,t,e,i,n),this.setVizProps(n),this.updateWFColorsFromVizProps(),this.setWFOptions(r),this.setDataRows(a),this.setIBCSOptions(s)};vitaraJQ.extend(v.prototype,o.hcCore.prototype,p.scalingHelper.prototype,h.default.prototype,l.waterfallStyledModeRenderer.prototype,d.default.prototype,{localUtils:{Array:{insert:function(t,e,i){t.splice(e,0,i)},insertMultiple:function(t,i,r,n){t.splice.apply(t,[i,r].concat(e(n)))},pickNext:function(t,e){return t[g.findIndex(t,(function(t){return null!==t}),e+1)]}}},COLOR_PALETTE:"waterfallColors",dontCreateFilterSelectionMap:!0,setIBCSOptions:function(t){this.IBCSOptions=t},getIBCSOptions:function(){return this.IBCSOptions},getWFViewDataType:function(){return this.wfViewType},setWFViewDataType:function(t){this.wfViewType=t},isEmptyBars:function(){return this.isTypeIBCS&&this.isTypeIBCS()&&this.isTypeIBCSPlanned&&this.isTypeIBCSPlanned()},isTypeIBCS:function(){return this.context.isTypeIBCS&&this.context.isTypeIBCS()},isTypeIBCSPlanned:function(){return!!this.getIBCSOptions()&&this.getIBCSOptions().dataType===this.context.ENUM_IBCS_DATA_TYPES.PL},setVizProps:function(t){this.vizProps=t},getVizProps:function(){return this.vizProps},updateWFColorsFromVizProps:function(){var t=this.context.getCustomDefaultPaletteColors()||[];this.setWFColors(g.merge(g.clone(a.default.waterfallColors),[this.getVizProps().waterfallUpColor||t[0]||void 0,this.getVizProps().waterfallDownColor||t[1]||void 0,this.getVizProps().waterfallTotalColor||t[2]||void 0]))},setWFColors:function(t){this.WFColors=t},getWFColors:function(){return this.WFColors},getWFOptions:function(){return this.wfOptions},setWFOptions:function(t){this.wfOptions=t},customDataLabelFormatter:function(t){var e=this;if(t.point){var i=e.vizProps.customLabel;if(null!=i&&null!=i&&""!=i){var r=e.vizProps.customLabelcolstate;return e.formCustomTooltip(t,i,r)}var a=e.getColIndex(t.point.category.parent?t.point.category.parent.name:t.point.category.name);return-1===a&&(a=e.chartDataMapper.numAttributes),n.utils.shortenNumber({rawVal:this.getWFPointValue(t.point),fv:n.utils.formatMetricLike(this.getWFPointValue(t.point),e.chartDataMapper.dataRows.metaInfo[a])},e.vizProps.dataLabelDisplayFormat)}return!1},wfDataLabelFormatter:function(t){if(!t.point)return"";var e=this.isTypeIBCS();if(this.showNegativeLabelsAtBottom()){if(0==t.point.high){if(t.point.negative&&t.y==t.point.high)return"";if(!t.point.negative&&t.y==t.point.low)return""}if(t.point.high<0&&t.y==t.point.high)return"";if(t.point.high>0&&t.y==t.point.low)return""}else if(e&&t.point.subtrahend?t.y!==t.point.low:t.y!==t.point.high)return"";if(t.point.high===t.point.low&&t.point.dataLabelUpper)return"";if(0==this.getWFPointValue(t.point)&&void 0!==t.point.lblVal)return"";var i=this.customDataLabelFormatter(t);return i=n.utils.appendTargetBlankToHTMLString(i),e&&t.point.isTotal&&(i="<b>"+i+"</b>"),this.includeCss(this.getLabelClassName(t.point),i)},isVerticalWF:function(){return this.getVizProps().invertedAxis=this.context.isVerticalWF(),this.getVizProps().invertedAxis},setCategoryAxisLabelAlignment:function(t){t.xAxis&&t.xAxis.categories&&(this.context&&this.context.isBreakBy()?t.xAxis.labels.indent=void 0:t.xAxis.labels.indent=!0)},forceOutlierLabelsOutside:function(){return 1==+this.getVizProps().forceOutlierLabelsOutside},showLabelsOutside:function(){return void 0===this.getVizProps().barColumnLabelPosition?!!this.isVerticalWF():+this.getVizProps().barColumnLabelPosition},getDataLabelAlignmentOptions:function(){var t=this.showLabelsOutside(),e=t&&this.forceOutlierLabelsOutside(),i={vertical:{inside:{inside:!0,verticalAlign:"middle",allowOverlap:!0},outside:{inside:!1,crop:!e&&void 0,overflow:e?"allow":void 0,verticalAlign:"middle",allowOverlap:!0,padding:16}},horizontal:{inside:{verticalAlign:"middle",align:"center",inside:!0},outside:{inside:!1,crop:!e&&void 0,overflow:e?"allow":void 0,padding:e?1:5,verticalAlign:"bottom"}}},r={plotOptions:{series:{dataLabels:{}}}};return this.isVerticalWF()?r.plotOptions.series.dataLabels=t?i.vertical.outside:i.vertical.inside:r.plotOptions.series.dataLabels=t?i.horizontal.outside:i.horizontal.inside,r},pointClickHandlerFunction:function(t){!0!==this.renderedChart.stopProp&&(this.context.clearAllSelections(t),this.context.handlePointSelection(t,!0)),this.renderedChart.stopProp=!1},pointSelectionFunction:function(t){t.resetSelection&&(this.renderedChart.stopProp=!0)},getDefaultChartOptions:function(){var t=this;return Highcharts.merge({chart:{type:"columnrange",zoomType:"xy",inverted:t.isVerticalWF(),events:{selection:t.pointSelectionFunction.bind(t),click:t.pointClickHandlerFunction.bind(t),load:t.getOnChartLoadCallback()}},xAxis:{categories:[],tickLength:0,lineColor:"#808080",labels:{groupedOptions:[{reserveSpace:!0,autoRotation:[0,90]}],autoRotation:[0,90],reserveSpace:!0,useHTML:!0}},plotOptions:{line:{connectNulls:!1,enableMouseTracking:!1},dashStyle:"dot",series:{dataLabels:{formatter:function(){return t.wfDataLabelFormatter(this)},style:{textOutline:!1}},point:{events:{click:t.context.applySelections()}}}},tooltip:{enabled:!0,formatter:function(){var e=t.vizProps.customTooltip;return null!=e&&null!=e&&""!=e?t.formCustomTooltip(this,e):'<span class="vitara-tooltip">'+this.point.name+"<br/>"+t.getFormattedValue(this.point)+"</span>"}},series:[{upColor:this.getWFColors()[0],color:this.getWFColors()[1],data:[],pointPadding:0}]},this.getDataLabelAlignmentOptions(),this.context.getChartDefaultsByVersion())},getDataRows:function(){return this.dataRows},setDataRows:function(t){this.dataRows=t},getTrellisDataMapper:function(){return this.trellisDataHelper||(this.trellisDataHelper=new u.default(this.getGroupByZone(this.getZoneData()),this.getBreakByZone(this.getZoneData()),this.data.getDataAsArray(),this.data.getTitles(),this.data.numAttributes,this)),this.trellisDataHelper},getTrellisLayoutHelper:function(){return this.trellisLayoutHelper||(this.trellisLayoutHelper=new s.trellisLayoutHelper),this.trellisLayoutHelper},getChartDataMapper:function(){return this.chartDataMapper||(this.chartDataMapper=new c.default(this.getDataRows()?this.getDataRows():this.data.getDataAsArray(),this.data.getTitles(),this.data.numAttributes,this,this.data.getColumnIds())),this.chartDataMapper},getZoneData:function(){return this.context.getZoneData(this.getChartDataMapper())},getColumnIndex:function(t){return this.data.isAndroidFixReq()?this.getColIndex(t)+1:this.getColIndex(t)},getColIndex:function(t){return this.getChartDataMapper().getColumnIndex(t,this.getChartDataMapper().titles)},getBreakByAttrIndex:function(t){return t&&t.breakby&&t.breakby.length>0?this.getColIndex(t.breakby[0].name):-1},getBreakByZone:function(t){return t&&t.breakby&&t.breakby.length>0?t.breakby:[]},getGroupByZone:function(t){return t.groupby&&t.groupby.length?t.groupby:[]},processSeriesGroup:function(t){var e=this;if(this.runningGroup=this.data.getHeader(0,t),this.nextGroup=t+1>this.data.getNumRows()-1?"undefined":this.data.getHeader(0,t+1),this.nextGroup!==this.runningGroup){this.xPercentileData=[],e.isLastTitle&&(this.runningOptions.breakBy||this.runningOptions.nonAdditive||(this.runningSum=this.wfOptions.series[0].data[this.wfOptions.series[0].data.length-1].high),e.AddTotalToSeries()),"undefined"!==this.nextGroup&&(this.setRunningSum(t+1),this.startValIndex=t+1),this.seriesGroups=this.seriesGroups||{},this.seriesGroups[this.runningGroup]=this.seriesGroups[this.runningGroup]?g.concat(this.seriesGroups[this.runningGroup],this.wfOptions.series[0].data):this.wfOptions.series[0].data,this.wfOptions.series[0].data=[],this.seriesGroupCategories=this.seriesGroupCategories||[];var i=g.findIndex(e.seriesGroupCategories,(function(t){return t.name==e.runningGroup}));-1===i?this.seriesGroupCategories.push(this.formParentCategoryNode(this.runningGroup,this.wfOptions.xAxis.categories,this.data.getTitles()[0])):this.seriesGroupCategories[i].categories=g.concat(this.seriesGroupCategories[i].categories,this.wfOptions.xAxis.categories),this.wfOptions.xAxis.categories=[]}this.nextNxtGroup=t+2>this.data.getNumRows()-1?"undefined":this.data.getHeader(0,t+2),this.nextNxtGroup!==this.runningGroup&&(this.endValIndex=t+1)},rowOperator:function(t,e){return function(e){try{var i=t.getPlotOptions(),r=t.getColumnIndex(i.title);if(-1===r)return;if(+i.breakBy){var a=t.getBreakByAttrIndex(t.zoneData),o=t.setPointColor(t.formBreakByValue(a,r,e));t.wfOptions.series[0].data.push(o),t.formCategories(i.title,o.name)}else{var s=t.getAggregatingPointIndex(i.title,e);(o=t.wfOptions.series[0].data[s]).formattedValue||t.formCategories(i.title,""),t.wfOptions.series[0].data[s]=o=t.setPointColor(t.formAggregatedValue(i,o,r,e))}t.isGroupBy&&t.processSeriesGroup(e)}catch(t){n.utils.logException("Error processing row data for the waterfall chart : "+t)}}},postChartRendering:function(){var t;this.context&&this.context.postChartRendering(this.renderedChart),this.initCustomClass(),this.context&&(null===(t=this.context.platformContext)||void 0===t?void 0:t.initContextMenu)&&this.context.platformContext.initContextMenu()},getStyleByTitle:function(t){return this.wfStylesList||(this.wfStylesList=[]),this.wfStylesList.filter((function(e){return e.title===t}))[0]||{}},setPointColor:function(t,e){if(t)return t.className="vitara-point "+this.getPointStyle(t,e||this.getPlotOptions()),t},formDataElement:function(t,e,i){return this.setPointColor(t,i)},getPlotOptions:function(){return this.runningOptions},formLineSeries:function(t){if(t&&t.series&&t.series[0]&&t.series[0].data){var e,i=[];return g.each(t.series[0].data,(function(t,r){if(e=t&&+t.subtrahend?t.low?t.low:i[i.length-1]?i[i.length-1].y:null:t.high?t.high:i[i.length-1]?i[i.length-1].y:null,i.length>0&&i[i.length-1]&&i[i.length-1].y!==e&&(i.push({x:r,y:i[i.length-1].y}),i.push(null)),null!==e&&i.push({x:r,y:e}),+t.subtrahend&&t.isTotal){var n=g.findLastIndex(i,(function(e){return e&&e.y===t.high}));-1!==n&&(i=i.concat([null,{x:r,y:t.high},{x:i[n].x,y:t.high},null,i[i.length-1]]))}})),t.series.push({data:i,type:"line",connectNulls:!1,dataLabels:{enabled:!1},className:"vitara-waterfall-connector-line"}),t}},getWFPlotOptions:function(t){return this.wfPlotOptions&&!t||(this.wfPlotOptions=this.context&&"function"==typeof this.context.getPlotOptions?g.cloneDeep(this.context.getPlotOptions()):{}),this.wfPlotOptions},isEnableBridgeLine:function(){return void 0===this.vizProps.wfEnableBridgeLine||+this.vizProps.wfEnableBridgeLine},setYAxisMin:function(t){t.yAxis=t.yAxis?t.yAxis:{};var e,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,n=t.series[0].data.length;return+this.vizProps.wfAutoComputeYStart?(t.series[0].data.forEach((function(t,e){e>0&&e<n&&!t.isStartBar&&!t.isTotal&&(i=Math.min(i,t.nonAdditive?t.subtrahend?t.low:t.high:Math.min(t.high,t.low)),r=Math.max(r,t.nonAdditive?t.subtrahend?t.low:t.high:Math.max(t.high,t.low)))})),e=10*(r-i)/100,i>=0&&r>=0?(t.yAxis.min=i-e,t.yAxis.min=t.yAxis.min<0?0:t.yAxis.min,t.yAxis.minLock=!0):i<=0&&r<=0&&(t.yAxis.max=r+e,t.yAxis.max=t.yAxis.max>0?0:t.yAxis.max,t.yAxis.maxLock=!0)):(t.series[0].data.forEach((function(t,e){i=Math.min(i,Math.min(t.high,t.low)),r=Math.max(r,Math.max(t.high,t.low))})),t.yAxis.min=i,i<0&&0===r&&(t.plotOptions.series.softThreshold=!1),t.yAxis.dataLimits={min:i}),t},setYAxisLabelFormatter:function(t){t.yAxis.labels||(t.yAxis.labels={});var e=this.getChartDataMapper().getMetricFormatObject(this.chartDataMapper.numAttributes);if(e&&e.durationFormat)t.yAxis.labels.durationFormat=e.durationFormat,t.yAxis.labels.formatter=function(){return n.utils.getDurationFormat(this.value,this.axis.options.labels.durationFormat)};else if(1==+this.vizProps.useYAxisMetricFormat){var i=this;t.yAxis.labels.formatter=function(){return n.utils.shortenNumber({rawVal:this.value,fv:n.utils.formatMetricLike(this.value,e)},i.getVizProps().dataLabelDisplayFormat)}}else{for(var r=!0,a=0;a<this.chartDataMapper.numMetrics;a++)if(!this.chartDataMapper.isMetricOfPercentageData(this.chartDataMapper.numAttributes+a)){r=!1;break}r&&(t.yAxis.labels.precision=n.utils.getPrecision(this.chartDataMapper.getMetricFormat(this.chartDataMapper.numAttributes)),t.yAxis.labels.formatter=function(){return n.utils.formatDecimalSeperator((100*this.value).toFixed(this.axis.options.labels.precision?this.axis.options.labels.precision:0))+"%"})}},replaceAttributeFormMacros:function(t,e){if(!e)return t;var i=this.getChartDataMapper().originalTitles.slice(0,this.getChartDataMapper().numAttributes);return g.each(i,(function(i,r){e[r]&&e[r].forms&&g.each(e[r].forms,(function(e,r){var n="&amp;["+i+"@"+r+"]";t=t.split(n).join(e.t)}))})),t},formCustomTooltip:function(t,e,i){var r=e;i||(i=this.vizProps.customTooltipcolstate);var a="",o="",s=t.point.category;if(-1===this.getColIndex(s.name)&&s.name!==(this.vizProps.wfTotalAlias||"Total")){if(t.point.cName){var l="&amp;["+t.point.cName+"]";r=r.split(l).join(s.name)}a+=s.name}else o+=s.name;for(;s.parent;)-1===this.getColIndex(s.parent.name)&&s.parent.name!==(this.vizProps.wfTotalAlias||"Total")?(s.parent.cName&&(l="&amp;["+s.parent.cName+"]",r=r.split(l).join(s.parent.name)),""!=a&&(a=", "+a),a=s.parent.name+a):(l="&amp;["+s.parent.name+"]",r=r.split(l).join(this.getFormattedValue(t.point)),s.parent.name!==(this.vizProps.wfTotalAlias||"Total")&&(o+=s.parent.name)),s=s.parent;r=(r=(r=r.split("&amp;[Attribute Values]").join(a)).split("&amp;[Metric Names]").join(o)).split("&amp;[Metric Values]").join(this.getFormattedValue(t.point)),r=(r=(r=(r=this.getColIndex(t.key)>=this.chartDataMapper.numAttributes?r.split("&amp;[point.category]").join(a):r.split("&amp;[point.category]").join(t.key)).split("&amp;[point.value]").join(this.getFormattedValue(t.point))).split("&amp;[point.metricName]").join(o)).split("&amp;[point.metric]").join(o),r=this.replaceAttributeFormMacros(r,t.point.dataRow),r=n.utils.appendTargetBlankToHTMLString(r);for(var u=0;u<i.length;u++)l="&amp;["+i[u].value+"]",r=r.split(l).join("");return n.utils.addMarkersIconsInTooltip(r)},getWFPointValue:function(t){return t.isAggregated?t.isNegativeVal?t.low-t.high:t.high-t.low:t.pointValue},getFormattedValue:function(t){var e=this.getColIndex(t.category&&t.category.parent?t.category.parent.name:t.category.name);return-1===e&&(e=this.chartDataMapper.numAttributes),n.utils.shortenNumber({rawVal:this.getWFPointValue(t),fv:n.utils.formatMetricLike(this.getWFPointValue(t),this.chartDataMapper.dataRows.metaInfo[e])},this.vizProps.dataLabelDisplayFormat)},setDataLabelRotation:function(t){var e=this.getVizProps().dataLabelRotation;return!e&&0!==e||"default"===e||t&&t.plotOptions&&t.plotOptions.series&&t.plotOptions.series.dataLabels&&f(t.plotOptions.series.dataLabels)==f({})&&(t.plotOptions.series.dataLabels.rotation=+e),t},setLineSeriesProperties:function(t){this.insertRule(".vitara-waterfall-connector-line > path {stroke: hexvalue; stroke-width:1;stroke-dasharray:1,4;}".replace(/hexvalue/g,"#979797"),this.ENUM_STYLE_SCOPE.GLOBAL)},isLegacyGroupBy:function(){return this.context.isTrellisMode()},isTrellisMode:function(){return this.isLegacyGroupBy()&&(void 0===this.vizProps.enableTrellis||+this.vizProps.enableTrellis)},getTooltipPosition:function(t){if(!(!t.yAxis||t.yAxis&&g.isArray(t.yAxis))){var e=g.get(t,"yAxis.dataLimits.min")===g.get(t,"yAxis.min");return!!+this.vizProps.wfAutoComputeYStart||!e&&g.isFinite(t.yAxis.min)||g.isFinite(t.yAxis.max)}},setTooltipPosition:function(t){t.tooltip&&(t.tooltip.followPointer=this.getTooltipPosition(t))},setValueAxisProps:function(t){this.setYAxisMin(t),this.context.vizParser.processYAxisMinMax(t,this.vizProps,this.chartDataMapper),this.setYAxisLabelFormatter(t)},getPointMinVal:function(t){return Math.min(t.high,t.low)},getPointMaxVal:function(t){return Math.max(t.high,t.low)},getMinMaxFromData:function(){var t=this,e=[];if(t.getRenderOptions().series){var i=g.cloneDeep(t.getRenderOptions().series[0]);if(i.data){var r=void 0!==i.yAxis?i.yAxis:0;e[r]||(e[r]={}),g.each(i.data,(function(i){i&&void 0!==i.high&&null!==i.high&&""!==i.high&&(e[r].min=Math.min(t.getPointMinVal(i),e[r].min?e[r].min:Number.MAX_SAFE_INTEGER),e[r].max=Math.max(t.getPointMaxVal(i),e[r].max?e[r].max:Number.MIN_SAFE_INTEGER))}))}}return e},setLabelPadding:function(t){var e=this.isTypeIBCS();g.each(t.series[0].data,(function(i,r){i&&e&&i.subtrahend&&(t.series[0].data[r].dataLabels={padding:0})}))},showNegativeLabelsAtBottom:function(){return!(1!=+this.getVizProps().waterfallNegativeLabels||!this.showLabelsOutside())},postProcessOptions:function(t){return this.setLabelPadding(t),this.showNegativeLabelsAtBottom()&&delete t.plotOptions.series.dataLabels.verticalAlign,this.isEnableBridgeLine()&&(t=this.formLineSeries(t)),this.setValueAxisProps(t),this.setTooltipPosition(t),this.vizProps.customLabel?t.plotOptions.series.dataLabels.useHTML=!0:t.plotOptions.series.dataLabels.useHTML=!1,this.context.setIBCSTypeAxisLabelFormatter(t),this.setCategoryAxisLabelAlignment(t),this.context.isOlderVersion()||(t.yAxis.gridLineWidth=void 0!==this.getVizProps().yAxisGridLineWidth?t.yAxis.gridLineWidth:0,t.xAxis.lineWidth=void 0!==this.getVizProps().xAxisLineWidth?t.xAxis.lineWidth:1),this.setPlotLines(t),this.processStyleMode(t),this.handleNegativeValueBars(t),t},handleNegativeValueBars:function(t){return g.each(t.series[0].data,(function(e,i){if(e.low>e.high){var r=t.series[0].data[i].low;t.series[0].data[i].low=t.series[0].data[i].high,t.series[0].data[i].high=r,t.series[0].data[i].isNegativeVal=!0}})),t},getMetricOptions:function(t){return this.metricGroups&&!t||(this.metricGroups=this.context&&"function"==typeof this.context.getPlotOptions?g.cloneDeep(this.context.getPlotOptions()):{}),this.metricGroups},getWaterfallSeriesOptions:function(){return{wfPlotOptions:this.getWFPlotOptions(!0),metricGroups:this.context?this.context.getMetricGroups():[],totalBarUnits:this.context?this.context.getTotalBarUnits():[],addTotal:void 0===this.vizProps.wfEnableTotal||+this.vizProps.wfEnableTotal,totalBarTitle:this.vizProps.wfTotalAlias||"Total",showAttributeFormID:this.getAttributeFormIDVisibility()}},getAttributeFormIDVisibility:function(){return void 0===this.getVizProps().includeAttributeFormID||1==+this.getVizProps().includeAttributeFormID},replot:function(t){this.setVizProps(t),this.startReplot(),this.renderChartNew()},startReplot:function(){},renderChart:function(){this.renderChartNew()},getRenderOptions:function(){return this.renderOptions},setRenderOptions:function(t){this.renderOptions=t},processIBCSOptions:function(t,e){return this.isTypeIBCS()&&e&&t?(this.setWFColors(g.merge(this.getWFColors(),e.colors)),g.each(t.series,(function(i,r){t.series[r].ibcsDataType=e.dataType,t.series[r].isPrimary=!0})),t=Highcharts.merge(t,e.extraOptions)):t},formChartOptions:function(){this.getChartDataMapper().initZoneData(this.getZoneData()),this.updateWFColorsFromVizProps();var t=Highcharts.merge(this.getDefaultChartOptions(),this.getWFOptions(),this.vizProps);t=Highcharts.merge(t,this.getChartDataMapper().formWaterfallSeries(this.getWaterfallSeriesOptions())),this.setChartScrollDimensions(t),t=this.processIBCSOptions(t,this.getIBCSOptions()),t=this.setDataLabelRotation(t),this.postProcessOptions(t),this.setRenderOptions(t)},getScrollDirection:function(){return this.isVerticalWF()?"height":"width"},getMaxPointWidth:function(){return+this.getVizProps().plotOptions.series.pointWidth||50},getSeriesIndexForScroll:function(t){return g.map(t.series,(function(t,e){return e}))},getSeriesGroupPadding:function(){return.03},getSeriesPadding:function(){return.03},isChartScrollEnabled:function(){if(!this.isTrellisMode()&&!this.isTypeIBCS())return 1==+this.getVizProps().enableAutoScroll},getSeriesPointWidth:function(t){return t.pointWidth?+t.pointWidth:void 0},renderChartOptions:function(){this.renderHCNode(this.getRenderOptions()),n.utils.setBackgroundImage(this.domNode,vitaraJQ.extend({basePath:this.context.getBackgroundImagePath()},this.vizProps),this.context?this.context.onBackgroundImageEnabled.bind(this.context):void 0)},renderChartNew:function(){this.formChartOptions(),this.renderChartOptions()},updateVizPostTrellisRender:function(){if(this.context&&this.context.isPrimaryWFScalingReq&&this.context.isPrimaryWFScalingReq()){var t=this.context.getScaleRefChartInstance();this.instanceId&&t&&t.instanceId!==this.instanceId&&this.rescaleWaterfallValueAxis(t.computeChartScale())&&(this.renderedChart.isDirtyBox=!0,this.renderedChart.redraw())}},rescaleWaterfallValueAxis:function(t){if(!this.renderedChart||!this.renderedChart.axes||!t)return!1;var e,i=this.renderedChart.axes[1],r=i.getExtremes(),n="height";i.horiz&&(n="width");var a=i[n]*t;return this.isTypeIBCS()?(e=a-(r.max-r.min),this.renderedChart.axes[1].setExtremes(r.min-e/2,a+r.min-e/2)):this.renderedChart.axes[1].setExtremes(r.min,a-r.min),!0},renderMultiple:function(t,e){this.destroyCharts(),this.context.renderedCharts=[];for(var i=0;i<e.length;i++){var r=this.getChartOptions(t,i),n=Highcharts.merge(this.vizProps,r);this.postProcessOptions(n),this.renderNode(n,e[i])}},getDefaultDataLabel:function(t){var e=this.getColIndex(t.category.parent.name);return-1===e&&(e=this.chartDataMapper.numAttributes),n.utils.shortenNumber({rawVal:this.getWFPointValue(t),fv:n.utils.formatMetricLike(this.getWFPointValue(t),this.chartDataMapper.dataRows.metaInfo[e])},this.vizProps.dataLabelDisplayFormat)},getDataLabelHtml:function(t){var e=this.vizProps.customLabel;if(e){var i=this.vizProps.customLabelcolstate;return this.formCustomTooltip(t,e,i)}return this.getDefaultDataLabel(t.point)},includeCss:function(t,e){return'<div class="'+t+'">'+e+"</div>"},getDataLabel:function(t){return this.isLabelRequired(t.point)?this.includeCss(this.getLabelClassName(t),this.getDataLabelHtml(t)):null},getLabelClassName:function(t){return 1==+this.vizProps.labelsWrapText?"vitara-datalabel vitara-wrap-content":"vitara-datalabel"},isLabelRequired:function(t){return t&&!t.vtrLblFlag},showLabelsOutsideBarColumn:function(t){return!0},onChartLoad:function(t){this.applyContrastColorsForJustifiedLabels(t),this.addPlotAreaSpacing(t)},addPlotAreaSpacing:function(t){var e,i,r,n,a;if(t&&(null===(i=null===(e=t.series)||void 0===e?void 0:e[0].data)||void 0===i?void 0:i.length)&&(null===(n=null===(r=t.series)||void 0===r?void 0:r[0])||void 0===n?void 0:n.dataLabelsGroup)&&this.forceOutlierLabelsOutside()&&this.context.isInvertedAxis(t.userOptions)){var o=g.max(g.map(t.series[0].dataLabelsGroup.renderer.cache,(function(t,e){return t.width})));o&&t.update({chart:{spacingRight:o+((null===(a=t.options.plotOptions.series.dataLabels)||void 0===a?void 0:a.padding)||0)}})}},getOnChartLoadCallback:function(){var t=this;return function(){try{isExporting()?t.onChartLoad(this):setTimeout(t.onChartLoad(this),0)}catch(t){console.log(t)}}},getPlotLineHelper:function(){return this.plotLineHelper||(this.plotLineHelper=new(this.context.getClsPlotLineHelper())(this.context,this.getChartDataMapper(),!0)),this.plotLineHelper},setPlotLines:function(t){if(g.has(this.vizProps,"plotLines")){this.getPlotLineHelper().cleanUpPlotLines(this.vizProps.plotLines);var e=g.filter(this.vizProps.plotLines,(function(t){return"attribute"!==t.type}));e.length&&t.yAxis&&(t.yAxis.plotLines?t.yAxis.plotLines=g.concat(t.yAxis.plotLines,this.getPlotLineHelper().getHCPlotLines(e)):t.yAxis.plotLines=this.getPlotLineHelper().getHCPlotLines(e))}}})}},a={};function s(t){var e=a[t];if(void 0!==e)return e.exports;var i=a[t]={id:t,loaded:!1,exports:{}};return r[t].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=r,i=[],s.O=function(e,r,n,a){if(!r){var o=1/0;for(h=0;h<i.length;h++){for(var l=t(i[h],3),u=(r=l[0],n=l[1],a=l[2],!0),c=0;c<r.length;c++)(!1&a||o>=a)&&Object.keys(s.O).every((function(t){return s.O[t](r[c])}))?r.splice(c--,1):(u=!1,a<o&&(o=a));if(u){i.splice(h--,1);var p=n();void 0!==p&&(e=p)}}return e}a=a||0;for(var h=i.length;h>0&&i[h-1][2]>a;h--)i[h]=i[h-1];i[h]=[r,n,a]},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":f(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==("undefined"==typeof window?"undefined":f(window)))return window}}(),s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var e={29:0};s.O.j=function(t){return 0===e[t]};var i=function(i,r){var n,a,o=t(r,3),l=o[0],u=o[1],c=o[2],p=0;if(l.some((function(t){return 0!==e[t]}))){for(n in u)s.o(u,n)&&(s.m[n]=u[n]);if(c)var h=c(s)}for(i&&i(r);p<l.length;p++)a=l[p],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(h)},r=self.webpackChunkwebpack_latest=self.webpackChunkwebpack_latest||[];r.forEach(i.bind(null,0)),r.push=i.bind(null,r.push.bind(r))}();var u=s.O(void 0,[34,42,33,35,38,41,36,43,44,46],(function(){return s(592)}));u=s.O(u)}()},4432:(t,e,i)=>{"use strict";var r=i(6486),n=(i(764),i(158),i(1095));const a={PLAY_AXIS:"Play Axis",CATEGORY:"Category Axis",CATEGORY_ZONE:"Category",COLOR_BY:"Color By",SLICE_BY:"Slice By",VALUE:"Value",HORIZONTAL_VALUES:"Horizontal Axis",VERTICAL:"Vertical Axis",BUBBLE_SIZE:"Bubble Size",START_VALUE:"Start Value",END_VALUE:"End Value",TOOLTIP:"Tooltip",SMALL_MULTIPLE:"Small Multiples",ATTRIBUTES:"Attributes",METRICS:"Metrics",BREAK_BY:"Break By",DRILL_TARGET:"Drill Target",INTER_VALUE:"Intermediate Value(s)",LAST_VALUE:"Last Value",GROUP_BY:"Group By",NUMERATOR:"Ratio - Numerator Value",DENOMINATOR:"Ratio - Denominator Value",RING_1:"Ring 1 Value",RING_2:"Ring 2 Value",RING_3:"Ring 3 Value",TIME:"Time",TREND_BY:"Trend By",BAR:"Bar",MARKERS:"Markers",DATE:"Date",TOP_LABEL:"Main Label",SUB_LABEL:"Sub Label",THRESHOLD_METRICS:"Threshold Metrics",STACK_BY:"Stack By"};var o=i(6486),s=mstrmojo.declare(null,null,{MSTR_TYPE:{ATTRIBUTE:"attribute",METRIC:"metric",ATTRIBUTE_OR_METRIC:"attributeOrMetric"},ENUM_ZONES:a,isDZSupport:function(){return isMSTRDashBoard()||isMSTRDesktop()},getZoneElements:function(t,e){for(var i=[],r=0;r<t.length;r++)i.push({name:t[r].n,type:e});return i},getZoneAttributes:function(t){return this.getZoneElements(t.items,this.MSTR_TYPE.ATTRIBUTE)},getZoneMetrics:function(t){return this.getZoneElements(t.items,this.MSTR_TYPE.METRIC)},getAttributeNameByID:function(t){for(var e=this.dataHelper.data.data.gsi.rows,i=0;i<e.length;i++)if(e[i].did==t)return this.dataHelper.parseMSTRText(e[i].n)},getMetricNameByID:function(t){for(var e=this.dataHelper.data.data.gsi.mx,i=0;i<e.length;i++)if(e[i].did==t)return this.dataHelper.parseMSTRText(e[i].n);if(isMSTRMobile()&&isMSTRDashBoard()){var r=this.dataHelper.data.getColTitles();if(r&&r.titles&&r.titles[0]){var n=r.titles[0].es||[];for(i=0;i<n.length;i++)if(n[i].oid===t)return this.dataHelper.parseMSTRText(n[i].n)}}},getZoneElementId:function(t,e){var i=t&&t.id;return this.dataHelper&&e===this.MSTR_TYPE.ATTRIBUTE?this.dataHelper.getCompatibleAttrId(i):i},createZoneElements:function(t,e,i){t=o.uniqWith(t,o.isEqual);for(var r=[],n=0;n<t.length;n++)r.push({name:i.call(this,t[n].id),type:e,id:this.getZoneElementId(t[n],e)});return r},getElementType:function(t){var e=t&&t[0]?t[0]:void 0;return e&&e.t&&4===e.t?this.MSTR_TYPE.METRIC:this.MSTR_TYPE.ATTRIBUTE},formAttributeOrMetricZoneData:function(t){return this.getElementType(t)===this.MSTR_TYPE.ATTRIBUTE?this.formAttributeZoneData(t):this.formMetricZoneData(t)},formAttributeZoneData:function(t){return this.createZoneElements(t,this.MSTR_TYPE.ATTRIBUTE,this.getAttributeNameByID)},formMetricZoneData:function(t){return this.createZoneElements(t,this.MSTR_TYPE.METRIC,this.getMetricNameByID)},getElementsFromZoneByName:function(t,e,i){if(t&&t.getDropZoneObjectsByName){var r=t.getDropZoneObjectsByName(e);if(r.length>0)return i==this.MSTR_TYPE.ATTRIBUTE_OR_METRIC?this.formAttributeOrMetricZoneData(r):i==this.MSTR_TYPE.ATTRIBUTE?this.formAttributeZoneData(r):this.formMetricZoneData(r)}},getZoneData:function(t,e,i){return{}},getDropZoneElements:function(t,e){if(this.dataHelper||(this.dataHelper=e),!this.dataHelper)return"";var i=this;try{if(!this.isDZSupport())return this.dataHelper.getTitles();if(!t)return"";var r={};return o.each(this.ZONES,(function(e,n){o.each(i.MSTR_TYPE,(function(n,a){if(!r[e]){var s=o.filter(i.getElementsFromZoneByName(t,e,n),(function(t){return t&&void 0!==t.name}));s&&s.length>0&&(r[e]=s)}}))})),r}catch(t){return"unable to retrieve drop zone data: "+t.message}}}),l=mstrmojo.declare(s,null,{scriptClass:"mstrmojo.plugins.VitaraCharts.v530159.VitaraHCWaterfallDropZoneReader",getZoneData:function(t,e,i,r,n){var a={},o=this.MSTR_TYPE;if(this.dataHelper=r,this.isDZSupport()){var s=t.getZones();for(var l in a.groupby=this.getElementsFromZoneByName(t,s.GROUP_BY,o.ATTRIBUTE),a.breakby=this.getElementsFromZoneByName(t,s.BREAK_BY,o.ATTRIBUTE),a)void 0!==a[l]&&0!=a[l].length||delete a[l]}else a.groupby=+i.enableTrellis||n&&n.isIBCSViewEnabled&&n.isIBCSViewEnabled()||void 0===i.enableTrellis&&e.numAttributes>1?e.getAttributeAtIndexAsZones(0):void 0,a.breakby=e.numAttributes>1||e.numAttributes>0&&void 0===a.groupby?e.getLastAttributeAsZones():void 0;return a}}),u=i(4089),c=i(9153),p=i(8397);const h=mstrmojo.declare(Object,null,{STR_GROUP_SETTINGS:"Group Settings",init:function(t){t&&t.context&&(this.context=t.context)},getContext:function(){return this.context},getNewGroupClickListener:function(t){var e=this;return function(i){var r=e.getNewUID(e.getMetricGroups()),n=e.formNewGroupElement({type:e.ENUM_UNIT_TYPE.GROUP_UNIT,id:r,name:e.getNewGroupTitle(),titles:[],columns:[],isDefault:!1,options:{}});e.addMetricGroup(n),e.createNewGroup(n,t,e.getMenuNodeContainer(i.target)),e.addAccordionsToGroup(e.getGroupSettingsAccordion(),r,!0),e.createNewMenuOptionsNode({id:e.getNewMenuNodeId()},t,e.getContainerUnitByID(r))}},getNewTotalBarClickListener:function(t){var e=this;return function(i){var r=e.getNewUID(e.getTotalBarUnits()),n=e.formNewTotalElement({type:e.ENUM_UNIT_TYPE.TOTAL_BAR_UNIT,id:r,name:e.getNewTotalTitle(),options:{},pos:null});e.addTotalBarUnit(n),e.createNewTotalBarUnit(n,t,e.getMenuNodeContainer(i.target)),e.createNewMenuOptionsNode({id:e.getNewMenuNodeId()},t,e.getContainerUnitByID(r)),e.onCalculationSchemeModified()}},getOnDropListener:function(){var t=this;return function(e,i){var r=i.draggable.clone();r.removeAttr("style"),vitaraJQ(this).append(r),t.makeSortable(t.getElementGroupId(this)),i.draggable.remove(),t.reCreateCollsableAccordion(r,t.getElementGroupId(this)),t.onCalculationSchemeModified()}},getCloseGroupClickListner:function(t){var e=this;return function(i){var r=vitaraJQ(this).closest(vitaraJQ(".group-container",t));e.removeNextMenuElement(r.prop("id")),e.removeMetricGroup(r.prop("id"));var n=e.getBaseAccordionFields(e.getDroppableContainerForGroup(r.prop("id")));e.addAccordionsToGroup(n,e.getMetricGroups()[e.getMetricGroups().length-1].id),r.remove(),e.onCalculationSchemeModified()}},getTextChangeListner:function(){var t=this;return function(e){t.onCalculationSchemeModified()}},removeNextMenuElement:function(t,e){vitaraJQ("#"+t,e).next(".group-menu-container").remove()},getCloseTotalBarUnitClickListner:function(t){var e=this;return function(i){var r=vitaraJQ(this).closest(vitaraJQ(".total-bar-container",t));e.removeNextMenuElement(r.prop("id")),e.removeTotalBarUnit(r.prop("id")),r.remove(),e.onCalculationSchemeModified()}},HtmlTemplates:{HTML_TEMPLATES:{DROPPABLE_GROUP:['<div id="<%- groupId %>" class="group-container unit-container">','<div class="group-header">','<div class="text-right">','<button id="btnGroupDelete" style="visibility:<%-showDelete %>" type="button" title="delete group" class="group-delete-button btn btn-sm"><span class="fa fa-window-close"></span></button>',"</div>","</div>",'<div class="group-body">','<div class="group-title-container"><input type="text" class="form-control group-title" id="groupTitle" value="<%-groupTitle%>"></input></div>','<div class="group-droppable-container"></div>','<div class="group-non-droppable-container"></div>',"</div>","</div>"],DROPPABLE_GROUPS_CONTAINER:['<div class="groups-container wf-editor"></div>'],ADD_NEW_GROUP:['<div class="add-group-btn-container">','<button id="btnGroupAdd" type="button" class="btn btn-secondary btn-sm group-add-button">New Group</button>',"</div>"],OPTIONS_MENU:['<div id="<%-nodeId%>" class="group-menu-container">','<div class="dropdown">','<button class="btn btn-sm dropdown-toggle groups-menu-dropdown-btn" type="button" id="groups-menu-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">','<span class="groups-menu-dropdown-icon fa fa-dot-3"></span>',"</button>",'<ul class="dropdown-menu" aria-labelledby="groups-menu-dropdown">','<li><a id="btnInsertTotal" href="#">Insert Total Bar</a></li>','<li><a id="btnAddGroup" href="#">Add New Group</a></li>',"</ul>","</div>","</div>"],TOTAL_BAR:['<div id="<%-totalBarId %>" class="total-bar-container unit-container">','<div class="total-bar-unit-block total-bar-title-container">','<input type="text" class="form-control total-bar-title" id="totalBarTitle" value="<%- totalBarTitle %>"></input>',"</div>",'<div class="total-bar-unit-block">','<button id="btnTotalBarDelete" style="visibility:<%- showDelete %>" type="button" title="delete total bar" class="total-bar-delete-button btn btn-sm"><span class="fa fa-window-close"></span></button>',"</div>","</div>"]},getGroupAddBtnHtml:function(){return p.template(this.HTML_TEMPLATES.ADD_NEW_GROUP.join("\n"))()},getDroppableGroupsContainerHtml:function(){return p.template(this.HTML_TEMPLATES.DROPPABLE_GROUPS_CONTAINER.join("\n"))()},getDroppableContainerHtml:function(t,e,i){return p.template(this.HTML_TEMPLATES.DROPPABLE_GROUP.join("\n"))({groupId:t,groupTitle:e,showDelete:void 0!==i?+i?"visible":"hidden":"visible"})},getTotalBarUnitHtml:function(t,e,i){return p.template(this.HTML_TEMPLATES.TOTAL_BAR.join("\n"))({totalBarId:t,totalBarTitle:e,showDelete:void 0!==i?+i?"visible":"hidden":"visible"})},getOptionsMenuHtml:function(t){return p.template(this.HTML_TEMPLATES.OPTIONS_MENU.join("\n"))({nodeId:t})}},getNewGroupTitle:function(){return"Metric Group "+(this.getMetricGroups().length+1)},getNewTotalTitle:function(){return"Result "+(this.getTotalBarUnits().length+1)},getMenuNodeContainer:function(t){return vitaraJQ(vitaraJQ(t).closest(".dropdown").parent())},getNodeElements:function(){return vitaraJQ(".group-menu-container",vitaraJQ(".groups-container",this.getViewContainer()))},getNewMenuNodeId:function(){return"menuNode"+(this.getNodeElements().length+1)},getRandomBtwn:function(t,e){return Math.floor(Math.random()*(e-t))+t},getNewId:function(){return this.getRandomBtwn(1e5,999999)},getNewUID:function(t){for(var e=this.getNewId();-1!==p.findIndex(t,(function(t){return t.id===e}));)this.getNewUID();return e},setCalculationScheme:function(t){this.calculationScheme=t},getCalculationScheme:function(){return this.calculationScheme},setWfPlotOptions:function(t){this.wfPlotOptions=t},getWfPlotOptions:function(t){return t?this.wfPlotOptions[t]:this.wfPlotOptions},setOpts:function(t){this.opts=t},getOpts:function(){return this.opts},setTotalBarUnits:function(t){this.totalBarUnits=t},getTotalBarUnits:function(){return this.totalBarUnits},addTotalBarUnit:function(t){this.getTotalBarUnits().push(t)},removeTotalBarUnit:function(t){var e=p.findIndex(this.getTotalBarUnits(),(function(e){return e.id==t}));-1!==e&&this.getTotalBarUnits().splice(e,1)},setMetricGroups:function(t){this.metricGroups=t},getMetricGroups:function(){return this.metricGroups},getMetricGroupOptionsByTitle:function(t){return p.filter(this.getMetricGroups(),(function(e){return-1!==p.indexOf(e.titles,(function(e){return e===t}))})).options},getMetricGroupByTitle:function(t){return p.filter(this.getMetricGroups(),(function(e){return-1!==p.indexOf(e.titles,(function(e){return e===t}))}))},getMetricGroupOptionsById:function(t){return p.filter(this.getMetricGroups(),(function(e){return e.id===t}))[0].options},getMetricGroupById:function(t){return p.filter(this.getMetricGroups(),(function(e){return e.id===t}))},addMetricGroup:function(t){this.getMetricGroups().push(t)},removeMetricGroup:function(t){var e=p.findIndex(this.getMetricGroups(),(function(e){return e.id==t}));-1!==e&&this.getMetricGroups().splice(e,1)},getElementGroupId:function(t){return vitaraJQ(t).closest(vitaraJQ(".group-container",this.getViewContainer())).prop("id")},makeSortable:function(t){var e=this.getDroppableContainerForGroup(t);vitaraJQ(e).hasClass("ui-sortable")?e.sortable("refresh"):vitaraJQ(e).sortable()},getAccordionTitle:function(t){return vitaraJQ(t).children("h3").first().text()},getAccordionId:function(t){return vitaraJQ(t).children("h3").first().attr("data-metricId")},setCollapsableAccordionStateGroupSettings:function(t,e,i){if(t&&e){var r=vitaraJQ(".ui-accordion-content",t);vitaraJQ("#popupwfEnableSubTotal",r).prop("checked",e.addSubTotal),vitaraJQ("#popupwfIsSubtrahend",r).prop("checked",e.subtrahend),vitaraJQ("#popupwfEnableGroupCategories",r).prop("checked",e.groupCategories)}},setCollapsableAccordionState:function(t,e,i){if(t&&e){var r=vitaraJQ(".ui-accordion-content",t);vitaraJQ("#popupwfEnableBreakBy",r).prop("checked",e.breakBy),e.breakBy&&(vitaraJQ("#popupwfAggregationSelector",r).prop("disabled",!0),vitaraJQ("#popupwfIsNonAdditive",r).prop("disabled",!0)),vitaraJQ("#popupwfAggregationSelector",r).val(e.aggregation),"xpercent"===e.aggregation?(vitaraJQ("#popupwfXPercentValue",r).parent().show(),vitaraJQ("#popupwfXPercentValue",r).val(e.xPercent)):vitaraJQ("#popupwfXPercentValue",r).parent().hide(),vitaraJQ("#popupwfIsNonAdditive",r).prop("checked",e.nonAdditive),this.getContext().getBaseContext().propMenuHelper.setVitaraColorPicker("#popupwfMetricColor",e.color,null,"arrow",null,r),i&&i.disableBreakBy&&(vitaraJQ("#popupwfEnableBreakBy",r).prop("checked",!1),vitaraJQ("#popupwfEnableBreakBy",r).prop("disabled",!0))}},setGroupCollapsableAccordionsState:function(t,e,i){if(t&&e){var r=this;p.each(t,(function(t){var n=r.getAccordionTitle(t);e[n]&&r.setCollapsableAccordionState(t,e[n],i)}))}},reCreateCollsableAccordion:function(t,e){this.createCollapsableAccordion(t,e),vitaraJQ(t).accordion("destroy"),this.createCollapsableAccordion(t,e)},createCollapsableAccordion:function(t,e){var i=this;vitaraJQ(t).accordion({collapsible:!0,active:!1,animate:!1,heightStyle:"content",classes:{"ui-accordion-header-active":"accordion-active","ui-accordion-content":"accordion-content"},create:function(t,r){var n=i.getAccordionTitle(vitaraJQ(this)),a=i.getAccordionId(vitaraJQ(this));n===i.STR_GROUP_SETTINGS?i.setCollapsableAccordionStateGroupSettings(vitaraJQ(this),i.getMetricGroupOptionsById(e)):i.setCollapsableAccordionState(vitaraJQ(this),i.getWfPlotOptions(a),i.getOpts())}})},createCollapsableAccordions:function(t,e){if(t){var i=this;p.each(t,(function(t){i.createCollapsableAccordion(t,e)}))}},getGroupSettingsAccordion:function(){return vitaraJQ(this.groupSettingsAccordion).clone()},setGroupSettingsAccordion:function(t){this.groupSettingsAccordion=t},getFieldAccordions:function(t){var e=this;return p.filter(t,(function(t){return e.getAccordionTitle(t)!==e.STR_GROUP_SETTINGS}))},getBaseAccordionFields:function(t){return vitaraJQ(".vitara-accordion-field",t)},getAccordionFieldsByColumns:function(t,e){var i=this,r=[];return p.each(t,(function(t){var n=p.findIndex(e,(function(e){return t===i.getAccordionId(e)}));-1!==n&&r.push(e[n])})),r},getDroppableContainerForGroup:function(t){return vitaraJQ(".group-droppable-container",this.getGroupContainer(t))},createNewGroup:function(t,e,i){t&&e&&(i?vitaraJQ(i).after(this.HtmlTemplates.getDroppableContainerHtml(t.id,t.name,!t.isDefault)):vitaraJQ(e).append(this.HtmlTemplates.getDroppableContainerHtml(t.id,t.name,!t.isDefault)),this.getDroppableContainerForGroup(t.id).droppable({accept:".vitara-accordion-field",drop:this.getOnDropListener()}),this.getDroppableContainerForGroup(t.id).sortable(),t.isDefault||vitaraJQ("#btnGroupDelete",this.getGroupContainer(t.id)).on("click",this.getCloseGroupClickListner(e)),vitaraJQ("#groupTitle",this.getGroupContainer(t.id)).on("change",this.getTextChangeListner()),vitaraJQ(this.getGroupContainer(t.id)).data("isDefault",t.isDefault),vitaraJQ(this.getGroupContainer(t.id)).data("type",t.type))},createNewTotalBarUnit:function(t,e,i){t&&e&&(i?vitaraJQ(i).after(this.HtmlTemplates.getTotalBarUnitHtml(t.id,t.name,!0)):vitaraJQ(e).append(this.HtmlTemplates.getTotalBarUnitHtml(t.id,t.name,!0)),vitaraJQ("#btnTotalBarDelete",this.getContainerUnitByID(t.id)).on("click",this.getCloseTotalBarUnitClickListner(e)),vitaraJQ("#totalBarTitle",this.getContainerUnitByID(t.id)).on("change",this.getTextChangeListner()),vitaraJQ(this.getContainerUnitByID(t.id)).data("type",t.type))},createNewMenuOptionsNode:function(t,e,i){t&&e&&(i?vitaraJQ(i).after(this.HtmlTemplates.getOptionsMenuHtml(t.id)):vitaraJQ(e).append(this.HtmlTemplates.getOptionsMenuHtml(t.id)),vitaraJQ("#btnInsertTotal",this.getContainerUnitByID(t.id)).on("click",this.getNewTotalBarClickListener(e)),vitaraJQ("#btnAddGroup",this.getContainerUnitByID(t.id)).on("click",this.getNewGroupClickListener(e)))},getViewContainer:function(){return this.viewContainer},setViewContainer:function(t){this.viewContainer=t},getGroupContainer:function(t){return vitaraJQ("#"+t,this.getViewContainer())},getContainerUnitByID:function(t){return vitaraJQ("#"+t,this.getViewContainer())},ENUM_UNIT_TYPE:{GROUP_UNIT:0,TOTAL_BAR_UNIT:1},formNewGroupElement:function(t){return{type:t.type,id:t.id,name:t.name,isDefault:t.isDefault,columns:t.columns,titles:t.titles,options:t.options,pos:t.pos}},formNewTotalElement:function(t){return{type:t.type,id:t.id,name:t.name,options:t.options,pos:t.pos}},getMetricGroupingInfo:function(){var t=this,e=[];return groups=vitaraJQ(".group-container",vitaraJQ(".groups-container",this.getViewContainer())),p.each(groups,(function(i){var r=vitaraJQ(".vitara-accordion-field",vitaraJQ(".group-droppable-container",i)),n=[];p.each(r,(function(e){e&&e.style&&"hidden"===e.style.visibility||n.push(t.getAccordionTitle(e))})),e.push(t.formNewGroupElement({id:vitaraJQ(i).prop("id"),name:t.getContext().getBaseContext().propMenuHelper.sanitizeContent(vitaraJQ(".group-title-container > input",i).val()),titles:n,isDefault:vitaraJQ(i).data("isDefault"),options:{addSubTotal:vitaraJQ("#popupwfEnableSubTotal",vitaraJQ(i)).prop("checked"),subtrahend:vitaraJQ("#popupwfIsSubtrahend",vitaraJQ(i)).prop("checked")}}))})),e},getTotalBarInfo:function(t,e){return this.formNewTotalElement({type:this.ENUM_UNIT_TYPE.TOTAL_BAR_UNIT,id:vitaraJQ(t).prop("id"),name:this.getContext().getBaseContext().propMenuHelper.sanitizeContent(vitaraJQ(".total-bar-title",t).val()),pos:e})},getMetricGroupInfo:function(t,e){var i=this,r=vitaraJQ(".vitara-accordion-field",vitaraJQ(".group-droppable-container",t)),n=[],a=[];return p.each(r,(function(t){t&&t.style&&"hidden"===t.style.visibility||(n.push(i.getAccordionTitle(t)),a.push(i.getAccordionId(t)))})),i.formNewGroupElement({type:i.ENUM_UNIT_TYPE.GROUP_UNIT,id:vitaraJQ(t).prop("id"),name:i.getContext().getBaseContext().propMenuHelper.sanitizeContent(vitaraJQ(".group-title-container > input",t).val()),titles:n,columns:a,isDefault:vitaraJQ(t).data("isDefault"),options:{addSubTotal:vitaraJQ("#popupwfEnableSubTotal",vitaraJQ(t)).prop("checked"),subtrahend:vitaraJQ("#popupwfIsSubtrahend",vitaraJQ(t)).prop("checked"),groupCategories:vitaraJQ("#popupwfEnableGroupCategories",vitaraJQ(t)).prop("checked")},pos:e})},getMetricCalculationScheme:function(){var t=this,e=[],i=[],r=vitaraJQ(".unit-container",vitaraJQ(".groups-container",this.getViewContainer()));return p.each(r,(function(r,n){vitaraJQ(r).data("type")===t.ENUM_UNIT_TYPE.GROUP_UNIT?e.push(t.getMetricGroupInfo(r,n)):vitaraJQ(r).data("type")===t.ENUM_UNIT_TYPE.TOTAL_BAR_UNIT&&i.push(t.getTotalBarInfo(r,n))})),{metricGroups:e,totalBarUnits:i}},onGroupModified:function(){this.setMetricGroups(this.getMetricGroupingInfo()),this.getContext().getBaseContext().propMenuhelper.getEventHandler().broadcastEvent(this.getViewContainer(),this.getContext().getBaseContext().propMenuHelper.getEventHandler().getEvent("onMetricGroupingChange","metricGroups",this.getMetricGroups(),null,this.getViewContainer()))},onCalculationSchemeModified:function(){this.setCalculationScheme(this.getMetricCalculationScheme()),this.setMetricGroups(this.getCalculationScheme().metricGroups),this.setTotalBarUnits(this.getCalculationScheme().totalBarUnits),this.getContext().getBaseContext().propMenuHelper.getEventHandler().broadcastEvent(this.getContext().getTargetNode(),this.getContext().getBaseContext().propMenuHelper.getEventHandler().getEvent("onCalculationSchemeChange","calculationScheme",this.getCalculationScheme(),null,this.getViewContainer()))},addAccordionsToGroup:function(t,e,i){var r=this,n=i?vitaraJQ(".group-non-droppable-container",this.getGroupContainer(e)):vitaraJQ(".group-droppable-container",this.getGroupContainer(e));p.each(t,(function(t){n.append(t),r.createCollapsableAccordion(t,e),!i&&n.sortable("refresh")}))},createDefaultDragDropLayoutView:function(t){var e=this.getBaseContext();var i=vitaraJQ(".vitara-accordion-field",e.getMenuElement(".panel-collapse.waterfall")),r=i.parent();r.html(this.getDroppableGroupsContainerHtml());var n=vitaraJQ(".groups-container",r);n.html(this.getDroppableContainerHtml("samplegroup","sample",!1)),i.appendTo(vitaraJQ(".group-droppable-container",n)),this.createWaterfallOptionsView(i),vitaraJQ(".group-droppable-container",n).droppable({accept:".vitara-accordion-field",drop:this.getOnDropListener()}),vitaraJQ(".group-droppable-container",n).sortable(),r.append(this.getGroupAddBtnHtml()),vitaraJQ("#btnGroupAdd",r).on("click",this.getNewGroupClickListener(n))},getCalculationSchemeUnitsByPosition:function(t){if(!t)return[];var e=t.metricGroups&&t.metricGroups.length?t.metricGroups:[],i=t.totalBarUnits&&t.totalBarUnits.length?t.totalBarUnits:[],r=[].concat(e,i);return r.sort((function(t,e){return t.pos-e.pos})),r},createView:function(t,e,i,r){var n,a=this,o=this.getBaseAccordionFields(e[0]),s=this.getBaseAccordionFields(e[1]);e=vitaraJQ(e[0]),a.setCalculationScheme(t),a.setMetricGroups(t.metricGroups),a.setTotalBarUnits(t.totalBarUnits),a.setWfPlotOptions(i),a.setOpts(r),a.setViewContainer(e),a.setGroupSettingsAccordion(s),s.remove(),e.empty(),e.append(a.HtmlTemplates.getDroppableGroupsContainerHtml()),n=vitaraJQ(".groups-container",e),p.each(a.getCalculationSchemeUnitsByPosition(this.getCalculationScheme()),(function(t){t.type===a.ENUM_UNIT_TYPE.GROUP_UNIT?t.titles&&(a.createNewGroup({type:t.type,id:t.id,name:t.name,isDefault:t.isDefault},n),a.addAccordionsToGroup(a.getAccordionFieldsByColumns(t.columns,o),t.id),a.addAccordionsToGroup(a.getGroupSettingsAccordion(),t.id,!0)):t.type===a.ENUM_UNIT_TYPE.TOTAL_BAR_UNIT&&a.createNewTotalBarUnit({id:t.id,name:t.name,type:t.type},n),a.createNewMenuOptionsNode({id:a.getNewMenuNodeId()},n)}))}});var d=i(8397);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,x(r.key),r)}}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=m(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}}).apply(this,arguments)}function m(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function y(t,e){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=A(t);if(e){var n=A(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return C(this,i)}}function C(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return T(t)}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e,i){return(e=x(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function x(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:String(e)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(a,t);var e,i,r,n=b(a);function a(t,e){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),w(T(i=n.call(this,t,e)),"DataIndicatorElemId",{wfv1:"#popupwfAttrElemV1",wfv2:"#popupwfAttrElemV2"}),w(T(i),"DEF_OPTION_TEXT","Auto");var r=Object.getOwnPropertyNames(Object.getPrototypeOf(c.Z.prototype)),o={};return r.forEach((function(t){"function"==typeof c.Z.prototype[t]&&"constructor"!==t&&(o[t]=c.Z.prototype[t])})),Object.assign(a.prototype,o),i.setBaseContext(t),i.setEditorInterface(e),i}return e=a,(i=[{key:"setBaseContext",value:function(t){this.context=t}},{key:"setEditorInterface",value:function(t){this.eInterface=t}},{key:"getNewId",value:function(){return this.getRandomBtwn(1e5,999999)}},{key:"getNewGID",value:function(t){for(var e=this.getNewId();d.find(t,(function(i){return-1!==d.findIndex(t[i],(function(t){return t.gid===e}))}));)this.getNewGID();return e}},{key:"getNewUID",value:function(t){for(var e=this.getNewId();d.find(t,(function(i){return-1!==d.findIndex(t[i],(function(t){return t.gid===e||t.id===e}))}));)this.getNewUID();return e}},{key:"onWfAggregationSelectorChange",value:function(t){"xpercent"===t.detail.value?vitaraJQ("#popupwfXPercentValue",vitaraJQ(t.target).parent().parent()).parent().show():vitaraJQ("#popupwfXPercentValue",vitaraJQ(t.target).parent().parent()).parent().hide()}},{key:"onWfApplyMetricOptionsChange",value:function(t){var e=this.getBaseContext(),i=e.propMenuHelper.getState().wfPlotOptions||{},r=d.cloneDeep(i),n=vitaraJQ(t.target).closest(".ui-accordion-content"),a=n.prev("h3").text(),o=n.prev("h3").attr("data-metricId");i[o]=i[o]||{},i[o].title=a,i[o].columnId=o,i[o].breakBy=vitaraJQ("#popupwfEnableBreakBy",n).prop("checked"),i[o].aggregation=vitaraJQ("#popupwfAggregationSelector",n).val(),"xpercent"===i[o].aggregation&&(i[o].xPercent=vitaraJQ("#popupwfXPercentValue",n).val()),i[o].nonAdditive=vitaraJQ("#popupwfIsNonAdditive",n).prop("checked"),i[o].color=vitaraJQ("#popupwfMetricColor",n).val(),i[o].breakBy||""!=i[o].aggregation||(delete i[o],0===Object.keys(i).length&&(i=null)),i&&i.isDefault&&!d.isEqual(i,r)&&(i.isDefault=!1),e.propMenuHelper.saveFormData("wfPlotOptions",i)}},{key:"onMetricGroupingChange",value:function(t){if(t&&t.detail&&t.detail.value){var e=this.getBaseContext().propMenuHelper.getState();e.metricGroups=t.detail.value,this.getBaseContext().propMenuHelper.setState(e),this.getBaseContext().propMenuHelper.saveFormData("metricGroups",t.detail.value)}}},{key:"onCalculationSchemeChange",value:function(t){if(t&&t.detail&&t.detail.value){var e=this.getBaseContext().propMenuHelper.getState();e.calculationScheme=t.detail.value,this.getBaseContext().propMenuHelper.setState(e),this.getBaseContext().propMenuHelper.saveFormData("calculationScheme",t.detail.value)}}},{key:"onwfApplyGroupOptionsChange",value:function(t){this.getMetricGroupingView().onCalculationSchemeModified()}},{key:"onWfEnableBreakByChange",value:function(t){var e=vitaraJQ(t.target).closest(".ui-accordion-content");vitaraJQ(t.target).prop("checked")?(vitaraJQ("#popupwfAggregationSelector",e).val(""),vitaraJQ("#popupwfAggregationSelector",e).prop("disabled",!0),vitaraJQ("#popupwfXPercentValue",e).val(""),vitaraJQ("#popupwfXPercentValue",e).parent().hide(),vitaraJQ("#popupwfIsNonAdditive",e).prop("checked",!1),vitaraJQ("#popupwfIsNonAdditive",e).prop("disabled",!0)):(vitaraJQ("#popupwfAggregationSelector",e).prop("disabled",!1),vitaraJQ("#popupwfAggregationSelector",e).val("total"),vitaraJQ("#popupwfIsNonAdditive",e).prop("disabled",!1))}},{key:"onWfAutoComputeYStartChange",value:function(t){this.getBaseContext().propMenuHelper.onChangeAutoComputeYStart(t.target,t.detail.value)}},{key:"getMetricGroupOptions",value:function(){return this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().getMetricGroups()}},{key:"getTotalBarUnits",value:function(){return this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().getTotalBarUnits()}},{key:"getCalculationScheme",value:function(){return{metricGroups:this.getMetricGroupOptions(),totalBarUnits:this.getTotalBarUnits()}}},{key:"getMetricGroupingViewContext",value:function(){return vitaraJQ(".vitara-accordion-field",this.getBaseContext().getMenuElement(".panel-collapse.waterfall")).parent()}},{key:"getMetricGroupingView",value:function(t){return this.wfmGroupingView&&!t||(this.wfmGroupingView=new h({context:this})),this.wfmGroupingView}},{key:"createWfGroupView",value:function(t){this.getMetricGroupingView(!0).createView(this.getCalculationScheme(),this.getMetricGroupingViewContext(),this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().getPlotOptions(),{disableBreakBy:this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().disableBreakBy()})}},{key:"disableOption",value:function(t,e){d.each(e,(function(e){vitaraJQ("select"+e+" option:contains('"+t+"')").attr("disabled","disabled")}))}},{key:"enableOption",value:function(t,e){d.each(e,(function(e){vitaraJQ("select"+e+" option:contains('"+t+"')").removeAttr("disabled")}))}},{key:"setDataOptionFields",value:function(t){var e=this.getBaseContext().propMenuHelper,i=this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().getDataIndicatorOptions();i&&(e.setDropdownOptions(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv1),e.getAsDropDownOptionsCustom(i,this.DEF_OPTION_TEXT)),e.setDropdownOptions(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv2),e.getAsDropDownOptionsCustom(i,this.DEF_OPTION_TEXT)))}},{key:"onEditorViewCreated",value:function(t){v(A(a.prototype),"onEditorViewCreated",this).call(this,t),this.getBaseContext().propMenuHelper.initCustomWaterfallFields(),this.createWfGroupView(t),this.setDataOptionFields(t),this.toogleDataLabelFields()}},{key:"setDataOptionsState",value:function(){var t=this.getBaseContext().menuOptions.fetchCallback.chartSpecificFetch().getDataIndicatorsState();t&&(t.p&&(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv1).val(t.p.selCategory||""),this.getBaseContext().getMenuElement("#popupwfAttrElemTypeV1").val(t.p.selDataType||""),this.displayDefaultSelection(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv1),t.p.category,t.p.selCategory),this.displayDefaultSelection(this.getBaseContext().getMenuElement("#popupwfAttrElemTypeV1"),t.p.dataType,t.p.selDataType)),t.s&&(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv2).val(t.s.selCategory||""),this.getBaseContext().getMenuElement("#popupwfAttrElemTypeV2").val(t.s.selDataType||""),this.displayDefaultSelection(this.getBaseContext().getMenuElement(this.DataIndicatorElemId.wfv2),t.s.category,t.s.selCategory),this.displayDefaultSelection(this.getBaseContext().getMenuElement("#popupwfAttrElemTypeV2"),t.s.dataType,t.s.selDataType)))}},{key:"onMenuSelected",value:function(t){v(A(a.prototype),"onMenuSelected",this).call(this,t),"IBCS Features"===t.detail.name&&this.setDataOptionsState(t),t.detail.name}},{key:"onIBCSDataOptsChange",value:function(t){this.saveAndEndBroadcast(t),this.setDataOptionsState(t)}},{key:"refreshWaterfallMenu",value:function(t){this.getBaseContext().getActiveMenu(),this.getBaseContext().propMenuHelper.initCustomWaterfallFields(),this.createWfGroupView(t)}},{key:"onBarColumnLabelPositionChanged",value:function(t){v(A(a.prototype),"onBarColumnLabelPositionChanged",this).call(this,t),void 0!==(t&&t.detail&&t.detail.value)&&this.getBaseContext().getMenuElement("#popupwaterfallNegativeLabels").attr("disabled",0==+t.detail.value)}},{key:"setCustomEventHandlers",value:function(){v(A(a.prototype),"setCustomEventHandlers",this).call(this),this.setEventHandler("onWfAggregationSelectorChange",this.onWfAggregationSelectorChange),this.setEventHandler("onWfApplyMetricOptionsChange",this.onWfApplyMetricOptionsChange),this.setEventHandler("onWfEnableBreakByChange",this.onWfEnableBreakByChange),this.setEventHandler("onWfAutoComputeYStartChange",this.onWfAutoComputeYStartChange,this.saveAndEndBroadcast),this.setEventHandler("onCalculationSchemeChange",this.onCalculationSchemeChange),this.setEventHandler("onwfApplyGroupOptionsChange",this.onwfApplyGroupOptionsChange),this.setEventHandler("onIBCSDataOptsChange",this.onIBCSDataOptsChange)}}])&&f(e.prototype,i),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(c.Z),O=i(8397);function P(t){t&&this.setContext(t),this.waterfallProperties={label:"Waterfall",id:"waterfall",containers:[{title:"",type:"collapsable",class:"draggable-accordion",headers:[],data:[{label:"Break By",fields:["wfEnableBreakBy"]},{label:"Aggregation",fields:["wfAggregationSelector"]},{label:"Percentile",fields:["wfXPercentValue"]},{label:"Non Additive",fields:["wfIsNonAdditive"]},{label:"Color",fields:["wfMetricColor"]},{label:"",fields:["wfApplyMetricOptions"]}]},{title:"",data:[{label:"Auto Compute Total",fields:["wfEnableTotal"]},{label:"Label",fields:["wfTotalAlias"]},{label:"Enable Connector Lines",fields:["wfEnableBridgeLine"]},{label:"Truncate Axis Lables",fields:["wfTruncAxisLbls"]}]},{title:"",type:"collapsable",headers:["Group Settings"],class:"non-draggable-accordion",data:[{label:"Add Sub Total",fields:["wfEnableSubTotal"]},{label:"Deduct Value",fields:["wfIsSubtrahend"]},{label:"",fields:["wfApplyGroupOptions"]}]}]},this.waterfallProperties.containers[1].data.push(this.getBarColumnOptionsForZeroValues())}Object.assign(P.prototype,u.Z.prototype,{getCustomFields:function(){return{startValueAggregation:{type:"select",name:"startValueAggregation",id:"startValueAggregation",class:"startValueAggregation",publish:"onAggregationSelectChange",options:this.getFieldDefs().getOptions().metricAggregationOptionsSet2},endValueAggregation:{type:"select",name:"endValueAggregation",id:"endValueAggregation",class:"endValueAggregation",publish:"onAggregationSelectChange",options:this.getFieldDefs().getOptions().metricAggregationOptionsSet2}}},getCustomEventHandler:function(t,e){return new S(t,e)},onPropMenuCreated(){this.propMenuHelper.waterfall.setMetricSelector(),this.propMenuHelper.waterfall.initListeners()},axisOptions:{excludeXAxisLabelStartIndex:!0,excludeXAxisLabelInterval:!0},getCustomProperty:function(){if(this.context)for(var t=this.context.getMetricIds(),e=0;e<this.waterfallProperties.containers.length;e++)if("collapsable"==this.waterfallProperties.containers[e].type){this.waterfallProperties.containers[e].headers=t;break}return O.filter([this.getAppearanceProperties(),this.AxisProperties(this.axisOptions),this.BackgroundProperties(),this.modifyFields(this.DataLabelsProperties(),["dataLabelsDisplayStyle"]),this.TooltipProperties(),this.waterfallProperties,this.plotLineProperties(),this.GenericTrellisProperties({disableAxisProps:!1}),this.context.hasIBCSAccess&&this.context.hasIBCSAccess()?this.getWFIbcsProperties():null,this.SecurityProperties(),this.getAboutChartMenu()],(function(t){return null!==t}))},includeYAxisMinMaxFields:function(t){return t.containers[1].sections=t.containers[1].sections.concat([{header:"Start Value",data:[{label:"Auto Compute Start Value",fields:["wfAutoComputeYStart"]},{label:"Metric",fields:["startValueMetricSelect"]},{label:"Operator",fields:["startValueAggregation"]},{label:"Value",fields:["startValueXPercentValue"]},{label:"Value",fields:["startValueFixedValue"]}]},{header:"End Value",data:[{label:"Metric",fields:["endValueMetricSelect"]},{label:"Operator",fields:["endValueAggregation"]},{label:"Value",fields:["endValueXPercentValue"]},{label:"Value",fields:["endValueFixedValue"]}]}]),t},getAppearanceProperties:function(){let t={label:"Appearance",id:"appearance",containers:[{title:"",data:[{label:"Up Value Color",fields:["waterfallUpColor"]},{label:"Down Value Color",fields:["waterfallDownColor"]},{label:"Total Bar Color",fields:["waterfallTotalColor"]},{label:"Invert Axes",fields:["invertedAxis"]},{label:"Bar/Column Width",fields:["seriesTypeWidth"]}]},{title:"Chart Scroll",data:[{label:"Enable Auto scroll",fields:["enableAutoScroll"]},{label:"Scroll Area Opacity",fields:["chartScrollAreaOpacity"]}]},{title:"Editor Layout",data:[{label:"Right to left",fields:["rtlLayout"]}]}]};return t.containers[0].data.push(this.getBarColumnOptionsForZeroValues()),t},getWFIbcsProperties:function(){return{label:"IBCS Features",id:"ibcsfeatures",containers:[{title:"Vertical Waterfall Options",data:[{label:"Enable IBCS View",fields:["ibcsViewEnable"]}]},{title:"",data:[{label:"Enable Absolute Variance",fields:["enableDeltaView"]},{label:"Select Chart Type",fields:["deltaViewChartType"]},{label:"Enable Percentage Variance",fields:["enableDeltaPercentageView"]}]},{title:"Waterfall(1) Options",data:[{label:"Category",fields:["wfAttrElemV1"]},{label:"Data Type",fields:["wfAttrElemTypeV1"]}]},{title:"Waterfall(2) Options",data:[{label:"Category",fields:["wfAttrElemV2"]},{label:"Data Type",fields:["wfAttrElemTypeV2"]}]},{title:"Scaling Group Options",data:[{label:"Select Scaling Group",fields:["scalingGroup"]},{label:"Enable Layout Auto Hide",fields:["ibcsLayoutAutoHide"]}]}]}},getExtraDataLabelsProperties:function(){return[{label:"Force Outlier Labels Outside",fields:["forceOutlierLabelsOutside"]},{label:"Show Label Outside Bar/Column",fields:["barColumnLabelPosition"]},{label:"Show Negative Value Label Below Bar/Column",fields:["waterfallNegativeLabels"]}]},getExtraDataLabelsFormatProperties:function(){return[{label:"",fields:["deltaViewLabelEditor"]},{label:"",fields:["applydeltaViewLabel"]}]}});var D=i(6486),E={getTargetDataFromEvent:function(t){var e=this,i=null!=t&&t.target?this._super(t):t;if(i||(i=this._super(this.getpointEvent(t))),i){var r,n,a,o,s,l=(null==this||null===(r=this.getRenderer())||void 0===r||null===(n=r.getChartDataMapper)||void 0===n||null===(n=n.call(r))||void 0===n?void 0:n.dataRows)||(null==this||null===(a=this.getRenderer())||void 0===a||null===(a=a.renderedChartInstance)||void 0===a||null===(o=a.getChartDataMapper)||void 0===o||null===(o=o.call(a))||void 0===o?void 0:o.dataRows)||this.dataHelper.getDataAsArray();i.dataRow=D.find(l,(function(t){if(D.forEach(t,(function(t){if(e.checkRowDataOption(i,t))return i.selectorFunc=t.selector,s=t.row,!1})),void 0!==s)return s}))}return i},checkRowDataOption:function(t,e){if(e)return t.mName===e.t||(null==t?void 0:t.fv)===(null==e?void 0:e.fv)||!1},getpointEvent:function(t){window.event||vitaraD3.event;var e={fv:this.getStrTextContent(t)||t.target.textContent,mName:this.getStrTextContent(t)||t.target.textContent};return t?(t.target.point=e,t):e},getGraphicModel:function(t){if(this.getDataHelper().getNumMetrics()&&this.getDataHelper().getNumAttributes())return this._super(t);if(!this.getGraphicModels||!t||!t.dataRow)return null;var e=this.getContextMenuSelector(t);return(e=t.dataRow.filter((function(e){if(t.fv===e.fv||t.mName===e.t)return e})))?this.getGraphicModels().children.filter((function(t){var i;if(D.isEqual(null==t?void 0:t.formattedValue,null===(i=e[0])||void 0===i?void 0:i.v))return t.getSelector()}))[0]:null},getStrTextContent:function(t){}};i.g.vitaraLD||(i.g.vitaraLD=r),mstrmojo.plugins.VitaraCharts.v530159.VitaraHCWaterfallChart=mstrmojo.declare(n.Z,[E],{scriptClass:"mstrmojo.plugins.VitaraCharts.v530159.VitaraHCWaterfallChart",cssClass:"VitaraHCWaterfallChart",getVisualInstance:function(){return this.visualInstance||(this.visualInstance=new VitaraHCWaterfallChartMixin(this),this.visualInstance.updateVisualProps=this.updateVisualProps),this.visualInstance},getEditorName:function(){return"Waterfall"},getEditor:function(t){return this.propsEditor||(this.propsEditor=new P(t)),this.propsEditor},getZoneReader:function(){return this.zoneReader||(this.zoneReader=new l),this.zoneReader},getSelectorObject:function(t,e){var i;return null===(i=this.getTargetDataFromEvent)||void 0===i?void 0:i.call(this,e)},validateMinCriteria:function(t,e){return{valid:e>0,message:"Include at least 1 metric to see the chart."}},getChartSpecificConfigProperties:function(t){return r.includes(t,"vitara-chart-container")?["invertedAxis","catAxis","valAxis"]:this._super(t)},getDefaultConfigForContextMenu:function(){return["tooltip","datalabel","invertedAxis"]},processChartSpecificCompatabilityChecks:function(t){return this.getUtils().isOlderVersion(t,"4.5.0.674")&&(t.calculationScheme&&t.calculationScheme.metricGroups&&(t.calculationScheme.metricGroups=this.getRenderer().convertMetricGroups(t.calculationScheme.metricGroups)),t.wfPlotOptions&&(t.wfPlotOptions=this.getRenderer().convertPlotOptions(t.wfPlotOptions))),t=this.getRenderer().compatabilityCheckForColumnIds(t),t=this.vizParser.getUpdateWaterfallOptions(t)}})}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var a=i[t]={id:t,loaded:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,t=[],r.O=(e,i,n,a)=>{if(!i){var o=1/0;for(c=0;c<t.length;c++){for(var[i,n,a]=t[c],s=!0,l=0;l<i.length;l++)(!1&a||o>=a)&&Object.keys(r.O).every(t=>r.O[t](i[l]))?i.splice(l--,1):(s=!1,a<o&&(o=a));if(s){t.splice(c--,1);var u=n();void 0!==u&&(e=u)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[i,n,a]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={780:0};r.O.j=e=>0===t[e];var e=(e,i)=>{var n,a,[o,s,l]=i,u=0;if(o.some(e=>0!==t[e])){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(l)var c=l(r)}for(e&&e(i);u<o.length;u++)a=o[u],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(c)},i=self.webpackChunkVitaraCharts_MicroStrategy=self.webpackChunkVitaraCharts_MicroStrategy||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var n=r.O(void 0,[445,915,89],()=>r(4432));n=r.O(n)})();
