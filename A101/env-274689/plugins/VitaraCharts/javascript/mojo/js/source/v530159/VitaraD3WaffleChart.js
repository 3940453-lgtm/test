mstrmojo.requiresCls("mstrmojo.plugins.VitaraCharts.v530159.VitaraD3WaffleChartInitializer"),(()=>{var t,e={1396:()=>{function t(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,a,n,o,l=[],s=!0,h=!1;try{if(n=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(i=n.call(r)).done)&&(l.push(i.value),l.length!==e);s=!0);}catch(t){h=!0,a=t}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw a}}return l}}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";var e,i={583:function(t,e,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(n=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===a(n)?n:String(n)),i)}var n}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i.r(e),i.d(e,{WaffleThresholdMapper:function(){return u}});var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(c,t);var e,r,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(i);if(a){var r=h(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return s(this,t)});function c(){return n(this,c),u.apply(this,arguments)}return e=c,(r=[{key:"setThreshold",value:function(t,e,r,i,a){var n;if(n="aboveaverage"===r.condition||"belowaverage"===r.condition?a.targetIndex:i,r.color||r.markerType||r.markerSize||r.panelColor){var o=t.map((function(t){return-1!==(0===n?vitaraJQ.inArray(t[n].t,e):vitaraJQ.inArray(t[n].v,e))&&(t.threshold={color:r.color},1==+r.markerEnable&&(t.threshold.markerType=r.markerType,t.threshold.markerEnable=r.markerEnable,t.threshold.markerSize=r.markerSize,t.threshold.markerHAlign=r.markerHAlign,t.threshold.markerColor=r.markerColor,t.threshold.svgOptions=r.svgOptions),+r.enableDataLabel&&(t.threshold.dataLabelStyle=r.dataLabelStyle,t.threshold.customLabel=r.customLabel)),t}));t=o}return t}}])&&o(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(i(509).ThresholdMapperBase)},580:function(t,e,i){i.r(e),i.d(e,{VitaraD3WaffleChartMixin:function(){return b}}),i(1);var a=i(581),n=i(398),o=i(583),l=i(4);function s(t){return(s="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}function h(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,v(i.key),i)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=c(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(arguments.length<3?t:r):a.value}}).apply(this,arguments)}function c(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}function d(t,e){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===s(e)?e:String(e)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(c,t);var e,r,i,n,s=(i=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(i);if(n){var r=g(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return p(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),m(f(e=s.call(this,t)),"scriptClass","mstrmojo.plugins.VitaraCharts.v530159.VitaraD3WaffleChartMixin"),m(f(e),"cssClass","VitaraD3WaffleChartMixin"),m(f(e),"NAME","Vitara Waffle Chart"),e.logEnvironmentInfo(),e}return e=c,(r=[{key:"validateMinCriteria",value:function(t,e){if("percentage"===this.vizProps.waffle){var r=this.zonesModel.getZones();return!isMSTRDashBoard()&&!isMSTRDesktop()||isMSTRMobile()||0==this.zonesModel.getDropZoneObjectsByName(r.VALUE).length&&(e=0),{valid:e>0,message:"Include atleast one metric to see the chart."}}return!isMSTRDashBoard()&&!isMSTRDesktop()||isMSTRMobile()||(r=this.zonesModel.getZones(),0==this.zonesModel.getDropZoneObjectsByName(r.VALUE).length&&(e=0)),{valid:e>0&&t>0,message:"Include atleast one attribute and one metric to see the chart."}}},{key:"enableUseAsFilter",value:function(){return!0}},{key:"getPropertyEditor",value:function(){}},{key:"getPropMenuCustomEventHandler",value:function(){}},{key:"getThresholdMapper",value:function(){return this.thresholdMapper||(this.thresholdMapper=new o.WaffleThresholdMapper({context:this})),this.thresholdMapper}},{key:"getEditorName",value:function(){return"WaffleChart"}},{key:"getSeriesElements",value:function(){var t=this.renderedChart,e=this.renderedChart.chartDataMapper,r=e.getTitles()[e.numAttributes];return[{sId:t.data.getColumnIdByTitle(r),name:r}]}},{key:"getPropMenuDefaults",value:function(){return{legendEnable:"1",legendCompact:"1",headerLabelsEnable:"1",legendLayout:"horizontal",legendHAlignment:"center",legendVAlignment:"bottom",legendItemStyleFontSize:"13px",labelItemStyleFontSize:"13px"}}},{key:"getDefaultColors",value:function(){return l.cloneDeep(this.defaultChartColors.defaultPalette)}},{key:"destroyChart",value:function(){if(this.renderedChart)try{this.renderedChart.chartContainer&&this.renderedChart.chartContainer.selectAll("*").remove(),this.renderedChart.chartDataMapper=null,this.renderedChart.destroy&&(this.renderedChart=this.renderedChart.destroy()),vitaraJQ(".ch-tooltip",this.domNode).remove(),this.renderedChart=null}catch(t){console.error(t)}}},{key:"getXAxisAttribute",value:function(){if(this.renderedChart){var t=this.renderedChart.chartDataMapper;if(t&&t.numAttributes>0)return t.titles[t.numAttributes-1]}return null}},{key:"getPointTarget",value:function(t){return t&&t.target?t.target.closest(".vitara-point"):u(g(c.prototype),"getPointTarget",this).call(this,t)}},{key:"vitaraPlot",value:function(t){try{this.renderedChart=new a.renderWaffleChart(this.dataHelper,this.position,this.chartNode,this.vizProps),this.renderedChart.render()}catch(t){this.handleVizError(t)}}}])&&h(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(n.default);window.VitaraD3WaffleChartMixin=b},581:function(t,e,r){r.r(e),r.d(e,{renderWaffleChart:function(){return p}});var i=r(45),a=r(436),n=r(234),o=r(399),l=r(320),s=r(472),h=r(440),u=r(505),c=r(582),d=r(4),p=function(t,e,r,i){a.hcCore.call(this,t,e,r,i)};vitaraJQ.extend(p.prototype,a.hcCore.prototype,h.styledModeRendererBase.prototype,c.tooltipProvider.prototype,{ATTR_TITLE_MRKR:"t",thresholdTargets:[],seriesVisibility:{},getWaffleMode:function(){return this.vizProps.waffle?this.vizProps.waffle:"percentage"},isLegendRequired:function(){return"block"===this.getWaffleMode()},isLegendEnabled:function(){if(this.isLegendRequired())return this.vizProps.legend?1==this.vizProps.legend.enabled:0!=+this.vizProps.legendEnable},isDataLabelRequired:function(){return"percentage"===this.getWaffleMode()},getHeaderLabelOptions:function(){return{fontName:this.vizProps.labelItemStyleFontName?"'".concat(this.vizProps.labelItemStyleFontName,"'"):"",fontSize:parseInt(this.vizProps.labelItemStyleFontSize||"13"),color:this.vizProps.labelItemStyleColor||"black",weight:1==this.vizProps.labelItemStyleBold?"bold":"normal",style:1==this.vizProps.labelItemStyleItalic?"italic":"normal",decoration:1==this.vizProps.labelItemStyleUnderline?"underline":"none"}},getDataLabelOptions:function(){return{enable:this.isDataLabelEnabled(this.vizProps.headerLabelsEnable),format:this.vizProps.dataLabelDisplayFormat||"default",textStyle:{fontName:this.vizProps.textStyleFontName||"",fontSize:parseInt(this.vizProps.textStyleFontSize||"13"),weight:1==this.vizProps.textStyleBold?"bold":"normal",style:1==this.vizProps.textStyleItalic?"italic":"normal",decoration:1==this.vizProps.textStyleUnderline?"underline":"none",color:this.vizProps.textStyleColor||"#808080"}}},setNumberOfIcons:function(t,e){var r,i,a;return"percentage"===t?(r=10,i=10):"individual"===t?(r=20,i=5):"1"===e?(r=5,i=20):"0"===e?(r=20,i=5):(a=!0,r=10,i=10),{reScale:a,widthSquares:r,heightSquares:i}},getIcon:function(t){return t||"circle"},isDataLabelEnabled:function(t){return void 0===t?1:0===Number(t)?0:1},getWaffleIconSize:function(t,e,r,i){if(t&&!isNaN(t)&&parseInt(t)>0)return parseInt(t);if(!e||!r||isNaN(e)||isNaN(r))return 10;var a=Math.floor((parseInt(this.domNode.style.width)-2*i.margin)/(e+1)),n=Math.floor((parseInt(this.domNode.style.height)-3*i.margin)/(r+1));return a<n?a:n},getTooltipData:function(t,e){var r=this.vizProps.customTooltip,i="";if(null!=r&&null!=r&&""!=r)i=this.formCustomTooltip(e,r,this.chartDataMapper.dataRows[e.rowIndex]);else{i+=this.chartDataMapper.titles[0]+" : "+e.attributeName+"<br>"+e.metricName+" : "+e.formattedValue,i+='<hr style="margin-top:3px;margin-bottom:3px;">';for(var a=this.chartDataMapper.numAttributes+1;a<this.chartDataMapper.numColumns;a++){var n=this.chartDataMapper.getGroupAggregate(e.path,{metric:this.chartDataMapper.titles[a]},{format:this.vizProps.dataLabelDisplayFormat});i+=this.chartDataMapper.titles[a]+" : "+n.fv+"<br>"}}return i},getDataLabel:function(t,e){var r=(null==e?void 0:e.customLabel)||this.vizProps.customLabel;if(null!=r&&null!=r&&""!=r){var i=this.vizProps.customLabelcolstate;return r=this.changePointerEvent(t[0].rowIndex,r),this.formCustomTooltip(t[0],r,this.chartDataMapper.dataRows[t[0].rowIndex],i).split("<div>").join("<span>")}return t[0].formattedValue},changePointerEvent:function(t,e){var r,a;return i.utils.isHTMLStringContainsLink(e)?(((null===(r=vitaraJQ(this.labelContainer[0]))||void 0===r||null===(r=r.children())||void 0===r?void 0:r.length)>t?null===(a=vitaraJQ(this.labelContainer[0]))||void 0===a||null===(a=a.children()[t])||void 0===a?void 0:a.style:void 0)&&(vitaraJQ(this.labelContainer[0]).children()[t].style.pointerEvents="auto"),i.utils.appendTargetBlankToHTMLString(e)):e},formCustomTooltip:function(t,e,r,a){var n=e;a||(a=this.vizProps.customTooltipcolstate);var o="",l="&amp;["+this.chartDataMapper.originalTitles[0]+"]";o+=g=r[0].t;var s="&amp;[Metric Names]",h="",u=(n=(n=n.split(l).join(g)).split("&amp;[Attribute Values]").join(o)).indexOf(s),c=n.indexOf("&amp;[Metric Values]");if(-1===u&&(u=c),-1!==u){if(-1===c)c=u+s.length;else if(c<u){var d=c;c=u+s.length,u=d}else c+="&amp;[Metric Values]".length;h=n.substring(u,c)}for(var p="",f=this.numAttributes;f<this.chartDataMapper.numColumns;f++){l="&amp;["+this.chartDataMapper.originalTitles[f]+"]";var g=this.chartDataMapper.getGroupAggregate(t.path,{metric:this.chartDataMapper.titles[f]},{format:this.vizProps.dataLabelDisplayFormat}).fv;if(n=n.split(l).join(g),""!==h){var m=h.split(s).join(this.chartDataMapper.originalTitles[f]);m=m.split("&amp;[Metric Values]").join(g),t.metricName===this.chartDataMapper.originalTitles[f]?p=m+"<br>"+p:(p+=m,f!==this.chartDataMapper.numColumns-1&&(p+="<br>"))}}for(""!==h&&(n=n.split(h).join(p)),n=(n=(n=(n=(n=this.replaceAttributeFormMacrosForCategory(n,r,this.chartDataMapper)).split("&amp;[point.category]").join(t.attributeName)).split("&amp;[point.value]").join(t.formattedValue)).split("&amp;[point.metricName]").join(t.metricName?t.metricName:"")).split("&amp;[point.metric]").join(t.metricName?t.metricName:""),f=0;f<a.length;f++){for(var v=!1,b=0;b<this.chartDataMapper.numColumns;b++)if(a[f].value==this.chartDataMapper.originalTitles[f]){v=!0;break}0==v&&(l="&amp;["+a[f].value+"]",n=n.split(l).join(""))}return i.utils.addMarkersIconsInTooltip(n)},replacePatternWithValue:function(t,e,r){return t.split(e).join(r)},replaceAttributeFormMacrosForCategory:function(t,e,r){var i=-1;if(e&&(this.context&&this.context.getXAxisAttribute&&(i=r.titles.indexOf(this.context.getXAxisAttribute())),e[i]&&e[i].forms)){var a=this;d.each(e[i].forms,(function(e,r){var i="&amp;[point.category@"+r+"]";t=a.replacePatternWithValue(t,i,e.t)}))}return t},getColorsArray:function(t,e){for(var r=d.cloneDeep(this.vizProps.colors||e),i=r.length,a=0;a<t;a++)void 0===r[a]&&(r[a]=r[a-i]||"rgb(0,0,0)");return r},isFloat:function(t){return Number(t)===t&&t%1!=0},rePosGraphContainer:function(t,e,r,i,a){var n=i?e:0,o=a?r:0,l=vitaraJQ("svg .graph",vitaraJQ(this.domNode,vitaraJQ(t)));l.attr("x",n),l.attr("y",o),l=null},setLabelReference:function(t){t&&this.labelRef.length<t.length&&(this.labelRef=t)},addSeriesVisibility:function(t){this.seriesVisibility[t]||(this.seriesVisibility[t]={visible:!0})},toggleSeriesVisibility:function(t){this.seriesVisibility[t].visible=!this.seriesVisibility[t].visible},formDataElement:function(t,e,r,i){return this.setLabelReference(r.name),this.addSeriesVisibility(r.elemId),this.chartDataMapper.dataRows.metaInfo[this.chartDataMapper.numAttributes].isPercentageData&&(i[r.name].v*=100),{attributeName:r.name?r.name:"",metricValue:i[r.name].v,formattedValue:i[r.name].fv,elemId:r.elemId,metricName:e,rowIndex:r.rowIndex,path:r.path,visible:!1!==this.seriesVisibility[r.elemId].visible}},getRenderData:function(t){var e,r=this.chartDataMapper.titles[this.chartDataMapper.numAttributes],i=this.chartDataMapper.getGroupElements(),a=this.chartDataMapper.getAggregatedGroupElements("",{metric:this.chartDataMapper.titles[this.chartDataMapper.numAttributes]},{format:this.vizProps.dataLabelDisplayFormat});if("percentage"===t.plotMode){e=[];for(var n=0;n<i.length;n++)e[n]=this.constructRenderData(t,this.computePercentage(this.formDataElement(n,r,i[n],a)))}else e=this.constructRenderData(t,this.computeGraphProperties(r,i,a));return e},computeGraphProperties:function(t,e,r){for(var i=0,a=[],n=0;n<e.length;n++)a[n]=this.formDataElement(n,t,e[n],r),a[n].metricValue||(a[n].metricValue=0),i+=a[n].metricValue;return{dataArray:a,total:i}},computePercentage:function(t){var e=[],r=0;return e[0]=t,t.metricValue&&(r=t.metricValue),e[0].metricValue=r,e[1]=d.cloneDeep(e[0]),e[1].metricValue=100,{dataArray:e,total:100}},constructRenderData:function(t,e){var r=e.dataArray,i=e.total,a=[],n=[];return t.squareValue=i/(t.widthSquares*t.heightSquares),r.forEach((function(e,r){e.metricValue=+e.metricValue,"percentage"===t.plotMode?(e.units=Number(Math.round(100*e.metricValue/i)),e.ratio=e.units):e.units=Number(Math.floor(e.metricValue/t.squareValue)),e.units<0&&(e.units=0),"percentage"===t.plotMode&&(0===a.length&&e.units>100&&(e.units=100),100===a.length&&(e.units=0),0!==a.length&&a.length+e.units<100&&e.units++,0!==a.length&&a.length+e.units>100&&(e.units=100-a.length),1===r&&a.length+e.units<100&&(e.units=100-a.length),0===t.squareValue&&0===i&&(e.units=1===r?100:0)),!1!==e.visible&&(a=a.concat(Array(e.units+1).join(1).split("").map((function(){return{squareValue:t.squareValue,units:e.units,metricValue:e.metricValue,formattedValue:e.formattedValue,groupIndex:r,ratio:e.ratio}}))),0===e.units&&"individual"===t.plotMode&&(e.units=e.metricValue/t.squareValue,a[0]={squareValue:t.squareValue,units:e.units.toFixed(2),metricValue:e.metricValue,formattedValue:e.formattedValue,groupIndex:r}),"individual"===t.plotMode&&(n[r]=a,a=[]))})),"individual"===t.plotMode?{data:r,theData:n}:{data:r,theData:a}},cleanupWaffleContianer:function(){vitaraD3.select(this.domNode).selectAll("svg").remove();var t=vitaraJQ(".waffle-chart-container",this.domNode);t&&t.length>0&&t.remove();var e=vitaraJQ(".ch-tooltip",this.domNode);e&&e.length>0&&e.remove()},startRender:function(t,e){this.cleanupWaffleContianer(),this.chartContainer=vitaraD3.select(this.domNode).attr("class",this.getUniqueChartStyle("name")+" vitara-chart-container vitara-theme-custom vitara-chart-background").append("div").attr("class","waffle-chart-container vitara-plot-background").attr("id","waffle-chart-container").attr("style","margin-top :"+e.margin+"px;  margin-left :"+e.margin+"px;  margin-right :"+e.margin+"px;  margin-bottom :"+e.margin+"px;  "),this.labelContainer=this.chartContainer.append("div").attr("class","waffle-datalabels").attr("style","position:relative;float:left;");var r,i=this.chartContainer.append("svg").attr("class","waffle-container").attr("id","waffle-container").attr("style","overflow:visible;");vitaraD3.select(this.domNode).append("div").attr("class","ch-tooltip").attr("style","display:none"),r="block"===t.plotMode?i.append("svg").attr("class","graph").attr("id","graph"):i,this.graphContainer=r.append("g").attr("class","graph-node")},getCustomSvgMarker:function(t,e,r,i,a,n){var o=vitaraD3.select(n).append("g"),l=r<3||i<3?0:2;return vitaraD3.select(n).attr("width",r-l).attr("height",i-l),(0,u.InfographicHelper)({svgOptions:vitaraJQ.extend({infoMarkerType:"vitaraCustomSVGFile",infographicCustomSVGEnable:a.svgOptions["custom-path"],infographicCustomSVGPath:a.svgOptions["infographic-path"]},this.context.getCustomSVGFilePaths()),trgBounds:{x:t,y:e,width:r-l,height:i-l},point:{id:(new Date).getTime()},container:o[0][0],id:"marker-custom",inverted:a.inverted}),n},renderWaffle:function(t,e,r,i,a,n,o,s,h){var u,c=this,p=0,f=0,g=0,m=t.data,v=t.theData,b="percentage"===r.plotMode?m[0].rowIndex:"individual"===r.plotMode?v[0].groupIndex:-1,y=b>-1?c.thresholdTargets.find((function(t){return t[b].threshold})):void 0;function S(t){return t.units>1?r.squareSize:r.squareSize*t.units}if(y&&(y=y[b].threshold),"block"===r.plotMode&&c.thresholdTargets&&c.thresholdTargets.length>0&&d.each(c.thresholdTargets[0],(function(t,e){if(t&&t.threshold){var r=e;d.each(v.filter((function(t){return t.groupIndex===r})),(function(e){e.threshold=t.threshold}))}})),e+=Number(r.squareSize/2),"block"!==r.plotMode&&"1"==r.labelsEnable&&"top"===r.labelsVAlign&&(u=this.renderHeaderLabel(m,v,r,n,i,e,o,s)),this.graphContainer.append("g").attr("class","graph-subdomain").selectAll("div").data(v).enter().append((function(t,e){var i;return y&&y.markerEnable&&y.markerType?"vitaraCustomSVGFile"===y.markerType&&y.svgOptions?(i=document.createElementNS(vitaraD3.ns.prefix.svg,"svg"),i=c.getCustomSvgMarker(void 0,void 0,S(t),S(t),{svgOptions:y.svgOptions},i),vitaraJQ(i).find('g[data-class="vitara-custom-svg"]').css({transform:"translateY(-50%)"})):(i=document.createElementNS(vitaraD3.ns.prefix.svg,"text")).textContent=l.VitaraMarker.getInstance().getMarkerIcon(c.getIcon(y.markerType)):t.threshold&&t.threshold.markerEnable&&t.threshold.markerType?"vitaraCustomSVGFile"===t.threshold.markerType&&t.threshold.svgOptions?(i=document.createElementNS(vitaraD3.ns.prefix.svg,"svg"),i=c.getCustomSvgMarker(void 0,void 0,S(t),S(t),{svgOptions:t.threshold.svgOptions},i),vitaraJQ(i).find('g[data-class="vitara-custom-svg"]').css({transform:"translateY(-50%)"})):(i=document.createElementNS(vitaraD3.ns.prefix.svg,"text")).textContent=l.VitaraMarker.getInstance().getMarkerIcon(c.getIcon(t.threshold.markerType)):"vitaraCustomSVGFile"!==r.icon?(i=document.createElementNS(vitaraD3.ns.prefix.svg,"text")).textContent=r.icon:(i=document.createElementNS(vitaraD3.ns.prefix.svg,"svg"),i=c.getCustomSvgMarker(void 0,void 0,S(t),S(t),{svgOptions:c.vizProps.svgMarkerOptions.iconType},i),vitaraJQ(i).find('g[data-class="vitara-custom-svg"]').css({transform:"translateY(-50%)"})),i})).attr("class",(function(t){return"vitara-point waffle-group-"+t.groupIndex})).attr("text-anchor","start").attr("alignment-baseline","middle").attr("font-family","fontello").attr("font-size",(function(t){var e,i,a=(null===(e=y)||void 0===e?void 0:e.markerSize)||(null===(i=t.threshold)||void 0===i?void 0:i.markerSize)||r.squareSize;return t.units>1?a+"px":a*t.units+"px"})).style({cursor:"pointer",overflow:function(t){return"vitaraCustomSVGFile"!==r.icon?"auto":"visible"}}).attr("fill",(function(t){var e,i,a=(null===(e=y)||void 0===e?void 0:e.color)||(null===(i=t.threshold)||void 0===i?void 0:i.color)||void 0;return"individual"===r.plotMode?(t.color=t.metricValue>0?a||r.colors[0]||r.defaultColor:r.plotAreaBGColor,t.color):"percentage"===r.plotMode?(t.color=0===t.groupIndex?a||r.colors[0]:r.defaultColor,t.color):(t.color=a||r.colors[t.groupIndex%r.colors.length]||r.defaultColor,t.color)})).attr("opacity",(function(t,e){return"vitaraCustomSVGFile"!==r.icon?"1":this.getAttribute("fill")===r.defaultColor?"0.3":"1"})).attr("x",(function(t,e){var i,a=e%r.widthSquares;return"percentage"===r.plotMode?(i=o+a*r.squareSize+Number(r.squareSize/2),f=i):i=a*r.squareSize+Number(r.squareSize/2),v[e].x=i,n.graphWidth<i+Number(r.squareSize/2)&&(n.graphWidth=i+Number(r.squareSize/2)),i})).attr("y",(function(t,i){var a,o=Math.floor(i/r.widthSquares);return"percentage"===r.plotMode?(a=s+("top"===r.labelsVAlign?r.yLabelOffset:0)+e+r.heightSquares*r.squareSize-o*r.squareSize-Number(r.squareSize/2),0===i&&(g=a)):(a=("top"===r.labelsVAlign?r.yLabelOffset:r.yDataOffset)+e+o*r.squareSize+Number(r.squareSize/2),p=a),v[i].y=a,n.graphHeight<a&&(n.graphHeight=a),a})).call((function(t){r.squareSize>0&&t.attr("rx",r.squareSize).attr("ry",r.squareSize),h.enable&&function(t){var e={selection:t,getTooltipText:x,isTooltipEnabled:w};c.renderTooltip(e)}(t)})).on("click",(function(t){var e=c.getElementSelector.call(c,t,m);e&&c.context.applySelections().call({selector:e,id:m[t.groupIndex].rowIndex},vitaraD3.event)})).on("contextmenu",(function(t){var e;vitaraD3.event&&null!==(e=c.context)&&void 0!==e&&e.platformContext&&c.context.platformContext.handleContextMenuSelection&&c.handleContextMenuSelection.call(c,{selector:c.getElementSelector.call(c,t,m)},vitaraD3.event)})),"percentage"===r.plotMode&&a.enable){var M={width:r.squareSize*r.widthSquares,height:r.squareSize*r.heightSquares};this.renderDataLabel(m,a,n,o,"top"===r.labelsVAlign&&"1"==r.labelsEnable?u:s,M,y)}return"block"!==r.plotMode&&"1"==r.labelsEnable&&"bottom"===r.labelsVAlign?this.renderHeaderLabel(m,v,r,n,i,e,o,g,p,f):(v=null,"percentage"===r.plotMode?{x:f+n.padding,y:g}:p+n.padding);function x(t){return c.getTooltipData(t,m[t.groupIndex])}function w(t){return!(1===t.groupIndex&&"percentage"===r.plotMode)}},renderHeaderLabel:function(t,e,r,a,n,o,l,s,h,u){var c,d,p=this;return r.yDataOffset=parseInt(r.squareSize)/2,h+=parseInt(r.squareSize)/2,this.graphContainer.append("g").append("text").attr("class","graph-header-label").text((function(){if("percentage"===r.plotMode)return p.numAttributes>0?i.utils.decodeStringValue(p.formatHeaderLabel(t[0].attributeName)):i.utils.decodeStringValue(p.formatHeaderLabel(t[0].metricName));var o=t[e[0].groupIndex].attributeName+" "+e[0].units+"%",l=n.charDimens.width*o.length;return n.charDimens.height,a.graphWidth<l+Number(r.squareSize)&&(a.graphWidth=l+Number(r.squareSize)),i.utils.decodeStringValue(o)})).attr("x",(function(){return c="percentage"===r.plotMode?l+Number(r.squareSize/2):Number(r.squareSize/2)})).attr("y",(function(){var t;return t="percentage"===r.plotMode?("bottom"===r.labelsVAlign?s+r.yDataOffset:s)+o+parseInt(n.fontSize)/2:("top"===r.labelsVAlign?o:h+r.yDataOffset)+parseInt(n.fontSize)/2,d=t,h=t,t})),"individual"===r.plotMode&&a.graphWidth<n.maxHeaderWidth&&(a.graphWidth=n.maxHeaderWidth),"bottom"===r.labelsVAlign?"percentage"===r.plotMode?{x:u,y:d+parseInt(n.fontSize)/2,xl:c}:h+parseInt(n.fontSize)/2:d+parseInt(n.fontSize)/2},formatHeaderLabel:function(t){return this.maxHeaderLength<t.length?t.substring(0,this.maxHeaderLength)+(1===this.maxHeaderLength?"":".."):t},renderDataLabel:function(t,e,r,i,a,n,o){this.labelContainer.append("div").attr("style","position:absolute;pointer-events:none;left:"+(i+(r.padding+n.width)/2)+"px;top:"+(a+n.height/2)+"px;").append("text").attr("class","graph-data-label").html(this.getDataLabel(t,o))},computeMaxTextLength:function(t,e,r){var i=this.getTextDimension(t,r.fontSize,r.fontFamily,this.domNode);return i.width>e?(r.maxHeaderWidth=e,this.maxHeaderLength=Math.floor(e*t.length/i.width-2),this.maxHeaderLength<1&&(this.maxHeaderLength=1)):(r.maxHeaderWidth=i.width,this.maxHeaderLength=t.length),{width:i.width/(0===t.length?1:t.length),height:i.height}},getTextDimension:function(t,e,r,i){var a=!1;return this.e||(a=!0,this.e=document.createElement("span"),this.e.style.color="transparent"),a&&(i?i.appendChild(this.e):document.body.appendChild(this.e)),e&&e.toString().indexOf("px")<0&&(e+="px"),this.e.style.fontSize=e,this.e.style.fontFamily=r,this.e.innerHTML=t,{width:this.e.offsetWidth,height:this.e.offsetHeight}},handleContextMenuSelection:function(t,e){var r,i,a,n;null===(r=this.context)||void 0===r||null===(r=r.platformContext)||void 0===r||null===(i=r.handleContextMenuSelection)||void 0===i||i.call(r,e,null===(a=this.context)||void 0===a||null===(a=a.platformContext)||void 0===a||null===(n=a.getGraphicModel)||void 0===n?void 0:n.call(a,t))},getElementSelector:function(t,e){return this.chartDataMapper.filterHandler().getAttributeSelectionHandler(e[t.groupIndex].rowIndex,0)},legendClickHandler:function(t,e){this.toggleSeriesVisibility(e);var r=this.getChartRenderOptions(),i=r.chartOptions,a=r.scaleOptions,n=this.getHeaderLabelOptions(),l=this.getDataLabelOptions();l.charDimens=this.computeMaxTextLength(this.labelRef,i.squareSize*(i.widthSquares-1),l),n.charDimens=this.computeMaxTextLength(this.labelRef,i.squareSize*(i.widthSquares-1),n),i.colors=this.getColorsArray(this.chartDataMapper.dataRows.length,o.default.defaultPalette);var s=this.getRenderData(i);return this.graphContainer.selectAll("*").remove(),this.renderWaffle(s,0,i,n,l,a,a.padding,0,this.getTooltipOptions()),this.seriesVisibility[e].visible},renderLegend:function(t,e,r){var i=[],a=[],n=e.length;t.forEach((function(t,r){a[r]=t.elemId,i[r]=t.attributeName+"-"+t.units+"%",e[r]||(e[r]=e[r%n])}));var o={enabled:!0,align:"center",layout:"horizontal",position:"relative",verticalAlign:"bottom",colors:e,labels:i,seriesIds:a,options:{padding:"5"},containerWidth:this.domNodeWidth-2*r,containerHeight:this.position.height-2*r},l=this.vizProps.legend;return l.align=l.align?l.align:"center",l.layout=l.layout?l.layout:"horizontal",l.verticalAlign=l.verticalAlign?l.verticalAlign:"bottom",o=vitaraJQ.extend(o,this.vizProps.legend),this.processLegendStyles(o),s.vitaraLegend.init(o,vitaraD3.select(this.domNode).select(".waffle-chart-container").select(".waffle-container"),this.domNode,null,this.legendClickHandler.bind(this)),o},setWaffleStyle:function(t,e,r){vitaraJQ(".graph-header-label",this.domNode).attr("style","text-anchor: start;alignment-baseline: middle;font-family: "+e.fontName+";font-size: "+e.fontSize+"px;fill: "+e.color+";font-weight: "+e.weight+";font-style: "+e.style+";text-decoration: "+e.decoration+";cursor: pointer;");var i=vitaraJQ(".graph-data-label",this.domNode);i.attr("style","text-anchor: middle;alignment-baseline: middle;font-family: "+r.textStyle.fontName+";font-size: "+r.textStyle.fontSize+"px;fill: "+r.textStyle.color+";font-weight: "+r.textStyle.weight+";font-style: "+r.textStyle.style+";text-decoration: "+r.textStyle.decoration+";cursor: pointer;"),d.each(i,(function(t){var e=t.getBoundingClientRect();t.parentNode.style.left=parseFloat(t.parentNode.style.left)-e.width/2+"px",t.parentNode.style.top=parseFloat(t.parentNode.style.top)-e.height/2+"px"}))},setChartDimensions:function(){this.chartContainer.node&&!this.chartContainer.node().style.height&&this.chartContainer.attr("style",this.chartContainer.attr("style")+"height:"+i.utils.getElementDimensions(this.chartContainer).height+"px;")},setDimensions:function(t,e,r,i,a){t[0].style.width=e+2*i+"px",t[0].style.height=r+2*i+a+"px"},postChartRendering:function(){var t;this.removeExtraSpanElement(),this.processStyleMode(),this.context&&null!==(t=this.context.platformContext)&&void 0!==t&&t.initContextMenu&&this.context.platformContext.initContextMenu()},processLegendStyles:function(t){this.init(),this.processVitaraLegendItems(t)},getVitaraChartBgClass:function(){return".vitara-chart-background"},processStyleMode:function(){this.isLegendEnabled()||this.init(),this.setChartBackground()},destroy:function(){this.graphContainer.selectAll("*").remove(),this.graphContainer=null,this.labelContainer=null,this.removeExtraSpanElement()},removeExtraSpanElement:function(){this.e&&(this.e.remove?this.e.remove():this.e.removeNode&&(this.e.textContent="",this.e.removeNode()),this.e=null)},getChartDataMapper:function(){return this.chartDataMapper||(this.chartDataMapper=new n.chartDataMapperBase(this.data.getDataAsArray(),this.data.getTitles(),this.data.numAttributes,{data:this.data})),this.chartDataMapper},getChartRenderOptions:function(){var t,e=this.getWaffleMode(),r=this.setNumberOfIcons(e,this.vizProps.orientation),i=this.getWaffleIconSize(this.vizProps.waffleIconSize,null,null,{margin:10}),a=l.VitaraMarker.getInstance().getMarkerIcon(this.getIcon(this.vizProps.iconType)),n=this.isDataLabelEnabled(this.vizProps.waffleLabelsEnable),s="#F2F2F2",h={margin:10,reScale:!1,padding:Number(i/2)+2,labelPadding:0,width:0,height:0,offsetHeight:i/2,offsetWidth:i/2,legendHeight:0,legendWidth:0,adjustHeight:this.domNodeWidth/this.position.height>1,adjustWidth:this.domNodeWidth/this.position.height<1,graphWidth:0,graphHeight:0};t=this.vizProps.colors?this.vizProps.colors:this.context.getCustomPaletteDefaults()?this.context.getCustomDefaultPaletteColors():o.default.defaultPalette,void 0!==this.vizProps.waffleUnfilledColor&&this.vizProps.waffleUnfilledColor&&(s=this.vizProps.waffleUnfilledColor);var u={icon:a,plotMode:e,colors:t,defaultColor:s,widthSquares:r.widthSquares,heightSquares:r.heightSquares,squareValue:0,yLabelOffset:0,yDataOffset:0,labelsEnable:n,labelsVAlign:this.vizProps.waffleLabelsVAlign?this.vizProps.waffleLabelsVAlign:"top"};return u.squareSize=this.getWaffleIconSize(this.vizProps.waffleIconSize,u.widthSquares,u.heightSquares,h),h.reScale=r.reScale,{chartOptions:u,scaleOptions:h}},renderChart:function(){var t=this.getWaffleMode();if("percentage"===t&&this.data.numMetrics<1)this.handleVizError("Include atleast one metric to see the chart.");else if("percentage"!==t&&(this.data.numMetrics<1||this.data.numAttributes<1))this.handleVizError("Include atleast one attribute and one metric to see the chart.");else{this.getChartDataMapper(),this.domNodeWidth=this.domNode.offsetWidth,this.labelRef="",this.seriesVisibility={};var e=this.getHeaderLabelOptions(),r=this.getDataLabelOptions(),a=this.getTooltipOptions(),n=[],l=this.getChartRenderOptions(),h=l.chartOptions,u=l.scaleOptions;if(this.vizProps.thresholds){var c=this.context.getThresholdHelper();c.setChartDataMapper(this.chartDataMapper),this.chartDataMapper.seriesBy=this.chartDataMapper.MSTR_TYPE_METRIC;var d=c.procThresholdsPreCleanUp(this.vizProps.thresholds,this.chartDataMapper.getAllMetricsAsZones());for(var p in d){var f,g=this.chartDataMapper.numAttributes;if(-1!==g&&(f=this.chartDataMapper.getTitles()[g]),-1!=g&&d[p].length>0){this.thresholdTargets=[];for(var m=0;m<d[p].length;m++){this.setMetricIndexUsage(c,this.chartDataMapper,f,d[p][m],void 0);var v=this.getThresholdTargetMetricName(f,d[p][m]),b=c.processThreshold(this.chartDataMapper.dataRows,v,d[p][m],this.chartDataMapper,null,1==+d[p][m].level?void 0:null);b&&this.thresholdTargets.push(b)}}}}if(this.chartDataMapper.groupByAttributes(this.chartDataMapper.titles[0]),n=this.getRenderData(h),0===this.chartDataMapper.numAttributes&&(this.labelRef=this.chartDataMapper.titles[this.chartDataMapper.numAttributes]),"individual"===h.plotMode&&(this.labelRef+=" 0.00%"),r.charDimens=this.computeMaxTextLength(this.labelRef,h.squareSize*(h.widthSquares-1),r),e.charDimens=this.computeMaxTextLength(this.labelRef,h.squareSize*(h.widthSquares-1),e),"block"===h.plotMode)h.colors=this.getColorsArray(this.chartDataMapper.dataRows.length,o.default.defaultPalette),D.call(this);else{if(h.labelsEnable&&(h.yLabelOffset=parseInt(e.fontSize)+u.padding),this.startRender(h,u),"percentage"===h.plotMode){for(var y={x:0,y:0},S={x:u.padding,y:0,xl:0},M=0;M<n.length;M++)S=this.renderWaffle(n[M],0,h,e,r,u,S.x,S.y,a),0===M&&(y.x=S.x,y.y=S.y,u.chartOffset=y,u.graphWidth=S.x,u.graphHeight=S.y),y.x+S.x+4*u.padding>this.domNodeWidth-2*u.margin?(u.graphWidth=S.x+2*u.padding,S.x=u.padding,M!==n.length-1?S.y+=2*u.padding:S.y-=y.y,u.graphHeight=S.y):(S.x+=2*u.padding,S.y-=y.y);u.graphWidth<S.x&&(u.graphWidth=S.x),u.graphHeight<S.y+y.y&&(u.graphHeight=S.y+y.y+e.charDimens.height)}else if("individual"===h.plotMode){var x=0,w=this;n.theData.forEach((function(t,i){if(t.length>0){var o={data:n.data,theData:t};x=w.renderWaffle(o,x,h,e,r,u,0,0,a)}})),u.graphHeight=x}C.call(this)}this.setWaffleStyle(h,e,r),h=null,u=null,e=null,r=null,i.utils.setBackgroundImage(this.domNode,vitaraJQ.extend({basePath:this.context.getBackgroundImagePath()},this.vizProps),function(t){this.context&&this.context.platformContext.updateBackgroundImageLoadStatus()}.bind(this)),this.endChartRendering()}function C(){var t;u.width=u.graphWidth,u.height=u.graphHeight,t="block"===h.plotMode?vitaraJQ(".graph",this.domNode):vitaraJQ(".waffle-container",this.domNode),"individual"===h.plotMode?this.setDimensions(t,u.width,u.height,u.padding,u.offsetHeight):this.setDimensions(t,u.width,u.height,u.padding,0),this.setChartDimensions()}function D(){this.startRender(h,u),this.renderWaffle(n,0,h,e,r,u,u.padding,0,a),this.renderLegend(n.data,h.colors,u.padding);var t=s.vitaraLegend.getDimensions();u.legendWidth=t.includeLegendWidth?t.width:0,u.legendHeight=t.includeLegendHeight?t.height:0,u.reScale&&(u.width+u.padding+u.legendWidth>=this.domNodeWidth-2*u.margin||u.height+u.padding+u.legendHeight>=this.position.height-2*u.margin)&&P.call(this);var i,o=h.widthSquares*h.squareSize,l=h.heightSquares*h.squareSize,c="#"+vitaraD3.select(this.domNode).attr("id"),d=vitaraJQ(".waffle-container",this.domNode);this.setDimensions(d,(o>t.width||t.includeLegendWidth?o+u.offsetWidth:t.width)+u.legendWidth,(l>t.height||t.includeLegendHeight?l+u.offsetHeight:t.height)+u.legendHeight,u.padding,0),this.rePosGraphContainer(c,t.width,t.height,t.xPos,t.yPos),s.vitaraLegend.resetLegend({width:(i=vitaraJQ(".waffle",d)).attr("width"),height:i.attr("height")}),C.call(this)}function P(){var t=h.widthSquares,e=h.heightSquares;h.width=h.squareSize*Math.round(h.widthSquares),u.adjustWidth&&h.width+u.padding+u.legendWidth>=this.domNodeWidth-2*u.margin?u.adjustHeight?u.reScale=!1:(u.adjustWidth=!0,h.widthSquares=(this.domNodeWidth-u.padding-u.legendWidth-2*u.margin)/h.squareSize,t===h.widthSquares&&h.widthSquares--,h.widthSquares<5&&(h.widthSquares=5,u.reScale=!1),h.heightSquares=Math.ceil(t*e/h.widthSquares),h.heightSquares<5?(h.heightSquares=5,h.widthSquares=Math.ceil(t*e/h.heightSquares),u.reScale=!1):(h.widthSquares=Math.floor(h.widthSquares),h.widthSquares*h.heightSquares<t*e&&(h.widthSquares--,h.heightSquares+=2),u.reScale=!1)):u.adjustWidth?u.reScale=!1:(u.adjustHeight=!0,h.heightSquares=(this.position.height-u.padding-u.legendHeight-2*u.margin)/h.squareSize,e===h.heightSquares&&h.heightSquares--,h.heightSquares<5&&(h.heightSquares=5,u.reScale=!1),h.widthSquares=Math.ceil(t*e/h.heightSquares),h.widthSquares<5?(h.widthSquares=5,h.heightSquares=Math.ceil(t*e/h.widthSquares),u.reScale=!1):(h.heightSquares=Math.floor(h.heightSquares),h.widthSquares*h.heightSquares<t*e&&(h.heightSquares--,h.widthSquares+=2),u.reScale=!1)),u.reScale?T.call(this):D.call(this)}function T(){h.width=h.squareSize*Math.round(h.widthSquares),h.height=h.squareSize*Math.round(h.heightSquares),h.width+u.padding+u.legendWidth>=this.domNodeWidth-2*u.margin||h.height+u.padding+u.legendHeight>=this.position.height-2*u.margin?P.call(this):(h.widthSquares=Math.round(h.widthSquares),h.heightSquares=Math.round(h.heightSquares),u.reScale=!1,D.call(this))}},setMetricIndexUsage:function(t,e,r,i,a){var n=!1;"string"==typeof r&&(1==+i.level&&a&&1===a.length||1!=+i.level&&1===e.dataRows.length)&&(n=!0),t.setTargetIndexUsage(n)},getThresholdTargetMetricName:function(t,e){return"string"==typeof t?t:e.source},pointClickHandler:function(t){var e=t.target.parentNode,r="."+t.target.getAttribute("class").split(" ")[1];t.target=vitaraJQ(r,e),h.styledModeRendererBase.prototype.pointClickHandler.call(this,t)}})},582:function(t,e,r){r.r(e),r.d(e,{tooltipProvider:function(){return a}});var i=r(45),a=function(t){this.context=t};vitaraJQ.extend(a.prototype,{getTooltipOptions:function(){return{enable:0!=this.vizProps.tooltipEnable,fontName:this.vizProps.toolTipStyleFontName||"Arial",fontSize:this.vizProps.toolTipStyleFontSize||13,color:this.vizProps.toolTipStyleColor||"black",weight:1==this.vizProps.toolTipStyleBold?"bold":"normal",style:1==this.vizProps.toolTipStyleItalic?"italic":"normal",decoration:1==this.vizProps.toolTipStyleUnderline?"underline":"none",bgColor:this.vizProps.toolTipBgColor||"white"}},getTooltipDelayStyles:function(){var t=this.getTooltipOptions();return"background: ".concat(t.bgColor,";\n\t\t\tcolor: ").concat(t.color,";\n\t\t\tfont-family: ").concat(t.fontName,";\n\t\t\tfont-size: ").concat(t.fontSize,"px;\n\t\t\tfont-weight: ").concat(t.weight,";\n\t\t\tfont-style: ").concat(t.style,";\n\t\t\ttext-decoration: ").concat(t.decoration,";\n\t\t").replace(/[\s]+/g," ")},hideTooltip:function(){vitaraJQ(".ch-tooltip",this.domNode).attr("style","display:none").html("")},renderTooltip:function(t){var e=this,r=vitaraJQ(".ch-tooltip",this.domNode),a=0,n=0,o=0,l=0;t.selection.on("mouseover",(function(s){var h,u,c="",d=vitaraD3.event||s,p=s.color||(null===(h=null==this?void 0:this.style)||void 0===h?void 0:h.color)||"";"function"==typeof t.getTooltipText&&(c=t.getTooltipText(s)),i.utils.isHTMLStringContainsLink(c)&&(a=500,n=1500,c=i.utils.appendTargetBlankToHTMLString(c)),clearTimeout(l),o=setTimeout(function(){var a,n;if("function"==typeof t.isTooltipEnabled&&t.isTooltipEnabled(s)){if(r.html(c).attr("style","display: block; border-color: ".concat(p,"; ").concat(e.getTooltipDelayStyles())),!i.utils.isHTMLStringContainsLink(c)){var o=vitaraD3.select(".vitara-tooltip");null==o||o.style("pointer-events","none"),r[0].style.pointerEvents="none"}e.domDimens||(e.domDimens=(null===(n=null===(a=null==e?void 0:e.context)||void 0===a?void 0:a.isTrellisMode)||void 0===n?void 0:n.call(a))?i.utils.getElementDimensions(e.context.domNode):i.utils.getElementDimensions(e.domNode)),u="function"==typeof t.getTooltipPosition?t.getTooltipPosition(d,r):i.utils.getTooltipPosition(d,e.domDimens,e.domNode,r[0],e.domNode),r[0].style.left=u.left+"px",r[0].style.top=u.top+"px"}}.bind(d),a)})),t.selection.on("mouseout",(function(){this.style.stroke&&this.style.strokeWidth&&(this.style.stroke="",this.style.strokeWidth=""),l=setTimeout((function(){e.hideTooltip()}),n),clearTimeout(o)}))}})}},a={};function n(t){var e=a[t];if(void 0!==e)return e.exports;var r=a[t]={id:t,loaded:!1,exports:{}};return i[t].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=i,e=[],n.O=function(r,i,a,o){if(!i){var l=1/0;for(d=0;d<e.length;d++){for(var s=t(e[d],3),h=(i=s[0],a=s[1],o=s[2],!0),u=0;u<i.length;u++)(!1&o||l>=o)&&Object.keys(n.O).every((function(t){return n.O[t](i[u])}))?i.splice(u--,1):(h=!1,o<l&&(l=o));if(h){e.splice(d--,1);var c=a();void 0!==c&&(r=c)}}return r}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,a,o]},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":r(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==("undefined"==typeof window?"undefined":r(window)))return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var e={3:0};n.O.j=function(t){return 0===e[t]};var r=function(r,i){var a,o,l=t(i,3),s=l[0],h=l[1],u=l[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(a in h)n.o(h,a)&&(n.m[a]=h[a]);if(u)var d=u(n)}for(r&&r(i);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},i=self.webpackChunkwebpack_latest=self.webpackChunkwebpack_latest||[];i.forEach(r.bind(null,0)),i.push=r.bind(null,i.push.bind(i))}();var o=n.O(void 0,[34,33,35,38,36],(function(){return n(580)}));o=n.O(o)}()},8562:(t,e,r)=>{"use strict";var i=r(6486),a=(r(764),r(1396),r(1095)),n=r(4089),o=r(9153);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function h(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:String(e)}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var a=p(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(n,t);var e,r,i,a=c(n);function n(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),r=a.call(this,t,e);var i=Object.getOwnPropertyNames(Object.getPrototypeOf(o.Z.prototype)),l={};return i.forEach((function(t){"function"==typeof o.Z.prototype[t]&&"constructor"!==t&&(l[t]=o.Z.prototype[t])})),Object.assign(n.prototype,l),r.setBaseContext(t),r.setEditorInterface(e),r}return e=n,(r=[{key:"getMarkerKey",value:function(){return"iconType"}},{key:"setBaseContext",value:function(t){this.context=t}},{key:"setEditorInterface",value:function(t){this.eInterface=t}}])&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),n}(o.Z);function g(t){t&&this.setContext(t)}Object.assign(g.prototype,n.Z.prototype,{getCustomProperty:function(){return[this.AppearanceProperties(),this.BackgroundProperties(),this.DataLabelsProperties,this.LegendProperties(),this.TooltipProperties(),this.ThresholdsPropertiesWaffle(),this.MarkerProperties,this.WaffleProperties,this.SecurityProperties(),this.getAboutChartMenu()]},getCustomEventHandler:function(t,e){return new f(t,e)},MarkerProperties:{label:"Marker",id:"MarkerProperties",containers:[{title:"",data:[{label:"Marker Type",fields:["iconType"]},{label:"Marker Size",fields:["waffleIconSize"]}]}]},DataLabelsProperties:{label:"Data Labels",id:"data_labels",containers:[{title:"",data:[{label:"Enable header labels",fields:["waffleLabelsEnable"]},{label:"Vertical Position",fields:["waffleLabelsVAlign"]},{label:"Label Style",fields:["labelItemStyleFontName","labelItemStyleFontSize","labelItemStyleBold","labelItemStyleItalic","labelItemStyleUnderline","labelItemStyleColor"]}]},{title:"",data:[{label:"Enable data labels",fields:["headerLabelsEnable"]},{label:"Format",fields:["dataLabelDisplayFormat"]}]},{title:"Format",data:[{label:"",fields:["customLabelEditor"]},{label:"",fields:["applycustomLabel"]}]}]},WaffleProperties:{label:"Waffle",id:"waffle",containers:[{title:"",data:[{label:"Layout",fields:["waffle"]},{label:"Orientation",fields:["orientation"]}]}]},getExtraAppearanceProps:function(){return[{label:"Unfilled Color",fields:["waffleUnfilledColor"]}]}});var m={processPreExportUpdates:function(){vitaraJQ("#waffle-chart-container",this.domNode).height("fit-content"),this._super()}};r.g.vitaraLD||(r.g.vitaraLD=i),mstrmojo.plugins.VitaraCharts.v530159.VitaraD3WaffleChart=mstrmojo.declare(a.Z,[m],{scriptClass:"mstrmojo.plugins.VitaraCharts.v530159.VitaraD3WaffleChart",cssClass:"VitaraD3WaffleChart",getVisualInstance:function(){return this.visualInstance||(this.visualInstance=new VitaraD3WaffleChartMixin(this),this.visualInstance.updateVisualProps=this.updateVisualProps),this.visualInstance},getEditorName:function(){return"WaffleChart"},getEditor:function(t){return this.propsEditor||(this.propsEditor=new g(t)),this.propsEditor},validateMinCriteria:function(t,e){if("percentage"===this.vizProps.waffle){if((isMSTRDashBoard()||isMSTRDesktop())&&!isMSTRMobile()){var r=this.zonesModel.getZones();0==this.zonesModel.getDropZoneObjectsByName(r.VALUE).length&&(e=0)}return{valid:e>0,message:"Include at least one metric to see the chart."}}return!isMSTRDashBoard()&&!isMSTRDesktop()||isMSTRMobile()||(r=this.zonesModel.getZones(),0==this.zonesModel.getDropZoneObjectsByName(r.VALUE).length&&(e=0)),{valid:e>0&&t>0,message:"Include at least one attribute and one metric to see the chart."}},getCustomContextMenuItems:function(){var t=["tooltip","separator","format","separator","palette"];return this.mRendererInstance.renderedChart&&this.mRendererInstance.renderedChart.isLegendRequired&&this.mRendererInstance.renderedChart.isLegendRequired()&&t.splice(1,0,"legend"),this.mRendererInstance.renderedChart&&this.mRendererInstance.renderedChart.isDataLabelRequired&&this.mRendererInstance.renderedChart.isDataLabelRequired()&&t.splice(1,0,"datalabel"),t},getPropertyDefault:function(t){return"headerLabelsEnable"===t?this.getRenderer().getPropMenuDefaults().headerLabelsEnable:this._super(t)},addContextMenuToDataPoints:function(){},getPropertyKey:function(t){return"DataLabel"===t||"datalabel"===t?"headerLabelsEnable":this._super(t)}})}},r={};function i(t){var a=r[t];if(void 0!==a)return a.exports;var n=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=e,t=[],i.O=(e,r,a,n)=>{if(!r){var o=1/0;for(u=0;u<t.length;u++){for(var[r,a,n]=t[u],l=!0,s=0;s<r.length;s++)(!1&n||o>=n)&&Object.keys(i.O).every(t=>i.O[t](r[s]))?r.splice(s--,1):(l=!1,n<o&&(o=n));if(l){t.splice(u--,1);var h=a();void 0!==h&&(e=h)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[r,a,n]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={257:0};i.O.j=e=>0===t[e];var e=(e,r)=>{var a,n,[o,l,s]=r,h=0;if(o.some(e=>0!==t[e])){for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(s)var u=s(i)}for(e&&e(r);h<o.length;h++)n=o[h],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(u)},r=self.webpackChunkVitaraCharts_MicroStrategy=self.webpackChunkVitaraCharts_MicroStrategy||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var a=i.O(void 0,[445,915,89],()=>i(8562));a=i.O(a)})();
