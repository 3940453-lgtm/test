mstrmojo.requiresCls("mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CirclePackingChartInitializer"),(()=>{var t,e={8191:()=>{function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var r,n,i,o,l=[],s=!0,c=!1;try{if(i=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;s=!1}else for(;!(s=(r=i.call(a)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(t){c=!0,n=t}finally{try{if(!s&&null!=a.return&&(o=a.return(),Object(o)!==o))return}finally{if(c)throw n}}return l}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function i(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(e){var a=function(e,a){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,a||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==t(a)?a:String(a)}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=p(t);if(e){var n=p(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return u(this,a)}}function u(e,a){if(a&&("object"===t(a)||"function"==typeof a))return a;if(void 0!==a)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){"use strict";var a,n={583:function(t,e,a){a.r(e),a.d(e,{tooltipProvider:function(){return n}});var r=a(44),n=function(t){this.context=t};vitaraJQ.extend(n.prototype,{getTooltipOptions:function(){return{enable:0!=this.vizProps.tooltipEnable,fontName:this.vizProps.toolTipStyleFontName||"Arial",fontSize:this.vizProps.toolTipStyleFontSize||13,color:this.vizProps.toolTipStyleColor||"black",weight:1==this.vizProps.toolTipStyleBold?"bold":"normal",style:1==this.vizProps.toolTipStyleItalic?"italic":"normal",decoration:1==this.vizProps.toolTipStyleUnderline?"underline":"none",bgColor:this.vizProps.toolTipBgColor||"white"}},getTooltipDelayStyles:function(){var t=this.getTooltipOptions();return"background: ".concat(t.bgColor,";\n\t\t\tcolor: ").concat(t.color,";\n\t\t\tfont-family: ").concat(t.fontName,";\n\t\t\tfont-size: ").concat(t.fontSize,"px;\n\t\t\tfont-weight: ").concat(t.weight,";\n\t\t\tfont-style: ").concat(t.style,";\n\t\t\ttext-decoration: ").concat(t.decoration,";\n\t\t").replace(/[\s]+/g," ")},hideTooltip:function(){vitaraJQ(".ch-tooltip",this.domNode).attr("style","display:none").html("")},renderTooltip:function(t){var e=this,a=vitaraJQ(".ch-tooltip",this.domNode),n=0,i=0,o=0,l=0;t.selection.on("mouseover",(function(s){var c,u,p="",h=vitaraD3.event||s,d=s.color||(null===(c=null==this?void 0:this.style)||void 0===c?void 0:c.color)||"";"function"==typeof t.getTooltipText&&(p=t.getTooltipText(s)),r.utils.isHTMLStringContainsLink(p)&&(n=500,i=1500,p=r.utils.appendTargetBlankToHTMLString(p)),clearTimeout(l),o=setTimeout(function(){var n,i;if("function"==typeof t.isTooltipEnabled&&t.isTooltipEnabled(s)){if(a.html(p).attr("style","display: block; border-color: ".concat(d,"; ").concat(e.getTooltipDelayStyles())),!r.utils.isHTMLStringContainsLink(p)){var o=vitaraD3.select(".vitara-tooltip");null==o||o.style("pointer-events","none"),a[0].style.pointerEvents="none"}e.domDimens||(e.domDimens=(null===(i=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.isTrellisMode)||void 0===i?void 0:i.call(n))?r.utils.getElementDimensions(e.context.domNode):r.utils.getElementDimensions(e.domNode)),u="function"==typeof t.getTooltipPosition?t.getTooltipPosition(h,a):r.utils.getTooltipPosition(h,e.domDimens,e.domNode,a[0],e.domNode),a[0].style.left=u.left+"px",a[0].style.top=u.top+"px"}}.bind(h),n)})),t.selection.on("mouseout",(function(){this.style.stroke&&this.style.strokeWidth&&(this.style.stroke="",this.style.strokeWidth=""),l=setTimeout((function(){e.hideTooltip()}),i),clearTimeout(o)}))}})},656:function(t,e,a){a.r(e),a.d(e,{VitaraD3CirclePackingChartMixin:function(){return p}}),a(1);var n=a(398),o=a(657),s=a(689),u=a(4),p=function(t){l(a,t);var e=c(a);function a(t){var n;return r(this,a),(n=e.call(this,t)).scriptClass="mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CirclePackingChart",n.cssClass="VitaraD3CirclePackingChart",n.NAME="Vitara Packed Bubble Chart",n.COLOR_PALETTE="defaultPalette",n.logEnvironmentInfo(),n}return i(a,[{key:"enableUseAsFilter",value:function(){return!0}},{key:"getThresholdMapper",value:function(){return this.thresholdMapper||(this.thresholdMapper=new s.CirclePackingThresholdMapper({context:this})),this.thresholdMapper}},{key:"getDefaultColors",value:function(){return u.cloneDeep(this.defaultChartColors.defaultPalette)}},{key:"getPropMenuDefaults",value:function(){return{labelsEnable:"1",unpackCircles:this.vizProps.unpackCircles||this.dataInterface&&this.dataInterface.getRowTitles().size()<2}}},{key:"getDataLabelTypes",value:function(){return[]}},{key:"destroyChart",value:function(){if(this.renderedChart)try{this.renderedChart.chartContainer&&this.renderedChart.chartContainer.selectAll("*").remove(),this.renderedChart.chartDataMapper=null,vitaraJQ(".ch-tooltip",this.chartNode).remove(),this.renderedChart=null}catch(t){console.error(t)}}},{key:"getSeriesElements",value:function(){return this.renderedChart&&this.renderedChart.chartDataMapper?[{name:this.renderedChart.chartDataMapper.titles[this.renderedChart.chartDataMapper.numAttributes],sId:this.renderedChart.data&&this.renderedChart.data.getColumnIdByTitle(this.renderedChart.chartDataMapper.titles[this.renderedChart.chartDataMapper.numAttributes])}]:[]}},{key:"vitaraPlot",value:function(t){try{this.renderedChart=new o.renderCirclePackingChart(this.dataHelper,this.position,this.chartNode,this.vizProps),this.renderedChart.render()}catch(t){this.handleVizError(t)}}}]),a}(VitaraMix(n.default).with());window.VitaraD3CirclePackingChartMixin=p},657:function(t,e,a){a.r(e),a.d(e,{renderCirclePackingChart:function(){return p}});var r=a(436),n=a(234),i=a(44),o=a(473),l=a(658),s=a(441),c=a(583),u=a(4),p=function(t,e,a,n){r.hcCore.call(this,t,e,a,n)};vitaraJQ.extend(p.prototype,r.hcCore.prototype,s.styledModeRendererBase.prototype,c.tooltipProvider.prototype,{isSeriesByMetric:function(){return!0},COLOR_PALETTE:"defaultColors",getChartDataMapper:function(){return this.chartDataMapper||(this.chartDataMapper=new n.chartDataMapperBase(this.context.dataHelper.getDataAsArray(),this.context.dataHelper.getTitles(),this.context.dataHelper.numAttributes,{data:this.context.dataHelper})),this.chartDataMapper},renderChart:function(){var t=this;this.legendItems=null;var e=t.context.dataHelper;this.getChartDataMapper(),t.chartDataMapper.isMetricOfPercentageData(e.numAttributes);var a,r,n,s,c,p,h,d,f,v,m=t.vizProps.colors||t.context.getDefaultColors(),g=t.getDataLabelOptions(),b=this.getTooltipOptions(),y=vitaraD3.scale.linear().domain([0,20]).range([.1,1]),D=t.domNode.offsetWidth<t.domNode.offsetHeight?t.domNode.offsetWidth:t.domNode.offsetHeight,C={},P=1,x=t.domNode.offsetHeight,M=t.domNode.offsetWidth;t.chartContainer=vitaraD3.select(t.domNode).attr("class",t.context.getUniqueChartStyle("name")+" vitara-chart-container vitara-theme-custom vitara-chart-background").append("div").attr("class","vitara-plot-background");var T=Math.sqrt(3),S=[[0,-1],[T/2,.5],[0,1],[-T/2,.5],[-T/2,-.5],[0,-1],[T/2,-.5]],w=0,L={x:0,y:0};if(b.enable&&(a=vitaraD3.select(this.domNode).append("div").attr("class","ch-tooltip").attr("style","display:none")),1==t.vizProps.unpackCircles||0!=t.vizProps.unpackCircles&&1===t.chartDataMapper.numAttributes?N():V(),this.isLegendEnabled()){var k;if(this.isColorByThresholds())k=this.getLegendItems(this.vizProps.thresholds);else{(k={labels:[],colors:[]}).labels=Object.keys(C),k.labels.forEach((function(t,e){k.colors[e]=C[t]}));var z=this.getLegendItems(this.vizProps.thresholds);k.labels=k.labels.concat(z.labels),k.colors=k.colors.concat(z.colors)}if(k.labels.length>0&&k.colors.length>0){this.renderLegend(k.labels,k.colors,20);var A=o.vitaraLegend.getPositionOffsets();if(A.y<x){t.isIE()&&A.x&&(w=20);var E=(M=A.x?M-A.x:M)<(x=A.y?x-A.y:x)?M:x;E!==D&&(D=E,vitaraJQ(".circle-packing-container",t.domNode).remove(),1==t.vizProps.unpackCircles||0!=t.vizProps.unpackCircles&&1===t.chartDataMapper.numAttributes?N():V())}o.vitaraLegend.repositionLegend(this.domNode,this.context.chartNode,".vitara-plot-background",!1)}}n.attr("width",M-10-w/2).attr("height",x-10),L.x=(M-(20+w)/2)/2,L.y=(x-10)/2,s.attr("transform","translate("+L.x+","+L.y+")");var O=s.selectAll("circle,text,path");function j(){t.context.vizParser.setDefaultThresholds(t.vizProps,[{data:h,name:t.chartDataMapper.titles[t.chartDataMapper.numAttributes],sId:t.data&&t.data.getColumnIdByTitle(t.chartDataMapper.titles[t.chartDataMapper.numAttributes])}],m),t.vizProps.thresholds&&t.context.getThresholdHelper().processGenericThreshold(t.vizProps.thresholds,[{data:h,name:t.chartDataMapper.titles[t.chartDataMapper.numAttributes],sId:t.data&&t.data.getColumnIdByTitle(t.chartDataMapper.titles[t.chartDataMapper.numAttributes])}],t.chartDataMapper)}function N(){r=u.cloneDeep(t.chartDataMapper.dataRows.slice(0,t.chartDataMapper.dataRows.length));var e=t.chartDataMapper.numAttributes;n=t.chartContainer.append("svg").attr("class","circle-packing-container"),s=n.append("g"),c=l.pack().size([D-(20+w),D-20]).padding(2),r=l.hierarchy({children:r}).sum((function(a){if(a[e]){a.values=[],a.names=[],a.name="";for(var r=0;r<t.chartDataMapper.numAttributes;r++)""!==a.name&&a[r].t&&(a.name+=", "),a.name+=a[r].t,a.names.push(a[r].t);for(r=0;r<t.chartDataMapper.numMetrics;r++)a.values[r]={v:a[r+t.chartDataMapper.numAttributes].fv,rv:a[r+t.chartDataMapper.numAttributes].v};return a.selectorFunc=a[e].selector,a.value=a[e].v,"fixed"===t.vizProps.bubbleSize?1:a[e].v}})),C={},P=1,p=r,h=c(r).leaves(),j();var i=s.selectAll("circle").data(h).enter().append("g").attr("class","node"),o="hexagon"===t.vizProps.bubbleType?"hexagon":"circle";(f="hexagon"===o?i.append("path").attr("d",(function(t){return I(t.r)})):i.append("circle")).attr("class",(function(t,e){return t.className=o+"_"+e,"vitara-point "+o+"_"+e})).style("fill",(function(t){return t.color?t.color:(C[t.data[0].t]||(C[t.data[0].t]=m[P++%m.length]),t.color=C[t.data[0].t],C[t.data[0].t])})).on("click",(function(e){vitaraD3.event&&(vitaraD3.event.stopPropagation(),vitaraD3.event.shiftKey||t.applySelection.call(t,e,vitaraD3.event))})).on("contextmenu",(function(e){var a;vitaraD3.event&&(null===(a=t.context)||void 0===a?void 0:a.platformContext)&&t.context.platformContext.handleContextMenuSelection&&(vitaraD3.event.stopPropagation(),t.handleContextMenuSelection.call(t,e,vitaraD3.event))})).call((function(e){a&&t.getToolTipHtml(e)}))}function V(){var e=t.chartDataMapper.numAttributes;t.chartDataMapper.groupByAttributes(t.chartDataMapper.titles.slice(0,t.chartDataMapper.numAttributes)),r=u.cloneDeep(t.chartDataMapper.getGroupRoot()),n=t.chartContainer.append("svg").attr("class","circle-packing-container"),s=n.append("g"),(c=vitaraD3.layout.pack().size([D-(20+w),D-20]).padding(2)).value((function(a){if(void 0===a.value){a.values=[],a.names=[],a.name="",a.value=a.records[0][e].v,a.selectorFunc=a.records[0][e].selector;for(var r=0;r<t.chartDataMapper.numAttributes;r++)""!==a.name&&a.records[0][r].t&&(a.name+=", "),a.name+=a.records[0][r].t,a.names.push(a.records[0][r].t);for(r=0;r<t.chartDataMapper.numMetrics;r++)a.values[r]={v:a.records[0][r+t.chartDataMapper.numAttributes].fv,rv:a.records[0][r+t.chartDataMapper.numAttributes].v}}return a.value<0?0:a.value})),"fixed"===t.vizProps.bubbleSize&&c.radius((function(t){return t<0?0:100})),h=c.nodes(r),C={},P=1,p=r,j();var i=function(e,r){e&&e.attr("class",(function(t,e){return t.name=t.toString(),t.className=r+"_"+e,(t.parent?(t.children?"vitara-point vitara-bubble node ":"vitara-point node node--leaf ")+"vitara-series-"+t.name.split(" ").join(""):"node node--root vitara-point vitara-bubble")+" "+r+"_"+e})).style("fill",(function(e){if(e.color)return e.color;if(!e.children){var a=t.getElementData(e);return C[a.name]||(C[a.name]=m[P++%m.length]),e.color=C[a.name],C[a.name]}return m[0]})).style("fill-opacity",(function(t){return t.children?y(t.depth):1})).on("click",(function(e){vitaraD3.event&&(vitaraD3.event.stopPropagation(),vitaraD3.event.shiftKey?p!==e&&e.children?B(e):p===e.parent||e.children||B(e.parent):t.applySelection.call(t,e,vitaraD3.event))})).on("contextmenu",(function(e){var a;vitaraD3.event&&(null===(a=t.context)||void 0===a?void 0:a.platformContext)&&t.context.platformContext.handleContextMenuSelection&&(vitaraD3.event.stopPropagation(),t.handleContextMenuSelection.call(t,e,vitaraD3.event))})).call((function(e){a&&t.getToolTipHtml(e)}))};if("hexagon"===t.vizProps.bubbleType){var o=s.selectAll("circle").data(h).enter().append("g");f=o.filter((function(t){return t.children})).append("circle"),v=o.filter((function(t){return!t.children})).append("path").attr("d",(function(t){return I(t.r)}))}else f=s.selectAll("circle").data(h).enter().append("circle");i(f,"circle"),i(v,"hexagon")}function I(t){return"m"+S.map((function(e){return[e[0]*t,e[1]*t].join(",")})).join("l")+"z"}function B(e){p=e,t.chartContainer.transition().duration(vitaraD3.event&&vitaraD3.event.altKey?7500:750).tween("zoom",(function(t){var e=vitaraD3.interpolateZoom(d,[p.x,p.y,2*p.r+20]);return function(t){_(e(t))}})).selectAll(".vitara-datalabel").filter((function(t){if(t)return this.style.fillOpacity="0",t.parent===p||"inline"===this.style.display})).style("fill-opacity",(function(t){if(t)return 0})).each("start",(function(t){t&&t.parent===p&&(this.style.display="inline")})).each("end",(function(t){if(t)if(t.parent!==p)this.style.display="none";else{var e=i.utils.getElementDimensions(this),a=Math.floor(Math.sqrt(Math.pow(2*t.r,2)/2));!e||e.width<a||e.height<a?this.style.fillOpacity="1":this.style.fillOpacity="0"}}))}function _(e){var a=D/e[2];d=e;var r=i.utils.getElementDimensions(t.chartContainer);O.attr("transform",(function(t,r){return"translate("+(t.x-e[0])*a+","+(t.y-e[1])*a+")"})),f.attr("r",(function(t){return 0===t.value&&0===t.r?1:t.r*a})),v&&v.attr("d",(function(t){return I(t.r*a)}));var n=t.chartContainer.selectAll(".vitara-datalabel")[0];u.each(n,(function(e,a){if(e){var n=s.select("."+e.__data__.className).node(),o=i.utils.getElementDimensions(n),l=i.utils.getElementDimensions(e),c=o.left-r.left,u=o.top-r.top,p=t.getLabelPosition(l,o,t.vizProps);e.style.visibility=function(e,a){if(1==t.vizProps.labelsEnableOverlap)return"visible";var r=e.width;return Math.sqrt(Math.pow(a.height,2)+Math.pow(a.width,2))<r?"visible":"hidden"}(o,l),e.style.transform="translate("+(c+p.left)+"px,"+(u+p.top)+"px)"}}))}n.on("click",(function(){if(vitaraD3.event)if(vitaraD3.event.shiftKey){if(0!=t.vizProps.unpackCircles&&1===t.chartDataMapper.numAttributes||1==t.vizProps.unpackCircles)return;vitaraD3.event.stopPropagation(),B(r)}else t.context.platformContext.selectedPoints=[window],t.context.applySelections().call(window,vitaraD3.event)})),t.labelContainer&&t.labelContainer.selectAll("*").remove(),t.labelContainer=t.chartContainer.append("div").attr("class","chart-datalabels").attr("style","position:absolute;visibility:hidden;pointer-events:none;"),t.labelContainer.selectAll("text").data(h).enter().append("div").attr("class",(function(e){return 1==+t.vizProps.labelsWrapText?"vitara-datalabel vitara-wrap-content "+e.className:"vitara-datalabel "+e.className})).attr("font-family",(function(e){return t.getDataLabelStyle(e,"fontFamily",g.textStyle.fontName)})).attr("font-size",(function(e){return t.getDataLabelStyle(e,"fontSize",g.textStyle.fontSize+"px")})).attr("fill",(function(e){return t.getDataLabelStyle(e,"color",g.textStyle.color)})).attr("font-weight",(function(e){return t.getDataLabelStyle(e,"fontWeight",g.textStyle.weight)})).attr("font-style",(function(e){return t.getDataLabelStyle(e,"fontStyle",g.textStyle.style)})).attr("text-decoration",(function(e){return t.getDataLabelStyle(e,"text-decoration",g.textStyle.decoration)})).attr("style",(function(t,e){return"fill-opacity:"+(t.parent===r?1:0)+";display:"+(t.parent===r?"inline":"none")+";position:absolute;"})).html((function(e){return e.value<0?"":1==g.enable||e.dataLabels&&1==e.dataLabels.enabled?t.getDataLabel(e):""})).attr({x:0,dy:"1em"}),_([r.x,r.y,2*r.r+20]),t.labelContainer.attr("style","position:relative;float:left;pointer-events:none;"),i.utils.setBackgroundImage(t.domNode,vitaraJQ.extend({basePath:t.context.getBackgroundImagePath()},t.vizProps)),t.endChartRendering()},getLabelPosition:function(t,e,a){var r=0,n=0;return"left"===a.labelsAlign||(r="right"===a.labelsAlign?e.width-t.width:e.width/2-(e.width-t.width<0?e.width:t.width)/2),"top"===a.labelsVAlign||(n="bottom"===a.labelsVAlign?e.height-t.height:e.height/2-(e.height-t.height<0?e.height:t.height)/2),{left:r,top:n}},postChartRendering:function(){var t;this.processStyleMode(),this.context&&(null===(t=this.context.platformContext)||void 0===t?void 0:t.initContextMenu)&&this.context.platformContext.initContextMenu()},processLegendStyles:function(t){this.init(),this.processVitaraLegendItems(t)},isLegendEnabled:function(){return 1==this.vizProps.legendEnable},getVitaraChartBgClass:function(){return".vitara-chart-background"},processStyleMode:function(){this.isLegendEnabled()||this.init(),this.setChartBackground()},getDataLabelOptions:function(){return{enable:0!=this.vizProps.labelsEnable,format:this.vizProps.dataLabelDisplayFormat||"default",textStyle:{fontName:this.vizProps.textStyleFontName||"",fontSize:this.vizProps.textStyleFontSize||13,weight:1==this.vizProps.textStyleBold?"bold":"normal",style:1==this.vizProps.textStyleItalic?"italic":"normal",decoration:1==this.vizProps.textStyleUnderline?"underline":"none",color:this.vizProps.textStyleColor||"#282828"}}},renderLegend:function(t,e,a){var r={enabled:!0,align:"center",layout:"horizontal",position:"relative",verticalAlign:"bottom",colors:e,labels:t,options:{padding:"5"},containerWidth:this.position.width-a,containerHeight:this.position.height-a},n=this.vizProps.legend;n.align=n.align?n.align:"center",n.layout=n.layout?n.layout:"horizontal",n.verticalAlign=n.verticalAlign?n.verticalAlign:"bottom","middle"===(r=vitaraJQ.extend(r,this.vizProps.legend)).verticalAlign&&"center"===r.align&&(r.verticalAlign="bottom");var i="text-align:"+r.align+";";return"vertical"===r.layout&&(i+="display:inline-block;","top"===r.verticalAlign&&(i+="vertical-align:top;")),this.processLegendStyles(r),o.vitaraLegend.init(r,vitaraD3.select(this.domNode).append("div").attr("class","vitara-legend").attr("id","vitara-legend").attr("style",i)),r},handleContextMenuSelection:function(t,e){var a,r,n,i,o,l;null===(n=null===(r=null===(a=this.context)||void 0===a?void 0:a.platformContext)||void 0===r?void 0:r.handleContextMenuSelection)||void 0===n||n.call(r,e,null===(l=null===(o=null===(i=this.context)||void 0===i?void 0:i.platformContext)||void 0===o?void 0:o.getGraphicModel)||void 0===l?void 0:l.call(o,this.getElementData(t)))},applySelection:function(t,e){this.getElementData(t).selectorFunc?this.context.applySelections().call(this.getElementData(t),e):this.resetSelection(e)},resetSelection:function(t){this.context.platformContext.selectedPoints=[window],this.context.applySelections().call(window,t)},generateTooltipText:function(t,e){var a=t,r=this,n=this.data.getTitles(),i="",o=[],l=this.vizProps.customTooltip;if(i+=this.getElementData(t).name,a.parent)for(0===a.parent.depth&&a.name&&o.push(a.name);a.parent.depth>0;)0===o.length&&o.push(a.name),o.unshift(a.parent.name),a.parent.name&&(i?i=a.parent.name+", "+i:i+=a.parent.name),a=a.parent;if(l&&""!=l){if(0===o.length){var s=this.getElementData(t);o=s.names?s.names:[]}return this.formCustomTooltip(t,l,n,o)}return this.getElementData(t)&&this.getElementData(t).values&&this.getElementData(t).values.forEach((function(t,a){i+="<br/>"+e[a]+" : "+r.getPointMetricValue(t)})),i},getTooltipText:function(t){return this.generateTooltipText(t,this.data.getTitles().slice(this.data.numAttributes))},isTooltipEnabled:function(t){return!t.children},getToolTipHtml:function(t){var e={selection:t,isTooltipEnabled:this.isTooltipEnabled.bind(this),getTooltipText:this.getTooltipText.bind(this)};this.renderTooltip(e)},getDataLabelHtml:function(t){var e=t.customLabel||this.vizProps.customLabel;if(e){var a;a=t.customLabel?this.vizProps.thresholdCustomLabelcolstate:this.vizProps.customLabelcolstate;var r=this.data.getTitles();return this.formCustomTooltip(t,e,r,[this.getElementData(t).name],a)}var n="";return t.children&&"root"===this.getElementData(t).name?"":"attributeLabel"===this.vizProps.dataLabelsDisplayStyle?this.getElementData(t).name:("combinedFormat"===this.vizProps.dataLabelsDisplayStyle&&(n+=this.getElementData(t).name),n+(""!==n?"<br>":"")+this.getPointMetricValue(t))},getPointValue:function(t,e){var a=this.getElementData(t);return a.values?a.values[0][e]:void 0===a[e]?a.value:a[e]||""},getPointMetricValue:function(t){return"string"!=typeof this.getPointValue(t,"v")&&(t.v=i.utils.formatMetricLike(this.getPointValue(t,"rv"),this.chartDataMapper.getMetricFormatObject(this.chartDataMapper.numAttributes))),i.utils.shortenNumber({fv:this.getPointValue(t,"v"),rawVal:this.getPointValue(t,"rv")},this.vizProps.dataLabelDisplayFormat)},includeCss:function(t,e){return""!==t?'<div class="'+t+'">'+e+"</div>":e},getDataLabel:function(t){return this.includeCss(this.getLabelClassName(t),this.getDataLabelHtml(t))},getLabelClassName:function(t){return 1==+this.vizProps.labelsWrapText?"vitara-wrap-content":""},formCustomTooltip:function(t,e,a,r,n){var o=e;n||(n=this.vizProps.customTooltipcolstate);for(var l="",s=0;s<this.data.numAttributes;s++){var c="&amp;["+a[s]+"]",u=r[s]?r[s]:"";o=o.split(c).join(u),u&&(""!=l&&(l+=","),l+=u)}var p="&amp;[Metric Names]",h="",d=(o=o.split("&amp;[Attribute Values]").join(l)).indexOf(p),f=o.indexOf("&amp;[Metric Values]");if(-1===d&&(d=f),-1!==d){if(-1===f)f=d+p.length;else if(f<d){var v=f;f=d+p.length,d=v}else f+="&amp;[Metric Values]".length;h=o.substring(d,f)}var m="";for(s=this.data.numAttributes;s<this.data.numColumns;s++){if(c="&amp;["+a[s]+"]",u="",this.getElementData(t).values){var g=this.getElementData(t).values[s-this.data.numAttributes];u=i.utils.shortenNumber({rawVal:g.rv,fv:g.v},this.vizProps.dataLabelDisplayFormat)}else if(this.chartDataMapper.getGroupNode()||this.chartDataMapper.groupByAttributes(this.chartDataMapper.titles.slice(0,this.chartDataMapper.numAttributes)),this.chartDataMapper.getGroupNode()){var b=this.chartDataMapper.getGroupAggregate(l.split(","),{metric:this.chartDataMapper.titles[s]},{format:this.vizProps.dataLabelDisplayFormat});b&&(u=b.fv)}if(o=o.split(c).join(u),""!==h){var y=h.split(p).join(a[s]);y=y.split("&amp;[Metric Values]").join(u),t.mName===a[s]?m=y+"<br>"+m:(m+=y,s!==this.chartDataMapper.numColumns-1&&(m+="<br>"))}}for(""!==h&&(o=o.split(h).join(m)),o=(o=(o=(o=o.split("&amp;[point.category]").join(l)).split("&amp;[point.value]").join(this.getPointMetricValue(t))).split("&amp;[point.metricName]").join(a[this.data.numAttributes])).split("&amp;[point.metric]").join(a[this.data.numAttributes]),s=0;s<n.length;s++){for(var D=!1,C=0;C<this.chartDataMapper.numColumns;C++)if(n[s].value==a[s]){D=!0;break}0==D&&(c="&amp;["+n[s].value+"]",o=o.split(c).join(""))}return i.utils.addMarkersIconsInTooltip(o)},getElementData:function(t){return t.data||t},getDataLabelStyle:function(t,e,a){return t.dataLabels&&t.dataLabels.enabled&&t.dataLabels.style?t.dataLabels.style[e]:a},isIE:function(){return!!document.documentMode||!!window.StyleMedia},getThresholdsByGID:function(t){if(t&&Object.keys(t).length>0){var e={};return u.forEach(t,(function(t){u.forEach(t,(function(t){t.gid?(e[t.gid]||(e[t.gid]=[]),e[t.gid].push(t)):(e.others||(e.others=[]),e.others.push(t))}))})),e}},isGRThresholdsInCol:function(t){var e=!1;return u.forEach(t,(function(t){u.forEach(t,(function(t){t&&t.gid&&(e=!0)}))})),e},isColorByThresholds:function(){if(this.vizProps&&this.vizProps.thresholds&&Object.keys(this.vizProps.thresholds).length>0){var t=0;return u.forEach(this.vizProps.thresholds,(function(e){t+=e.length})),t>0&&this.isGRThresholdsInCol(this.vizProps.thresholds)}return!1},getMetricFormat:function(t){return this.metricFormatTemplate||(this.metricFormatTemplate=this.chartDataMapper.dataRows.metaInfo[t]),this.metricFormatTemplate},formLegendLabel:function(t,e,a){var r=this.chartDataMapper.titles.indexOf(a);return r<this.chartDataMapper.numAttributes&&(r=this.chartDataMapper.numAttributes),this.context.utils.formatLabel(t,this.getMetricFormat(r),this.vizProps.dataLabelDisplayFormat)+" - "+this.context.utils.formatLabel(e,this.getMetricFormat(r),this.vizProps.dataLabelDisplayFormat)},isNumber:function(t){return void 0!==t&&"number"==typeof t&&!isNaN(t)},pickStartEndValues:function(t,e){var a,r=[],n=this,i=t.targetValues.filter((function(t){return n.isNumber(t)}));return i.sort((function(t,e){return t-e})),void 0===e||isNaN(e)||(a=this.getChartDataMapper().isMetricOfPercentageData(e)),r.push("between"===t.condition?a?t.values[0]/100:t.values[0]:i[0]),r.push("between"===t.condition?a?t.values[1]/100:t.values[1]:i[i.length-1]),r},includeToLegend:function(t){return["between","toppercentage","bottompercentage","betweenpercentage","lessthan","greaterthan","lessthanequalto","greaterthanequalto","aboveaverage","belowaverage","top","bottom","equalto"].indexOf(t)},setLegendItems:function(t,e,a){if(this.legendItems||(this.legendItems={labels:[],colors:[]}),-1!==this.includeToLegend(t.condition)){var r=this.pickStartEndValues(t,a);void 0!==r[0]&&void 0!==r[1]&&(this.legendItems.labels.push(this.formLegendLabel(r[0],r[1],t.source)+e),this.legendItems.colors.push(t.color))}},getLegendItems:function(t){return this.legendItems?this.legendItems:{labels:[],colors:[]}}})},689:function(t,e,a){a.r(e),a.d(e,{CirclePackingThresholdMapper:function(){return n}});var n=function(t){l(a,t);var e=c(a);function a(){return r(this,a),e.apply(this,arguments)}return i(a,[{key:"setThreshold",value:function(t,e,a,r){var n,i=this,o=r-i.context.dataHelper.numAttributes,l="attribute"===a.type;return l&&(n=this.getAttributeValueMarker(a),o=r),t.data=t.data.map((function(t){if(t.data)-1!==vitaraJQ.inArray(t.data[r][n||"v"],e)&&(t.color=a.color||a.defaultColor,i.setDataLabel(t,{enabled:a.enableDataLabel,style:a.dataLabelStyle}),i.setCustomDataLabel(t,a.customLabel));else if(t.values){-1!==(l&&t.records&&t.records[0]?vitaraJQ.inArray(t.records[0][o][n],e):vitaraJQ.inArray(t.values[o].rv,e))&&(t.color=a.color||a.defaultColor,i.setDataLabel(t,{enabled:a.enableDataLabel,style:a.dataLabelStyle}),i.setCustomDataLabel(t,a.customLabel))}return t})),i.context.renderedChart.setLegendItems(a,i.getSourceLabel(i.context.dataHelper,r,a),r),t}}]),a}(a(510).ThresholdMapperBase)}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var a=o[t]={id:t,loaded:!1,exports:{}};return n[t].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=n,a=[],s.O=function(t,r,n,i){if(!r){var o=1/0;for(h=0;h<a.length;h++){for(var l=e(a[h],3),c=(r=l[0],n=l[1],i=l[2],!0),u=0;u<r.length;u++)(!1&i||o>=i)&&Object.keys(s.O).every((function(t){return s.O[t](r[u])}))?r.splice(u--,1):(c=!1,i<o&&(o=i));if(c){a.splice(h--,1);var p=n();void 0!==p&&(t=p)}}return t}i=i||0;for(var h=a.length;h>0&&a[h-1][2]>i;h--)a[h]=a[h-1];a[h]=[r,n,i]},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},s.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":t(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==("undefined"==typeof window?"undefined":t(window)))return window}}(),s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t={1:0};s.O.j=function(e){return 0===t[e]};var a=function(a,r){var n,i,o=e(r,3),l=o[0],c=o[1],u=o[2],p=0;if(l.some((function(e){return 0!==t[e]}))){for(n in c)s.o(c,n)&&(s.m[n]=c[n]);if(u)var h=u(s)}for(a&&a(r);p<l.length;p++)i=l[p],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(h)},r=self.webpackChunkwebpack_latest=self.webpackChunkwebpack_latest||[];r.forEach(a.bind(null,0)),r.push=a.bind(null,r.push.bind(r))}();var u=s.O(void 0,[34,37,33,35,36],(function(){return s(656)}));u=s.O(u)}()},1486:(t,e,a)=>{"use strict";var r=a(6486),n=(a(764),a(8191),a(6819)),i=a(4089);function o(t){t&&this.setContext(t)}Object.assign(o.prototype,i.Z.prototype,{getCustomProperty(){return[this.AppearanceProperties(),this.BackgroundProperties(),this.DataLabelsProperties(),this.LegendProperties(),this.TooltipProperties(),this.ThresholdsPropertiesType2(),this.CirclePackingProperties,this.SecurityProperties(),this.getAboutChartMenu()]},CirclePackingProperties:{label:"Packed Bubble",id:"packed_bubble",containers:[{title:"",data:[{label:"UnGroup",fields:["unpackCircles"]},{label:"Bubble Type",fields:["bubbleType"]},{label:"Bubble Size",fields:["bubbleSize"]}]}]}}),a.g.vitaraLD||(a.g.vitaraLD=r),mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CirclePackingChart=mstrmojo.declare(n.Z,[],{scriptClass:"mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CalHeatMapChart",cssClass:"VitaraD3CirclePackingChart",getVisualInstance:function(){return this.visualInstance||(this.visualInstance=new VitaraD3CirclePackingChartMixin(this),this.visualInstance.updateVisualProps=this.updateVisualProps),this.visualInstance},getEditorName:function(){return"CirclePackingEditor"},getEditor:function(t){return this.propsEditor||(this.propsEditor=new o(t)),this.propsEditor},validateMinCriteria:function(t,e){if((isMSTRDashBoard()||isMSTRDesktop())&&!isMSTRMobile()){var a=this.zonesModel.getZones();0==this.zonesModel.getDropZoneObjectsByName(a.VALUE).length&&(e=0)}return{valid:e>0&&t>0,message:"Include at least 1 metric and 1 attribute to see the chart."}},addContextMenuToDataPoints:function(){}})}},a={};function r(t){var n=a[t];if(void 0!==n)return n.exports;var i=a[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,t=[],r.O=(e,a,n,i)=>{if(!a){var o=1/0;for(u=0;u<t.length;u++){for(var[a,n,i]=t[u],l=!0,s=0;s<a.length;s++)(!1&i||o>=i)&&Object.keys(r.O).every(t=>r.O[t](a[s]))?a.splice(s--,1):(l=!1,i<o&&(o=i));if(l){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[a,n,i]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={738:0};r.O.j=e=>0===t[e];var e=(e,a)=>{var n,i,[o,l,s]=a,c=0;if(o.some(e=>0!==t[e])){for(n in l)r.o(l,n)&&(r.m[n]=l[n]);if(s)var u=s(r)}for(e&&e(a);c<o.length;c++)i=o[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(u)},a=self.webpackChunkVitaraCharts_MicroStrategy=self.webpackChunkVitaraCharts_MicroStrategy||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})();var n=r.O(void 0,[445,272,89],()=>r(1486));n=r.O(n)})();
