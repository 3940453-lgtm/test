mstrmojo.requiresCls("mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CalHeatMapChartInitializer"),(()=>{var t,e={7049:(t,e,a)=>{var i,n;function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i,n,o,r,s=[],l=!0,h=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(i=o.call(a)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){h=!0,n=t}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(h)throw n}}return s}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=c(t);if(e){var n=c(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return u(this,a)}}function u(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function d(t,e,a){return e&&m(t.prototype,e),a&&m(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=g(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:String(e)}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";var r,l={649:function(t,e,a){a.r(e),a.d(e,{CalHeatMap:function(){return i.CalHeatMap}});var i=a(650);i.CalHeatMap.prototype.getSubDomainTitle=function(t){if(null!==t.v||this.options.considerMissingDataAsZero){var e=t.v;return null===e&&this.options.considerMissingDataAsZero&&(e=0),this.dataContext.vizProps.customTooltip?this.dataContext.metricsDataForTooltip(t.t,t.v,this.initTimeStamps,this.options.subDomain,!1,t,this.dataContext.getTimeZoneAsLang(t.t,this.options.subDomainDateFormat)):this.options.subDomainTitleFormat.filled.format({count:this.formatNumber(Math.round(e)),title:this.dataContext.getTitleForSubdomain(),name:this.options.itemName[1!==e?1:0],connector:this._domainType[this.options.subDomain].format.connector,date:this.dataContext.getTimeZoneAsLang(t.t,this.options.subDomain),allmetrics_formattedvalue:this.dataContext.metricsDataForTooltip(t.t,t.v,this.initTimeStamps,this.options.subDomain,!1,t)})}return this.dataContext.vizProps.customTooltip?this.dataContext.metricsDataForTooltip(t.t,t.v,this.initTimeStamps,this.options.subDomain,!1,t,this.dataContext.getTimeZoneAsLang(t.t,this.options.subDomainDateFormat)):this.options.subDomainTitleFormat.empty.format({date:this.dataContext.getTimeZoneAsLang(t.t,this.options.subDomain)})},i.CalHeatMap.prototype.getToolTipHtml=function(t){var e=0,a=0,i=0,n=0,o=this;t.on("mouseover",(function(t){var r=o.getSubDomainTitle(t);o.dataContext.context.utils.isHTMLStringContainsLink(r)&&(i=500,n=1500,r=o.dataContext.context.utils.appendTargetBlankToHTMLString(r));var s=vitaraD3.event||event,l=vitaraD3.rgb(vitaraD3.select(this).style("fill"));clearTimeout(a),e=setTimeout(function(){o.tooltip.html(r||"").attr("style","display: inline-block;background:"+(o.dataContext.vizProps.toolTipBgColor||"#ffffff")+";pointer-events: all;"),l.a=.7,o.tooltip.style("border-color",l),l.a=.5,o.tooltip.style("box-shadow",l),o.dataContext.vizProps.customTooltip||o.tooltip.html(o.tooltip.text()),o.dataContext.context.utils.isIE()&&!o.dataContext.domDimens&&(o.dataContext.domDimens=o.dataContext.context.utils.getElementDimensions(o.dataContext.domNode));var t=o.dataContext.context.utils.getTooltipPosition(s,o.dataContext.domDimens,o.dataContext.domNode,o.tooltip,o.dataContext.chartNode);o.tooltip[0][0].style.left=(o.dataContext.chartNode.scrollLeft?o.dataContext.chartNode.scrollLeft:0)+t.left+"px",o.tooltip[0][0].style.top=(o.dataContext.chartNode.scrollTop?o.dataContext.chartNode.scrollTop:0)+t.top+"px"}.bind(s),i)})),t.on("mouseout",(function(){a=setTimeout((function(){o.tooltip.attr("style","display:none").html("")}),n),clearTimeout(e)}))}},650:function(o,r,s){s.r(r),s.d(r,{CalHeatMap:function(){return c}});var l=s(648),h=s.n(l);function u(t){return(u="function"==typeof Symbol&&"symbol"==g(Symbol.iterator)?function(t){return g(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":g(t)})(t)}o=s.hmd(o);var c=function(){var t=this;for(var e in this.allowedDataType=["json","csv","tsv","txt"],this.options={domNode:"",itemSelector:"#cal-heatmap",paintOnLoad:!0,range:12,cellSize:10,cellPadding:2,cellRadius:0,domainGutter:2,domainMargin:[0,0,0,0],domain:"hour",subDomain:"min",colLimit:null,rowLimit:null,weekStartOnMonday:!0,start:new Date,minDate:null,maxDate:null,data:"",dataType:this.allowedDataType[0],dataPostPayload:null,considerMissingDataAsZero:!1,loadOnInit:!0,verticalOrientation:!1,domainDynamicDimension:!0,label:{position:"bottom",align:"center",offset:{x:0,y:0},rotate:null,width:100,height:null},legend:[10,20,30,40],displayLegend:!0,legendCellSize:10,legendCellPadding:2,legendMargin:[0,0,0,0],legendVerticalPosition:"bottom",legendHorizontalPosition:"left",legendOrientation:"horizontal",legendColors:null,highlight:[],itemName:["item","items"],domainLabelFormat:null,subDomainTitleFormat:{empty:"{date}",filled:"{count} {name} {connector} {date}"},subDomainDateFormat:null,subDomainTextFormat:null,legendTitleFormat:{lower:"less than {min} {name}",inner:"between {down} and {up} {name}",upper:"more than {max} {name}"},animationDuration:500,nextSelector:!1,previousSelector:!1,itemNamespace:"cal-heatmap",tooltip:!1,onClick:null,onContextMenu:null,afterLoad:null,afterLoadNextDomain:null,afterLoadPreviousDomain:null,onComplete:null,afterLoadData:function(t){return t},onMaxDomainReached:null,onMinDomainReached:null,arabic:!1},this._domainType={min:{name:"minute",level:10,maxItemNumber:60,defaultRowNumber:10,defaultColumnNumber:6,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){return Math.floor(e.getMinutes()/t._domainType.min.row(e))},y:function(e){return e.getMinutes()%t._domainType.min.row(e)}},format:{date:"%H:%M, %A %B %-e, %Y",legend:"",connector:"at"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()).getTime()}},hour:{name:"hour",level:20,maxItemNumber:function(e){switch(t.options.domain){case"day":return 24;case"week":return 168;case"month":return 24*(t.options.domainDynamicDimension?t.getDayCountInMonth(e):31)}},defaultRowNumber:6,defaultColumnNumber:function(e){switch(t.options.domain){case"day":return 4;case"week":return 28;case"month":return t.options.domainDynamicDimension?t.getDayCountInMonth(e):31}},row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){return"month"===t.options.domain?t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getHours()+24*(e.getDate()-1))/t._domainType.hour.row(e)):Math.floor(e.getHours()/t._domainType.hour.row(e))+4*(e.getDate()-1):"week"===t.options.domain?t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getHours()+24*t.getWeekDay(e))/t._domainType.hour.row(e)):Math.floor(e.getHours()/t._domainType.hour.row(e))+4*t.getWeekDay(e):Math.floor(e.getHours()/t._domainType.hour.row(e))},y:function(e){var a=e.getHours();if(t.options.colLimit>0||t.options.rowLimit>0)switch(t.options.domain){case"month":a+=24*(e.getDate()-1);break;case"week":a+=24*t.getWeekDay(e)}return Math.floor(a%t._domainType.hour.row(e))}},format:{date:"%Hh, %A %B %-e, %Y",legend:"%H:00",connector:"at"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()).getTime()}},day:{name:"day",level:30,maxItemNumber:function(e){switch(t.options.domain){case"week":return 7;case"month":return t.options.domainDynamicDimension?t.getDayCountInMonth(e):31;case"year":return t.options.domainDynamicDimension?t.getDayCountInYear(e):366}},defaultColumnNumber:function(e){switch(e=new Date(e),t.options.domain){case"week":return 1;case"month":return t.options.domainDynamicDimension&&!t.options.verticalOrientation?t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()+1,0))-t.getWeekNumber(e)+1:6;case"year":return t.options.domainDynamicDimension?t.getWeekNumber(new Date(e.getFullYear(),11,31))-t.getWeekNumber(new Date(e.getFullYear(),0))+1:54}},defaultRowNumber:7,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){switch(t.options.domain){case"week":return Math.floor(t.getWeekDay(e)/t._domainType.day.row(e));case"month":return t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getDate()-1)/t._domainType.day.row(e)):t.options.arabic?t.getWeekNumber(e)-t.getWeekNumber(new Date(h()(e).startOf("iMonth").valueOf())):t.getWeekNumber(e)-t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()));case"year":return t.options.colLimit>0||t.options.rowLimit>0?Math.floor((t.getDayOfYear(e)-1)/t._domainType.day.row(e)):t.getWeekNumber(e)}},y:function(e){var a=t.getWeekDay(e);if(t.options.colLimit>0||t.options.rowLimit>0)switch(t.options.domain){case"year":a=t.getDayOfYear(e)-1;break;case"week":a=t.getWeekDay(e);break;case"month":a=e.getDate()-1}return Math.floor(a%t._domainType.day.row(e))}},format:{date:"%A %B %-e, %Y",legend:"%e %b",connector:"on"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}},week:{name:"week",level:40,maxItemNumber:function(e){switch(t.options.domain){case"year":return t.options.arabic?52:54;case"month":return 6}},defaultColumnNumber:function(e){switch(e=new Date(e),t.options.domain){case"year":return t._domainType.week.maxItemNumber(e);case"month":return t.options.domainDynamicDimension?t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()+1,0))-t.getWeekNumber(e):5}},defaultRowNumber:1,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){switch(t.options.domain){case"year":var a="00";return t.lastWeek&&t.lastWeek!==e.valueOf()&&(a=Math.floor(t.getWeekNumber(e)/t._domainType.week.row(e))),t.lastWeek=e.valueOf(),a;case"month":return Math.floor(t.getMonthWeekNumber(e)/t._domainType.week.row(e))}},y:function(e){switch(t.options.domain){case"year":return t.getWeekNumber(e)%t._domainType.week.row(e);case"month":return t.getMonthWeekNumber(e)}}},format:{date:"%B Week #%W",legend:"%B Week #%W",connector:"in"},extractUnit:function(e){var a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=a.getDay()-(t.options.weekStartOnMonday?1:0);return i<0&&(i=6),a.setDate(a.getDate()-i),a.getTime()}},month:{name:"month",level:50,maxItemNumber:12,defaultColumnNumber:12,defaultRowNumber:1,row:function(){return t.getSubDomainRowNumber()},column:function(){return t.getSubDomainColumnNumber()},position:{x:function(e){return t.options.arabic?Math.floor(h()(e).iMonth()/t._domainType.month.row(e)):Math.floor(e.getMonth()/t._domainType.month.row(e))},y:function(e){return t.options.arabic?h()(e).iMonth()%t._domainType.month.row(e):e.getMonth()%t._domainType.month.row(e)}},format:{date:"%B %Y",legend:"%B",connector:"in"},extractUnit:function(e){return t.options.arabic?e.valueOf():new Date(e.getFullYear(),e.getMonth()).getTime()}},year:{name:"year",level:60,row:function(){return t.options.rowLimit||1},column:function(){return t.options.colLimit||1},position:{x:function(){return 1},y:function(){return 1}},format:{date:"%Y",legend:"%Y",connector:"in"},extractUnit:function(t){return new Date(t.getFullYear()).getTime()}}},this._domainType)if(this._domainType.hasOwnProperty(e)){var a=this._domainType[e];this._domainType["x_"+e]={name:"x_"+e,level:a.type,maxItemNumber:a.maxItemNumber,defaultRowNumber:a.defaultRowNumber,defaultColumnNumber:a.defaultColumnNumber,row:a.column,column:a.row,position:{x:a.position.y,y:a.position.x},format:a.format,extractUnit:a.extractUnit}}function i(e,a){var i=t.options.cellSize*t._domainType[t.options.subDomain].column(e)+t.options.cellPadding*t._domainType[t.options.subDomain].column(e);return 2===arguments.length&&!0===a?"month"==t.options.domain&&"week"==t.options.subDomain?i+(t.domainHorizontalLabelWidth+t.options.domainGutter+t.options.domainMargin[1]+t.options.domainMargin[3]):i+(t.domainHorizontalLabelWidth+t.options.domainGutter+t.options.domainMargin[1]+t.options.domainMargin[3]+t.options.cellSize):i}function n(e,a){var i=t.options.cellSize*t._domainType[t.options.subDomain].row(e)+t.options.cellPadding*t._domainType[t.options.subDomain].row(e);return 2===arguments.length&&!0===a&&(i+=t.options.domainGutter+t.domainVerticalLabelHeight+t.options.domainMargin[0]+t.options.domainMargin[2]),i}this.lastInsertedSvg=null,this._completed=!1,this._domains=vitaraD3.map(),this.graphDim={width:0,height:0},this.legendDim={width:0,height:0},this.NAVIGATE_LEFT=1,this.NAVIGATE_RIGHT=2,this.RESET_ALL_ON_UPDATE=0,this.RESET_SINGLE_ON_UPDATE=1,this.APPEND_ON_UPDATE=2,this.DEFAULT_LEGEND_MARGIN=10,this.root=null,this.tooltip=null,this._maxDomainReached=!1,this._minDomainReached=!1,this.domainPosition=new p,this.Legend=null,this.legendScale=null,this.DSTDomain=[],this._init=function(){return t.getDomain(t.options.start).map((function(t){return t.getTime()})).map((function(e){t._domains.set(e,t.getSubDomain(e).map((function(e){return{t:t._domainType[t.options.subDomain].extractUnit(e),v:null}})))})),t.root=vitaraD3.select(t.options.domNode).select(t.options.itemSelector).append("svg").attr("class","cal-heatmap-container"),t.tooltip=vitaraD3.select(t.options.domNode).select(t.options.itemSelector).attr("style",(function(){var e=vitaraD3.select(t.options.domNode).select(t.options.itemSelector).attr("style");return(null!==e?e:"")+"position:relative;"})).append("div").attr("class","ch-tooltip"),t.root.attr("x",0).attr("y",0).append("svg").attr("class","graph"),t.Legend=new m(t),t.options.paintOnLoad&&function(){t.verticalDomainLabel="top"===t.options.label.position||"bottom"===t.options.label.position,t.domainVerticalLabelHeight=null===t.options.label.height?Math.max(25,2*t.options.cellSize):t.options.label.height,t.domainHorizontalLabelWidth=0,""===t.options.domainLabelFormat&&null===t.options.label.height&&(t.domainVerticalLabelHeight=0),t.verticalDomainLabel||(t.domainVerticalLabelHeight=0,t.domainHorizontalLabelWidth=t.options.label.width),t.paint(),!1!==t.options.nextSelector&&vitaraD3.select(t.options.nextSelector).on("click."+t.options.itemNamespace,(function(){return vitaraD3.event.preventDefault(),t.loadNextDomain(1)})),!1!==t.options.previousSelector&&vitaraD3.select(t.options.previousSelector).on("click."+t.options.itemNamespace,(function(){return vitaraD3.event.preventDefault(),t.loadPreviousDomain(1)})),t.Legend.redraw(t.graphDim.width-t.options.domainGutter-t.options.cellPadding),t.afterLoad();var e=t.getDomainKeys();t.options.loadOnInit?t.getDatas(t.options.data,new Date(e[0]),t.getSubDomain(e[e.length-1]).pop(),(function(){t.fill(),t.onComplete()})):t.onComplete(),t.checkIfMinDomainIsReached(e[0]),t.checkIfMaxDomainIsReached(t.getNextDomain().getTime())}(),!0},this.paint=function(e){var a=t.options;0===arguments.length&&(e=!1);var o=t.root.select(".graph").selectAll(".graph-domain").data((function(){var a=t.getDomainKeys();return e===t.NAVIGATE_LEFT?a.reverse():a}),(function(t){return t})),r=0,s=0,l=o.enter().append("svg").attr("width",(function(t){return i(t,!0)})).attr("height",(function(t){return n(t,!0)})).attr("x",(function(e){return a.verticalOrientation?(t.graphDim.width=Math.max(t.graphDim.width,i(e,!0)),0):u(e,t.graphDim,"width",i(e,!0))})).attr("y",(function(e){return a.verticalOrientation?u(e,t.graphDim,"height",n(e,!0)):(t.graphDim.height=Math.max(t.graphDim.height,n(e,!0)),0)})).attr("class",(function(e){var i="graph-domain",n=new Date(e);switch(a.domain){case"hour":i+=" h_"+n.getHours();case"day":i+=" d_"+n.getDate()+" dy_"+n.getDay();case"week":i+=" w_"+t.getWeekNumber(n);case"month":i+=" m_"+(t.options.arabic?h()(n).iMonth():n.getMonth()+1);case"year":i+=" y_"+(t.options.arabic?h()(n).iYear():n.getFullYear())}return i}));function u(a,i,n,o){var l=0;switch(e){case!1:return l=i[n],i[n]+=o,t.domainPosition.setPosition(a,l),l;case t.NAVIGATE_RIGHT:return t.domainPosition.setPosition(a,i[n]),r=o,s=t.domainPosition.getPositionFromIndex(1),t.domainPosition.shiftRightBy(s),i[n];case t.NAVIGATE_LEFT:return r=-(l=-o),s=i[n]-t.domainPosition.getLast(),t.domainPosition.setPosition(a,l),t.domainPosition.shiftLeftBy(r),l}}t.lastInsertedSvg=l,l.append("rect").attr("width",(function(t){return i(t,!0)-a.domainGutter-a.cellPadding})).attr("height",(function(t){return n(t,!0)-a.domainGutter-a.cellPadding})).attr("class","domain-background");var c=l.append("svg").attr("x",(function(){return"left"===a.label.position?t.domainHorizontalLabelWidth+a.domainMargin[3]:a.domainMargin[3]})).attr("y",(function(){return"top"===a.label.position?t.domainVerticalLabelHeight+a.domainMargin[0]:a.domainMargin[0]})).attr("class","graph-subdomain-group"),p=c.selectAll("g").data((function(e){return t._domains.get(e)})).enter().append("g"),m=p.append("rect").attr("class",(function(e){return"graph-rect"+t.getHighlightClassName(e.t)+(null!==a.onClick?" hover_cursor":"")+(null!==a.onContextMenu?" context_menu":"")})).attr("width",a.cellSize).attr("height",a.cellSize).attr("x",(function(e){return t.positionSubDomainX(e.t)}));function d(e){switch(a.label.rotate){case"right":e.attr("transform",(function(e){var n="rotate(90), ";switch(a.label.position){case"right":n+="translate(-"+i(e)+" , -"+i(e)+")";break;case"left":n+="translate(0, -"+t.domainHorizontalLabelWidth+")"}return n}));break;case"left":e.attr("transform",(function(e){var n="rotate(270), ";switch(a.label.position){case"right":n+="translate(-"+(i(e)+t.domainHorizontalLabelWidth)+" , "+i(e)+")";break;case"left":n+="translate(-"+t.domainHorizontalLabelWidth+" , "+t.domainHorizontalLabelWidth+")"}return n}))}}if(t.lastDate=void 0,m.attr("y",(function(e){return t.positionSubDomainY(e.t)})).on("click",(function(e){if(null!==a.onClick)return t.onClick(new Date(e.t),e.v)})).on("contextmenu",(function(e){if(null!==a.onContextMenu)return t.onContextMenu(new Date(e.t),e.v)})).call((function(e){a.cellRadius>0&&e.attr("rx",a.cellRadius).attr("ry",a.cellRadius),null!==t.legendScale&&null!==a.legendColors&&a.legendColors.hasOwnProperty("base")&&e.attr("fill",a.legendColors.base),a.tooltip&&t.getToolTipHtml(e)})),""!==a.domainLabelFormat&&l.append("text").attr("class","graph-label").attr("y",(function(e){var i=a.domainMargin[0];switch(a.label.position){case"top":i+=t.domainVerticalLabelHeight/2;break;case"bottom":i+=n(e)+t.domainVerticalLabelHeight/2}return i+a.label.offset.y*("right"===a.label.rotate&&"right"===a.label.position||"left"===a.label.rotate&&"left"===a.label.position?-1:1)})).attr("x",(function(e){var n=a.domainMargin[3];switch(a.label.position){case"right":n+=i(e);break;case"bottom":case"top":if("right"===a.label.align)break;n+=i(e)/2}return"right"===a.label.align?n+t.domainHorizontalLabelWidth-a.label.offset.x*("right"===a.label.rotate?-1:1):n+a.label.offset.x})).attr("text-anchor",(function(){switch(a.label.align){case"start":case"left":return"start";case"end":case"right":return"start";default:return"middle"}})).attr("dominant-baseline",(function(){return t.verticalDomainLabel?"middle":"top"})).text((function(e){return t.formatDate(new Date(e),a.domainLabelFormat)})).call(d),null!==a.subDomainTextFormat){t.lastWeek=null;var f=p.append("text").attr("class",(function(e){return"subdomain-text"+t.getHighlightClassName(e.t)})).attr("x",(function(e){return t.positionSubDomainX(e.t)+a.cellSize/2}));t.lastDate=void 0,f.attr("y",(function(e){return t.positionSubDomainY(e.t)+a.cellSize/2})).attr("text-anchor","middle").attr("dominant-baseline","central").text((function(e){return t.formatDate(new Date(e.t),a.subDomainTextFormat)}))}!1!==e&&o.transition().duration(a.animationDuration).attr("x",(function(e){return a.verticalOrientation?0:t.domainPosition.getPosition(e)})).attr("y",(function(e){return a.verticalOrientation?t.domainPosition.getPosition(e):0}));var g=t.graphDim.width,D=t.graphDim.height;a.verticalOrientation?t.graphDim.height+=r-s:t.graphDim.width+=r-s,o.exit().transition().duration(a.animationDuration).attr("x",(function(n){if(a.verticalOrientation)return 0;switch(e){case t.NAVIGATE_LEFT:return Math.min(t.graphDim.width,g);case t.NAVIGATE_RIGHT:return-i(n,!0)}})).attr("y",(function(i){if(!a.verticalOrientation)return 0;switch(e){case t.NAVIGATE_LEFT:return Math.min(t.graphDim.height,D);case t.NAVIGATE_RIGHT:return-n(i,!0)}})).remove()}};c.prototype={init:function(t){var e=this,a=e.options=function t(e,a){for(var i in a)try{a[i].constructor===Object?e[i]=t(e[i],a[i]):e[i]=a[i]}catch(t){e[i]=a[i]}return e}(e.options,t);if(function(){if(!e._domainType.hasOwnProperty(a.domain)||"min"===a.domain||"x_"===a.domain.substring(0,2))throw new Error("The domain '"+a.domain+"' is not valid");if(!e._domainType.hasOwnProperty(a.subDomain)||"year"===a.subDomain)throw new Error("The subDomain '"+a.subDomain+"' is not valid");if(e._domainType[a.domain].level<=e._domainType[a.subDomain].level)throw new Error("'"+a.subDomain+"' is not a valid subDomain to '"+a.domain+"'")}(),r(a.itemSelector,!1,"itemSelector"),-1===e.allowedDataType.indexOf(a.dataType))throw new Error("The data type '"+a.dataType+"' is not valid data type");if(null===vitaraD3.select(a.domNode).select(a.itemSelector)[0][0])throw new Error("The node '"+a.itemSelector+"' specified in itemSelector does not exists");try{r(a.nextSelector,!0,"nextSelector"),r(a.previousSelector,!0,"previousSelector")}catch(t){return console.log(t.message),!1}t.hasOwnProperty("subDomain")||(this.options.subDomain=function(t){switch(t){case"year":return"month";case"month":case"week":return"day";case"day":return"hour";default:return"min"}}(t.domain)),"string"==typeof a.itemNamespace&&""!==a.itemNamespace||(console.log("itemNamespace can not be empty, falling back to cal-heatmap"),a.itemNamespace="cal-heatmap");var i,n=["data","onComplete","onClick","afterLoad","afterLoadData","afterLoadPreviousDomain","afterLoadNextDomain"];for(var o in n.push("onContextMenu"),n)t.hasOwnProperty(n[o])&&(a[n[o]]=t[n[o]]);function r(t,e,a){if((e&&!1===t||t instanceof Element||"string"==typeof t)&&""!==t)return!0;throw new Error("The "+a+" is not valid")}function s(t){switch("number"==typeof t&&(t=[t]),Array.isArray(t)||(console.log("Margin only takes an integer or an array of integers"),t=[0]),t.length){case 1:return[t[0],t[0],t[0],t[0]];case 2:return[t[0],t[1],t[0],t[1]];case 3:return[t[0],t[1],t[2],t[1]];case 4:return t;default:return t.slice(0,4)}}return a.subDomainDateFormat="string"==typeof a.subDomainDateFormat||"function"==typeof a.subDomainDateFormat?a.subDomainDateFormat:this._domainType[a.subDomain].format.date,a.domainLabelFormat="string"==typeof a.domainLabelFormat||"function"==typeof a.domainLabelFormat?a.domainLabelFormat:this._domainType[a.domain].format.legend,a.subDomainTextFormat="string"==typeof a.subDomainTextFormat&&""!==a.subDomainTextFormat||"function"==typeof a.subDomainTextFormat?a.subDomainTextFormat:null,a.domainMargin=s(a.domainMargin),a.legendMargin=s(a.legendMargin),a.highlight=e.expandDateSetting(a.highlight),a.itemName=function(t){return"string"==typeof t?[t,t+(""!==t?"s":"")]:Array.isArray(t)?1===t.length?[t[0],t[0]+"s"]:t.length>2?t.slice(0,2):t:["item","items"]}(a.itemName),a.colLimit=(i=a.colLimit)>0?i:null,a.rowLimit=function(t){return t>0&&a.colLimit>0?(console.log("colLimit and rowLimit are mutually exclusive, rowLimit will be ignored"),null):t>0?t:null}(a.rowLimit),t.hasOwnProperty("legendMargin")||function(){switch(a.legendVerticalPosition){case"top":a.legendMargin[2]=e.DEFAULT_LEGEND_MARGIN;break;case"bottom":a.legendMargin[0]=e.DEFAULT_LEGEND_MARGIN;break;case"middle":case"center":a.legendMargin["right"===a.legendHorizontalPosition?3:1]=e.DEFAULT_LEGEND_MARGIN}}(),function(){if(!t.hasOwnProperty("label")||t.hasOwnProperty("label")&&!t.label.hasOwnProperty("align")){switch(a.label.position){case"left":a.label.align="right";break;case"right":a.label.align="left";break;default:a.label.align="center"}"left"===a.label.rotate?a.label.align="right":"right"===a.label.rotate&&(a.label.align="left")}(!t.hasOwnProperty("label")||t.hasOwnProperty("label")&&!t.label.hasOwnProperty("offset"))&&("left"!==a.label.position&&"right"!==a.label.position||(a.label.offset={x:10,y:15}))}(),this._init()},expandDateSetting:function(t){return Array.isArray(t)||(t=[t]),t.map((function(t){return"now"===t?new Date:t instanceof Date&&t})).filter((function(t){return!1!==t}))},fill:function(t){var e=this,a=e.options;0===arguments.length&&(t=e.root.selectAll(".graph-domain"));var i=t.selectAll("svg").selectAll("g").data((function(t){return e._domains.get(t)}));function n(t){if(null===e.legendScale)return!1;t.attr("fill",(function(t){return null===t.v&&a.hasOwnProperty("considerMissingDataAsZero")&&!a.considerMissingDataAsZero&&a.legendColors.hasOwnProperty("base")?a.legendColors.base:null!==a.legendColors&&a.legendColors.hasOwnProperty("empty")&&(0===t.v||null===t.v&&a.hasOwnProperty("considerMissingDataAsZero")&&a.considerMissingDataAsZero)?a.legendColors.empty:t.v<0&&a.legend[0]>0&&null!==a.legendColors&&a.legendColors.hasOwnProperty("overflow")?a.legendColors.overflow:e.legendScale(Math.min(t.v,a.legend[a.legend.length-1]))}))}function o(t){"function"==typeof a.subDomainTextFormat&&t.text((function(t){return a.subDomainTextFormat(t.t,t.v)}))}i.transition().duration(a.animationDuration).select("rect").attr("class",(function(t){var i=e.getHighlightClassName(t.t).trim().split(" "),n=e.dateIsLessThan(t.t,new Date),o=e.dateIsEqual(t.t,new Date);return(null===e.legendScale||null===t.v&&a.hasOwnProperty("considerMissingDataAsZero")&&!a.considerMissingDataAsZero&&!a.legendColors.hasOwnProperty("base"))&&i.push("graph-rect"),o?i.push("now"):n||i.push("future"),null!==t.v?i.push(e.Legend.getClass(t.v,null===e.legendScale)):a.considerMissingDataAsZero&&n&&i.push(e.Legend.getClass(0,null===e.legendScale)),null!==a.onClick&&i.push("hover_cursor"),null!==a.onContextMenu&&i.push("context_menu"),i.join(" ")})).call(n),i.transition().duration(a.animationDuration).select("title").text((function(t){return e.getSubDomainTitle(t)})),i.transition().duration(a.animationDuration).select("text").attr("class",(function(t){return"subdomain-text"+e.getHighlightClassName(t.t)})).call(o)},triggerEvent:function(t,e,a){return!!(3===arguments.length&&a||null===this.options[t])||("function"==typeof this.options[t]?("function"==typeof e&&(e=e()),this.options[t].apply(this,e)):(console.log("Provided callback for "+t+" is not a function."),!1))},onClick:function(t,e){return this.triggerEvent("onClick",[t,e])},onContextMenu:function(t,e){return this.triggerEvent("onContextMenu",[t,e])},afterLoad:function(){return this.triggerEvent("afterLoad")},onComplete:function(){var t=this.triggerEvent("onComplete",[],this._completed);return this._completed=!0,t},afterLoadPreviousDomain:function(t){var e=this;return this.triggerEvent("afterLoadPreviousDomain",(function(){var a=e.getSubDomain(t);return[a.shift(),a.pop()]}))},afterLoadNextDomain:function(t){var e=this;return this.triggerEvent("afterLoadNextDomain",(function(){var a=e.getSubDomain(t);return[a.shift(),a.pop()]}))},onMinDomainReached:function(t){return this._minDomainReached=t,this.triggerEvent("onMinDomainReached",[t])},onMaxDomainReached:function(t){return this._maxDomainReached=t,this.triggerEvent("onMaxDomainReached",[t])},checkIfMinDomainIsReached:function(t,e){this.minDomainIsReached(t)&&this.onMinDomainReached(!0),2===arguments.length&&this._maxDomainReached&&!this.maxDomainIsReached(e)&&this.onMaxDomainReached(!1)},checkIfMaxDomainIsReached:function(t,e){this.maxDomainIsReached(t)&&this.onMaxDomainReached(!0),2===arguments.length&&this._minDomainReached&&!this.minDomainIsReached(e)&&this.onMinDomainReached(!1)},formatNumber:vitaraD3.format(",g"),formatDate:function(t,e){if(arguments.length<2&&(e="title"),"function"==typeof e)return e(t);if(this.options.arabic){if(e.length>2){for(var a="",i=h()(t),n=e.split(" "),o=0;o<n.length;o++)""!==a&&(a+=" "),a+=i.format(this.getArabicFormat(n[o]));return a}return h()(t).format(this.getArabicFormat(e))}var r=vitaraD3.time.format(e);return r(t)},getArabicFormat:function(t){switch(t){case"%B":return"iMMM";case"%Y":return"iYYYY";case"%W":case"%U":return"iw";case"%b":return"iM";case"%m":return"iMM";case"%e":case"%-e,":case"%d":return"iD";case"%A":return"iAA";default:return t}},getSubDomainTitle:function(t){if(null!==t.v||this.options.considerMissingDataAsZero){var e=t.v;return null===e&&this.options.considerMissingDataAsZero&&(e=0),this.options.subDomainTitleFormat.filled.format({count:this.formatNumber(e),name:this.options.itemName[1!==e?1:0],connector:this._domainType[this.options.subDomain].format.connector,date:this.formatDate(new Date(t.t),this.options.subDomainDateFormat)})}return this.options.subDomainTitleFormat.empty.format({date:this.formatDate(new Date(t.t),this.options.subDomainDateFormat)})},getToolTipHtml:function(t){var e=this;t.on("mouseover",(function(t){var a=this.parentNode.parentNode;e.tooltip.html(e.getSubDomainTitle(t)).attr("style","display: block;");var i=e.positionSubDomainX(t.t)-e.tooltip[0][0].offsetWidth/2+e.options.cellSize/2,n=e.positionSubDomainY(t.t)-e.tooltip[0][0].offsetHeight-e.options.cellSize/2;i+=parseInt(a.getAttribute("x"),10),n+=parseInt(a.getAttribute("y"),10),i+=parseInt(e.root.select(".graph").attr("x"),10),n+=parseInt(e.root.select(".graph").attr("y"),10),i+=parseInt(a.parentNode.getAttribute("x"),10),n+=parseInt(a.parentNode.getAttribute("y"),10),e.tooltip.attr("style","display: block; left: "+i+"px; top: "+n+"px;")})),t.on("mouseout",(function(){e.tooltip.attr("style","display:none").html("")}))},loadNextDomain:function(t){if(this._maxDomainReached||0===t)return!1;var e=this.loadNewDomains(this.NAVIGATE_RIGHT,this.getDomain(this.getNextDomain(),t));return this.afterLoadNextDomain(e.end),this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(),e.start),!0},loadPreviousDomain:function(t){if(this._minDomainReached||0===t)return!1;var e=this.loadNewDomains(this.NAVIGATE_LEFT,this.getDomain(this.getDomainKeys()[0],-t).reverse());return this.afterLoadPreviousDomain(e.start),this.checkIfMinDomainIsReached(e.start,e.end),!0},loadNewDomains:function(t,e){var a=this,i=t===this.NAVIGATE_LEFT,n=-1,o=e.length,r=this.getDomainKeys();function s(t){return{t:a._domainType[a.options.subDomain].extractUnit(t),v:null}}for(;++n<o;){if(i&&this.minDomainIsReached(e[n])){e=e.slice(0,n+1);break}if(!i&&this.maxDomainIsReached(e[n])){e=e.slice(0,n);break}}for(n=0,o=(e=e.slice(-this.options.range)).length;n<o;n++)this._domains.set(e[n].getTime(),this.getSubDomain(e[n]).map(s)),this._domains.remove(i?r.pop():r.shift());return r=this.getDomainKeys(),i&&(e=e.reverse()),this.paint(t),this.getDatas(this.options.data,e[0],this.getSubDomain(e[e.length-1]).pop(),(function(){a.fill(a.lastInsertedSvg)})),{start:e[i?0:1],end:r[r.length-1]}},maxDomainIsReached:function(t){return null!==this.options.maxDate&&this.options.maxDate.getTime()<t},minDomainIsReached:function(t){return null!==this.options.minDate&&this.options.minDate.getTime()>=t},getDomainKeys:function(){return this._domains.keys().map((function(t){return parseInt(t,10)})).sort((function(t,e){return t-e}))},positionSubDomainX:function(t){var e=this._domainType[this.options.subDomain].position.x(new Date(t));return e*this.options.cellSize+e*this.options.cellPadding},positionSubDomainY:function(t){var e=this._domainType[this.options.subDomain].position.y(new Date(t));return e*this.options.cellSize+e*this.options.cellPadding},getSubDomainColumnNumber:function(t){if(this.options.rowLimit>0){var e=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof e&&(e=e(t)),Math.ceil(e/this.options.rowLimit)}var a=this._domainType[this.options.subDomain].defaultColumnNumber;return"function"==typeof a&&(a=a(t)),this.options.colLimit||a},getSubDomainRowNumber:function(t){if(this.options.colLimit>0){var e=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof e&&(e=e(t)),Math.ceil(e/this.options.colLimit)}var a=this._domainType[this.options.subDomain].defaultRowNumber;return"function"==typeof a&&(a=a(t)),this.options.rowLimit||a},getHighlightClassName:function(t){if(t=new Date(t),this.options.highlight.length>0)for(var e in this.options.highlight)if(this.dateIsEqual(this.options.highlight[e],t))return this.isNow(this.options.highlight[e])?" highlight-now":" highlight";return""},isNow:function(t){return this.dateIsEqual(t,new Date)},dateIsEqual:function(t,e){switch(t instanceof Date||(t=new Date(t)),e instanceof Date||(e=new Date(e)),this.options.subDomain){case"x_min":case"min":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes();case"x_hour":case"hour":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours();case"x_day":case"day":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();case"x_week":case"week":return t.getFullYear()===e.getFullYear()&&this.getWeekNumber(t)===this.getWeekNumber(e);case"x_month":case"month":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth();default:return!1}},dateIsLessThan:function(t,e){function a(t,e){switch(e){case"x_min":case"min":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()).getTime();case"x_hour":case"hour":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()).getTime();case"x_day":case"day":return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();case"x_week":case"week":case"x_month":case"month":return new Date(t.getFullYear(),t.getMonth()).getTime();default:return t.getTime()}}return t instanceof Date||(t=new Date(t)),e instanceof Date||(e=new Date(e)),a(t,this.options.subDomain)<a(e,this.options.subDomain)},getDayOfYear:vitaraD3.time.format("%j"),getWeekNumber:function(t){return this.options.arabic?1===h()(t).iWeek()&&11===h()(t).iMonth()?h()(t).subtract(1,"week").iWeek()+1:h()(t).iWeek():(!0===this.options.weekStartOnMonday?vitaraD3.time.format("%W"):vitaraD3.time.format("%U"))(t)},getMonthWeekNumber:function(t){if("number"==typeof t&&(t=new Date(t)),this.lastDate===t.valueOf()||null==this.lastDate)this.options.arabic?1===(e=h()(t).add(1,"iMonth").startOf("iMonth").iWeek())&&(e=h()(t).subtract(1,"week").iWeek()+1):"00"===(e=this.getWeekNumber(new Date(t.getFullYear(),t.getMonth()+1)))?e=52:this.getWeekNumber(t)<e&&(e=0);else if(this.options.arabic)var e=h()(t).startOf("iMonth").iWeek();else e=this.getWeekNumber(new Date(t.getFullYear(),t.getMonth()));return this.lastDate=t.valueOf(),this.getWeekNumber(t)-e},getWeekNumberInYear:function(t){"number"==typeof t&&(t=new Date(t))},getDayCountInMonth:function(t){return this.options.arabic?this.getEndOfMonth(t).iDate():this.getEndOfMonth(t).getDate()},getDayCountInYear:function(t){return"number"==typeof t&&(t=new Date(t)),this.options.arabic?h()(t).endOf("iYear").iDayOfYear():1===new Date(t.getFullYear(),1,29).getMonth()?366:365},getWeekDay:function(t){return!1===this.options.weekStartOnMonday?t.getDay():0===t.getDay()?6:t.getDay()-1},getEndOfMonth:function(t){return"number"==typeof t&&(t=new Date(t)),this.options.arabic?h()(t).endOf("iMonth"):new Date(t.getFullYear(),t.getMonth()+1,0)},jumpDate:function(t,e,a){var i=new Date(t);switch(a){case"hour":i.setHours(i.getHours()+e);break;case"day":i.setHours(i.getHours()+24*e);break;case"week":i.setHours(i.getHours()+24*e*7);break;case"month":i.setMonth(i.getMonth()+e);break;case"year":i.setFullYear(i.getFullYear()+e)}return new Date(i)},getMinuteDomain:function(t,e){var a,i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());return a=e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()):new Date(+i+1e3*e*60),vitaraD3.time.minutes(Math.min(i,a),Math.max(i,a))},getHourDomain:function(t,e){var a=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()),i=null;e instanceof Date?i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()):(i=new Date(a)).setHours(i.getHours()+e);var n=vitaraD3.time.hours(Math.min(a,i),Math.max(a,i)),o=0,r=n.length;for(o=0;o<r;o++)if(o>0&&n[o].getHours()===n[o-1].getHours()){this.DSTDomain.push(n[o].getTime()),n.splice(o,1);break}return"number"==typeof e&&n.length>Math.abs(e)&&n.splice(n.length-1,1),n},getDayDomain:function(t,e){if(this.options.arabic){var a=h()(t).startOf(),i=null;e instanceof Date?i=h()(e):(i=new Date(a),i=new Date(i.setDate(i.getDate()+parseInt(e,10))))}else a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=null,e instanceof Date?i=new Date(e.getFullYear(),e.getMonth(),e.getDate()):(i=new Date(a),i=new Date(i.setDate(i.getDate()+parseInt(e,10))));return vitaraD3.time.days(Math.min(a,i),Math.max(a,i))},getWeekDomain:function(t,e){var a;!1===this.options.weekStartOnMonday?a=this.options.arabic?h()(t).startOf("iWeek").subtract(t.getDay(),"day"):new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()):1===t.getDay()?a=new Date(t.getFullYear(),t.getMonth(),t.getDate()):0===t.getDay()?(a=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setDate(a.getDate()-6):a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+1);var i=new Date(a),n=e;return"object"!==u(e)&&(n=new Date(i.setDate(i.getDate()+7*e))),!0===this.options.weekStartOnMonday?vitaraD3.time.mondays(Math.min(a,n),Math.max(a,n)):vitaraD3.time.sundays(Math.min(a,n),Math.max(a,n))},getMonthDomain:function(t,e){var a=new Date(t.getFullYear(),t.getMonth()),i=null;if(i=e instanceof Date?new Date(e.getFullYear(),e.getMonth()):(i=new Date(a)).setMonth(i.getMonth()+e),this.options.arabic){var n=[],o=h()(t).startOf("iMonth").valueOf();for(i=h()(o).add(e,"iMonth").valueOf();o<i;)n.push(new Date(o)),o=h()(o).add(1,"iMonth").valueOf();return n}return vitaraD3.time.months(Math.min(a,i),Math.max(a,i))},getYearDomain:function(t,e){var a=new Date(t.getFullYear(),0),i=null;if(i=e instanceof Date?new Date(e.getFullYear(),0):new Date(t.getFullYear()+e,0),this.options.arabic){var n=[],o=h()(t).startOf("iYear").valueOf();for(i=h()(o).add(e,"iYear").valueOf();o<i;)n.push(new Date(o)),o=h()(o).add(1,"iYear").valueOf();return n}return vitaraD3.time.years(Math.min(a,i),Math.max(a,i))},getDomain:function(t,e){switch("number"==typeof t&&(t=new Date(t)),arguments.length<2&&(e=this.options.range),this.options.domain){case"hour":var a=this.getHourDomain(t,e);return"number"==typeof e&&a.length<e&&(e>0?a.push(this.getHourDomain(a[a.length-1],2)[1]):a.shift(this.getHourDomain(a[0],-2)[0])),a;case"day":return this.getDayDomain(t,e);case"week":return this.getWeekDomain(t,e);case"month":return this.getMonthDomain(t,e);case"year":return this.getYearDomain(t,e)}},getSubDomain:function(t){"number"==typeof t&&(t=new Date(t));var e=this;switch(this.options.subDomain){case"x_min":case"min":return this.getMinuteDomain(t,function(t,e){switch(e){case"hour":return 60;case"day":return 1440;case"week":return 10080}}(0,this.options.domain));case"x_hour":case"hour":return this.getHourDomain(t,function(t,a){switch(a){case"day":return 24;case"week":return 168;case"month":return 24*e.getDayCountInMonth(t)}}(t,this.options.domain));case"x_day":case"day":return this.getDayDomain(t,function(t,a){switch(a){case"year":return e.getDayCountInYear(t);case"month":return e.getDayCountInMonth(t);case"week":return 7}}(t,this.options.domain));case"x_week":case"week":return this.getWeekDomain(t,function(t,a){if("month"===a){if(e.options.arabic)var i=h()(t).endOf("iMonth").valueOf(),n=e.getWeekNumber(h()(t).startOf("iMonth").valueOf());else i=new Date(t.getFullYear(),t.getMonth()+1,0),n=e.getWeekNumber(new Date(t.getFullYear(),t.getMonth()));var o=e.getWeekNumber(i);return n>o&&(n=0,o++),o-n+1}if("year"===a)return parseInt(e.getWeekNumber(new Date(t.getFullYear(),11,31)))+1}(t,this.options.domain));case"x_month":case"month":return this.getMonthDomain(t,12)}},getNextDomain:function(t){return 0===arguments.length&&(t=1),this.getDomain(this.jumpDate(this.getDomainKeys().pop(),t,this.options.domain),1)[0]},getPreviousDomain:function(t){return 0===arguments.length&&(t=1),this.getDomain(this.jumpDate(this.getDomainKeys().shift(),-t,this.options.domain),1)[0]},getDatas:function(t,e,a,i,n,o){var r=this;arguments.length<5&&(n=!0),arguments.length<6&&(o=this.APPEND_ON_UPDATE);var s=function(t){!1!==n?"function"==typeof n?t=n(t):"function"==typeof r.options.afterLoadData?t=r.options.afterLoadData(t):console.log("Provided callback for afterLoadData is not a function."):"csv"!==r.options.dataType&&"tsv"!==r.options.dataType||(t=this.interpretCSV(t)),r.parseDatas(t,o,e,a),"function"==typeof i&&i()};switch(u(t)){case"string":if(""===t)return s({}),!0;var l=this.parseURI(t,e,a),h="GET";null!==r.options.dataPostPayload&&(h="POST");var c=null;switch(null!==r.options.dataPostPayload&&(c=this.parseURI(r.options.dataPostPayload,e,a)),this.options.dataType){case"json":vitaraD3.json(l,s).send(h,c);break;case"csv":vitaraD3.csv(l,s).send(h,c);break;case"tsv":vitaraD3.tsv(l,s).send(h,c);break;case"txt":vitaraD3.text(l,"text/plain",s).send(h,c)}return!1;case"object":if(t===Object(t))return s(t),!1;default:return s({}),!0}},parseDatas:function(t,e,a,i){e===this.RESET_ALL_ON_UPDATE&&this._domains.forEach((function(t,e){e.forEach((function(t,e,a){a[e].v=null}))}));var n={},o=function(t){return t.t};for(var r in t){var s=new Date(1e3*r),l=this.getDomain(s)[0].getTime();if(this.DSTDomain.indexOf(l)>=0&&this._domains.has(l-36e5)&&(l-=36e5),!isNaN(r)&&t.hasOwnProperty(r)&&this._domains.has(l)&&l>=+a&&l<+i){var h=this._domains.get(l);n.hasOwnProperty(l)||(n[l]=h.map(o));var u=n[l].indexOf(this._domainType[this.options.subDomain].extractUnit(s));e===this.RESET_SINGLE_ON_UPDATE?h[u].v=t[r]:-1!==u&&(isNaN(h[u].v)?h[u].v=t[r]:h[u].v+=t[r])}}},parseURI:function(t,e,a){return(t=(t=(t=t.replace(/\{\{t:start\}\}/g,e.getTime()/1e3)).replace(/\{\{t:end\}\}/g,a.getTime()/1e3)).replace(/\{\{d:start\}\}/g,e.toISOString())).replace(/\{\{d:end\}\}/g,a.toISOString())},interpretCSV:function(t){var e,a,i={},n=Object.keys(t[0]);for(e=0,a=t.length;e<a;e++)i[t[e][n[0]]]=+t[e][n[1]];return i},resize:function(){var t=this.options,e=t.displayLegend?this.Legend.getDim("width")+t.legendMargin[1]+t.legendMargin[3]:0,a=t.displayLegend?this.Legend.getDim("height")+t.legendMargin[0]+t.legendMargin[2]:0,i=this.graphDim.width-t.domainGutter-t.cellPadding,n=this.graphDim.height-t.domainGutter-t.cellPadding;this.root.transition().duration(t.animationDuration).attr("width",(function(){return"middle"===t.legendVerticalPosition||"center"===t.legendVerticalPosition?i+e:Math.max(i,e)})).attr("height",(function(){return"middle"===t.legendVerticalPosition||"center"===t.legendVerticalPosition?Math.max(n,a):n+a})),this.root.select(".graph").transition().duration(t.animationDuration).attr("y",(function(){return"top"===t.legendVerticalPosition?a:0})).attr("x",(function(){return"middle"!==t.legendVerticalPosition&&"center"!==t.legendVerticalPosition||"left"!==t.legendHorizontalPosition?0:e}))},next:function(t){return 0===arguments.length&&(t=1),this.loadNextDomain(t)},previous:function(t){return 0===arguments.length&&(t=1),this.loadPreviousDomain(t)},jumpTo:function(t,e){arguments.length<2&&(e=!1);var a=this.getDomainKeys(),i=a[0],n=a[a.length-1];return t<i?this.loadPreviousDomain(this.getDomain(i,t).length):e?this.loadNextDomain(this.getDomain(i,t).length):t>n&&this.loadNextDomain(this.getDomain(n,t).length)},rewind:function(){this.jumpTo(this.options.start,!0)},update:function(t,e,a){arguments.length<2&&(e=!0),arguments.length<3&&(a=this.RESET_ALL_ON_UPDATE);var i=this.getDomainKeys(),n=this;this.getDatas(t,new Date(i[0]),this.getSubDomain(i[i.length-1]).pop(),(function(){n.fill()}),e,a)},setLegend:function(){var t=this.options.legend.slice(0);arguments.length>=1&&Array.isArray(arguments[0])&&(this.options.legend=arguments[0]),arguments.length>=2&&(Array.isArray(arguments[1])&&arguments[1].length>=2?this.options.legendColors=[arguments[1][0],arguments[1][1]]:this.options.legendColors=arguments[1]),(arguments.length>0&&!d(t,this.options.legend)||arguments.length>=2)&&(this.Legend.buildColors(),this.fill()),this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding)},removeLegend:function(){return!!this.options.displayLegend&&(this.options.displayLegend=!1,this.Legend.remove(),!0)},showLegend:function(){return!this.options.displayLegend&&(this.options.displayLegend=!0,this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding),!0)},highlight:function(t){return(this.options.highlight=this.expandDateSetting(t)).length>0&&(this.fill(),!0)},destroy:function(t){return this.root.transition().duration(this.options.animationDuration).attr("width",0).attr("height",0).remove().each("end",(function(){"function"==typeof t?t():void 0!==t&&console.log("Provided callback for destroy() is not a function.")})),null},getSVG:function(){for(var t={".cal-heatmap-container":{},".graph":{},".graph-rect":{},"rect.highlight":{},"rect.now":{},"rect.highlight-now":{},"text.highlight":{},"text.now":{},"text.highlight-now":{},".domain-background":{},".graph-label":{},".subdomain-text":{},".q0":{},".qi":{}},e=1,a=this.options.legend.length+1;e<=a;e++)t[".q"+e]={};var i,n=this.root,o=["stroke","stroke-width","stroke-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-miterlimit","fill","fill-opacity","fill-rule","marker","marker-start","marker-mid","marker-end","alignement-baseline","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","shape-rendering","text-transform","font-family","font","font-size","font-weight"],r=function(e,a,i){-1!==o.indexOf(a)&&(t[e][a]=i)};for(var s in t)if(t.hasOwnProperty(s)){var l=(i=s,n.select(i)[0][0]);if(null!==l)if("getComputedStyle"in window){var h=getComputedStyle(l,null);if(0!==h.length)for(var u=0;u<h.length;u++)r(s,h.item(u),h.getPropertyValue(h.item(u)));else for(var c in h)h.hasOwnProperty(c)&&r(s,c,h[c])}else if("currentStyle"in l){var p=l.currentStyle;for(var m in p)r(s,m,p[m])}}var d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css"><![CDATA[ ';for(var f in t){for(var g in d+=f+" {\n",t[f])d+="\t"+g+":"+t[f][g]+";\n";d+="}\n"}return d+="]]></style>",(d+=(new XMLSerializer).serializeToString(this.root[0][0]))+"</svg>"}};var p=function(){this.positions=vitaraD3.map()};p.prototype.getPosition=function(t){return this.positions.get(t)},p.prototype.getPositionFromIndex=function(t){var e=this.getKeys();return this.positions.get(e[t])},p.prototype.getLast=function(){var t=this.getKeys();return this.positions.get(t[t.length-1])},p.prototype.setPosition=function(t,e){this.positions.set(t,e)},p.prototype.shiftRightBy=function(t){this.positions.forEach((function(e,a){this.set(e,a-t)}));var e=this.getKeys();this.positions.remove(e[0])},p.prototype.shiftLeftBy=function(t){this.positions.forEach((function(e,a){this.set(e,a+t)}));var e=this.getKeys();this.positions.remove(e[e.length-1])},p.prototype.getKeys=function(){return this.positions.keys().sort((function(t,e){return parseInt(t,10)-parseInt(e,10)}))};var m=function(t){this.calendar=t,this.computeDim(),null!==t.options.legendColors&&this.buildColors()};function d(t,e){if(!e||!t)return!1;if(t.length!==e.length)return!1;for(var a=0;a<t.length;a++)if(t[a]instanceof Array&&e[a]instanceof Array){if(!d(t[a],e[a]))return!1}else if(t[a]!==e[a])return!1;return!0}m.prototype.computeDim=function(){var t=this.calendar.options;this.dim={width:t.legendCellSize*(t.legend.length+1)+t.legendCellPadding*t.legend.length,height:t.legendCellSize}},m.prototype.remove=function(){this.calendar.root.select(".graph-legend").remove(),this.calendar.resize()},m.prototype.redraw=function(t){if(!this.calendar.options.displayLegend)return!1;var e,a=this,i=this.calendar,n=i.root,o=i.options;this.computeDim();var r=o.legend.slice(0);r.push(r[r.length-1]+1);var s=i.root.select(".graph-legend");function l(t){t.attr("width",o.legendCellSize).attr("height",o.legendCellSize).attr("x",(function(t,e){return e*(o.legendCellSize+o.legendCellPadding)}))}function h(){switch(o.legendHorizontalPosition){case"right":return"center"===o.legendVerticalPosition||"middle"===o.legendVerticalPosition?t+o.legendMargin[3]:t-a.getDim("width")-o.legendMargin[1];case"middle":case"center":return Math.round(t/2-a.getDim("width")/2);default:return o.legendMargin[3]}}function u(){return"bottom"===o.legendVerticalPosition?i.graphDim.height+o.legendMargin[0]-o.domainGutter-o.cellPadding:o.legendMargin[0]}null!==s[0][0]?e=(n=s).select("g").selectAll("rect").data(r):((n="top"===o.legendVerticalPosition?n.insert("svg",".graph"):n.append("svg")).attr("x",h()).attr("y",u()),e=n.attr("class","graph-legend").attr("height",a.getDim("height")).attr("width",a.getDim("width")).append("g").selectAll().data(r)),e.enter().append("rect").call(l).attr("class",(function(t){return i.Legend.getClass(t,null===i.legendScale)})).attr("fill-opacity",0).call((function(t){null!==i.legendScale&&null!==o.legendColors&&o.legendColors.hasOwnProperty("base")&&t.attr("fill",o.legendColors.base)})).append("title"),e.exit().transition().duration(o.animationDuration).attr("fill-opacity",0).remove(),e.transition().delay((function(t,e){return o.animationDuration*e/10})).call(l).attr("fill-opacity",1).call((function(t){t.attr("fill",(function(t,e){return null===i.legendScale?"":0===e?i.legendScale(t-1):i.legendScale(o.legend[e-1])})),t.attr("class",(function(t){return i.Legend.getClass(t,null===i.legendScale)}))})),e.select("title").text((function(t,e){return 0===e?o.legendTitleFormat.lower.format({min:o.legend[e],name:o.itemName[1]}):e===r.length-1?o.legendTitleFormat.upper.format({max:o.legend[e-1],name:o.itemName[1]}):o.legendTitleFormat.inner.format({down:o.legend[e-1],up:o.legend[e],name:o.itemName[1]})})),n.transition().duration(o.animationDuration).attr("x",h()).attr("y",u()).attr("width",a.getDim("width")).attr("height",a.getDim("height")),n.select("g").transition().duration(o.animationDuration).attr("transform",(function(){return"vertical"===o.legendOrientation?"rotate(90 "+o.legendCellSize/2+" "+o.legendCellSize/2+")":""})),i.resize()},m.prototype.getDim=function(t){var e="horizontal"===this.calendar.options.legendOrientation;switch(t){case"width":return this.dim[e?"width":"height"];case"height":return this.dim[e?"height":"width"]}},m.prototype.buildColors=function(){var t=this.calendar.options;if(null===t.legendColors)return this.calendar.legendScale=null,!1;var e=[];if(Array.isArray(t.legendColors))e=t.legendColors;else{if(!t.legendColors.hasOwnProperty("min")||!t.legendColors.hasOwnProperty("max"))return t.legendColors=null,!1;e=[t.legendColors.min,t.legendColors.max]}var a=t.legend.slice(0);a[0]>0?a.unshift(0):a[0]<0&&a.unshift(a[0]-(a[a.length-1]-a[0])/a.length);var i=vitaraD3.scale.linear().range(e).interpolate(vitaraD3.interpolateHcl).domain([vitaraD3.min(a),vitaraD3.max(a)]),n=a.map((function(t){return i(t)}));return this.calendar.legendScale=vitaraD3.scale.threshold().domain(t.legend).range(n),!0},m.prototype.getClass=function(t,e){if(null===t||isNaN(t))return"";for(var a=[this.calendar.options.legend.length+1],i=0,n=this.calendar.options.legend.length-1;i<=n;i++){if(this.calendar.options.legend[0]>0&&t<0){a=["1","i"];break}if(t<=this.calendar.options.legend[i]){a=[i+1];break}}return 0===t&&a.push(0),a.unshift(""),(a.join(" r")+(e?a.join(" q"):"")).trim()},String.prototype.format=function(){var t=this;for(var e in arguments[0])if(arguments[0].hasOwnProperty(e)){var a=new RegExp("\\{"+e+"\\}","gi");t=t.replace(a,arguments[0][e])}return t},s.amdO?(i=[a(5827)],void 0===(n=function(){return c}.apply(e,i))||(t.exports=n)):"object"===u(o)&&o.exports?o.exports=c:window.CalHeatMap=c},648:function(t,e,a){var i,n,o;o=this,i=[a(45)],void 0===(n=function(t){return o.moment=function(t){if(null==t)throw new Error("Cannot find moment");var e,a,i=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990],n=/(\[[^\[]*\])|(\\)?i(Mo|MM?M?M?|Do|DDDo|DD?D?D?|w[o|w]?|AA|YYYYY|YYYY|YY|gg(ggg?)?)|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,o=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,r=/\d\d?/,s=/\d{1,3}/,l=/\d{3}/,h=/\d{1,4}/,u=/[+\-]?\d{1,6}/,c=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.?)|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,p=/Z|[\+\-]\d\d:?\d\d/i,m=/T/i,d=/[\+\-]?\d+(\.\d{1,3})?/,f={hd:"idate",hm:"imonth",hy:"iyear"},g={},D="DDD w M D".split(" "),v="M D w".split(" "),y={iM:function(){return this.iMonth()+1},iMMM:function(t){return this.localeData().iMonthsShort(this,t)},iMMMM:function(t){return this.localeData().iMonths(this,t)},iAA:function(){return this.localeData().iDayOfWeek(this)},iD:function(){return this.iDate()},iDDD:function(){return this.iDayOfYear()},iw:function(){return this.iWeek()},iYY:function(){return x(this.iYear()%100,2)},iYYYY:function(){return x(this.iYear(),4)},iYYYYY:function(){return x(this.iYear(),5)},igg:function(){return x(this.iWeekYear()%100,2)},igggg:function(){return this.iWeekYear()},iggggg:function(){return x(this.iWeekYear(),5)}};function b(t,e){return function(a){return x(t.call(this,a),e)}}function M(t,e){return function(a){return this.localeData().ordinal(t.call(this,a),e)}}for(;D.length;)e=D.pop(),y["i"+e+"o"]=M(y["i"+e],e);for(;v.length;)e=v.pop(),y["i"+e+e]=b(y["i"+e],2);function w(t,e){var a;for(a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}function x(t,e){for(var a=t+"";a.length<e;)a="0"+a;return a}function C(t){return t?f[t]||t.toLowerCase().replace(/(.)s$/,"$1"):t}function S(t,e,a,i){var n=t._isUTC?"UTC":"";t._d["set"+n+"FullYear"](e),t._d["set"+n+"Month"](a),t._d["set"+n+"Date"](i)}function _(t){function e(){}return e.prototype=t,new e}y.iDDDD=b(y.iDDD,3),w((a=t.localeData(),Object.getPrototypeOf?Object.getPrototypeOf(a):"".__proto__?a.__proto__:a.constructor.prototype),{_iMonths:["Muharram","Safar","Rabi' al-Awwal","Rabi' al-Thani","Jumada al-Ula","Jumada al-Alkhirah","Rajab","Shaban","Ramadhan","Shawwal","Thul-Qidah","Thul-Hijjah"],iMonths:function(t){return this._iMonths[t.iMonth()]},_iMonthsShort:["Muh","Saf","Rab-I","Rab-II","Jum-I","Jum-II","Raj","Sha","Ram","Shw","Dhu-Q","Dhu-H"],iMonthsShort:function(t){return this._iMonthsShort[t.iMonth()]},iMonthsParse:function(t){var e,a,i;for(this._iMonthsParse||(this._iMonthsParse=[]),e=0;e<12;e+=1)if(this._iMonthsParse[e]||(a=L([2e3,(2+e)%12,25]),i="^"+this.iMonths(a,"")+"$|^"+this.iMonthsShort(a,"")+"$",this._iMonthsParse[e]=new RegExp(i.replace(".",""),"i")),this._iMonthsParse[e].test(t))return e},_iDayOfWeek:["al - Aad","al - Ithnayn","ath - Thulth","al - Arba","al - Khams","al - Jumah","as- Sabt"],iDayOfWeek:function(t){return this._iDayOfWeek[t.day()]}});var k={iMonths:"__ _ _ _ _____ _ ".split("_"),iMonthsShort:"__ _ _ _ _____ _ ".split("_"),iDayOfWeek:"______".split("_")};if("function"==typeof t.updateLocale)t.updateLocale("ar-sa",k);else{var P=t.locale();t.defineLocale("ar-sa",k),t.locale(P)}function T(e,a){switch(e){case"iDDDD":return l;case"iYYYY":return h;case"iYYYYY":return u;case"iDDD":return s;case"iMMM":case"iMMMM":case"iAA":return c;case"iMM":case"iDD":case"iYY":case"iM":case"iD":return r;case"DDDD":return l;case"YYYY":return h;case"YYYYY":return u;case"S":case"SS":case"SSS":case"DDD":return s;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return c;case"a":case"A":return t.localeData(a._l)._meridiemParse;case"X":return d;case"Z":case"ZZ":return p;case"T":return m;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return r;default:return new RegExp(e.replace("\\",""))}}function O(e,a,i){var n,o=i._a;switch(e){case"iM":case"iMM":o[1]=null==a?0:~~a-1;break;case"iMMM":case"iMMMM":null!=(n=t.localeData(i._l).iMonthsParse(a))?o[1]=n:i._isValid=!1;break;case"iD":case"iDD":case"iDDD":case"iDDDD":null!=a&&(o[2]=~~a);break;case"iYY":o[0]=~~a+(~~a>47?1300:1400);break;case"iYYYY":case"iYYYYY":o[0]=~~a}null==a&&(i._isValid=!1)}function F(t,e,a){var i,n=a-e,o=a-t.day();return o>n&&(o-=7),o<n-7&&(o+=7),i=L(t).add(o,"d"),{week:Math.ceil(i.iDayOfYear()/7),year:i.iYear()}}function N(e,a,i,o){var r,s,l,h={_i:e,_f:a,_l:i};if(a){if(function(t){return"[object Array]"===Object.prototype.toString.call(t)}(a))return function(t,e){var a,i,n,o,r,s,l=t._f.length;if(0===l)return N(new Date(NaN));for(a=0;a<l;a+=1)i=t._f[a],r=0,(n=N(t._i,i,t._l,e)).isValid()&&(r+=n._hDiff,n._il&&(r+=n._il.length),(null==s||r<s)&&(s=r,o=n));return o}(h,o);r=function(t){var e,a,i,o=t._f.match(n),r=t._i,s=o.length;for(t._a=[],e=0;e<s;e+=1)(i=(T(a=o[e],t).exec(r)||[])[0])&&(r=r.slice(r.indexOf(i)+i.length)),y[a]&&O(a,i,t);return r&&(t._il=r),function(t){var e,a,i=t._a[0],n=t._a[1],o=t._a[2];return null==i&&null==n&&null==o?[0,0,1]:(i=i||0,n=n||0,((o=o||1)<1||o>L.iDaysInMonth(i,n))&&(t._isValid=!1),a=A((e=Y(i,n,o)).gy,e.gm,e.gd),t._hDiff=0,~~a.hy!==i&&(t._hDiff+=1),~~a.hm!==n&&(t._hDiff+=1),~~a.hd!==o&&(t._hDiff+=1),[e.gy,e.gm,e.gd])}(t)}(h),function(t){var e,a,i,o=t._i,r="",s="",l=t._f.match(n),h=l.length;for(e=0;e<h;e+=1)(i=(T(a=l[e],t).exec(o)||[])[0])&&(o=o.slice(o.indexOf(i)+i.length)),y[a]instanceof Function||(s+=a,i&&(r+=i));t._i=r,t._f=s}(h),a="YYYY-MM-DD-"+h._f,e=x(r[0],4)+"-"+x(r[1]+1,2)+"-"+x(r[2],2)+"-"+h._i}return s=o?t.utc(e,a,i):t(e,a,i),!1===h._isValid&&(s._isValid=!1),s._hDiff=h._hDiff||0,w(l=_(L.fn),s),l}function L(t,e,a){return N(t,e,a,!1)}function A(t,e,a){var n=function(t){var e=t-24e5,a=function(t){for(var e=0;e<i.length;e+=1)if(i[e]>t)return e}(e),n=a+16260,o=Math.floor((n-1)/12);return{hy:o+1,hm:n-12*o,hd:e-i[a-1]+1}}(function(t,e,a){return H(1461*(t+H(e-8,6)+100100),4)+H(153*z(e+9,12)+2,5)+a-34840408-H(3*H(t+100100+H(e-8,6),100),4)+752}(t,e+1,a));return n.hm-=1,n}function Y(t,e,a){var n=function(t){var e,a,i,n;return e=(e=4*t+139361631)+4*H(3*H(4*t+183187720,146097),4)-3908,a=5*H(z(e,1461),4)+308,i=H(z(a,153),5)+1,n=z(H(a,153),12)+1,{gy:H(e,1461)-100100+H(8-n,6),gm:n,gd:i}}(function(t,e,a){var n=I(t,e);return a+i[n-1]-1+24e5}(t,e+1,a));return n.gm-=1,n}return w(L,t),L.fn=_(t.fn),L.utc=function(t,e,a){return N(t,e,a,!0)},L.fn.format=function(e){var a,i,r=this;if(e){for(a=5,i=function(t){return r.localeData().longDateFormat(t)||t};a>0&&o.test(e);)a-=1,e=e.replace(o,i);g[e]||(g[e]=function(t){var e,a=t.match(n),i=a.length;for(e=0;e<i;e+=1)y[a[e]]&&(a[e]=y[a[e]]);return function(n){var o="";for(e=0;e<i;e+=1)o+=a[e]instanceof Function?"["+a[e].call(n,t)+"]":a[e];return o}}(e)),e=g[e](this)}return t.fn.format.call(this,e)},L.fn.iYear=function(e){var a,i,n;return"number"==typeof e?(i=A(this.year(),this.month(),this.date()),a=Math.min(i.hd,L.iDaysInMonth(e,i.hm)),S(this,(n=Y(e,i.hm,a)).gy,n.gm,n.gd),this.month()===n.gm&&this.date()===n.gd&&this.year()===n.gy||S(this,n.gy,n.gm,n.gd),t.updateOffset(this),this):A(this.year(),this.month(),this.date()).hy},L.fn.iMonth=function(e){var a,i,n;if(null!=e){if("string"==typeof e){if(!((e=this.localeData().iMonthsParse(e))>=0))return this;e-=1}return i=A(this.year(),this.month(),this.date()),a=Math.min(i.hd,L.iDaysInMonth(i.hy,e)),this.iYear(i.hy+H(e,12)),(e=z(e,12))<0&&(e+=12,this.iYear(this.iYear()-1)),S(this,(n=Y(this.iYear(),e,a)).gy,n.gm,n.gd),this.month()===n.gm&&this.date()===n.gd&&this.year()===n.gy||S(this,n.gy,n.gm,n.gd),t.updateOffset(this),this}return A(this.year(),this.month(),this.date()).hm},L.fn.iDate=function(e){var a,i;return"number"==typeof e?(S(this,(i=Y((a=A(this.year(),this.month(),this.date())).hy,a.hm,e)).gy,i.gm,i.gd),this.month()===i.gm&&this.date()===i.gd&&this.year()===i.gy||S(this,i.gy,i.gm,i.gd),t.updateOffset(this),this):A(this.year(),this.month(),this.date()).hd},L.fn.iDayOfYear=function(t){var e=Math.round((L(this).startOf("day")-L(this).startOf("iYear"))/864e5)+1;return null==t?e:this.add(t-e,"d")},L.fn.iDaysInMonth=function(){return parseInt(L(this).endOf("iMonth").format("iDD"))},L.fn.iDayOfMonth=function(){return parseInt(L(this).endOf("iMonth").format("iDD"))},L.fn.iWeek=function(t){var e=F(this,this.localeData()._week.dow,this.localeData()._week.doy).week;return null==t?e:this.add(7*(t-e),"d")},L.fn.iWeekYear=function(t){var e=F(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")},L.fn.add=function(e,a){var i;return null===a||isNaN(+a)||(i=e,e=a,a=i),"iyear"===(a=C(a))?this.iYear(this.iYear()+e):"imonth"===a?this.iMonth(this.iMonth()+e):"idate"===a?this.iDate(this.iDate()+e):t.fn.add.call(this,e,a),this},L.fn.subtract=function(e,a){var i;return null===a||isNaN(+a)||(i=e,e=a,a=i),"iyear"===(a=C(a))?this.iYear(this.iYear()-e):"imonth"===a?this.iMonth(this.iMonth()-e):"idate"===a?this.iDate(this.iDate()-e):t.fn.subtract.call(this,e,a),this},L.fn.startOf=function(e){return"iyear"===(e=C(e))||"imonth"===e?("iyear"===e&&this.iMonth(0),this.iDate(1),this.hours(0),this.minutes(0),this.seconds(0),this.milliseconds(0),this):t.fn.startOf.call(this,e)},L.fn.endOf=function(t){return void 0===(t=C(t))||"milisecond"===t?this:this.startOf(t).add(1,"isoweek"===t?"week":t).subtract(1,"milliseconds")},L.fn.clone=function(){return L(this)},L.fn.iYears=L.fn.iYear,L.fn.iMonths=L.fn.iMonth,L.fn.iDates=L.fn.iDate,L.fn.iWeeks=L.fn.iWeek,L.iDaysInMonth=function(t,e){var a=I(t,e+1);return i[a]-i[a-1]},L.iConvert={toHijri:A,toGregorian:Y},L;function H(t,e){return~~(t/e)}function z(t,e){return t-~~(t/e)*e}function I(t,e){return 12*(t-1)+1+(e-1)-16260}}(t),o.moment}.apply(e,i))||(t.exports=n)},647:function(t,e,a){a.r(e),a.d(e,{default:function(){return f}});var i=a(45),n=a(648),o=a(234),r=a(44),s=a(399),l=a(473),h=a(436),u=a(441),c=a(649),p=(a(651),a(4));function m(t){return(m="function"==typeof Symbol&&"symbol"==g(Symbol.iterator)?function(t){return g(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":g(t)})(t)}var d=function(t,e,a,i,n){this.options={},this.chartNode=n,h.hcCore.call(this,t,e,a,i)};vitaraJQ.extend(d.prototype,h.hcCore.prototype,u.styledModeRendererBase.prototype,{postChartRendering:function(){var t;this.context&&null!==(t=this.context.platformContext)&&void 0!==t&&t.initContextMenu&&this.context.platformContext.initContextMenu(),this.context.reportReadyForExport()},conversionConstructor:function(t,e){var a=vitaraJQ(".cal-heatmap-container",vitaraJQ(e,t));a.css("overflow","auto"),this.setColors=function(e,a,i){for(var n,o=1;o<=a.length+1;o++){n=vitaraD3.select(t).select(e).selectAll(".q"+o);var r=i[o-1]||"rgb(0, 0, 0)";n.attr("style","fill-opacity: 1;fill:"+r+";")}n=null},this.resizeLayout=function(i,n,o,s,l){n=n||0;var h=vitaraJQ(".vitara-chart-container",t).width(),u=(vitaraJQ(".vitara-chart-container",t).height(),vitaraJQ("svg .graph-domain",vitaraJQ(e,t)));if(!(u.length<1)){var c,p,m,d,f,g,D=Number(u[0].getAttribute("height")),v=Number(u[0].getAttribute("width")),y=s.getDimensions(),b=y.width,M=y.height,w=y.includeLegendWidth,x=y.includeLegendHeight,C=y.xPos,S=y.yPos,_=!1,k=function(a,n,o,s,l){var h;if("week"==i.calHeatSubDomain&&"month"==i.calHeatDomain){if(h=12,l.enable)var u=l.textStyle}else h=Math.floor(a/n);var c=0,p=0,m=0;return s.each((function(a,i){if(p>=h&&(p=0,c++),0===p&&u){var s=i.className.baseVal.split("_");m=r.utils.getTextDimensions(s[s.length-1],u.fontSize+"px",u.fontName).width+10,vitaraD3.select(t).select(e).select(".graph").append("text").attr("class","graph-label").attr("x",p*n+5).attr("y",c*o+o/2).attr("width",m).text(s[s.length-1])}i.setAttribute("y",c*o),i.setAttribute("x",p*n+m),p++})),[h,c+1,m]}(function(t,e,a){var i=0;return(w?a+t:a)>e?(i=a,_=!0):i=w?e-t:e,i}(b,h,v),v,D,u,l),P=v*k[0];c=D*k[1],p=P+k[2],m=M,d=b,g=w?d+p:p,_&&(g=w?p+d:p),f=(f=x?m+c:c)<m?m:f,g=g<d?d:g,a.attr("width",g),a.attr("height",f),function(a,i){var n=C?a:0,o=S?i:0,r=vitaraJQ("svg .graph",vitaraJQ(e,t));r.attr("x",n),r.attr("y",o),r=null}(b,M),s.resetLegend(),a=null}}},createDateFormatArray:function(){var t=[];if(""!==this.vizProps.customDateFormat&&void 0!==this.vizProps.customDateFormat)t=[this.vizProps.customDateFormat];else if(""!==this.vizProps.Input_Date_Format&&void 0!==this.vizProps.Input_Date_Format){var e=this.vizProps.Input_Date_Format;t.push(e),t.push(e.replace("YYYY","YY"))}else t=r.utils.getSupportedDateFormats();return t},countCharOfString:function(){String.prototype.count=function(t){return(this.length-this.replace(new RegExp(t,"g"),"").length)/t.length}},changeDateFormatAndData:function(t,e){this.options.dateFormat=this.flipCharacters(this.options.dateFormat,e[t-1]),this.newHeatMapData=this.loadHeatmapData()},flipCharacters:function(t,e){var a="";if(1===e.count("Y"))a+=t.reverse();else for(var i=0;i<t.length;i++)t[i]===e[0]?a+=e[1]:t[i]===e[1]?a+=e[0]:a+=t[i];return a},convertDate:function(t,e){var a=i(t,e,r.utils.localeSelected(),!0);this.options.arabic&&"string"==typeof e&&(a=n(t,e));var o=["DM"];if(a.isValid())return a;if(this.countCharOfString(),!this.options.dateFormat)throw new Error(r.utils.getCustomErrorCode("E0020"));2===this.options.dateFormat.count("Y")&&(o=["DM","MY","MD"]),this.dateFormatAttempts++,this.dateFormatAttempts<=o.length&&this.changeDateFormatAndData(this.dateFormatAttempts,o)},setHeaderLabelStyle:function(t,e,a){if(a.enable){var i=a.textStyle;vitaraJQ(".graph-label",vitaraJQ(t,e)).each((function(){vitaraJQ(this).attr("style",(i.fontName?"font-family:"+i.fontName+";":"")+(i.fontSize?"font-size:"+i.fontSize+"px;":"")+"fill:"+i.color+";font-weight:"+i.weight+";font-style:"+i.style+";text-decoration:"+i.decoration+";")}))}},iterateElements:function(t,e,a,i,n,o){var r,s=vitaraD3.select(e).select(t).selectAll(".graph-subdomain-group")[0],l=this,h=0;p.forEach(s,(function(t){r=vitaraD3.select(t).selectAll("g")[0],p.forEach(r,(function(t){vitaraD3.select(t).select("rect").classed("vitara-point",!0),"year"!==i||"x_day"!==n&&"day"!==n||(h=l.showMonthSeperation(t,h,2)),"week"!==n&&"month"!==n||l.setElementData(t),a.enable&&(vitaraD3.select(t).select("text").classed("vitara-datalabel",!0),l.setTextElementStyle(t,a,o))}))})),r=null,s=null},showMonthSeperation:function(t,e,a){var n,o=vitaraD3.select(t).datum(),r=vitaraD3.select(t).select("rect")[0][0];if(!i(i(o.t)).isSame(i(o.t).add(7,"d"),"month")){var s=parseInt(r.getAttribute("width")),l=parseInt(r.getAttribute("x"))+s,h=parseInt(r.getAttribute("y"))-1,u="M "+l+" "+h+" l 0 "+(s+1);this.drawLine(t,u,a),0===e&&(n=l),e++}return 7===e&&(l!==n&&(u="M "+(l=parseInt(r.getAttribute("x"))-1)+" "+(h=parseInt(r.getAttribute("y"))+s)+" l "+(s+=1)+" 0",this.drawLine(t,u,a)),e=0),e},drawLine:function(t,e,a){vitaraD3.select(t).append("path").attr("id","subDomain_line").attr("d",e).attr("stroke","black").attr("stroke-width",a).attr("fill","none")},setElementData:function(t){var e=vitaraD3.select(t).datum();if(this.options.tooltipData[this.chartDataMapper.numAttributes]&&this.options.tooltipData[this.chartDataMapper.numAttributes][e.t/1e3]&&null==this.options.tooltipData[this.chartDataMapper.numAttributes][e.t/1e3].v)if(this.options.tooltipData[this.chartDataMapper.numAttributes][e.t/1e3][1].v!==e.v){for(var a=this.chartDataMapper.numAttributes;a<this.chartDataMapper.numAttributes+this.chartDataMapper.numMetrics;a++)this.options.tooltipData[a]&&(e[a]=this.options.tooltipData[a][e.t/1e3][0]);e.month="first"}else{for(a=this.chartDataMapper.numAttributes;a<this.chartDataMapper.numAttributes+this.chartDataMapper.numMetrics;a++)this.options.tooltipData[a]&&(e[a]=this.options.tooltipData[a][e.t/1e3][1]);e.month="second"}else if(null!=e.v)for(a=this.chartDataMapper.numAttributes;a<this.chartDataMapper.numAttributes+this.chartDataMapper.numMetrics;a++)this.options.tooltipData[a]&&(e[a]=this.options.tooltipData[a][e.t/1e3]);vitaraD3.select(t).datum(e)},setTextElementStyle:function(t,e,a){var i=e.textStyle,n=vitaraD3.select(t).datum(),o=vitaraD3.select(t).select("rect")[0][0],s=vitaraD3.select(t).select("text"),l=i.color||"#000000";i.color||o.style.fill&&""!=o.style.fill&&(l=chroma.contrast(o.style.fill,"#000000")>chroma.contrast(o.style.fill,"#ffffff")?"#000000":"#ffffff"),n[this.chartDataMapper.numAttributes]&&"metric"===e.type&&(this.vizProps.dataLabelDisplayFormat&&"default"!==this.vizProps.dataLabelDisplayFormat?s.text(n[this.chartDataMapper.numAttributes].fv):s.text(r.utils.shortenNumber({rawVal:n[this.chartDataMapper.numAttributes].v,fv:n[this.chartDataMapper.numAttributes].fv},this.vizProps.dataLabelDisplayFormat))),s.attr("style",(i.fontName?"font-family:"+i.fontName+";":"")+(i.fontSize?"font-size:"+i.fontSize+"px;":"")+"fill:"+l+";font-weight:"+i.weight+";font-style:"+i.style+";text-decoration:"+i.decoration+";")},setBackgroundColors:function(){var t=vitaraJQ(this.chartNode,this.domNode).attr("style"),e=vitaraJQ(".cal-heatmap-container",vitaraJQ(this.chartNode,this.domNode)).attr("style");t?t+="background:"+(this.vizProps.chartAreaBGColor||"transparent")+";":t="background:"+(this.vizProps.chartAreaBGColor||"transparent")+";",e?e+="background:"+(this.vizProps.plotAreaBGColor||"transparent")+";":e="background:"+(this.vizProps.plotAreaBGColor||"transparent")+";",vitaraJQ(this.chartNode,this.domNode).attr("style",t),vitaraJQ(".cal-heatmap-container",vitaraJQ(this.chartNode,this.domNode)).attr("style",e)},processChartThresholds:function(){if(this.options.agData){var t=this;this.context.legendOptions=null;var e=this.options.thresholdData.getFirstMetricAsZones()[0].name,a=this.context.getThresholdHelper();this.context.vizParser.setDefaultThresholds(this.vizProps,[{name:e}],this.vizProps.colors||s.default.heatmapColors),a.setChartDataMapper(this.chartDataMapper);var i=a.procThresholdsPreCleanUp(this.vizProps.thresholds,[{name:e}]);a.setChartDataMapper(null),a.getThresholdMapper().setDefaultColor(this.vizProps.heatMapDefaultColor||s.default.heatmapColors[0]),p.forEach(i[e],(function(i,n,o){a.processThreshold(t.options.agData,e,i,t.options.thresholdData)})),a.destroy()}},resetCalHeatMap:function(t,e,a){var i=this,n=new i.conversionConstructor(this.domNode,this.options.chartId);vitaraD3.select(this.domNode).select(this.options.chartId).select(".graph-legend").remove();var o=function(t){var e={enabled:!0,align:"center",layout:"horizontal",verticalAlign:"bottom",colors:t?t.colors:[],labels:t?t.labels:[],containerWidth:i.position.width,containerHeight:i.position.height};return vitaraJQ.extend(e,i.vizProps.legend)}(this.context.legendOptions);this.processLegendStyles(o),l.vitaraLegend.init(o,vitaraD3.select(this.domNode).select(this.options.chartId).select(".cal-heatmap-container")),n.resizeLayout(t,null,o,l.vitaraLegend,a)},hideFilteredData:function(t){var e;+(null===(e=this.vizProps)||void 0===e?void 0:e.displayFilteredColumn)&&vitaraD3.select(this.context.chartNode).selectAll(".graph").selectAll("g").each((function(t){t.v||vitaraD3.select(this).style({visibility:"hidden"})}))},processLegendStyles:function(t){this.context.init(),this.processVitaraLegendItems(t)},appendTooltipData:function(t,e,a,i,n){for(var o in this.options.tooltipData[a]||(this.options.tooltipData[a]={}),t)this.options.tooltipData[a][o]?this.options.tooltipData[a][o]={0:this.options.tooltipData[a][o],1:{v:e,fv:i?r.utils.formatMetricLike(e,i):e}}:(this.options.tooltipData[a][o]={},this.options.tooltipData[a][o].v=e,i&&(this.options.tooltipData[a][o].fv=r.utils.formatMetricLike(e,i))),this.options.thresholdData.dataRows[n][a].v=e},getTemplate:function(t){return this.chartDataMapper.dataRows.metaInfo[t]},setTooltipData:function(t,e,a){var n={};if("week"===a||"month"===a){var o=0,r=this.getTemplate(e);for(var s in t)i(1e3*s),n[("week"===a?i(1e3*s).startOf(this.options.weekStartDay?"isoWeek":"week"):i(1e3*s).startOf("month"))._d.valueOf()/1e3]=0,this.appendTooltipData(n,t[s],e,r,o++),n={};return o}if(this.options.tooltipData[e]=t,this.options.thresholdData.numAttributes>1){var l=0;for(var s in t)this.options.thresholdData.dataRows[l++][e].v=t[s];return l}return this.options.thresholdData.dataRows.length},processAggregationOnData:function(t,e,a,o,r,s){var l,h,u,c,p,m={},d={},f=0,g=this.getTemplate(a);if("x_hour"===e){for(var D in t)if("number"==typeof t[D]){for(var v in u=(l=i(1e3*D)).startOf("hour").valueOf()/1e3,m[D]=t[D],d[u]=m[D],delete t[D],t)if((h=i(1e3*v)).isSame(l,"hour"))m[D]+=t[v],d[u]=m[D],delete t[v];else if(-0!==l.diff(h,"hours"))break;this.appendTooltipData(d,m[D],a,g,f++),d={}}}else if("x_day"===e||"day"===e){for(var y in t)if("number"==typeof t[y]){for(var b in u=(l=i(1e3*y)).startOf("day").valueOf()/1e3,m[y]=t[y],d[u]=m[y],delete t[y],t)if((h=i(1e3*b)).isSame(l,"day"))m[y]+=t[b],d[u]=m[y],delete t[b];else if(-0!==l.diff(h,"days"))break;this.appendTooltipData(d,m[y],a,g,f++),d={}}}else if("week"===e){var M,w,x;for(var C in t)if("number"==typeof t[C]){for(var S in l=n(1e3*C),M=n(1e3*C).startOf(o?"isoWeek":"week"),p=n(1e3*C).startOf(this.options.arabic?"iMonth":"month").valueOf(),w=n(1e3*C).startOf(this.options.arabic?"iYear":"year").valueOf(),c=M._d.valueOf()/1e3,m[C]=t[C],d[c]=0,delete t[C],x=!1,t){if(!(h=i(1e3*S)).isSame(l,o?"isoWeek":"week"))break;("month"==r?p===n(1e3*S).startOf(this.options.arabic?"iMonth":"month").valueOf():w===n(1e3*S).startOf(this.options.arabic?"iYear":"year").valueOf())||x||(this.appendTooltipData(d,m[C],a,g,f++),x=!0,m[C]=0),m[C]+=t[S],delete t[S]}this.appendTooltipData(d,m[C],a,g,f++),d={}}}else if("month"===e){for(var _ in t)if("number"==typeof t[_]){for(var k in d[c=(p=n(1e3*_).startOf(this.options.arabic?"iMonth":"month"))._d.valueOf()/1e3]=0,m[_]=t[_],delete t[_],t){if(c!==n(1e3*k).startOf(this.options.arabic?"iMonth":"month").valueOf()/1e3)break;m[_]+=t[k],delete t[k]}this.appendTooltipData(d,m[_],a,g,f++),d={}}}else this.setFVforCatAggrtdData(t,a),m=t,f=this.setTooltipData(m,a,e);return s&&(this.options.thresholdData.dataRows.splice(f,this.options.thresholdData.dataRows.length),this.options.thresholdData.dataRows.metaInfo=this.chartDataMapper.dataRows.metaInfo),m},aggregateTooltipMetricsData:function(t,e,a){for(var i=this.chartDataMapper.numAttributes+1;i<this.chartDataMapper.numColumns;i++)a["Metric"+(i-1)]||(a["Metric"+(i-1)]={}),"number"==typeof e[i].v&&(a["Metric"+(i-1)][t]||(a["Metric"+(i-1)][t]=0),a["Metric"+(i-1)][t]+=+e[i].v);return a},otherMetricsAggregationProcess:function(t){for(var e=this.calendarOptions(),a=this.chartDataMapper.numAttributes+1;a<this.chartDataMapper.numColumns;a++)this.processAggregationOnData(t["Metric"+(a-1)],e.calHeatSubDomain,a,e.weekStartDay,e.calHeatDomain)},setFVforCatAggrtdData:function(t,e){for(var a in t){var n={},o=i(1e3*a);n[a]=t[a];var s=this.timeStampValues.indexOf(o.valueOf()/1e3),l=this.chartDataMapper.dataRows.metaInfo[e];this.chartDataMapper.dataRows[s][e].fv=r.utils.formatMetricLike(n[a],l)}},getThresholdsFromColorOptions:function(t){var e=this.chartDataMapper.titles[this.chartDataMapper.getNumAttributes()],a=p.cloneDeep(t.colorRanges);a.unshift(t.minMaxValues[0]),a.push(t.minMaxValues[1]);for(var i=[],n=0;n<5;n++){var o=[a[n],a[n+1]],r={condition:"between",source:e,defaultColor:t.colors[n],color:t.colors[n],values:o};i.push(r)}return i},getDefaultColorRangesForColumn:function(t,e,a){if(e===a){var i=[e],n=[];return t.length>i.length?n.push(t[0]):n=t,{colors:n,colorRanges:i,minMaxValues:[e,a]}}return i=[],i=[Math.floor(20*(a-e)/100+e),Math.floor(40*(a-e)/100+e),Math.floor(60*(a-e)/100+e),Math.floor(80*(a-e)/100+e)],n=[],{colors:n=t.length>i.length?this.options.vizParser.getFiveScaleColors(t):t,colorRanges:i,minMaxValues:[e,a]}},getColorRangesFromColorAxis:function(t,e,a){var i,n=[],o=[];return t.length>0&&(t.sort((function(t,e){return+t.from>+e.from?1:+e.from>+t.from?-1:0})),vitaraJQ.map(t,(function(e,a){e.from!==i?(o.push(e.from),o.push(e.to),n.push("#FFFFBF  "),n.push(e.color)):(0===a&&o.push(e.from),o.push(e.to),n.push(e.color)),a===t.length-1&&n.push("#FFFFBF  "),i=e.to}))),{colors:n,colorRanges:o,minMaxValues:[e,a]}},deleteDefColorScaleThresholds:function(t){for(var e=this.vizProps.thresholds[t],a=0;a<e.length;a++)"between"===e[a].condition&&void 0!==e[a].defaultColor&&(e.splice(a,1),a--)},updateThresholdsToPropMenuState:function(t){this.options.propMenuPropertyState.thresholds=t,this.options.updateChartSavedState(this.options.propMenuPropertyState),this.options.readChartState=!1,this.options.propMenu&&this.options.propMenu.updateFormData()},getChartColorRanges:function(t,e){var a=p.values(t);a.sort((function(t,e){return t-e}));var i=Math.floor(a[0]),n=Math.ceil(a[a.length-1]);void 0===this.options.calDomain&&(this.options.calDomain=this.vizProps.calDomain||"default");var o=this.chartDataMapper.titles[this.chartDataMapper.getNumAttributes()];if(this.vizProps.thresholds&&(this.options.getThresholdHelper().setChartDataMapper(this.chartDataMapper),this.options.getThresholdHelper().procThresholdsPreCleanUp(this.vizProps.thresholds,[{name:o}])),!this.vizProps.thresholds||!this.vizProps.thresholds[o])return u=this.vizProps.colors||s.default.heatmapColors,c=this.getDefaultColorRangesForColumn(u,i,n),m=this.getThresholdsFromColorOptions(c),this.vizProps.thresholds||(this.vizProps.thresholds={}),this.vizProps.thresholds[o]=m,this.updateThresholdsToPropMenuState(this.vizProps.thresholds),c;var r=this.vizProps.thresholds[o].filter((function(t){return"between"===t.condition})),l={};if(r&&r.length){var h=this.vizProps.colors||s.default.heatmapColors,u=this.options.vizParser.getFiveScaleColors(h);if(e){this.options.calDomain=this.vizProps.calDomain,this.deleteDefColorScaleThresholds(o);var c=this.getDefaultColorRangesForColumn(u,i,n),m=this.getThresholdsFromColorOptions(c);return this.vizProps.thresholds[o]=m.concat(this.vizProps.thresholds[o]),this.updateThresholdsToPropMenuState(this.vizProps.thresholds),c}return l=this.options.vizParser.getColorAxisFromThresholds(r,u),this.options.vizParser.getD3CalHeatMapColorOptions(l,i,n)}},getColorRanges:function(t){var e,a=[],i=[],n=[],o=p.values(t),r=o.length;u||this.vizProps.colors||s.default.heatmapColors,o.sort((function(t,e){return t-e}));var l=[];if(this.vizProps&&this.vizProps.colorAxis&&this.vizProps.colorAxis.dataClasses&&(l=this.vizProps.colorAxis.dataClasses),l.length>0){var h;l.sort((function(t,e){return+t.from>+e.from?1:+e.from>+t.from?-1:0})),vitaraJQ.map(l,(function(t,e){t.from!==h?(i.push(t.from),i.push(t.to),n.push("#FFFFBF  "),n.push(t.color)):(0===e&&i.push(t.from),i.push(t.to),n.push(t.color)),e===l.length-1&&n.push("#FFFFBF  "),h=t.to}))}else{var u=this.options.vizParser.interpretSeriesColor(this.vizProps.seriesColors,this.vizProps.invertColors);e=(n=u||this.vizProps.colors||s.default.heatmapColors).length;for(var c=0;c<(1!==e?e-1:e);c++){var m=(r/n.length-1)*c;c==n.length-1?a[c]=Math.floor(o[r-1]):a[c]=Math.floor(o[Math.floor(m)])}i=a}return{colors:n,colorRanges:i}},isDataLabelEnabled:function(t){return void 0===t?1:0===Number(t)?0:1},toggleAlignmentValue:function(t){return"left"===t?"right":"right"===t?"left":t},getHeaderLabelOptions:function(){return{enable:this.isDataLabelEnabled(this.vizProps.headerLabelsEnable),align:this.toggleAlignmentValue(this.vizProps.labelsAlign)||"",vAlign:this.vizProps.waffleLabelsVAlign||"",textStyle:{fontName:this.vizProps.labelItemStyleFontName?"'".concat(this.vizProps.labelItemStyleFontName,"'"):"",fontSize:this.vizProps.labelItemStyleFontSize||"",weight:1==this.vizProps.labelItemStyleBold?"bold":"normal",style:1==this.vizProps.labelItemStyleItalic?"italic":"normal",decoration:1==this.vizProps.labelItemStyleUnderline?"underline":"none",color:this.vizProps.labelItemStyleColor||"#000000"}}},getDataLabelOptions:function(){return{enable:this.isDataLabelEnabled(this.vizProps.waffleLabelsEnable),type:this.vizProps.dataLabelType||"date",textStyle:{fontName:this.vizProps.textStyleFontName?"'".concat(this.vizProps.textStyleFontName,"'"):"",fontSize:this.vizProps.textStyleFontSize||"",weight:1==this.vizProps.textStyleBold?"bold":"normal",style:1==this.vizProps.textStyleItalic?"italic":"normal",decoration:1==this.vizProps.textStyleUnderline?"underline":"none",color:this.vizProps.textStyleColor}}},getMatchingSelector:function(t,e,a,i,o){if(null!==i){var r,s=e[t/1e3];if("month"===this.options.calDomain.split(" ")[0]){r=[],void 0!==s&&(r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(s,0)));for(var l=n(t),h=o.indexOf(t/1e3)+1;h<o.length;h++){var u=n(1e3*o[h]);(!this.options.arabic&&l.month()===u.month()&&l.year()===u.year()||this.options.arabic&&l.iMonth()===u.iMonth()&&l.iYear()===u.iYear())&&(r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(e[o[h]],0)),void 0===s&&(s=h))}}else if("week"===this.options.calDomain.split(" ")[0]){if(r=[],"month"===this.options.calDomain.split(" ")[1])var c=!0;for(void 0!==s&&"second"!==a&&(r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(s,0))),l=n(t),h=o.indexOf(t/1e3)+1;h<o.length;h++)u=n(1e3*o[h]),l.isSame(u,this.options.weekStartDay?"isoWeek":"week")&&(c?!this.options.arabic&&"first"===a&&l.month()===u.month()||this.options.arabic&&"first"===a&&l.iMonth()===u.iMonth()||!this.options.arabic&&"second"===a&&l.month()!==u.month()||this.options.arabic&&"second"===a&&l.iMonth()!==u.iMonth()?r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(e[o[h]],0)):a||(r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(e[o[h]],0))):r=p.concat(r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(e[o[h]],0)),void 0===s&&(s=h))}else{if(void 0===s)return;r=vitaraJQ.extend(!0,r,this.chartDataMapper.getFilterHandler().getAttributeSelectionHandler(s,0))}return{selector:r,index:s}}},contextMenuHandler:function(t,e,a,i,n){var o,r,s,l,h=this.getMatchingSelector(t,e,a,i,n);h&&h.selector&&(null===(o=this.context)||void 0===o||null===(o=o.platformContext)||void 0===o||null===(r=o.handleContextMenuSelection)||void 0===r||r.call(o,event,null===(s=this.context)||void 0===s||null===(s=s.platformContext)||void 0===s||null===(l=s.getGraphicModel)||void 0===l?void 0:l.call(s,{selector:h.selector})))},clickFilterHandler:function(t,e,a,i,n){var o=this.getMatchingSelector(t,e,a,i,n);if(o&&o.selector){if(!isMSTRDashBoard()&&o.selector.length){if(!o.selector[0])return;o.selector=o.selector[0]}this.context.applySelections().call({selector:o.selector,id:"second"===a?0-o.selector.length:o.index},vitaraD3.event),o.selector=null}},getSubDomainText:function(t,e,a,i){return i.enable?"date"===i.type?a.subDomainTextFormat_value[a.calHeatSubDomain]:this.options.metricsDataForTooltip(t,e,this.timeStampValues,a.calHeatSubDomain):""},calendarOptions:function(){var t,e,a,o,s,l,h=function(t){s=s.startOf(t),l=l.endOf(t)};this.timeStampValues.sort((function(t,e){return t-e})),s=i.unix(this.timeStampValues[0]),l=i.unix(this.timeStampValues[this.timeStampValues.length-1]),this.options.arabic&&(s=n(s.valueOf()),l=n(l.valueOf()));var u=1,c="month",p="year",m=!0;-1===this.options.dateFormat.search("HH")&&-1===this.options.dateFormat.search("D")||(c="x_day",p="month"),"0"===this.vizProps.Week_Start_Day&&(m=!1),this.options.arabic&&(m=!1,c="x_day",p="month");var d=this.vizProps.calDomain;d&&2===d.split(" ").length?(a=(d=d.split(" "))[1],e=d[0]):(a=this.vizProps.calDomain||p,e=this.vizProps.calSubDomain||c),this.options.calDomain=e+" "+a,"month"===a?(h("week"==e?this.options.arabic?"iYear":"year":this.options.arabic?"iMonth":"month"),o=this.options.arabic?12*(l.iYear()-s.iYear())+(l.iMonth()-s.iMonth())+1:l.diff(s,"months")+1):"day"===a?(h("day"),o=l.diff(s,"days")+1):"hour"===a?(h("hour"),o=l.diff(s,"hours")+24):"year"===a?(o=this.options.arabic?l.iYear()-s.iYear()+1:l.year()-s.year()+1,"x_day"===e&&(e="day")):"week"===a&&(h(this.options.arabic?"iWeek":m?"isoWeek":"week"),o=l.diff(s,"weeks")+1),t=null==this.vizProps.cellsize||""==this.vizProps.cellsize?"month"===e?40:17:this.vizProps.cellsize,"month"===a&&"week"===e&&(u=2);var f=this;if(f.options.localeSelect=!r.utils.isEnglishLocale(),f.options.localeSelect){var g=r.utils.getDatePerLocaleSelected(s._d);f.options.selectedLocaleData=null==g?void 0:g._locale}else{var D;f.options.selectedLocaleData=null===(D=s)||void 0===D?void 0:D._locale}var v={day:"%d",x_day:"%d",month:"name"===f.vizProps.dateDisplayFormat?function(t,e){var a,i;return"number"==typeof t?f.options.arabic?n(t).format("iMMM"):null===(i=f.options)||void 0===i||null===(i=i.selectedLocaleData)||void 0===i?void 0:i.monthsShort()[new Date(t).getMonth()]:null===(a=f.options)||void 0===a||null===(a=a.selectedLocaleData)||void 0===a?void 0:a.monthsShort()[t.getMonth()]}:"%m",week:m?"%W":"%U",x_hour:"%H",hour:"%H",x_min:"%M",min:"%M"};return{startDate:s,endDate:l,range:o,cellSize:t,calHeatDomain:a,calHeatSubDomain:e,weekStartDay:m,subDomainTextFormat_value:v,domainGutterVal:u}},getTimeZoneAsLang:function(t,e){var a=r.utils.getDatePerLocaleSelected(new Date(t))._locale._abbr;return i.locale(a),"week"===e?"".concat(i(t).format("MMMM")," week #").concat(i(t).format("WW")):"month"==e?i(t).format("MMMM YYYY"):"x_hour"===e?"".concat(i(t).format("HH"),"h, ").concat(i(t).format("dddd MMMM DD, YYYY")):i(t).format("dddd MMMM DD, YYYY")},setDomainLabelFormat:function(t){var e,a=this,i=null===(e=a.options)||void 0===e?void 0:e.selectedLocaleData;if("week"===t.calHeatDomain){var o=function(t,e){var a=vitaraD3.time.format(e);return(null==i?void 0:i.months()[t.getMonth()])+" "+a(t)};return t.weekStartDay?a.options.localeSelect?function(t){return o(t,"Week #%W")}:"%B Week #%W":a.options.localeSelect?function(t){return o(t,"Week #%U")}:"%B Week #%U"}return"month"==t.calHeatDomain&&"week"==t.calHeatSubDomain?function(t){return a.options.arabic?["Muharram","Safar","Rabi' al-Awwal","Rabi' al-Thani","Jumada al-Ula","Jumada al-Alkhirah","Rajab","Shaban","Ramadhan","Shawwal","Thul-Qidah","Thul-Hijjah"][n(t).iMonth()].substring(0,1):null==i?void 0:i.monthsShort()[t.getMonth()].substring(0,1)}:a.options.arabic||"month"!=t.calHeatDomain||"x_day"!=t.calHeatSubDomain?"day"!=t.calHeatDomain||"x_hour"!=t.calHeatSubDomain||function(t){return t.getDate()+" "+(null==i?void 0:i.monthsShort()[t.getMonth()])+" "+t.getFullYear()}:function(t){return(null==i?void 0:i.months()[t.getMonth()])+" "+t.getFullYear()}},calHeatMapRender:function(t,e,a){var i,n=this,o=this.context.renderedChart=new c.CalHeatMap,s=this.getHeaderLabelOptions(),l=this.getDataLabelOptions(),h=this.calendarOptions();this.options.weekStartDay=h.weekStartDay;var u={year:{month:1,week:1,day:1,x_day:1,x_hour:0,x_min:0},month:{month:-1,week:1,day:1,x_day:1,x_hour:1,x_min:0},week:{month:-1,week:-1,day:1,x_day:1,x_hour:1,x_min:0},day:{month:-1,week:-1,day:-1,x_day:-1,x_hour:1,x_min:0},hour:{month:-1,week:-1,day:-1,x_day:-1,x_hour:-1,x_min:1}};if(-1===u[h.calHeatDomain][h.calHeatSubDomain])throw new Error(r.utils.getCustomErrorCode("E0021"));if(0===u[h.calHeatDomain][h.calHeatSubDomain])throw new Error(r.utils.getCustomErrorCode("E0022"));e&&(this.options.agData=null,this.options.agData=this.processAggregationOnData(p.cloneDeep(t),h.calHeatSubDomain,this.chartDataMapper.numAttributes,h.weekStartDay,h.calHeatDomain,!0),this.chartDataMapper.numMetrics>1&&this.otherMetricsAggregationProcess(a));var m={},d=p.cloneDeep(t);"week"==h.calHeatSubDomain&&"month"==h.calHeatDomain?(h.rowLimit=6,h.domainDynamicDimension=!0,h.domainGutterVal=0,h.domainMargin=0):(h.domainMargin=1,h.domainDynamicDimension=!1),o.initTimeStamps=this.timeStampValues,o.dataContext=this,o.init({domNode:this.domNode,itemSelector:this.options.chartId,itemName:["",""],domain:h.calHeatDomain,subDomain:h.calHeatSubDomain,data:d,weekStartOnMonday:h.weekStartDay,subDomainTextFormat:l.enable?"date"===l.type?h.subDomainTextFormat_value[h.calHeatSubDomain]:function(t,e){return"week"!==h.calHeatSubDomain&&"month"!==h.calHeatSubDomain?n.metricsDataForTooltip(t,e,n.timeStampValues,h.calHeatSubDomain,!0):""}:"",range:h.range,rowLimit:h.rowLimit,cellSize:parseInt(h.cellSize),domainLabelFormat:s.enable?this.setDomainLabelFormat(h):"",label:{align:s.align?s.align:"center",position:s.vAlign?s.vAlign:"top",width:20,height:s.enable?20:10},onClick:function(t,e){vitaraD3&&vitaraD3.event&&n.clickFilterHandler(t,n.unsortedtimeStampValues,vitaraD3.select(vitaraD3.event.target).datum().month,e,this.initTimeStamps)},onContextMenu:null!==(i=this.context)&&void 0!==i&&i.platformContext&&this.context.platformContext.handleContextMenuSelection?function(t,e,a){vitaraD3&&n.contextMenuHandler(t,n.unsortedtimeStampValues,vitaraD3.select(vitaraD3.event.target).datum().month,e,this.initTimeStamps)}:null,start:h.startDate._d,displayLegend:!1,legendVerticalPosition:"top",legendHorizontalPosition:"right",legendOrientation:"horizontal",domainDynamicDimension:h.domainDynamicDimension,domainGutter:h.domainGutterVal,domainMargin:h.domainMargin,tooltip:0!=this.vizProps.tooltipEnable,cellPadding:1,subDomainTitleFormat:{empty:"{date} &lt;br/&gt; No data",filled:"{date} &lt;br/&gt; {allmetrics_formattedvalue}"},arabic:this.options.arabic,subDomainDateFormat:"week"===h.calHeatDomain||"week"===h.calHeatSubDomain?h.weekStartDay?"%B Week #%W":"%B [Week] [#] %U":null,onComplete:function(){setTimeout((function(){try{n.chartDataMapper&&(n.processChartThresholds(),n.resetCalHeatMap(h,m,s),n.hideFilteredData(h),n.setHeaderLabelStyle(n.options.chartId,n.domNode,s),n.iterateElements(n.options.chartId,n.domNode,l,h.calHeatDomain,h.calHeatSubDomain,null),n.setBackgroundColors(),n.postChartRendering(),n.endChartRendering())}catch(t){n.handleVizError(t)}}),600)}})},getChartDataMapper:function(){return this.chartDataMapper||(this.chartDataMapper=new o.chartDataMapperBase(this.data.getDataAsArray(),this.data.getTitles(),this.data.numAttributes,this)),this.chartDataMapper},replot:function(t){this.vizProps=t,this.renderChart(!0)},renderChart:function(t){var e=this.isAggregationRequired(t);if(this.getChartDataMapper(),this.options.isPercentageData=this.chartDataMapper.isMetricOfPercentageData(this.chartDataMapper.numAttributes),this.options.metricFormat=this.chartDataMapper.dataRows.metaInfo[this.chartDataMapper.numAttributes],this.options.weekStartDay=!0,i.locale("en"),n.locale("en"),!e&&this.heatmapData||(this.cleanUpGlobalData(),this.options.tooltipData={},this.dateFormatAttempts=0,this.newHeatMapData={},this.heatmapData=this.loadHeatmapData(),this.options.thresholdData=this.getThresholdData()),this.options.chartId="#"+vitaraD3.select(this.chartNode).attr("id"),vitaraJQ(this.chartNode).addClass("cal-heatmap-instance "+this.context.getUniqueChartStyle("name")),0===this.timeStampValues.length)throw new Error(r.utils.getCustomErrorCode("E0006"));this.calHeatMapRender(this.heatmapData.renderData,e,this.heatmapData.metricData),r.utils.setBackgroundImage(this.chartNode,vitaraJQ.extend({basePath:this.context.getBackgroundImagePath()},this.vizProps))},getThresholdData:function(){return new o.chartDataMapperBase(this.data.getDataAsArray(),this.data.getTitles(),this.data.numAttributes,this)},isAggregationRequired:function(t){var e=!1;return!0!==t?(this.chartDataMapper=null,this.options.dateFormat=null,e=!0,this.options.customDateFormat=this.vizProps.customDateFormat,this.options.metricFormat=null,this.options.arabic="hijri"==this.vizProps.calType):(void 0!==this.vizProps.calDomain&&this.options.calDomain!==this.vizProps.calDomain&&(e=!0),"0"!==this.vizProps.Week_Start_Day!=this.options.weekStartDay&&(e=!0),"string"==typeof this.vizProps.customDateFormat&&this.vizProps.customDateFormat!==this.options.customDateFormat&&(this.options.customDateFormat=this.vizProps.customDateFormat,e=!0),"string"==typeof this.vizProps.Input_Date_Format&&this.vizProps.Input_Date_Format!==this.options.Input_Date_Format&&(this.options.Input_Date_Format=this.vizProps.Input_Date_Format,e=!0),this.options.arabic!==("hijri"==this.vizProps.calType)&&(this.options.arabic="hijri"==this.vizProps.calType,e=!0)),e},cleanUpGlobalData:function(){this.heatmapData=null,this.options.tooltipData=null,this.options.thresholdData=null,this.unsortedtimeStampValues=null,this.timeStampValues=null,this.newHeatMapData=null},loadHeatmapData:function(){var t=this.createDateFormatArray(),e=this.chartDataMapper.dataRows,a={};if(this.timeStampValues=[],this.unsortedtimeStampValues={},0===this.dateFormatAttempts){var o=this.convertDate(e[0][0].t,t);if(void 0===o)throw new Error(r.utils.getCustomErrorCode("E0020"));if(this.options.dateFormat=o.creationData().format,i(e[0][0].t,this.options.dateFormat).format("YYYY")<n().format("iYYYY")){this.options.arabic=!0;var s=this.options.dateFormat.replace("D","iD");s=(s=s.replace("M","iM")).replace("Y","iY"),n(e[0][0].t,s).isValid()&&(this.options.dateFormat=s)}}for(var l={},h=0;h<e.length;h++)if(e[h][0].t&&""!=e[h][0].t&&"number"==typeof e[h][this.chartDataMapper.numAttributes].v){var u=this.convertDate(e[h][0].t,this.options.dateFormat);if(void 0===u)return this.newHeatMapData;var c=u.valueOf()/1e3;this.timeStampValues.push(c),this.unsortedtimeStampValues[c]=h,a[c]||(a[c]=0),a[c]+=e[h][this.chartDataMapper.numAttributes].v,this.chartDataMapper.numMetrics>1&&(l=this.aggregateTooltipMetricsData(c,e[h],l))}return{renderData:a,metricData:l}},getTitleForSubdomain:function(){return this.chartDataMapper.titles[this.chartDataMapper.numAttributes]},metricsDataForTooltip:function(t,e,a,n,o,s,l){var h=this,u=function(t,e,a,n){var o,r=null,s=i(t);if("week"===a){for(o in e)if((l=i(1e3*o)).isSame(s,n?"isoWeek":"week")){r=l.valueOf()/1e3;break}}else if("month"===a){for(o in e)if((l=i(1e3*o)).month()===s.month()){r=l.valueOf()/1e3;break}}else if("x_day"===a||"day"===a)for(o in e){var l=i(1e3*o);if(s.valueOf()===l.startOf("day").valueOf()){r=s.valueOf()/1e3;break}}return r},c=function(t){return"object"===m(t)?t.v:"number"==typeof t?t:""},p=function(t,e,a){if(D){var i="&amp;["+t+"]";D=D.split(i).join(e),""!==v&&function(t,e,a){var i=v.split(b).join(t);i=i.split(M).join(e),y+=i,a!==h.chartDataMapper.numColumns-1&&(y+="<br>")}(t,e,a),a===h.chartDataMapper.numAttributes&&(D=(D=(D=D.split("&amp;[point.value]").join(e)).split("&amp;[point.metricName]").join(t)).split("&amp;[point.metric]").join(t))}else g+=t+" : "+e,a==h.chartDataMapper.numAttributes?g+="&lt;hr&gt;":a!=h.chartDataMapper.numColumns-1&&(g+="&lt;br/&gt;")},d=function(){return""!==v&&(D=D.split(v).join(y)),D?(f(),r.utils.addMarkersIconsInTooltip(D)):g},f=function(){for(var t=h.vizProps.customTooltipcolstate,e=0;e<t.length;e++){var a="&amp;["+t[e].value+"]";D=D.split(a).join("")}},g="",D=this.vizProps.customTooltip,v="",y="";if(D){var b="&amp;[Metric Names]",M="&amp;[Metric Values]";!function(t){var e=t.indexOf(b),a=t.indexOf(M);if(-1===e&&(e=a),-1!==e){if(-1===a)a=e+b.length;else if(a<e){var i=a;a=e+b.length,e=i}else a+=M.length;v=t.substring(e,a)}}(D),D=(D=(D=D.split("&amp;["+this.chartDataMapper.titles[0]+"]").join(l)).split("&amp;[point.category]").join(l)).split("&amp;[Attribute Values]").join(l)}if(s&&("week"===n||"month"===n)){for(var w=this.chartDataMapper.numAttributes;w<this.chartDataMapper.numColumns;w++)p(C=this.chartDataMapper.titles[w],S=s[w]?r.utils.shortenNumber({rawVal:s[w].v,fv:s[w].fv},this.vizProps.dataLabelDisplayFormat):"",w);return d()}var x=a.indexOf(t/1e3);if(s=this.chartDataMapper.dataRows,-1!==x||"week"!==n&&"month"!==n||(t=u(t,this.options.tooltipData[this.chartDataMapper.numAttributes],n,this.weekStartDay),x=a.indexOf(t),t*=1e3),!o){for(w=this.chartDataMapper.numAttributes;w<this.chartDataMapper.numColumns;w++){var C=this.chartDataMapper.titles[w],S="";if(w===this.chartDataMapper.numAttributes)S=r.utils.shortenNumber({rawVal:e,fv:r.utils.formatMetricLike(e,s.metaInfo[w])},this.vizProps.dataLabelDisplayFormat);else if(this.options.tooltipData[w])if(this.options.tooltipData[w][t/1e3]){var _=c(this.options.tooltipData[w][t/1e3]);S=r.utils.shortenNumber({rawVal:_,fv:r.utils.formatMetricLike(_,s.metaInfo[w])},this.vizProps.dataLabelDisplayFormat)}else _=c(this.options.tooltipData[w][u(t,this.options.tooltipData[w],n,null)]),S=r.utils.shortenNumber({rawVal:_,fv:r.utils.formatMetricLike(_,s.metaInfo[w])},this.vizProps.dataLabelDisplayFormat);p(C,S,w)}return d()}w=this.chartDataMapper.numAttributes;var k=e;return this.options.tooltipData[w]&&(this.options.tooltipData[w][t/1e3]?k=c(this.options.tooltipData[w][t/1e3]):-1!==x&&(k=c(this.options.tooltipData[w][u(t,this.options.tooltipData[w],n,null)]))),g+=r.utils.shortenNumber({rawVal:k,fv:r.utils.formatMetricLike(k,s.metaInfo[w])},this.vizProps.dataLabelDisplayFormat)}});var f=d},651:function(t,e,a){a.r(e),a.d(e,{default:function(){return n}});var i=a(44),n=function(){function t(e,a){p(this,t),this.domNode=e,this.chartId=a,this.rootContainerNode=vitaraJQ(".cal-heatmap-container",vitaraJQ(a,e)),this.rootContainerNode.css("overflow","auto")}return d(t,[{key:"setColors",value:function(t,e,a){for(var i,n=1;n<=e.length+1;n++){i=vitaraD3.select(this.domNode).select(t).selectAll(".q"+n);var o=a[n-1]||"rgb(0, 0, 0)";i.attr("style","fill-opacity: 1;fill:"+o+";")}i=null}},{key:"resizeLayout",value:function(t,e,a,n,o){e=e||0;var r=vitaraJQ(".vitara-chart-container",this.domNode).width(),s=(vitaraJQ(".vitara-chart-container",this.domNode).height(),vitaraJQ("svg .graph-domain",vitaraJQ(this.chartId,this.domNode)));if(!(s.length<1)){var l=Number(s[0].getAttribute("height")),h=Number(s[0].getAttribute("width")),u=n.getDimensions(),c=u.width,p=u.height,m=u.includeLegendWidth,d=u.includeLegendHeight,f=u.xPos,g=u.yPos,D=!1,v=function(t,e,a){var i=0;return(m?a+t:a)>e?(i=a,D=!0):i=m?e-t:e,i}.call(this,c,r,h),y=function(e,a,n,o,r){var s;if("week"==t.calHeatSubDomain&&"month"==t.calHeatDomain){if(s=12,r.enable)var l=r.textStyle}else s=Math.floor(e/a);var h=0,u=0,c=0;return o.each((function(t,e){if(u>=s&&(u=0,h++),0===u&&l){var o=e.className.baseVal.split("_");c=i.utils.getTextDimensions(o[o.length-1],l.fontSize+"px",l.fontName).width+10,vitaraD3.select(this.domNode).select(this.chartId).select(".graph").append("text").attr("class","graph-label").attr("x",u*a+5).attr("y",h*n+n/2).attr("width",c).text(o[o.length-1])}e.setAttribute("y",h*n),e.setAttribute("x",u*a+c),u++})),[s,h+1,c]}.call(this,v,h,l,s,o),b=function(t,e){return t*e}.call(this,h,y[0]),M=function(t,e){return t*e}.call(this,l,y[1]);(function(t,e,a,i,n,o){var r=d?i+e:e,s=m?n+a:a;return D&&(s=m?a+n:a),r=r<i?i:r,s=s<n?n:s,this.rootContainerNode.attr("width",s),this.rootContainerNode.attr("height",r),[s,r]}).call(this,l,M,b+y[2],p,c,r),function(t,e){var a=f?t:0,i=g?e:0,n=vitaraJQ("svg .graph",vitaraJQ(this.chartId,this.domNode));n.attr("x",a),n.attr("y",i),n=null}.call(this,c,p),n.resetLegend(),this.rootContainerNode=null}}}]),t}()},646:function(t,e,a){a.r(e),a.d(e,{VitaraD3CalHeatMapChartMixin:function(){return u}}),a(1);var i=a(647),n=a(398),o=a(652),r=a(44),l=a(4),u=function(t){s(a,t);var e=h(a);function a(t){var i;return p(this,a),(i=e.call(this,t)).scriptClass="mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CalHeatMapChart",i.NAME="Vitara Calender Heatmap",i.cssClass="VitaraD3CalHeatMapChart",i.FEATURES=[],i.context=t,i.logEnvironmentInfo(),i}return d(a,[{key:"validateMinCriteria",value:function(t,e){if((isMSTRDashBoard()||isMSTRDesktop())&&this.zonesModel&&!isMSTRMobile()){var a=this.zonesModel.getZones();0==this.zonesModel.getDropZoneObjectsByName(a.COLOR_BY).length&&(e=0)}return{valid:e>0&&t>0,message:r.utils.getCustomErrorCode("E0028")}}},{key:"getThresholdMapper",value:function(){return this.thresholdMapper||(this.thresholdMapper=new o.default({context:this})),this.thresholdMapper}},{key:"enableUseAsFilter",value:function(){return!0}},{key:"getEditorName",value:function(){return"CalHeatMap"}},{key:"getSeriesElements",value:function(){var t=[];if(this.renderedChart&&this.renderedChart.dataContext&&this.renderedChart.dataContext.chartDataMapper)for(var e=this.renderedChart.dataContext.chartDataMapper.numAttributes,a=l.clone(this.renderedChart.dataContext.chartDataMapper.titles),i=a.splice(e,a.length-1),n=0;n<1;n++)t.push({name:i[n]});return t}},{key:"getPropMenuDefaults",value:function(){return{legendEnable:"1",legendCompact:"1",legendLayout:"horizontal",legendHAlignment:"center",legendVAlignment:"bottom",heatMapDefaultColor:this.defaultChartColors.heatmapColors[0],waffleLabelsEnable:"1"}}},{key:"getDefaultColors",value:function(){return l.cloneDeep(this.defaultChartColors.heatmapColors)}},{key:"handlePointSelection",value:function(t,e){var a=this.renderedChart;a&&a.dataContext&&a.dataContext.pointClickHandler&&a.dataContext.pointClickHandler({target:t.target,multiSelect:r.utils.isMultiEleSelect(t),reset:e})}},{key:"destroyChart",value:function(){if(this.renderedChart)try{this.renderedChart.root&&this.renderedChart.root.selectAll("*").remove(),this.renderedChart.dataContext=null,this.renderedChart.destroy&&(this.renderedChart=this.renderedChart.destroy()),vitaraJQ(".ch-tooltip",this.chartNode).remove(),this.renderedChart=null}catch(t){console.error(t)}}},{key:"destroyInstance",value:function(t){if(t)try{t.heatmapData=null,t.chartDataMapper=null,t.newHeatMapData=null,t.timeStampValues=null,t.unsortedtimeStampValues=null,t.options&&(t.options.agData=null,t.options.thresholdData=null,t.options.tooltipData=null),t=null}catch(t){console.error(t)}}},{key:"onPropMenuCreated",value:function(){this.context.renderedChart&&this.context.renderedChart.options?(this.setCalendarMenuOptions(this.context.renderedChart.options.arabic),this.setDateTypeFieldVisibility(this.context.vizProps.dataLabelType)):(this.setCalendarMenuOptions(!1),this.setDateTypeFieldVisibility())}},{key:"showPropMenuOnError",value:function(){return!0}},{key:"getSubDomain",value:function(){if(this.renderedChart&&this.renderedChart.options)return this.renderedChart.options.subDomain}},{key:"getFetchCalls",value:function(){var t=this;return{fetchCHMSubDomain:function(){return t.getSubDomain()}}}},{key:"vitaraPlot",value:function(t){try{t&&this.renderedChartInstance?this.renderedChartInstance.replot(this.vizProps):(this.renderedChartInstance&&this.destroyInstance(this.renderedChartInstance),this.renderedChartInstance=new i.default(this.dataHelper,this.position,this.domNode,this.vizProps,this.chartNode),this.renderedChartInstance.render())}catch(t){this.handleVizError(t)}}}]),a}(VitaraMix(n.default).with());window.VitaraD3CalHeatMapChartMixin=u},652:function(t,e,a){a.r(e),a.d(e,{default:function(){return i}});var i=function(t){s(a,t);var e=h(a);function a(){return p(this,a),e.apply(this,arguments)}return d(a,[{key:"setThreshold",value:function(t,e,a,i){var n=this,o=n.context.renderedChart.dataContext.chartDataMapper.getMetricFormatObject(i),r=function(t){return n.context.utils.formatLabel(t,o,n.context.vizProps.dataLabelDisplayFormat)},s=0,l=n.getSourceLabel(n.context.renderedChart.dataContext.chartDataMapper,i,a);if(e.length>0){vitaraD3.select(this.context.chartNode).selectAll(".graph").selectAll("g").each((function(t){if(null!==t.v&&n.context.renderedChart){var o=n.context.renderedChart.dataContext.options.tooltipData[i][t.t/1e3];if(o){var r=o.v;!r&&o[s]&&(r=o[s].v,s=1===s?0:1),-1!==e.indexOf(r)&&vitaraD3.select(this.childNodes[0]).style("fill",a.color)}}}));var h=a.condition;if(a.color&&("between"===h||"betweenpercentage"===h||"toppercentage"===h||"bottompercentage"===h||"lessthan"===h||"greaterthan"===h||"lessthanequalto"===h||"greaterthanequalto"===h)){this.context.legendOptions||(this.context.legendOptions={},this.context.legendOptions.colors=[],this.context.legendOptions.labels=[]),e.sort((function(t,e){return t-e})),this.context.legendOptions.colors.push(a.color);var u=this.context.renderedChartInstance.getChartDataMapper().isMetricOfPercentageData(i),c="between"===h?u?a.values[0]/100:a.values[0]:e[0],p="between"===h?u?a.values[1]/100:a.values[1]:e[e.length-1];this.context.legendOptions.labels.push(r(c)+" - "+r(p)+l)}}return t}},{key:"setDefaultColor",value:function(t){vitaraD3.select(this.context.chartNode).selectAll(".graph").selectAll("g").each((function(e){e.v&&vitaraD3.select(this.childNodes[0]).style("fill",t)}))}}]),a}(a(510).ThresholdMapperBase)}},u={};function c(t){var e=u[t];if(void 0!==e)return e.exports;var a=u[t]={id:t,loaded:!1,exports:{}};return l[t].call(a.exports,a,a.exports,c),a.loaded=!0,a.exports}c.m=l,c.amdO={},r=[],c.O=function(t,e,a,i){if(!e){var n=1/0;for(p=0;p<r.length;p++){for(var s=o(r[p],3),l=(e=s[0],a=s[1],i=s[2],!0),h=0;h<e.length;h++)(!1&i||n>=i)&&Object.keys(c.O).every((function(t){return c.O[t](e[h])}))?e.splice(h--,1):(l=!1,i<n&&(n=i));if(l){r.splice(p--,1);var u=a();void 0!==u&&(t=u)}}return t}i=i||0;for(var p=r.length;p>0&&r[p-1][2]>i;p--)r[p]=r[p-1];r[p]=[e,a,i]},c.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return c.d(e,{a:e}),e},c.d=function(t,e){for(var a in e)c.o(e,a)&&!c.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},c.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":g(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==("undefined"==typeof window?"undefined":g(window)))return window}}(),c.hmd=function(t){return(t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t={0:0};c.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,n,r=o(a,3),s=r[0],l=r[1],h=r[2],u=0;if(s.some((function(e){return 0!==t[e]}))){for(i in l)c.o(l,i)&&(c.m[i]=l[i]);if(h)var p=h(c)}for(e&&e(a);u<s.length;u++)n=s[u],c.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return c.O(p)},a=self.webpackChunkwebpack_latest=self.webpackChunkwebpack_latest||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var m=c.O(void 0,[34,33,35,36],(function(){return c(646)}));m=c.O(m)}()},2112:(t,e,a)=>{"use strict";var i=a(6486),n=(a(764),a(7049),a(6819)),o=a(9153);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,l(i.key),i)}}function l(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:String(e)}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,a){var i=u(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:a):n.value}}).apply(this,arguments)}function u(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}function c(t,e){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=d(t);if(e){var n=d(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return m(this,a)}}function m(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(r,t);var e,a,i,n=p(r);function r(t,e){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),a=n.call(this,t,e);var i=Object.getOwnPropertyNames(Object.getPrototypeOf(o.Z.prototype)),s={};return i.forEach((function(t){"function"==typeof o.Z.prototype[t]&&"constructor"!==t&&(s[t]=o.Z.prototype[t])})),Object.assign(r.prototype,s),a.setBaseContext(t),a.setEditorInterface(e),a}return e=r,(a=[{key:"setBaseContext",value:function(t){this.context=t}},{key:"setEditorInterface",value:function(t){this.eInterface=t}},{key:"onMenuSelected",value:function(t){if(h(d(r.prototype),"onMenuSelected",this).call(this,t),"Data Labels"===t.detail.name){var e=this.getBaseContext().getMenuElement("#popupdataLabelType");this.getBaseContext().propMenuHelper.setDateTypeFieldVisibility(e.val())}}},{key:"onCHMLabelTypeChange",value:function(t){this.getBaseContext().propMenuHelper.setDateTypeFieldVisibility(t.detail.value)}},{key:"setCustomEventHandlers",value:function(t){h(d(r.prototype),"setCustomEventHandlers",this).call(this),this.setEventHandler("onCHMLabelTypeChange",this.onCHMLabelTypeChange,this.saveAndEndBroadcast)}}])&&s(e.prototype,a),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),r}(o.Z),g=a(4089);function D(t){t&&this.setContext(t)}Object.assign(D.prototype,g.Z.prototype,{getCustomEventHandler:function(t,e){return new f(t,e)},getCustomFields:function(){return{seriesColors:{id:"seriesColors",type:"select",name:"seriesColors",class:"seriesColors",publish:"onSeriesColorsChange",options:this.getFieldDefs().getOptions().heatMapColorOptions}}},getCustomProperty:function(){return[this.AppearanceProperties(),this.BackgroundProperties(),this.LabelProperties(),this.LegendProperties(),this.TooltipProperties(),this.ThresholdsPropertiesType3(),this.DateFormatProperties(),this.SecurityProperties(),this.getAboutChartMenu()]},LabelProperties:function(){return{label:"Data Labels",id:"labels",containers:[{title:"",data:[{label:"Enable header labels",fields:["headerLabelsEnable"]},{label:"Horizontal Position",fields:["labelsAlign"]},{label:"Vertical Position",fields:["waffleLabelsVAlign"]},{label:"Label Style",fields:["labelItemStyleFontName","labelItemStyleFontSize","labelItemStyleBold","labelItemStyleItalic","labelItemStyleUnderline","labelItemStyleColor"]}]},{title:"",data:[{label:"Enable data labels",fields:["waffleLabelsEnable"]},{label:"Label Type",fields:["dataLabelType"]},{label:"Date Format",fields:["dateDisplayFormat"]},{label:"Format",fields:["dataLabelDisplayFormat"]},{label:"Label Style",fields:["textStyleFontName","textStyleFontSize","textStyleBold","textStyleItalic","textStyleUnderline","textStyleColor"]}]}]}}}),a.g.vitaraLD||(a.g.vitaraLD=i),mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CalHeatMapChart=mstrmojo.declare(n.Z,[],{scriptClass:"mstrmojo.plugins.VitaraCharts.v533169.VitaraD3CalHeatMapChart",cssClass:"VitaraD3CalHeatMapChart",getVisualInstance:function(){return this.visualInstance||(this.visualInstance=new VitaraD3CalHeatMapChartMixin(this),this.visualInstance.updateVisualProps=this.updateVisualProps),this.visualInstance},getEditorName:function(){return"CalHeatMap"},getEditor:function(t){return this.propsEditor||(this.propsEditor=new D(t)),this.propsEditor},validateMinCriteria:function(t,e){if((isMSTRDashBoard()||isMSTRDesktop())&&this.zonesModel&&!isMSTRMobile()){var a=this.zonesModel.getZones();0==this.zonesModel.getDropZoneObjectsByName(a.COLOR_BY).length&&(e=0)}return{valid:e>0&&t>0,message:this.getUtils().getCustomErrorCode("E0028")}},addContextMenuToDataPoints:function(){},getPropertyKey:function(t){return"DataLabel"===t||"datalabel"===t?"waffleLabelsEnable":this._super(t)}})}},a={};function i(t){var n=a[t];if(void 0!==n)return n.exports;var o=a[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=e,t=[],i.O=(e,a,n,o)=>{if(!a){var r=1/0;for(u=0;u<t.length;u++){for(var[a,n,o]=t[u],s=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(i.O).every(t=>i.O[t](a[l]))?a.splice(l--,1):(s=!1,o<r&&(r=o));if(s){t.splice(u--,1);var h=n();void 0!==h&&(e=h)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,n,o]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={292:0};i.O.j=e=>0===t[e];var e=(e,a)=>{var n,o,[r,s,l]=a,h=0;if(r.some(e=>0!==t[e])){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(l)var u=l(i)}for(e&&e(a);h<r.length;h++)o=r[h],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(u)},a=self.webpackChunkVitaraCharts_MicroStrategy=self.webpackChunkVitaraCharts_MicroStrategy||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})();var n=i.O(void 0,[445,272,89],()=>i(2112));n=i.O(n)})();
