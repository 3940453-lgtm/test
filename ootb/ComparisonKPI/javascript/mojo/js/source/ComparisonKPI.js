(()=>{"use strict";mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});const t={LIGHT:{AREA:"#FFFFFF",TREND:"#D2D2D2",TREND_OPACITY:"40",FONT:"#35383A"},NIGHT:{AREA:"#313855",TREND:"#539CAE",TREND_OPACITY:"100",FONT:"#FFFFFF"},DESERT:{AREA:"#606060",TREND:"#FFD333",TREND_OPACITY:"100",FONT:"#FFFFFF"},OCEAN:{AREA:"#5181D7",TREND:"#83C8F4",TREND_OPACITY:"100",FONT:"#FFFFFF"}},e={INCREASE:"#83C962",DECREASE:"#DB6657",CONSTANT:"#606060"},n={LIGHT:"#FFFFFF",NIGHT:"#4D4D4D"},r="#CA3D40";mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var o={METRICS:0,BREAK_BY:1,TREND:2},a={METRICS:0,COMPARE_WITH:1,BREAK_BY:2,TREND:3},i=function(t){return 0===t?o:a};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var l="N/A",c="1",u="referenceLineLabel",s="previousValueLabel",d="removeWidgetString";function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function h(t,e,n){return(e=function(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var y={TEXT_CONTENT_TYPE:{ALL:"all",LABEL:"label",PRIMARY_VALUE:"primaryValue",SECONDARY_VALUE:"secondaryValue",INDICATOR:"indicator"},TREND_SHAPE:{AREA:"area",BAR:"bar",LINE:"line"},AXIS_SCALE:{GLOBAL:"global",SYNCED_METRIC:"synced",SYNCED_ALL:"syncedAll"},CARD_ALIGNMENT:{LEFT:"left",MIDDLE:"middle",RIGHT:"right"},TREND_INDICATOR_SHAPE:{BADGE:"badge",ARROW:"arrow"},TREND_INDICATOR_VALUE_TYPE:{PERCENT:"percentValue",NUMERIC:"numericValue"},SELECTED_REFERENCE_LINE_SHAPE:{DOTTED_LINE_TYPE:"1pt dotted",DASHED_LINE_TYPE:"1pt dashed",THIN_LINE_TYPE:"1pt solid",THICK_LINE_TYPE:"2pt solid"},REFERENCE_LINE_DEFAULT_VALUES:{font:{fontFamily:"Open Sans",style:[!1,!1,!1,!1],size:9,color:"#35383A"},line:{shape:"1pt dashed",color:"#4D4D4D"}},LAYOUT_TYPES:{GRID:0,STACKED:1,HORIZONTAL:2,VERTICAL:3},TEXT_SIZE_TYPE:{UNIFIED:0,FIT_TO_CONTAINER:1,FIXED:2},FIRST_CARD_INDEX:1},v={fontFamily:"Open Sans",fontStyle:[!1,!1,!1,!1],fontSteps:0,fontSize:""},g={HIDEABLE_SECTION_TEMPLATE:{name:"hideableSectionTemplate",defaultValue:null},CARD_STYLE:{name:"cardStyle",defaultValue:0},HIDEABLE_SECTION_LAYOUT:{name:"hideableSectionLayout",defaultValue:null},LAYOUT_TYPE:{name:"layoutType",defaultValue:y.LAYOUT_TYPES.GRID},GRID_LAYOUT_PROPERTIES:{name:"gridLayoutProperties",defaultValue:null},GRID_COLUMN_COUNT:{name:"gridColumnCount",defaultValue:4},GRID_FIX_CARD_HEIGHT:{name:"gridFixCardHeight",defaultValue:null},GRID_FIX_CARD_HEIGHT_ENABLED:{name:"gridFixCardHeightEnabled",defaultValue:!1},STACKED_LAYOUT_PROPERTIES:{name:"stackedLayoutProperties",defaultValue:null},STACKED_AUTO_PLAY:{name:"stackedAutoPlay",defaultValue:!0},SHOW_METRIC_NAME:{name:"showMetricName",defaultValue:null},SECONDARY_VALUE_LAYOUT:{name:"secondaryValueLayout",defaultValue:null},SECONDARY_METRIC_NAME:{name:"secondaryMetricName",defaultValue:""},TREND_INDICATOR_LAYOUT:{name:"trendIndicatorLayout",defaultValue:null},TREND_INDICATOR_ENABLED:{name:"trendIndicatorEnabled",defaultValue:!0},TREND_INDICATOR_ENABLED_LABEL:{name:"trendIndicatorEnabledLabel",defaultValue:""},COMPARISON_INDICATOR_ENABLED:{name:"comparisonIndicatorEnabled",defaultValue:!0},COMPARISON_INDICATOR_ENABLED_LABEL:{name:"comparisonIndicatorEnabledLabel",defaultValue:""},TREND_INDICATOR_VALUE_TYPE:{name:"trendIndicatorValueType",defaultValue:y.TREND_INDICATOR_VALUE_TYPE.PERCENT},ENTIRE_CHART_SECTION:{name:"entireChartSection",defaultValue:null},TEXT_SIZE_TYPE:{name:"textSizeType",defaultValue:y.TEXT_SIZE_TYPE.UNIFIED},SHAPE_SECTION:{name:"shapeSection",defaultValue:null},SHAPE_TYPE:{name:"shapeType",defaultValue:0},SHAPE_TYPE_COMPARISON:{name:"shapeTypeComparison",defaultValue:0},SHAPE_TYPE_COMPARISON_NO_TREND:{name:"shapeTypeComparisonNoTrend",defaultValue:0},BACKGROUND_SHAPE_AREA_SECTION:{name:"backgroundShapeAreaSection",defaultValue:null},THRESHOLDS_SECTION:{name:"colorThresholdsSection",defaultValue:{thresholds:[]}},TEXT_CONTENT_TYPE:{name:"textContentType",defaultValue:y.TEXT_CONTENT_TYPE.ALL},TEXT_CONTENT_TYPE_COMPARISON:{name:"textContentTypeComparison",defaultValue:y.TEXT_CONTENT_TYPE.ALL},FONT_FAMILY:{name:"fontFamily",defaultValue:v.fontFamily},FONT_STYLE:{name:"fontStyle",defaultValue:[!1,!1,!1,!1]},FONT_STEPS:{name:"fontSteps",defaultValue:0},FONT_SIZE:{name:"fontSize",defaultValue:""},FONT_COLOR:{name:"fontColor",defaultValue:t.LIGHT.FONT},TEXT_ALL_FONT_OPTIONS:{name:"allFontOptions",defaultValue:m(m({},v),{},{fontColor:"INDETERMINATE"})},TEXT_LABEL_FONT_OPTIONS:{name:"labelFontOptions",defaultValue:m(m({},v),{},{fontColor:t.LIGHT.FONT})},TEXT_PRIMARY_VALUE_FONT_OPTIONS:{name:"primaryValueFontOptions",defaultValue:m(m({},v),{},{fontColor:t.LIGHT.FONT})},TEXT_SECONDARY_VALUE_FONT_OPTIONS:{name:"secondaryValueFontOptions",defaultValue:m(m({},v),{},{fontStyle:[!0,!0,!1,!1],fontColor:t.LIGHT.FONT})},TEXT_INDICATOR_FONT_OPTIONS:{name:"indicatorFontOptions",defaultValue:m(m({},v),{},{fontColor:t.NIGHT.FONT})},AREA_FILL_COLOR:{name:"areaFillColor",defaultValue:t.LIGHT.AREA},AREA_FILL_OPACITY:{name:"areaFillOpacity",defaultValue:100},TREND_FILL_COLOR:{name:"trendFillColor",defaultValue:t.LIGHT.TREND},TREND_FILL_OPACITY:{name:"trendFillOpacity",defaultValue:t.LIGHT.TREND_OPACITY},TREND_INCREASE_BACKGROUND_COLOR:{name:"trendIncreaseBackgroundColor",defaultValue:e.INCREASE},TREND_DECREASE_BACKGROUND_COLOR:{name:"trendDecreaseBackgroundColor",defaultValue:e.DECREASE},HIDEABLE_SECTION_TREND_SHAPE:{name:"hideableSectionTrendShape",defaultValue:null},TREND_SHAPE:{name:"trendShape",defaultValue:y.TREND_SHAPE.AREA},AXIS_SCALE:{name:"axisScale",defaultValue:y.AXIS_SCALE.GLOBAL},AXIS_SCALE_COMPARISON:{name:"axisScaleComparison",defaultValue:y.AXIS_SCALE.GLOBAL},EMPTY_VIZ_WARNING_MESSAGE:{name:"emptyVizWarningMessage",defaultValue:null},VIZ_FIRST_TAB_SECTION:{name:"vizFirstTabSection",defaultValue:null},VIZ_SECOND_TAB_SECTION:{name:"vizSecondTabSection",defaultValue:null},CARD_ALIGNMENT:{name:"cardAlignment",defaultValue:""},TREND_INDICATOR_SHAPE_LAYOUT:{name:"trendIndicatorShapeLayout",defaultValue:""},TREND_INDICATOR_SHAPE:{name:"trendIndicatorShape",defaultValue:y.TREND_INDICATOR_SHAPE.BADGE},TREND_CONSTANT_BACKGROUND_COLOR:{name:"trendConstantBackgroundColor",defaultValue:e.CONSTANT},DOSSIER_FONT:{name:"dossierFont",defaultValue:""},HIDEABLE_SECTION_REFERENCE_LINES:{name:"hideableSectionReferenceLines",defaultValue:null},SELECTED_REFERENCE_LINE:{name:"selectedReferenceLine",defaultValue:""},REFERENCE_LINE_CONSTANT_VALUE:{name:"referenceLineConstantValue",defaultValue:""},REFERENCE_LINE_LABEL:{name:"referenceLineLabel",defaultValue:""},CREATED_REFERENCE_LINES:{name:"createdReferenceLines",defaultValue:{}},REFERENCE_LINE_CONSTANT_VALUE_WARNING:{name:"referenceLineConstantValueWarning",defaultValue:null},REFERENCE_LINES_SECTION:{name:"referenceLinesSection",defaultValue:null},TEXT_AND_FORM_DROPDOWN_WITH_REFERENCE_LINES:{name:"textAndFormDropdownWithReferenceLines",defaultValue:0},TEXT_AND_FORM_DROPDOWN_WITHOUT_REFERENCE_LINES:{name:"textAndFormDropdownWithoutReferenceLines",defaultValue:0},SELECTED_REFERENCE_LINE_TEXT_AND_FORM:{name:"selectedReferenceLineTextAndForm",defaultValue:""},SELECTED_REFERENCE_LINE_FONT_NAME:{name:"selectedReferenceLineFontName",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.fontFamily},SELECTED_REFERENCE_LINE_FONT_STYLE:{name:"selectedReferenceLineFontStyle",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.style},SELECTED_REFERENCE_LINE_FONT_SIZE:{name:"selectedReferenceLineFontSize",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.size},SELECTED_REFERENCE_LINE_FONT_COLOR:{name:"selectedReferenceLineFontColor",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.color},SELECTED_REFERENCE_LINE_COLOR:{name:"selectedReferenceLineColor",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.line.color},SELECTED_REFERENCE_LINE_SHAPE:{name:"selectedReferenceLineShape",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.line.shape},ACTIVE_CARD_INDEX:{name:"activeCardIndex",defaultValue:y.FIRST_CARD_INDEX},SECONDARY_METRIC_NAME_LABEL:{name:"secondaryMetricNameLabel",defaultValue:null},SECONDARY_METRIC_NAME_LABEL_COMPARISON:{name:"secondaryMetricNameLabelComparison",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL:{name:"trendIncreaseBackgroundColorLabel",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendIncreaseBackgroundColorLabelComparison",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL:{name:"trendDecreaseBackgroundColorLabel",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendDecreaseBackgroundColorLabelComparison",defaultValue:null}};function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var _={};function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}Object.entries(g).forEach(function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1].name;_[o]=a}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var C="properties",I=[C],A=function(t){"object"===E(t)?Object.values(t).forEach(function(t){A(t)}):Array.isArray(t)?t.forEach(function(t){A(t)}):I.push(t)};function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function w(t,e,n){return(e=function(t){var e=function(t){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t,e){if(t){if("string"==typeof t)return N(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}A(_),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var x=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length>0},D=function(t){var e=t.partialValue,n=t.totalValue;return mstrmojo.num.format(4,1,"",Math.abs(e/n))},M=function(t,e){var n=t.fontFamily,r=t.fontColor,o=t.fontSize,a=t.fontStyle,i=P(e),l=e.getProperty(g.DOSSIER_FONT.name),c=!1;l&&l!==i&&(c=!0);var u,s,d,f,p,m,h,y,v=c?i:n,b=e.isIOS&&"Open Sans"===v?"Helvetica":v,_="16px";return o&&"string"==typeof o&&o.indexOf("px")>0?_=o:o&&(_="".concat(L(o),"px")),function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach(function(e){w(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({fontSize:_,fontFamily:b,color:r},(y=4,u=function(t){if(Array.isArray(t))return t}(h=a)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(h,y)||O(h,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=u[0],d=u[1],f=u[2],p=u[3],m=[],f&&m.push("underline"),p&&m.push("line-through"),{fontWeight:s?"bold":"normal",fontStyle:d?"italic":"normal",textDecoration:m.join(" ")||"none currentcolor solid"}))},P=function(t){var e,n=null===(e=t.controller.model)||void 0===e?void 0:e.defmts.find(function(t){return"Text"===t.n});return(null==n?void 0:n.props.FormattingFont.Name)||t.getProperty(g.FONT_FAMILY.name)},R=function(t,e){var n=e<=1?e:e/100;return"rgba(".concat(parseInt(t.slice(1,3),16),",").concat(parseInt(t.slice(3,5),16),",").concat(parseInt(t.slice(5,7),16),", ").concat(n,")")},L=function(t){return 1.328147*t},j=function(t){var e=t.container,n=t.maxTextWidth,r=t.textData,o=t.fontSize,a=t.fontStyle,i=r.label,l=r.value,u=r.connector,s=i+u+l;if(e.title=s,e.style.fontSize="".concat(o,"px"),""===i)return e.textContent=l,{truncatedLabelAndValue:l,truncatedLabel:""};var d,f,p="...".concat(u);if(f=i[0]+p,mstrmojo.VisUtility.measureTextWidth(d+c,a,a.bonus)>=n)e.style.overflow="hidden",e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",e.textContent=l,f="";else{for(var m=2;m<i.length;m++)if(d=i.substring(0,m)+p+l,mstrmojo.VisUtility.measureTextWidth(d+c,a,a.bonus)>=n){f=i.substring(0,m-1)+p;break}d=f+l,e.textContent=d}return{truncatedLabelWithValue:e.textContent,truncatedLabel:f}},V=function(t){return.75292857248934*t},F=function(t){var e=parseInt(t)/Math.sqrt(2);return e+.1*e},k=function(t,e){var n=t.textContent,r=B(t,e);return mstrmojo.VisUtility.measureTextSize(n+c,r,0)},B=function(t,e){var n=mstrmojo.css.getComputedStyle(t);return{fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontSize:"".concat(parseInt(e),"px"),fontWeight:n.fontWeight,lineHeight:1,bonus:parseInt(n.paddingLeft)+parseInt(n.paddingRight)}},K=function(t,e,n){t.forEach(function(t){t.style[e]=n})},H=function(t){setTimeout(function(){var e,n;null===(e=(n=window).syncDossierFormatPanel)||void 0===e||e.call(n,t)},0)};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),_.EMPTY_VIZ_WARNING_MESSAGE;var Y=function(t){var e=i(t.KPIType);return t.isComparisonKPI&&x(t,e.COMPARE_WITH)};function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var G=function(t,e){for(var n={},r=function(){var r,l,c=(r=a[o],l=1,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(r,l)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(t,e):void 0}}(r,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],d=t[c],f=i(e.KPIType);switch(c){case g.SHOW_METRIC_NAME.name:if(null===d){var p=x(e,f.BREAK_BY),m=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length}(e,f.METRICS)>1;d=!p||m,e.showMetricName=d,H([c])}break;case g.CARD_ALIGNMENT.name:if(!d){var h=x(e,f.TREND);d=h?y.CARD_ALIGNMENT.LEFT:y.CARD_ALIGNMENT.MIDDLE,e.cardAlignment=d,H([c])}break;case g.SECONDARY_METRIC_NAME.name:var v,b,E=e.isComparisonKPI,C=e.isRealTime,I=e.timestampIndex,A=e.timeFilter,S=e.dataInterface,T=e.data,w=null==S||null===(v=S.data)||void 0===v||null===(b=v.wdgstrs)||void 0===b?void 0:b[s];if(d&&C&&E&&(x(e,f.COMPARE_WITH)||(d=null)),w&&!e.labelsEditState[c]&&(d=w,n[c]=d),!d){var O=E&&x(e,f.COMPARE_WITH),N=x(e,f.TREND);if(O){var D=C?S.data.gsi.mx[1].n:S.getColHeaders(0).getHeader(1).getName();d="".concat(mstrmojo.descP("KPI.","39","Compare with")," ").concat(D)}else if(N){var M=x(e,f.BREAK_BY)?1:0;if(C)if(A.isMoreDataThanFilter)d="".concat(A.filterLabel," ago");else{var P=new Date(T[0].cells[I].v).toTimeString().split(" ").shift();d="Compare to ".concat(P)}else d="".concat(mstrmojo.descP("KPI.","36","Previous")," ").concat(e.dataInterface.getRowTitles().getTitle(M).getName())}e.secondaryMetricName=d,H([c])}break;case g.CREATED_REFERENCE_LINES.name:if(!d)break;var R=function(t,e){var n=e[_.SELECTED_REFERENCE_LINE];if(!n){var r,o,a=null===(r=t.dataInterface.getColTitles().titles[0])||void 0===r?void 0:r.es.map(function(t){return{n:t.n,dssid:t.oid}});null!=a&&a.find(function(t){return t.dssid===n})&&!t.isComparisonKPI||(n=null==a||null===(o=a[0])||void 0===o?void 0:o.dssid)}return n}(e,t),L=g.REFERENCE_LINE_LABEL.name;Object.keys(d).forEach(function(r){var o=function(t,e,n){var r,o;return null===(r=t.model.data.gsi.mx.find(function(t){return t.did===e}))||void 0===r||null===(o=r.wdgstrs)||void 0===o?void 0:o[n]}(e,r,u);o&&!e.labelsEditState[r]&&(d[r].label=o,n[c]=d,R===r&&(t[L]=o,n[L]=o))})}t[c]=d},o=0,a=Object.entries(t);o<a.length;o++)r();return Object.keys(n).length&&function(t,e){var n=JSON.parse(t.getProperty(C));Object.keys(e).forEach(function(t){n[t]=e[t]}),t.getProperties()[C]=JSON.stringify(n)}(e,n),t};function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function W(t,e,n){return(e=function(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){if(t){if("string"==typeof t)return Z(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var J=function(t){if(!t)return!0;var e=t.color,n=t.range;return!(e||null!=n&&n.value)},Q=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return t.forEach(function(t){var r=t.nfs,o=t.id,a=(r||"General").split(";").map(function(t){return function(t){var e,n=["black","blue","cyan","green","magenta","red","white","yellow"],r={range:{check:function(t){return!0}},color:void 0,formatString:t.slice(t.lastIndexOf("]")+1)},o=(e=t.matchAll(/\[([A-Za-z0-9<>=-]+)\]/g),function(t){if(Array.isArray(t))return Z(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(t){return t[1]});return o&&o.forEach(function(t){if(n.includes(t.toLowerCase()))r.color=t.toLowerCase();else{var e=Number.parseFloat(t.split(/[^0-9-,.]/).join(""));r.range.value=e,0===t.search(">")?(r.range.compareType=0,1===t.search("=")?r.range.check=function(t){return t>=e}:r.range.check=function(t){return t>e}):0===t.search("<")?(r.range.compareType=1,1===t.search("=")?r.range.check=function(t){return t<=e}:r.range.check=function(t){return t<e}):0===t.search("=")&&(r.range.check=function(t){return t===e})}}),r}(t)}),i=o;!function(t){t.length>1&&void 0===t[0].range.value&&(t[0].range={value:0,check:function(t){return t>=0}},t[1]&&void 0===t[1].range.value&&(t[1].range={value:0,check:function(t){return t<0}}),t[2]&&void 0===t[2].range.value&&(t[2].range={value:0,check:function(t){return 0===t}},t[0].range={check:function(t){return t>0}}))}(a),a.forEach(function(t){t.rules=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=mstrmojo.locales.number,r=n.THOUSANDSEPARATOR,o={thousandSeparator:"",decimalSeparator:n.DECIMALSEPARATOR,minimalIntegerLength:1,maximalFractionLength:0,minimalFractionLength:0,divisor:1,prefix:"",suffix:"",shouldLeadingZeroBeOmitted:!1},a=/"(.*?)"/g.exec(t);if(a){var i=t.search(/[#0]/);if(0!==a.length){if(a.index<i){var l=X(a,2);o.prefix=l[1]}else{var c=X(a,2);o.suffix=c[1]}a.forEach(function(e){t=t.replace(e,"")})}}for("%"===t.slice(-1)&&(o.divisor*=.01,o.suffix+=e?"%":"pp",t=t.slice(0,-1));","===t.slice(-1);)o.divisor*=1e3,t=t.slice(0,-1);t.includes(",")&&(o.thousandSeparator=r),t.includes("(")&&t.includes(")")?(o.prefix="(".concat(o.prefix),o.suffix+=")","%)"===t.slice(-2)&&(t=t.slice(0,-2),t+=")",o.divisor*=.01,o.suffix+="pp")):t.includes("-")&&(o.prefix="-".concat(o.prefix));var u=t.split(".");if(2===u.length){var s=X(u,2),d=s[0],f=s[1],p=d.match(/[0]/g);p&&(o.minimalIntegerLength=p.length),o.maximalFractionLength=f.match(/[0#]/g).length;var m=f.match(/[0]/g);m&&(o.minimalFractionLength=m.length),1===d.length&&"#"===d&&(o.shouldLeadingZeroBeOmitted=!0)}return o}(t.formatString,e)}),n[i]=a}),n},tt=function(t,e,n){var r=Number.isNaN(Number(t))?0:Number(t);return function(t,e){var n=e.color,r=e.rules,o=r.maximalFractionLength,a=r.minimalIntegerLength,i=r.minimalFractionLength,l=r.thousandSeparator,c=r.decimalSeparator,u=r.prefix,s=r.suffix,d=r.shouldLeadingZeroBeOmitted,f=r.divisor,p=t<0,m=Math.abs(t)/f,h=function(t,e,n){if(e===n)return e;var r=parseFloat(Number(t).toFixed(n)).toString().split(".")[1];return r&&r.length>e?r.length:e}(t,i,o),y=m.toFixed(h);if(d&&m<1)y=y.slice(1);else{var v=Math.pow(10,a);m<v-1&&(y=(parseFloat(y)+v).toFixed(h).slice(1))}var g=y.split(".");return g[0]=g[0].replace(/\B(?=(\d{3})+(?!\d))/g,l),y=g.join(c),!p||r.prefix.includes("(")||r.prefix.includes("-")||(y="-".concat(y)),{formattedValue:"".concat(u).concat(y).concat(s),color:n}}(r,function(t,e){var n=e.filter(function(e){return e.range.check(t)});return n.length>1?function(t,e){if(t>=0)return!1;if(e.length<=1)return!1;var n=e.filter(function(t){return!J(t)});return n.length>0&&n.every(function(t){var e;return 1===(null===(e=t.range)||void 0===e?void 0:e.compareType)})}(t,n)?n.find(function(t){return!J(t)}):n.reduce(function(t,e){return e.range.value&&t.range.value?e.range.value>t.range.value?e:t:e.range.value?e:t}):n[0]}(r,n[e]))};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach(function(e){at(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ot(t){return function(t){if(Array.isArray(t))return lt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||it(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(t,e,n){return(e=function(t){var e=function(t){if("object"!=et(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function it(t,e){if(t){if("string"==typeof t)return lt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var ct=function(t,e,n){if(e.isRealTime){t=t.map(function(t){return ut(t.cells,e)});var r=st(e);e.mappedIndexes=r}var o=x(e,n.TREND),a=x(e,n.BREAK_BY),i=t[0].values.map(function(){return a?new Map:[]}),l=e.isComparisonKPI,c=e.timestampIndex,u=e.isRealTime,s=e.model;return t.forEach(function(t,r){var d,f,p,m,h,y;if(!mt(t)){if(a){var v,g,b,_,E=t.headers[0];d=E.attributeSelector,f=d.eid,p=E.name,m=null==E||null===(v=E.headerObj)||void 0===v||null===(g=v.t)||void 0===g||null===(b=g.fs)||void 0===b||null===(_=b[0])||void 0===_?void 0:_.bftp}else if(o){var C=t.headers[0];d=C.attributeSelector}if(o){var I,A,S,T,w,O,N,x,D=t.headers;h=a?null===(I=D[1])||void 0===I||null===(A=I.headerObj)||void 0===A||null===(S=A.t)||void 0===S||null===(T=S.fs[0])||void 0===T?void 0:T.bftp:null===(w=D[0])||void 0===w||null===(O=w.headerObj)||void 0===O||null===(N=O.t)||void 0===N||null===(x=N.fs[0])||void 0===x?void 0:x.bftp}t.values.forEach(function(v,g){var b,_,E,C,I,A,S,T=v.name,w=v.rv,O=v.v,N=v.id;if(1!==g||!l){y=(null==s||null===(b=s.getFullObjectInfo)||void 0===b||null===(_=b.call(s,N))||void 0===_?void 0:_.mft)||(null==s||null===(E=s.docModel)||void 0===E||null===(C=E.getObjectInfo)||void 0===C||null===(I=C.call(E,N))||void 0===I?void 0:I.mft)||(null==s||null===(A=s.getObjectInfo)||void 0===A||null===(S=A.call(s,N))||void 0===S?void 0:S.mft);var x,D,M=a?i[g].get(f):i[g][0];if(l&&(D=(x=t.values[1]||null)?{raw:x.rv,formatted:x.v}:null),M){if(o){var P=Object.keys(t.metricSelector),R={raw:w,formatted:O,graphicModel:ft(d,t.idValueMapping,P,N)};u&&(R.timestamp=e.data[r].cells[c].v,R.timestampDate=new Date(R.timestamp)),M.trendChartData.push(R)}l&&(M.compareMetricValue=D)}else{var L;if(o){var j=Object.keys(t.metricSelector);L=[{raw:w,formatted:O,graphicModel:ft(d,t.idValueMapping,j,N)}],u&&(L[0].timestamp=e.data[r].cells[c].v,L[0].timestampDate=new Date(L[0].timestamp))}else L=[{raw:w,formatted:O}];var V,F={metricId:N,graphicModel:pt(d,N,e,t,n),label:{withMetricName:p?"".concat(T," - ").concat(p):T,withoutMetricName:p||""},trendChartData:L,breakByAttributeName:p,breakByAttributeFormType:m,trendAttributeFormType:h,metricFormType:y};l&&(F.compareMetricId=(null===(V=x)||void 0===V?void 0:V.id)||null,F.compareMetricValue=D),a?i[g].set(f,F):i[g].push(F)}}})}}),a?i.map(function(t){return function(t){return function(t){if(Array.isArray(t))return N(t)}(e=t.values())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e}(t)}):i},ut=function(t,e){var n=e.isComparisonKPI,r=e.dataInterface.data.realtimeQueryInfo.columns,o={};r.forEach(function(t,e){o[t.id]=e});var a=-1,l=[],c=[],u={},s={},d=i(e.KPIType);if(e.zonesModel.getDropZoneObjectsByIndex(d.TREND).forEach(function(e){var n=o[e.id];a=n,u[e.id]=t[n].v,s[e.id]={}}),e.zonesModel.getDropZoneObjectsByIndex(d.BREAK_BY).forEach(function(e){var n=o[e.id];a=n,u[e.id]=t[n].v,s[e.id]={}}),a>=0){var f=r[a].id,p=t[a].v,m="".concat(p,";").concat(f);l.push({name:p,attributeSelector:{n:p,tid:f,eid:m,isSelectAttr:!0}})}var h,y=e.zonesModel.getDropZoneObjectsByIndex(d.METRICS);return n&&Y(e)&&y.push(null===(h=e.zonesModel)||void 0===h?void 0:h.getDropZoneObjectsByIndex(d.COMPARE_WITH)[0]),e.getDocModel(),y.forEach(function(n,r){var a=o[n.id];u[n.id]=tt(t[a].v,n.id,e.metricFormattingRules).formattedValue;var i=e.dataInterface.data.gsi.mx[r].n;c.push({v:u[n.id],rv:t[a].v,id:n.id,name:i})}),{headers:l,values:c,idValueMapping:u,metricSelector:s}},st=function(t){var e=t.dataInterface.data.realtimeQueryInfo.columns,n=[];return e.forEach(function(t){-1===t.bfid&&n.push(t.id)}),Object.keys(n).reduce(function(t,e){return t[n[e]]=parseInt(e),t},{})},dt=function(t,e,n){var r=e.colorThresholdsSection.thresholds,o=ot(t).sort(function(t,e){return t.primaryValue.raw-e.primaryValue.raw}),a=ot(t).sort(function(t,e){return e.primaryValue.raw-t.primaryValue.raw}),i=r.map(function(t){t.skip=!1;var e=t.advancedThreshold;if(e&&2===e.thresholdType){var n,r=null!==(n=e.rank)&&void 0!==n?n:"0",i=2===e.rankOption?o:a,l=function(t,e){return"%"===t.slice(-1)?Number(t.slice(0,-1))*e*.01:Number(t)}(r,i.length);if(l<1)return rt(rt({},t),{},{skip:!0});var c=function(t,e,n){var r=[];return t.forEach(function(t,n){if(n<=e-1){var o=t.trendChartData;r.push(o[o.length-1].raw)}}),2===n?{minValue:r[0],maxValue:r[r.length-1]}:{minValue:r[r.length-1],maxValue:r[0]}}(i,l,e.rankOption),u=c.minValue,s=c.maxValue;return rt(rt({},t),{},{min:u,max:s})}return t.min||t.max?t:rt(rt({},t),{},{min:0,max:0})}),l=function(t){return"%"==="".concat(t).slice(-1)?.01*Number(t.slice(0,-1)):t},c=function(e,r){var o=at(at(at(at(at(at(at({},2,null),3,null),4,null),5,null),6,null),7,null),8,null);return i.filter(function(o){var a=o.enabled,i=o.skip,c=o.advancedThreshold;if(!a)return!1;if(c&&3===c.thresholdType)return function(e,r){if(!n)return!1;var o=function(e){return ot(t).filter(function(t){if(t.indicator){var n=Math.sign(t.indicator.differenceBetweenPrimaryAndSecondary);return 1===e?n>0:n<0}return!1})}(e);return 0!==o.length&&o.some(function(t){return t.graphicModel.cardId===r})}(c.indicator,r);var u=parseFloat(l(o.min)||Number.NEGATIVE_INFINITY),s=parseFloat(l(o.max)||Number.POSITIVE_INFINITY);return u<=e&&s>=e&&!i}).reverse().forEach(function(t){var e=t.advancedThreshold,n=t.color;if(e){var r=e.selector,a=e.colors;1===r&&function(t,e,n,r){var o,a,i,l,c=void 0===n[1]||"INDETERMINATE"===n[1]?null:n[1];t[2]=rt(rt({},e),{},{color:null!==(o=null!=c?c:n[2])&&void 0!==o?o:r}),t[3]=rt(rt({},e),{},{color:null!==(a=null!=c?c:n[3])&&void 0!==a?a:r}),t[4]=rt(rt({},e),{},{color:null!==(i=null!=c?c:n[4])&&void 0!==i?i:r}),t[5]=rt(rt({},e),{},{color:null!==(l=null!=c?c:n[5])&&void 0!==l?l:r})}(o,t,void 0===a?{}:a,n),o[r]=t}else o[3]=t}),o};return t.map(function(t){var e=t.trendChartData,n=t.graphicModel,r=e[e.length-1].raw;return t.thresholdTarget=c(r,n.cardId),t})},ft=function(t,e,n,r){var o=new mstrmojo.customviz.GraphicModel,a=function(t,e){var n={};return Object.keys(t).filter(function(t){return e.includes(t)}).forEach(function(e){n[e]=t[e]}),n}(e,[].concat(ot(n),[r]));return o.setSelector(t,t.isSelectAttr),o.idValueMapping=a,o},pt=function(t,e,n,r,o){n.cardsIds||(n.cardIds=[]);var a=new mstrmojo.customviz.GraphicModel;return t?(a.setSelector(t,t.isSelectAttr),a.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e,"-").concat(t.eid)}),a.setGroupOptions([r.headers[0]]),a.setDrillOptions(t,[{dropZoneIndex:o.BREAK_BY,keepParent:!1}]),n.cardIds.push("".concat(n.id,"-").concat(e,"-").concat(t.eid))):(n.metricId=e,a.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e)}),n.cardIds.push("".concat(n.id,"-").concat(e))),a.idValueMapping=ht(r.headers),a},mt=function(t){return t.headers.some(function(t){var e;return null===(e=t.headerObj)||void 0===e?void 0:e.h.stt})},ht=function(t){return Object.fromEntries(t.map(function(t){var e=t.attributeSelector;return[e.tid,e.n]}).slice(0,-1))};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var yt={SANITIZE_NAMED_PROPS:!0,RETURN_DOM_FRAGMENT:!0,ADD_ATTR:["target"]};function vt(t,e){if(t){if("string"==typeof t)return gt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(t,e):void 0}}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var bt=function(t,e){return window.DOMPurify?DOMPurify.sanitize(t,e):t},_t=function(t,e){var n="",r=function(t){"_blank"===t.getAttribute("target")&&t.setAttribute("rel","noopener noreferrer"),n+=t.outerHTML},o=function(t){var e;t.nodeType===Node.ELEMENT_NODE?"IMG"===(e=t).tagName?n+="":"A"===e.tagName?r(e):e.childNodes?e.childNodes.forEach(o):n+=e.textContent:a(t)},a=function(t){n+=e?mstrmojo.string.encodeHtmlString(t.textContent):t.textContent};return t instanceof Node&&(null==t||t.childNodes.forEach(o)),n},Et=function(t){var e,n,r,o=t.tag,a=void 0===o?"div":o,i=t.classes,l=void 0===i?[]:i,c=t.content,u=void 0===c?"":c,s=t.style,d=void 0===s?{}:s,f=t.otherAttributes,p=void 0===f?{}:f,m=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=document.createElement(a);if((e=y.classList).add.apply(e,function(t){if(Array.isArray(t))return gt(t)}(r=l)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||vt(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&m&&h){var v=bt(u,yt);n=_t(v,m)}else n=m?mstrmojo.string.encodeHtmlString(u):u;return y.innerHTML=n,Object.assign(y.style,d),Object.entries(p).forEach(function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||vt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=e[0],r=e[1];y.setAttribute(n,mstrmojo.string.encodeHtmlString(r))}),y};function Ct(){}function It(t){return null==t?Ct:function(){return this.querySelector(t)}}function At(){return[]}function St(t){return null==t?At:function(){return this.querySelectorAll(t)}}function Tt(t){return function(){return this.matches(t)}}function wt(t){return function(e){return e.matches(t)}}var Ot=Array.prototype.find;function Nt(){return this.firstElementChild}var xt=Array.prototype.filter;function Dt(){return Array.from(this.children)}function Mt(t){return new Array(t.length)}function Pt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Rt(t,e,n,r,o,a){for(var i,l=0,c=e.length,u=a.length;l<u;++l)(i=e[l])?(i.__data__=a[l],r[l]=i):n[l]=new Pt(t,a[l]);for(;l<c;++l)(i=e[l])&&(o[l]=i)}function Lt(t,e,n,r,o,a,i){var l,c,u,s=new Map,d=e.length,f=a.length,p=new Array(d);for(l=0;l<d;++l)(c=e[l])&&(p[l]=u=i.call(c,c.__data__,l,e)+"",s.has(u)?o[l]=c:s.set(u,c));for(l=0;l<f;++l)u=i.call(t,a[l],l,a)+"",(c=s.get(u))?(r[l]=c,c.__data__=a[l],s.delete(u)):n[l]=new Pt(t,a[l]);for(l=0;l<d;++l)(c=e[l])&&s.get(p[l])===c&&(o[l]=c)}function jt(t){return t.__data__}function Vt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ft(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Pt.prototype={constructor:Pt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var kt="http://www.w3.org/1999/xhtml";const Bt={svg:"http://www.w3.org/2000/svg",xhtml:kt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kt(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Bt.hasOwnProperty(e)?{space:Bt[e],local:t}:t}function Ht(t){return function(){this.removeAttribute(t)}}function Yt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ut(t,e){return function(){this.setAttribute(t,e)}}function Gt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $t(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function zt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Wt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xt(t){return function(){this.style.removeProperty(t)}}function qt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Zt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Jt(t,e){return t.style.getPropertyValue(e)||Wt(t).getComputedStyle(t,null).getPropertyValue(e)}function Qt(t){return function(){delete this[t]}}function te(t,e){return function(){this[t]=e}}function ee(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ne(t){return t.trim().split(/^|\s+/)}function re(t){return t.classList||new oe(t)}function oe(t){this._node=t,this._names=ne(t.getAttribute("class")||"")}function ae(t,e){for(var n=re(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function ie(t,e){for(var n=re(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function le(t){return function(){ae(this,t)}}function ce(t){return function(){ie(this,t)}}function ue(t,e){return function(){(e.apply(this,arguments)?ae:ie)(this,t)}}function se(){this.textContent=""}function de(t){return function(){this.textContent=t}}function fe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function pe(){this.innerHTML=""}function me(t){return function(){this.innerHTML=t}}function he(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ye(){this.nextSibling&&this.parentNode.appendChild(this)}function ve(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ge(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===kt&&e.documentElement.namespaceURI===kt?e.createElement(t):e.createElementNS(n,t)}}function be(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _e(t){var e=Kt(t);return(e.local?be:ge)(e)}function Ee(){return null}function Ce(){var t=this.parentNode;t&&t.removeChild(this)}function Ie(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ae(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Se(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function Te(t,e,n){return function(){var r,o=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var i=0,l=o.length;i<l;++i)if((r=o[i]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},o?o.push(r):this.__on=[r]}}function we(t,e,n){var r=Wt(t),o=r.CustomEvent;"function"==typeof o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Oe(t,e){return function(){return we(this,t,e)}}function Ne(t,e){return function(){return we(this,t,e.apply(this,arguments))}}oe.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var xe=[null];function De(t,e){this._groups=t,this._parents=e}function Me(){return new De([[document.documentElement]],xe)}De.prototype=Me.prototype={constructor:De,select:function(t){"function"!=typeof t&&(t=It(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,i,l=e[o],c=l.length,u=r[o]=new Array(c),s=0;s<c;++s)(a=l[s])&&(i=t.call(a,a.__data__,s,l))&&("__data__"in a&&(i.__data__=a.__data__),u[s]=i);return new De(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):St(t);for(var e=this._groups,n=e.length,r=[],o=[],a=0;a<n;++a)for(var i,l=e[a],c=l.length,u=0;u<c;++u)(i=l[u])&&(r.push(t.call(i,i.__data__,u,l)),o.push(i));return new De(r,o)},selectChild:function(t){return this.select(null==t?Nt:function(t){return function(){return Ot.call(this.children,t)}}("function"==typeof t?t:wt(t)))},selectChildren:function(t){return this.selectAll(null==t?Dt:function(t){return function(){return xt.call(this.children,t)}}("function"==typeof t?t:wt(t)))},filter:function(t){"function"!=typeof t&&(t=Tt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,i=e[o],l=i.length,c=r[o]=[],u=0;u<l;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&c.push(a);return new De(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,jt);var n,r=e?Lt:Rt,o=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var i=a.length,l=new Array(i),c=new Array(i),u=new Array(i),s=0;s<i;++s){var d=o[s],f=a[s],p=f.length,m=Vt(t.call(d,d&&d.__data__,s,o)),h=m.length,y=c[s]=new Array(h),v=l[s]=new Array(h);r(d,f,y,v,u[s]=new Array(p),m,e);for(var g,b,_=0,E=0;_<h;++_)if(g=y[_]){for(_>=E&&(E=_+1);!(b=v[E])&&++E<h;);g._next=b||null}}return(l=new De(l,o))._enter=c,l._exit=u,l},enter:function(){return new De(this._enter||this._groups.map(Mt),this._parents)},exit:function(){return new De(this._exit||this._groups.map(Mt),this._parents)},join:function(t,e,n){var r=this.enter(),o=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(o=e(o))&&(o=o.selection()),null==n?a.remove():n(a),r&&o?r.merge(o).order():o},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,a=r.length,i=Math.min(o,a),l=new Array(o),c=0;c<i;++c)for(var u,s=n[c],d=r[c],f=s.length,p=l[c]=new Array(f),m=0;m<f;++m)(u=s[m]||d[m])&&(p[m]=u);for(;c<o;++c)l[c]=n[c];return new De(l,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],a=o.length-1,i=o[a];--a>=0;)(r=o[a])&&(i&&4^r.compareDocumentPosition(i)&&i.parentNode.insertBefore(r,i),i=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ft);for(var n=this._groups,r=n.length,o=new Array(r),a=0;a<r;++a){for(var i,l=n[a],c=l.length,u=o[a]=new Array(c),s=0;s<c;++s)(i=l[s])&&(u[s]=i);u.sort(e)}return new De(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,a=r.length;o<a;++o){var i=r[o];if(i)return i}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,a=e[n],i=0,l=a.length;i<l;++i)(o=a[i])&&t.call(o,o.__data__,i,a);return this},attr:function(t,e){var n=Kt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Yt:Ht:"function"==typeof e?n.local?zt:$t:n.local?Gt:Ut)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Xt:"function"==typeof e?Zt:qt)(t,e,null==n?"":n)):Jt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Qt:"function"==typeof e?ee:te)(t,e)):this.node()[t]},classed:function(t,e){var n=ne(t+"");if(arguments.length<2){for(var r=re(this.node()),o=-1,a=n.length;++o<a;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?ue:e?le:ce)(n,e))},text:function(t){return arguments.length?this.each(null==t?se:("function"==typeof t?fe:de)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?pe:("function"==typeof t?he:me)(t)):this.node().innerHTML},raise:function(){return this.each(ye)},lower:function(){return this.each(ve)},append:function(t){var e="function"==typeof t?t:_e(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:_e(t),r=null==e?Ee:"function"==typeof e?e:It(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Ce)},clone:function(t){return this.select(t?Ae:Ie)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,o,a=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),i=a.length;if(!(arguments.length<2)){for(l=e?Te:Se,r=0;r<i;++r)this.each(l(a[r],e,n));return this}var l=this.node().__on;if(l)for(var c,u=0,s=l.length;u<s;++u)for(r=0,c=l[u];r<i;++r)if((o=a[r]).type===c.type&&o.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?Ne:Oe)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,o=t[e],a=0,i=o.length;a<i;++a)(r=o[a])&&(yield r)}};const Pe=Me;var Re={value:()=>{}};function Le(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new je(r)}function je(t){this._=t}function Ve(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function Fe(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Re,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}je.prototype=Le.prototype={constructor:je,on:function(t,e){var n,r,o=this._,a=(r=o,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),i=-1,l=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<l;)if(n=(t=a[i]).type)o[n]=Fe(o[n],t.name,e);else if(null==e)for(n in o)o[n]=Fe(o[n],t.name,null);return this}for(;++i<l;)if((n=(t=a[i]).type)&&(n=Ve(o[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new je(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),a=0;a<n;++a)o[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,a=r.length;o<a;++o)r[o].value.apply(e,n)}};const ke=Le;var Be,Ke,He=0,Ye=0,Ue=0,Ge=0,$e=0,ze=0,We="object"==typeof performance&&performance.now?performance:Date,Xe="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qe(){return $e||(Xe(Ze),$e=We.now()+ze)}function Ze(){$e=0}function Je(){this._call=this._time=this._next=null}function Qe(t,e,n){var r=new Je;return r.restart(t,e,n),r}function tn(){$e=(Ge=We.now())+ze,He=Ye=0;try{!function(){qe(),++He;for(var t,e=Be;e;)(t=$e-e._time)>=0&&e._call.call(void 0,t),e=e._next;--He}()}finally{He=0,function(){for(var t,e,n=Be,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Be=e);Ke=t,nn(r)}(),$e=0}}function en(){var t=We.now(),e=t-Ge;e>1e3&&(ze-=e,Ge=t)}function nn(t){He||(Ye&&(Ye=clearTimeout(Ye)),t-$e>24?(t<1/0&&(Ye=setTimeout(tn,t-We.now()-ze)),Ue&&(Ue=clearInterval(Ue))):(Ue||(Ge=We.now(),Ue=setInterval(en,1e3)),He=1,Xe(tn)))}function rn(t,e,n){var r=new Je;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}Je.prototype=Qe.prototype={constructor:Je,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?qe():+n)+(null==e?0:+e),this._next||Ke===this||(Ke?Ke._next=this:Be=this,Ke=this),this._call=t,this._time=n,nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,nn())}};var on=ke("start","end","cancel","interrupt"),an=[];function ln(t,e,n,r,o,a){var i=t.__transition;if(i){if(n in i)return}else t.__transition={};!function(t,e,n){var r,o=t.__transition;function a(c){var u,s,d,f;if(1!==n.state)return l();for(u in o)if((f=o[u]).name===n.name){if(3===f.state)return rn(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete o[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete o[u])}if(rn(function(){3===n.state&&(n.state=4,n.timer.restart(i,n.delay,n.time),i(c))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),u=0,s=-1;u<d;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++s]=f);r.length=s+1}}function i(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,i=r.length;++a<i;)r[a].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=Qe(function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:o,on,tween:an,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function cn(t,e){var n=sn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function un(t,e){var n=sn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function sn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function dn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var fn,pn=180/Math.PI,mn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hn(t,e,n,r,o,a){var i,l,c;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),t*r<e*n&&(t=-t,e=-e,c=-c,i=-i),{translateX:o,translateY:a,rotate:Math.atan2(e,t)*pn,skewX:Math.atan(c)*pn,scaleX:i,scaleY:l}}function yn(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(a,i){var l=[],c=[];return a=t(a),i=t(i),function(t,r,o,a,i,l){if(t!==o||r!==a){var c=i.push("translate(",null,e,null,n);l.push({i:c-4,x:dn(t,o)},{i:c-2,x:dn(r,a)})}else(o||a)&&i.push("translate("+o+e+a+n)}(a.translateX,a.translateY,i.translateX,i.translateY,l,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(o(n)+"rotate(",null,r)-2,x:dn(t,e)})):e&&n.push(o(n)+"rotate("+e+r)}(a.rotate,i.rotate,l,c),function(t,e,n,a){t!==e?a.push({i:n.push(o(n)+"skewX(",null,r)-2,x:dn(t,e)}):e&&n.push(o(n)+"skewX("+e+r)}(a.skewX,i.skewX,l,c),function(t,e,n,r,a,i){if(t!==n||e!==r){var l=a.push(o(a)+"scale(",null,",",null,")");i.push({i:l-4,x:dn(t,n)},{i:l-2,x:dn(e,r)})}else 1===n&&1===r||a.push(o(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,i.scaleX,i.scaleY,l,c),a=i=null,function(t){for(var e,n=-1,r=c.length;++n<r;)l[(e=c[n]).i]=e.x(t);return l.join("")}}}var vn=yn(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?mn:hn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),gn=yn(function(t){return null==t?mn:(fn||(fn=document.createElementNS("http://www.w3.org/2000/svg","g")),fn.setAttribute("transform",t),(t=fn.transform.baseVal.consolidate())?hn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):mn)},", ",")",")");function bn(t,e){var n,r;return function(){var o=un(this,t),a=o.tween;if(a!==n)for(var i=0,l=(r=n=a).length;i<l;++i)if(r[i].name===e){(r=r.slice()).splice(i,1);break}o.tween=r}}function _n(t,e,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var a=un(this,t),i=a.tween;if(i!==r){o=(r=i).slice();for(var l={name:e,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===e){o[c]=l;break}c===u&&o.push(l)}a.tween=o}}function En(t,e,n){var r=t._id;return t.each(function(){var t=un(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return sn(t,r).value[e]}}function Cn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function In(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function An(){}var Sn=.7,Tn=1/Sn,wn="\\s*([+-]?\\d+)\\s*",On="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xn=/^#([0-9a-f]{3,8})$/,Dn=new RegExp(`^rgb\\(${wn},${wn},${wn}\\)$`),Mn=new RegExp(`^rgb\\(${Nn},${Nn},${Nn}\\)$`),Pn=new RegExp(`^rgba\\(${wn},${wn},${wn},${On}\\)$`),Rn=new RegExp(`^rgba\\(${Nn},${Nn},${Nn},${On}\\)$`),Ln=new RegExp(`^hsl\\(${On},${Nn},${Nn}\\)$`),jn=new RegExp(`^hsla\\(${On},${Nn},${Nn},${On}\\)$`),Vn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fn(){return this.rgb().formatHex()}function kn(){return this.rgb().formatRgb()}function Bn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=xn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Kn(e):3===n?new Un(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Hn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Hn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Dn.exec(t))?new Un(e[1],e[2],e[3],1):(e=Mn.exec(t))?new Un(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Pn.exec(t))?Hn(e[1],e[2],e[3],e[4]):(e=Rn.exec(t))?Hn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ln.exec(t))?qn(e[1],e[2]/100,e[3]/100,1):(e=jn.exec(t))?qn(e[1],e[2]/100,e[3]/100,e[4]):Vn.hasOwnProperty(t)?Kn(Vn[t]):"transparent"===t?new Un(NaN,NaN,NaN,0):null}function Kn(t){return new Un(t>>16&255,t>>8&255,255&t,1)}function Hn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Un(t,e,n,r)}function Yn(t,e,n,r){return 1===arguments.length?((o=t)instanceof An||(o=Bn(o)),o?new Un((o=o.rgb()).r,o.g,o.b,o.opacity):new Un):new Un(t,e,n,null==r?1:r);var o}function Un(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Gn(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}`}function $n(){const t=zn(this.opacity);return`${1===t?"rgb(":"rgba("}${Wn(this.r)}, ${Wn(this.g)}, ${Wn(this.b)}${1===t?")":`, ${t})`}`}function zn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xn(t){return((t=Wn(t))<16?"0":"")+t.toString(16)}function qn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Jn(t,e,n,r)}function Zn(t){if(t instanceof Jn)return new Jn(t.h,t.s,t.l,t.opacity);if(t instanceof An||(t=Bn(t)),!t)return new Jn;if(t instanceof Jn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),i=NaN,l=a-o,c=(a+o)/2;return l?(i=e===a?(n-r)/l+6*(n<r):n===a?(r-e)/l+2:(e-n)/l+4,l/=c<.5?a+o:2-a-o,i*=60):l=c>0&&c<1?0:i,new Jn(i,l,c,t.opacity)}function Jn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qn(t){return(t=(t||0)%360)<0?t+360:t}function tr(t){return Math.max(0,Math.min(1,t||0))}function er(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function nr(t,e,n,r,o){var a=t*t,i=a*t;return((1-3*t+3*a-i)*e+(4-6*a+3*i)*n+(1+3*t+3*a-3*i)*r+i*o)/6}Cn(An,Bn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Fn,formatHex:Fn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Zn(this).formatHsl()},formatRgb:kn,toString:kn}),Cn(Un,Yn,In(An,{brighter(t){return t=null==t?Tn:Math.pow(Tn,t),new Un(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Sn:Math.pow(Sn,t),new Un(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Un(Wn(this.r),Wn(this.g),Wn(this.b),zn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gn,formatHex:Gn,formatHex8:function(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}${Xn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:$n,toString:$n})),Cn(Jn,function(t,e,n,r){return 1===arguments.length?Zn(t):new Jn(t,e,n,null==r?1:r)},In(An,{brighter(t){return t=null==t?Tn:Math.pow(Tn,t),new Jn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Sn:Math.pow(Sn,t),new Jn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Un(er(t>=240?t-240:t+120,o,r),er(t,o,r),er(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new Jn(Qn(this.h),tr(this.s),tr(this.l),zn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=zn(this.opacity);return`${1===t?"hsl(":"hsla("}${Qn(this.h)}, ${100*tr(this.s)}%, ${100*tr(this.l)}%${1===t?")":`, ${t})`}`}}));const rr=t=>()=>t;function or(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):rr(isNaN(t)?e:t)}const ar=function t(e){var n=function(t){return 1===(t=+t)?or:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):rr(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Yn(t)).r,(e=Yn(e)).r),o=n(t.g,e.g),a=n(t.b,e.b),i=or(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=t,r}(1);function ir(t){return function(e){var n,r,o=e.length,a=new Array(o),i=new Array(o),l=new Array(o);for(n=0;n<o;++n)r=Yn(e[n]),a[n]=r.r||0,i[n]=r.g||0,l[n]=r.b||0;return a=t(a),i=t(i),l=t(l),r.opacity=1,function(t){return r.r=a(t),r.g=i(t),r.b=l(t),r+""}}}ir(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],a=t[r+1],i=r>0?t[r-1]:2*o-a,l=r<e-1?t[r+2]:2*a-o;return nr((n-r/e)*e,i,o,a,l)}}),ir(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],a=t[r%e],i=t[(r+1)%e],l=t[(r+2)%e];return nr((n-r/e)*e,o,a,i,l)}});var lr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cr=new RegExp(lr.source,"g");function ur(t,e){var n,r,o,a=lr.lastIndex=cr.lastIndex=0,i=-1,l=[],c=[];for(t+="",e+="";(n=lr.exec(t))&&(r=cr.exec(e));)(o=r.index)>a&&(o=e.slice(a,o),l[i]?l[i]+=o:l[++i]=o),(n=n[0])===(r=r[0])?l[i]?l[i]+=r:l[++i]=r:(l[++i]=null,c.push({i,x:dn(n,r)})),a=cr.lastIndex;return a<e.length&&(o=e.slice(a),l[i]?l[i]+=o:l[++i]=o),l.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)l[(n=c[r]).i]=n.x(t);return l.join("")})}function sr(t,e){var n;return("number"==typeof e?dn:e instanceof Bn?ar:(n=Bn(e))?(e=n,ar):ur)(t,e)}function dr(t){return function(){this.removeAttribute(t)}}function fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function pr(t,e,n){var r,o,a=n+"";return function(){var i=this.getAttribute(t);return i===a?null:i===r?o:o=e(r=i,n)}}function mr(t,e,n){var r,o,a=n+"";return function(){var i=this.getAttributeNS(t.space,t.local);return i===a?null:i===r?o:o=e(r=i,n)}}function hr(t,e,n){var r,o,a;return function(){var i,l,c=n(this);if(null!=c)return(i=this.getAttribute(t))===(l=c+"")?null:i===r&&l===o?a:(o=l,a=e(r=i,c));this.removeAttribute(t)}}function yr(t,e,n){var r,o,a;return function(){var i,l,c=n(this);if(null!=c)return(i=this.getAttributeNS(t.space,t.local))===(l=c+"")?null:i===r&&l===o?a:(o=l,a=e(r=i,c));this.removeAttributeNS(t.space,t.local)}}function vr(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,o)),n}return o._value=e,o}function gr(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,o)),n}return o._value=e,o}function br(t,e){return function(){cn(this,t).delay=+e.apply(this,arguments)}}function _r(t,e){return e=+e,function(){cn(this,t).delay=e}}function Er(t,e){return function(){un(this,t).duration=+e.apply(this,arguments)}}function Cr(t,e){return e=+e,function(){un(this,t).duration=e}}var Ir=Pe.prototype.constructor;function Ar(t){return function(){this.style.removeProperty(t)}}var Sr=0;function Tr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wr(){return++Sr}var Or=Pe.prototype;Tr.prototype=function(t){return Pe().transition(t)}.prototype={constructor:Tr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=It(t));for(var r=this._groups,o=r.length,a=new Array(o),i=0;i<o;++i)for(var l,c,u=r[i],s=u.length,d=a[i]=new Array(s),f=0;f<s;++f)(l=u[f])&&(c=t.call(l,l.__data__,f,u))&&("__data__"in l&&(c.__data__=l.__data__),d[f]=c,ln(d[f],e,n,f,d,sn(l,n)));return new Tr(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=St(t));for(var r=this._groups,o=r.length,a=[],i=[],l=0;l<o;++l)for(var c,u=r[l],s=u.length,d=0;d<s;++d)if(c=u[d]){for(var f,p=t.call(c,c.__data__,d,u),m=sn(c,n),h=0,y=p.length;h<y;++h)(f=p[h])&&ln(f,e,n,h,p,m);a.push(p),i.push(c)}return new Tr(a,i,e,n)},selectChild:Or.selectChild,selectChildren:Or.selectChildren,filter:function(t){"function"!=typeof t&&(t=Tt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,i=e[o],l=i.length,c=r[o]=[],u=0;u<l;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&c.push(a);return new Tr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,a=Math.min(r,o),i=new Array(r),l=0;l<a;++l)for(var c,u=e[l],s=n[l],d=u.length,f=i[l]=new Array(d),p=0;p<d;++p)(c=u[p]||s[p])&&(f[p]=c);for(;l<r;++l)i[l]=e[l];return new Tr(i,this._parents,this._name,this._id)},selection:function(){return new Ir(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=wr(),r=this._groups,o=r.length,a=0;a<o;++a)for(var i,l=r[a],c=l.length,u=0;u<c;++u)if(i=l[u]){var s=sn(i,e);ln(i,t,n,u,l,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new Tr(r,this._parents,t,n)},call:Or.call,nodes:Or.nodes,node:Or.node,size:Or.size,empty:Or.empty,each:Or.each,on:function(t,e){var n=this._id;return arguments.length<2?sn(this.node(),n).on.on(t):this.each(function(t,e,n){var r,o,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?cn:un;return function(){var i=a(this,t),l=i.on;l!==r&&(o=(r=l).copy()).on(e,n),i.on=o}}(n,t,e))},attr:function(t,e){var n=Kt(t),r="transform"===n?gn:sr;return this.attrTween(t,"function"==typeof e?(n.local?yr:hr)(n,r,En(this,"attr."+t,e)):null==e?(n.local?fr:dr)(n):(n.local?mr:pr)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Kt(t);return this.tween(n,(r.local?vr:gr)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?vn:sr;return null==e?this.styleTween(t,function(t,e){var n,r,o;return function(){var a=Jt(this,t),i=(this.style.removeProperty(t),Jt(this,t));return a===i?null:a===n&&i===r?o:o=e(n=a,r=i)}}(t,r)).on("end.style."+t,Ar(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,o,a;return function(){var i=Jt(this,t),l=n(this),c=l+"";return null==l&&(this.style.removeProperty(t),c=l=Jt(this,t)),i===c?null:i===r&&c===o?a:(o=c,a=e(r=i,l))}}(t,r,En(this,"style."+t,e))).each(function(t,e){var n,r,o,a,i="style."+e,l="end."+i;return function(){var c=un(this,t),u=c.on,s=null==c.value[i]?a||(a=Ar(e)):void 0;u===n&&o===s||(r=(n=u).copy()).on(l,o=s),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,o,a=n+"";return function(){var i=Jt(this,t);return i===a?null:i===r?o:o=e(r=i,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,o;function a(){var a=e.apply(this,arguments);return a!==o&&(r=(o=a)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,a,n)),r}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(En(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,o=sn(this.node(),n).tween,a=0,i=o.length;a<i;++a)if((r=o[a]).name===t)return r.value;return null}return this.each((null==e?bn:_n)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?br:_r)(e,t)):sn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Er:Cr)(e,t)):sn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){un(this,t).ease=e}}(e,t)):sn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;un(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,o=n.size();return new Promise(function(a,i){var l={value:i},c={value:function(){0===--o&&a()}};n.each(function(){var n=un(this,r),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),n.on=e}),0===o&&a()})},[Symbol.iterator]:Or[Symbol.iterator]};var Nr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function xr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Pe.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,r,o,a=t.__transition,i=!0;if(a){for(o in e=null==e?null:e+"",a)(n=a[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[o]):i=!1;i&&delete t.__transition}}(this,t)})},Pe.prototype.transition=function(t){var e,n;t instanceof Tr?(e=t._id,t=t._name):(e=wr(),(n=Nr).time=qe(),t=null==t?null:t+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var i,l=r[a],c=l.length,u=0;u<c;++u)(i=l[u])&&ln(i,t,e,u,l,n||xr(i,e));return new Tr(r,this._parents,t,e)};const{abs:Dr,max:Mr,min:Pr}=Math;function Rr(t){return{type:t}}function Lr(t){return"string"==typeof t?new De([[document.querySelector(t)]],[document.documentElement]):new De([[t]],xe)}function jr(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Rr),["n","s"].map(Rr),["n","w","e","s","nw","ne","sw","se"].map(Rr);const Vr={passive:!1},Fr={capture:!0,passive:!1};function kr(t){t.stopImmediatePropagation()}function Br(t){t.preventDefault(),t.stopImmediatePropagation()}const Kr=t=>()=>t;function Hr(t,{sourceEvent:e,subject:n,target:r,identifier:o,active:a,x:i,y:l,dx:c,dy:u,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:s}})}function Yr(t){return!t.ctrlKey&&!t.button}function Ur(){return this.parentNode}function Gr(t,e){return null==e?{x:t.x,y:t.y}:e}function $r(){return navigator.maxTouchPoints||"ontouchstart"in this}function zr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}Hr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};class Wr extends Map{constructor(t,e=qr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Xr(this,t))}has(t){return super.has(Xr(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}(this,t))}}function Xr({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function qr(t){return null!==t&&"object"==typeof t?t.valueOf():t}Set;const Zr=Symbol("implicit");function Jr(){var t=new Wr,e=[],n=[],r=Zr;function o(o){let a=t.get(o);if(void 0===a){if(r!==Zr)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return o.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Wr;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return o},o.range=function(t){return arguments.length?(n=Array.from(t),o):n.slice()},o.unknown=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return Jr(e,n).unknown(r)},zr.apply(o,arguments),o}function Qr(){var t,e,n=Jr().unknown(void 0),r=n.domain,o=n.range,a=0,i=1,l=!1,c=0,u=0,s=.5;function d(){var n=r().length,d=i<a,f=d?i:a,p=d?a:i;t=(p-f)/Math.max(1,n-c+2*u),l&&(t=Math.floor(t)),f+=(p-f-t*(n-c))*s,e=t*(1-c),l&&(f=Math.round(f),e=Math.round(e));var m=function(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(o);++r<o;)a[r]=t+r*n;return a}(n).map(function(e){return f+t*e});return o(d?m.reverse():m)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),d()):r()},n.range=function(t){return arguments.length?([a,i]=t,a=+a,i=+i,d()):[a,i]},n.rangeRound=function(t){return[a,i]=t,a=+a,i=+i,l=!0,d()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(l=!!t,d()):l},n.padding=function(t){return arguments.length?(c=Math.min(1,u=+t),d()):c},n.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),d()):c},n.paddingOuter=function(t){return arguments.length?(u=+t,d()):u},n.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),d()):s},n.copy=function(){return Qr(r(),[a,i]).round(l).paddingInner(c).paddingOuter(u).align(s)},zr.apply(d(),arguments)}const to=Math.sqrt(50),eo=Math.sqrt(10),no=Math.sqrt(2);function ro(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),i=a>=to?10:a>=eo?5:a>=no?2:1;let l,c,u;return o<0?(u=Math.pow(10,-o)/i,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,o)*i,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?ro(t,e,2*n):[l,c,u]}function oo(t,e,n){return ro(t=+t,e=+e,n=+n)[2]}function ao(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function io(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lo(t){let e,n,r;function o(t,r,o=0,a=t.length){if(o<a){if(0!==e(r,r))return a;do{const e=o+a>>>1;n(t[e],r)<0?o=e+1:a=e}while(o<a)}return o}return 2!==t.length?(e=ao,n=(e,n)=>ao(t(e),n),r=(e,n)=>t(e)-n):(e=t===ao||t===io?t:co,n=t,r=t),{left:o,center:function(t,e,n=0,a=t.length){const i=o(t,e,n,a-1);return i>n&&r(t[i-1],e)>-r(t[i],e)?i-1:i},right:function(t,r,o=0,a=t.length){if(o<a){if(0!==e(r,r))return a;do{const e=o+a>>>1;n(t[e],r)<=0?o=e+1:a=e}while(o<a)}return o}}}function co(){return 0}const uo=lo(ao),so=uo.right,fo=(uo.left,lo(function(t){return null===t?NaN:+t}).center,so);function po(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,a=new Array(o),i=new Array(r);for(n=0;n<o;++n)a[n]=vo(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<o;++n)i[n]=a[n](t);return i}}function mo(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ho(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=vo(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}function yo(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(a){for(n=0;n<r;++n)o[n]=t[n]*(1-a)+e[n]*a;return o}}function vo(t,e){var n,r,o=typeof e;return null==e||"boolean"===o?rr(e):("number"===o?dn:"string"===o?(n=Bn(e))?(e=n,ar):ur:e instanceof Bn?ar:e instanceof Date?mo:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?po:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ho:dn:yo))(t,e)}function go(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function bo(t){return+t}var _o=[0,1];function Eo(t){return t}function Co(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Io(t,e,n){var r=t[0],o=t[1],a=e[0],i=e[1];return o<r?(r=Co(o,r),a=n(i,a)):(r=Co(r,o),a=n(a,i)),function(t){return a(r(t))}}function Ao(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),a=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)o[i]=Co(t[i],t[i+1]),a[i]=n(e[i],e[i+1]);return function(e){var n=fo(t,e,1,r)-1;return a[n](o[n](e))}}var So,To=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wo(t){if(!(e=To.exec(t)))throw new Error("invalid format: "+t);var e;return new Oo({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Oo(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function No(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function xo(t){return(t=No(Math.abs(t)))?t[1]:NaN}function Do(t,e){var n=No(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}wo.prototype=Oo.prototype,Oo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Mo={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Do(100*t,e),r:Do,s:function(t,e){var n=No(t,e);if(!n)return t+"";var r=n[0],o=n[1],a=o-(So=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+No(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Po(t){return t}var Ro,Lo,jo,Vo=Array.prototype.map,Fo=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ko(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[o,a,i]=r?ro(e,t,n):ro(t,e,n);if(!(a>=o))return[];const l=a-o+1,c=new Array(l);if(r)if(i<0)for(let t=0;t<l;++t)c[t]=(a-t)/-i;else for(let t=0;t<l;++t)c[t]=(a-t)*i;else if(i<0)for(let t=0;t<l;++t)c[t]=(o+t)/-i;else for(let t=0;t<l;++t)c[t]=(o+t)*i;return c}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var o,a=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),o=r?oo(e,t,n):oo(t,e,n);return(r?-1:1)*(o<0?1/-o:o)}(t,e,n);switch((r=wo(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(o=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(xo(e)/3)))-xo(Math.abs(t)))}(a,i))||(r.precision=o),jo(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,xo(e)-xo(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(t){return Math.max(0,-xo(Math.abs(t)))}(a))||(r.precision=o-2*("%"===r.type))}return Lo(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,o,a=e(),i=0,l=a.length-1,c=a[i],u=a[l],s=10;for(u<c&&(o=c,c=u,u=o,o=i,i=l,l=o);s-- >0;){if((o=oo(c,u,n))===r)return a[i]=c,a[l]=u,e(a);if(o>0)c=Math.floor(c/o)*o,u=Math.ceil(u/o)*o;else{if(!(o<0))break;c=Math.ceil(c*o)/o,u=Math.floor(u*o)/o}r=o}return t},t}function Bo(){var t=function(){var t,e,n,r,o,a,i=_o,l=_o,c=vo,u=Eo;function s(){var t,e,n,c=Math.min(i.length,l.length);return u!==Eo&&(t=i[0],e=i[c-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=c>2?Ao:Io,o=a=null,d}function d(e){return null==e||isNaN(e=+e)?n:(o||(o=r(i.map(t),l,c)))(t(u(e)))}return d.invert=function(n){return u(e((a||(a=r(l,i.map(t),dn)))(n)))},d.domain=function(t){return arguments.length?(i=Array.from(t,bo),s()):i.slice()},d.range=function(t){return arguments.length?(l=Array.from(t),s()):l.slice()},d.rangeRound=function(t){return l=Array.from(t),c=go,s()},d.clamp=function(t){return arguments.length?(u=!!t||Eo,s()):u!==Eo},d.interpolate=function(t){return arguments.length?(c=t,s()):c},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,s()}}()(Eo,Eo);return t.copy=function(){return e=t,Bo().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},zr.apply(t,arguments),ko(t)}function Ko(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ho(t){return function(){return t}}function Yo(t){this._context=t}function Uo(t){return new Yo(t)}Ro=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Po:(e=Vo.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var o=t.length,a=[],i=0,l=e[0],c=0;o>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),a.push(t.substring(o-=l,o+l)),!((c+=l+1)>r));)l=e[i=(i+1)%e.length];return a.reverse().join(n)}),o=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?Po:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Vo.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",s=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=wo(t)).fill,n=t.align,d=t.sign,f=t.symbol,p=t.zero,m=t.width,h=t.comma,y=t.precision,v=t.trim,g=t.type;"n"===g?(h=!0,g="g"):Mo[g]||(void 0===y&&(y=12),v=!0,g="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var b="$"===f?o:"#"===f&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",_="$"===f?a:/[%p]/.test(g)?c:"",E=Mo[g],C=/[defgprs%]/.test(g);function I(t){var o,a,c,f=b,I=_;if("c"===g)I=E(t)+I,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?s:E(Math.abs(t),y),v&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(!+t[r])break t;o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==d&&(A=!1),f=(A?"("===d?d:u:"-"===d||"("===d?"":d)+f,I=("s"===g?Fo[8+So/3]:"")+I+(A&&"("===d?")":""),C)for(o=-1,a=t.length;++o<a;)if(48>(c=t.charCodeAt(o))||c>57){I=(46===c?i+t.slice(o+1):t.slice(o))+I,t=t.slice(0,o);break}}h&&!p&&(t=r(t,1/0));var S=f.length+t.length+I.length,T=S<m?new Array(m-S+1).join(e):"";switch(h&&p&&(t=r(T+t,T.length?m-I.length:1/0),T=""),n){case"<":t=f+t+I+T;break;case"=":t=f+T+t+I;break;case"^":t=T.slice(0,S=T.length>>1)+f+t+I+T.slice(S);break;default:t=T+f+t+I}return l(t)}return y=void 0===y?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),I.toString=function(){return t+""},I}return{format:d,formatPrefix:function(t,e){var n=d(((t=wo(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(xo(e)/3))),o=Math.pow(10,-r),a=Fo[8+r/3];return function(t){return n(o*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),Lo=Ro.format,jo=Ro.formatPrefix,Array.prototype.slice,Yo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const Go=Math.PI,$o=2*Go,zo=1e-6,Wo=$o-zo;function Xo(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class qo{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Xo:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Xo;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,o,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+o},${this._y1=+a}`}arcTo(t,e,n,r,o){if(t=+t,e=+e,n=+n,r=+r,(o=+o)<0)throw new Error(`negative radius: ${o}`);let a=this._x1,i=this._y1,l=n-t,c=r-e,u=a-t,s=i-e,d=u*u+s*s;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(d>zo)if(Math.abs(s*l-c*u)>zo&&o){let f=n-a,p=r-i,m=l*l+c*c,h=f*f+p*p,y=Math.sqrt(m),v=Math.sqrt(d),g=o*Math.tan((Go-Math.acos((m+d-h)/(2*y*v)))/2),b=g/v,_=g/y;Math.abs(b-1)>zo&&this._append`L${t+b*u},${e+b*s}`,this._append`A${o},${o},0,0,${+(s*f>u*p)},${this._x1=t+_*l},${this._y1=e+_*c}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,o,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(r),l=n*Math.sin(r),c=t+i,u=e+l,s=1^a,d=a?r-o:o-r;null===this._x1?this._append`M${c},${u}`:(Math.abs(this._x1-c)>zo||Math.abs(this._y1-u)>zo)&&this._append`L${c},${u}`,n&&(d<0&&(d=d%$o+$o),d>Wo?this._append`A${n},${n},0,1,${s},${t-i},${e-l}A${n},${n},0,1,${s},${this._x1=c},${this._y1=u}`:d>zo&&this._append`A${n},${n},0,${+(d>=Go)},${s},${this._x1=t+n*Math.cos(o)},${this._y1=e+n*Math.sin(o)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Zo(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new qo(e)}function Jo(t){return t[0]}function Qo(t){return t[1]}function ta(t,e){var n=Ho(!0),r=null,o=Uo,a=null,i=Zo(l);function l(l){var c,u,s,d=(l=Ko(l)).length,f=!1;for(null==r&&(a=o(s=i())),c=0;c<=d;++c)!(c<d&&n(u=l[c],c,l))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+t(u,c,l),+e(u,c,l));if(s)return a=null,s+""||null}return t="function"==typeof t?t:void 0===t?Jo:Ho(t),e="function"==typeof e?e:void 0===e?Qo:Ho(e),l.x=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),l):t},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Ho(+t),l):e},l.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ho(!!t),l):n},l.curve=function(t){return arguments.length?(o=t,null!=r&&(a=o(r)),l):o},l.context=function(t){return arguments.length?(null==t?r=a=null:a=o(r=t),l):r},l}function ea(t,e,n){var r=null,o=Ho(!0),a=null,i=Uo,l=null,c=Zo(u);function u(u){var s,d,f,p,m,h=(u=Ko(u)).length,y=!1,v=new Array(h),g=new Array(h);for(null==a&&(l=i(m=c())),s=0;s<=h;++s){if(!(s<h&&o(p=u[s],s,u))===y)if(y=!y)d=s,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),f=s-1;f>=d;--f)l.point(v[f],g[f]);l.lineEnd(),l.areaEnd()}y&&(v[s]=+t(p,s,u),g[s]=+e(p,s,u),l.point(r?+r(p,s,u):v[s],n?+n(p,s,u):g[s]))}if(m)return l=null,m+""||null}function s(){return ta().defined(o).curve(i).context(a)}return t="function"==typeof t?t:void 0===t?Jo:Ho(+t),e="function"==typeof e?e:Ho(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Qo:Ho(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:Ho(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Ho(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:Ho(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:Ho(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Ho(+t),u):n},u.lineX0=u.lineY0=function(){return s().x(t).y(e)},u.lineY1=function(){return s().x(t).y(n)},u.lineX1=function(){return s().x(r).y(e)},u.defined=function(t){return arguments.length?(o="function"==typeof t?t:Ho(!!t),u):o},u.curve=function(t){return arguments.length?(i=t,null!=a&&(l=i(a)),u):i},u.context=function(t){return arguments.length?(null==t?a=l=null:l=i(a=t),u):a},u}function na(t){return t<0?-1:1}function ra(t,e,n){var r=t._x1-t._x0,o=e-t._x1,a=(t._y1-t._y0)/(r||o<0&&-0),i=(n-t._y1)/(o||r<0&&-0),l=(a*o+i*r)/(r+o);return(na(a)+na(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(l))||0}function oa(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function aa(t,e,n){var r=t._x0,o=t._y0,a=t._x1,i=t._y1,l=(a-r)/3;t._context.bezierCurveTo(r+l,o+l*e,a-l,i-l*n,a,i)}function ia(t){this._context=t}function la(t){this._context=t}function ca(t){return new ia(t)}function ua(t,e,n){this.k=t,this.x=e,this.y=n}function sa(t){return sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sa(t)}function da(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function fa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?da(Object(n),!0).forEach(function(e){pa(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function pa(t,e,n){return(e=function(t){var e=function(t){if("object"!=sa(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=sa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==sa(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ia.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:aa(this,this._t0,oa(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,aa(this,oa(this,n=ra(this,t,e)),n);break;default:aa(this,this._t0,n=ra(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(function(t){this._context=new la(t)}.prototype=Object.create(ia.prototype)).point=function(t,e){ia.prototype.point.call(this,e,t)},la.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,o,a){this._context.bezierCurveTo(e,t,r,n,a,o)}},ua.prototype={constructor:ua,scale:function(t){return 1===t?this:new ua(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new ua(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new ua(1,0,0),ua.prototype,mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var ma=function(t,e,n,r){var o=t.xScale,a=t.yScale,i=ta().curve(ca).x(function(t){return o(t.index)}).y(function(t){return a(t.value)});e.append("path").datum(n).attr("fill","none").attr("stroke",r).attr("stroke-width",1.5).attr("d",i)},ha=function(t,e,n){t.attr("width",0).transition().duration(n).attr("width",e)},ya=function(t,e,n,o){var a=e.xScale,i=e.yScale,l=t.append("circle").attr("class","trend-graph__tooltip-marker").attr("fill",r);return{tooltipHandler:function(t){var e,r=t.detail,c=r.evt,u=r.returnObject,s=c.e.offsetX||c.layerX||0,d=Math.round(a.invert(s));parseFloat(l.attr("cx"))!==a(d)&&l.attr("cx",a(d)).attr("cy",i(n[d].value)).attr("r",0).transition().duration(300).attr("r",5),u.graphicModel=null===(e=o[d])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){l.transition().duration(0).attr("r",0)}}};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var va=function(t,e,n,r){var o=e.xBarScale,a=t.selectAll(".trend__bar"),i=o.step();return{tooltipHandler:function(t){var e,o,l,c,u=t.detail,s=u.evt,d=u.returnObject,f=(c=(null===(l=(o=s).e)||void 0===l?void 0:l.offsetX)||o.layerX,Math.floor(c/i));a.attr("fill-opacity",n),Lr(a.nodes()[f]).attr("fill-opacity",.4*n),d.graphicModel=null===(e=r[f])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){a.attr("fill-opacity",n)}}};function ga(t){return function(t){if(Array.isArray(t))return ba(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ba(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ba(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var _a=y.TREND_SHAPE,Ea=_a.LINE,Ca=_a.AREA,Ia=_a.BAR;var Aa=function(t,e,n,r,o,a,i){var l=t.cardDimensions,c=l.cardWidth,u=l.cardHeight,s=i.minValue,d=i.maxValue,f=r/100,p=(n?24:28)/100*(u-2),m=o===Ia?.01*p:5,h=c-2,y=null!=a&&a.value?Math.min(s,a.value):s,v=function(t,e,n,r,o,a){var i=Bo().domain([0,t.length-1]).range([0,e]),l=Bo().domain([n,r>=0?r:0]).range([o-a,a]),c=Qr().domain(t.map(function(t,e){return e})).range([0,e]).padding(.1).align(.5);return{xScale:i,yScale:l,xBarScale:c,heightScale:function(t){return Math.abs(l(0)-l(t))},barYScale:function(t){return l(t>=0?t:0)}}}(e,h,y,null!=a&&a.value?Math.max(d,a.value):d,p,m);return{scales:v,graphData:e.map(function(t,e){return{index:e,value:t.raw}}),trendFillOpacityFraction:f,trendWidth:h,scaledMinValue:y,trendVerticalMargin:m,SVGHeight:p}};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Sa=function(t,e,n,r){var o=t.sourceEvent||t;if(!e.isAndroid||!o.target.classList.contains("trend__body")){Ma(e);var a=e.selectedCardsGraphicModels;if(e.clearSelections(),e.isIOS&&(e.handleContextMenuSelection(o),e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")})),a=xa(o,a,n),e.selectedCardsGraphicModels=a,Da(e),"A"===(null==r?void 0:r.tagName)&&window.open(r.href,"_blank"),a.length>0){var l=i(e.KPIType),c=x(e,l.TREND),u=x(e,l.BREAK_BY);(c||u)&&Ta(e,a)}else wa(e,n)}},Ta=function(t,e){t.isIOS?e.forEach(function(t){var e=t.getSelector();e.messageType="selection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(e)}):t.applySelection(e.map(function(t){return t.getSelector()}))},wa=function(t,e){if(t.isIOS){var n=e.getSelector();n.messageType="deselection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(n)}else t.clearSelections(),t.endSelections()},Oa=function(t){var e=t.cardId;return document.getElementById(mstrmojo.string.encodeHtmlString(e))},Na=function(t){null==t||t.classList.remove("card--selected"),null==t||t.classList.remove("card--unselected"),null==t||t.classList.remove("card--selected-no-hover")},xa=function(t,e,n){var r=e.map(function(t){return t.cardId}),o=r.indexOf(n.cardId);if(!0===t.ctrlKey||!0===t.metaKey)-1!==o?e.splice(o,1):e.push(n);else{var a=-1===o||r.length>1&&-1!==o;e.length=0,a&&e.push(n)}return e},Da=function(t,e){var n=t.selectedCardsGraphicModels,r=t.isSingleCardDisplayed;if(null!=e&&e.length&&(n=e),t.getGraphicModels().forEach(function(t){var e=Oa(t);r?null==e||e.classList.add("card--no-hover"):null==e||e.classList.remove("card--no-hover")}),0!==n.length){var o=n.map(function(t){return t.cardId});t.getGraphicModels().forEach(function(t){var e=Oa(t);o.includes(t.cardId)?null!=e&&e.classList.contains("card--selected-context-menu")||function(t,e){null==t||t.classList.add(e?"card--selected-no-hover":"card--selected"),null==t||t.classList.remove("card--unselected")}(e,r):function(t,e){null==t||t.classList.remove("card--selected"),e||null==t||t.classList.add("card--unselected")}(e,r)})}else t.getGraphicModels().forEach(function(t){var e=Oa(t);Na(e)})},Ma=function(t){t.contextMenuCardsGraphicModels.forEach(function(t){var e=Oa(t);null==e||e.classList.remove("card--selected-context-menu")}),t.contextMenuCardsGraphicModels=[]};function Pa(t){return function(t){if(Array.isArray(t))return Ra(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ra(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ra(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ra(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var La=function(t,e){return{tag:"button",content:"",classes:["controls__dot-indicator"],style:{color:e},otherAttributes:{id:t}}},ja=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{tag:"button",classes:["controls__".concat(t,"-arrow")].concat(Pa(n),Pa(r)),content:e}};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Va=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r='<path fill="'.concat(t,'" fill-rule="nonzero" d="M11.2180716,2.07107347 L4.91484044,2.07107347 C4.44372309,2.07107347 4.06183057,2.45296599 4.06183057,2.92408334 C4.06183057,3.39520069 4.44372309,3.77709321 4.91484044,3.77709321 L9.15869251,3.77709321 L2.32092272,10.6149056 C1.98777972,10.9480487 1.98777972,11.4881319 2.32092272,11.8212322 C2.65402308,12.1543326 3.19410628,12.1543752 3.52724928,11.8212322 L10.3650617,4.98341977 L10.3650617,9.22727184 C10.3650617,9.69838919 10.7469542,10.0802817 11.2180716,10.0802817 C11.6891889,10.0802817 12.0710815,9.69838919 12.0710815,9.22727184 L12.0710815,2.92408334 C12.0710815,2.45983272 11.6937952,2.07107347 11.2180716,2.07107347 Z" transform="translate(7.071073, 7.071073)\n\trotate(').concat(1===e?"-45.0":"135.0",') translate(-7.071073, -7.071073)"></path>');return n?r:'<svg class="trend-indicator__icon" width="14pt" height="14pt" viewBox="0 0 14 14">'.concat(r,"</svg>")},Fa=function(t,e,n,r){var o,a=e.trendIncreaseBackgroundColor,i=e.trendDecreaseBackgroundColor,c=e.trendConstantBackgroundColor,u=e.trendIndicatorShape,s=e.trendIndicatorValueType,d=y.TREND_INDICATOR_SHAPE.BADGE,f=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,p=null===(o=r[5])||void 0===o?void 0:o.color;return 0===t?{indicatorColor:null!=p?p:c,valueSign:"",arrowType:null}:t<0?{indicatorColor:null!=p?p:i,valueSign:n===l||s===f?"":"-",arrowType:-1}:{indicatorColor:null!=p?p:a,valueSign:n===l||u!==d?"":"+",arrowType:1}};function ka(t){return ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ka(t)}function Ba(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ka(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ba(Object(n),!0).forEach(function(e){Ha(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ha(t,e,n){return(e=function(t){var e=function(t){if("object"!=ka(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ka(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ka(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ya(t){return Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ya(t)}function Ua(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ga(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ua(Object(n),!0).forEach(function(e){$a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ua(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function $a(t,e,n){return(e=function(t){var e=function(t){if("object"!=Ya(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ya(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ya(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var za=function(t,e,n,r){var o,a,i,l,u,s,d,f,p,m,h,v,g,b,_,E=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],C=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],I=e.isComparisonKPI,A=e.isRealTime,S=e.cardProperties,T=t.secondaryValue,w=t.indicator,O=t.trend,N=t.trendChartData,x=t.graphicModel,D=t.referenceLine,P=t.thresholdTarget,L=t.trendAttributeFormType,V=t.metricFormType,F=n.secondaryValueFontOptions,k=n.trendIndicatorEnabled,B=n.comparisonIndicatorEnabled,K=S.cssModifiers,H=S.isTrendIndicatorOnTop,Y=S.showSecondaryValue,U=S.isComparisonMetricAdded,G=x.cardId,$=[];if(T&&Y&&E)if(a=function(t,e,n,r,o,a){var i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=t.label,c=t.value;o&&(c+="");var u=l?"".concat(l,": ").concat(c):c,s=M(n,r),d=Et(function(t,e,n,r){var o=n.cardElementsModifier,a=n.indicatorPosition,i=n.cardAlignment;return r[4]&&(t.color=r[4].color),{classes:["card__secondary-value","card__secondary-value--".concat(o),"card__secondary-value--".concat(a),"card__secondary-value--".concat(i)],content:e,style:t}}(s,u,e,a),!0,i);return d.secondaryValueData={labelTitle:l,labelValue:c,wholeLabel:u,shouldSanitizeSecondaryValue:i},d}(T,K,F,e,U,P,L===(null!==(m=null===(h=mstrmojo)||void 0===h||null===(v=h.chart)||void 0===v||null===(g=v.model)||void 0===g||null===(b=g.enums)||void 0===b||null===(_=b.EnumDSSBaseFormType)||void 0===_?void 0:_.DssBaseFormHTMLTag)&&void 0!==m?m:7)||void 0!==V),e.components.cardSecondaryValues.push(a),A&&(e.parsedData[r].secondaryValueComponentIndex=e.components.cardSecondaryValues.length-1,e.isSecondaryLabelUpdated=!0),U){var z=Et((s=(u=K).cardAlignment,d=u.cardDirection,{tag:"div",classes:["card__secondary-value-with-indicator-wrapper","card__secondary-value-with-indicator-wrapper--".concat(s),"card__secondary-value-with-indicator-wrapper--".concat(d)]}));z.append(a),$.push(z),e.components.cardSecondaryValueWithIndicatorWrappers.push(z),B&&(l=function(t,e,n,r){var o=e.indicatorFontOptions,a=e.trendIndicatorValueType,i=t.differenceBetweenPrimaryAndSecondary,l=t[a],c=Fa(i,e,l,r),u=c.indicatorColor,s=c.valueSign,d=M(o,n),f=Et(function(t,e){return{tag:"div",classes:["card__comparison-indicator"],content:e,style:t}}(Ka(Ka({},d),{},{color:u}),a===y.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(s).concat(l,")"):"".concat(s).concat(l)));return f}(w,n,e,P),z.append(l),e.components.cardIndicators.push(l),e.cardComponentReferences[G].trendIndicator={cssModifiers:K,indicator:w})}else $.push(a),k&&(i=function(t,e,n,r,o){var a,i=n.trendIndicatorValueType,l=n.trendIndicatorShape,c=n.indicatorFontOptions,u=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,s=e.differenceBetweenPrimaryAndSecondary,d=mstrmojo.string.encodeHtmlString(e[i]),f=d,p=Fa(s,n,f,{}),m=p.arrowType,h=p.indicatorColor,v=p.valueSign,g="",b=M(c,r),_=null===(a=o[8])||void 0===a?void 0:a.color;if(l===y.TREND_INDICATOR_SHAPE.ARROW){var E=m?Va(h,m):"";g=i===u?"".concat(E,' <span class="trend-indicator__value---with-icon">').concat(v).concat(d,"</span>"):"".concat(E,' <span class="trend-indicator__value---with-icon">').concat(v," ").concat(d,"</span>"),b.color=null!=_?_:h}else g=d=i===u?"".concat(v).concat(d):"".concat(v," ").concat(d),b.background=null!=_?_:h;return Et(function(t,e,n,r,o){var a=e.indicatorPosition,i=e.cardElementsModifier,l=e.cardAlignment;return o[5]&&(t.color=o[5].color),{classes:["card__trend-indicator","card__trend-indicator--".concat(i),"card__trend-indicator--".concat(a),"card__trend-indicator--".concat(l)],content:r,style:t,otherAttributes:{title:n}}}(b,t,f,g,o),!1)}(K,w,n,e,P),H?e.cardComponentReferences[G].cardBody.append(i):$.push(i),e.components.cardIndicators.push(i),A&&(e.parsedData[r].trendIndicatorComponentIndex=e.components.cardIndicators-1),e.cardComponentReferences[G].trendIndicator={cssModifiers:K,indicator:w});if(T&&O&&C){var W=function(t,e,n,r,o,a,i,l){var u,s=n.minValue,d=n.maxValue,f=a.trendShape,p=a.trendFillColor,m=a.trendFillOpacity;l[6]&&(p=l[6].color,m=null!==(u=l[6].opacity)&&void 0!==u?u:100);var h,v=Aa(i,e,r,m,f,o,{minValue:s,maxValue:d}),g=v.scales,b=v.graphData,_=v.trendFillOpacityFraction,E=v.trendWidth,C=v.scaledMinValue,I=v.trendVerticalMargin,A=v.SVGHeight,S=Lr(t).append("svg");switch(S.attr("width",E).attr("height",A),f){case Ea:ma(g,S,b,R(p,m)),ha(S,E,i.animationDuration),h=ya(S,g,b,e);break;case Ca:!function(t,e,n,r,o,a,i){var l=t.xScale,c=t.yScale,u=ea().curve(ca).x(function(t){return l(t.index)}).y1(function(t){return c(t.value)}).y0(a>=0?c(a)+i:c(0));e.append("path").datum(n).attr("fill",r).attr("fill-opacity",o).attr("stroke","none").attr("d",u)}(g,S,b,p,_,C,I),ma(g,S,b,p),ha(S,E,i.animationDuration),h=ya(S,g,b,e);break;case Ia:!function(t,e,n,r,o,a){var i=e.xBarScale,l=e.heightScale,c=e.barYScale;t.selectAll("bars").data(n).enter().append("rect").attr("class","trend__bar").attr("x",function(t){return i(t.index)}).attr("y",function(){return c(0)}).attr("width",i.bandwidth()).attr("fill",r).attr("fill-opacity",o).attr("stroke",r).attr("stroke-width",1.5).attr("height",0).transition().duration(a).attr("y",function(t){return c(t.value)}).attr("height",function(t){return l(t.value)})}(S,g,b,p,_,i.animationDuration),h=va(S,g,_,e)}o&&function(t,e,n,r,o){var a,i=t.line,l=i.color,u=i.shape,s=t.value,d=t.formattedValue,f=t.label,p=t.font,m=M(p,o),h=e.yScale,v=y.SELECTED_REFERENCE_LINE_SHAPE,g=u===v.THICK_LINE_TYPE?2:1;switch(u){case v.DOTTED_LINE_TYPE:a="1 1";break;case v.DASHED_LINE_TYPE:a="3 3";break;case v.THIN_LINE_TYPE:case v.THICK_LINE_TYPE:a="1 0"}n.append("line").attr("stroke",l).attr("x1",0).attr("x2",r).attr("y1",h(s)).attr("y2",h(s)).attr("stroke-width",g).attr("stroke-dasharray",a);var b=f?"".concat(f," ").concat(d):d,_=mstrmojo.VisUtility.measureTextWidth(b+c,fa(fa({},m),{},{lineHeight:1})),E=parseFloat(m.fontSize),C=n.append("text").attr("x",Math.max(r-_-2,2)).attr("y",h(s)-4-E>0?h(s)-4:h(s)+4+E);C.attr("class","card__reference-line-label").text(b).attr("font-family",m.fontFamily).attr("fill",m.color).attr("font-weight",m.fontWeight).attr("font-style",m.fontStyle).attr("text-decoration",m.textDecoration).attr("font-size",m.fontSize);var I=document.createElement("span");if(_>r){var A=j({container:I,maxTextWidth:r-4,textData:{label:f,value:d,connector:" "},fontSize:parseInt(m.fontSize),fontStyle:m}).truncatedLabelWithValue;C.text(A)}I.remove()}(o,g,S,E,i),S.append("rect").attr("x",0).attr("y",0).attr("height",A).attr("width",E).style("fill","transparent").attr("class","trend__body");var T=h,w=T.tooltipHandler,O=T.resetHighlight;return S.on("tooltip",w).on("mouseout",function(){O(),i.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},i.hideTooltip(!1)}),S}(f=Et((p=K.indicatorPosition,{classes:["card__trend-graph","card__trend-graph--".concat(p)]})),N,O,H,D,n,e,P);e.trendSVGs.push(W),$.push(f),A&&(e.parsedData[r].trendComponentIndex=e.trendSVGs.length-1)}var X=Et("div");return X.classList.add("overlay-fill"),e.isMobile||X.classList.add("overlay-fill--not-mobile"),$.push(X),(o=e.cardComponentReferences[G].cardComponent).append.apply(o,$),E&&(i=I&&U?l:i,e.cardComponentReferences[G]=Ga(Ga({},e.cardComponentReferences[G]),{},{cardSecondaryValue:a,cardIndicator:i})),C&&(e.cardComponentReferences[G]=Ga(Ga({},e.cardComponentReferences[G]),{},{cardTrendGraph:f,cardTrendGraphData:{trendChartData:[],trend:O,isTrendIndicatorOnTop:H,referenceLine:D,properties:n}})),e.cardComponentReferences[G].cardComponent};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Wa="slider--sliding",Xa="controls__dot-indicator--active",qa="prev",Za="next",Ja="arrow",Qa=["ArrowLeft","ArrowRight","Delete","Enter","Backspace","End","Home"],ti="small",ei="medium",ni="large",ri="-dot-indicator";mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var oi=function(t){var e=t.sliderState,r=t.controlsLayout,o=t.vizHeight,a=t.cardWidth,i=t.cardsCount,l=t.elementRefs,c=t.properties,u=t.slideCard,s=1===c.cardStyle?n.LIGHT:n.NIGHT;return l.controlsContainer=Et({classes:["controls"]}),r===Ja?function(t,e,n,r,o,a,i){var l=function(t){return t===Za?'<svg width="18" height="16" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(a,'" points="5 16 13 9 5 2"></polygon></svg>'):'\n\t\t\t<svg width="18px" height="16px" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(a,'" transform="translate(9.000000, 9.000000) scale(-1, 1) translate(-9.000000, -9.000000) " points="5 16 13 9 5 2"></polygon></svg>\n\t\t')},c=n<150||e<100?ti:n>300&&e>300?ni:ei;c===ni?o.controlsContainer.classList.add("controls--arrow-indicators"):o.controlsContainer.classList.add("controls--smaller");var u=["controls__arrow"];c!==ni&&u.push("controls__arrow--smaller");var s=c===ti?["controls__prev-arrow--smaller"]:[];o.prevArrowControl=o.controlsContainer.appendChild(Et(ja(qa,l(qa),u,s),!1)),c!==ti&&function(t,e,n,r,o,a){var i=function(t){var e=t.target,r=t.key,o=e.textContent,a=n.toString().length;"ENTER"===r?e.blur():o.length>a&&(e.textContent=o.substring(0,a))},l=t.activeCardIndex,c=["controls__text-indicators"];e===ei&&c.push("controls__text-indicators--smaller"),r.textIndicator=r.controlsContainer.appendChild(Et({classes:c,style:{color:o}})),r.activeCardTextIndicator=r.textIndicator.appendChild(Et({classes:["controls__active-card"],content:l,style:{borderBottom:"1px solid ".concat(o)},otherAttributes:{contentEditable:""}})),r.activeCardTextIndicator.addEventListener("keydown",function(e){var n=t.sliding,r=e.key,o=e.shiftKey;isNaN(parseInt(r))&&!Qa.includes(r)||o||n?e.preventDefault():i(e)}),r.activeCardTextIndicator.addEventListener("keyup",i),r.activeCardTextIndicator.addEventListener("blur",function(e){var r=t.activeCardIndex,o=e.target,i=parseInt(o.textContent);i>n?o.textContent=r:a(i)}),r.textIndicator.appendChild(Et({classes:["controls__slash"],content:"/"})),r.textIndicator.appendChild(Et({classes:["controls__total-cards"],content:n}))}(t,c,r,o,a,i),o.nextArrowControl=o.controlsContainer.appendChild(Et(ja(Za,l(Za),u),!1)),o.prevArrowControl.addEventListener("click",function(){return i(t.activeCardIndex-1)}),o.nextArrowControl.addEventListener("click",function(){return i(t.activeCardIndex+1)})}(e,o,a,i,l,s,u):function(t,e,n,r,o){var a=y.FIRST_CARD_INDEX,i=t.activeCardIndex;n.controlsContainer.classList.add("controls--dot-indicators");for(var l=a;l<=e;l++){var c="".concat(l).concat(ri),u=n.controlsContainer.appendChild(Et(La(c,r)));l===i&&u.classList.add(Xa)}n.controlsContainer.addEventListener("click",function(e){var n=t.activeCardIndex,r=e.target;if(r.classList.contains("controls__dot-indicator")){var a=parseInt(r.id);if(a===n)return;o(a)}})}(e,i,l,s,u),l.controlsContainer};function ai(t){return ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ai(t)}function ii(t,e,n){return(e=function(t){var e=function(t){if("object"!=ai(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ai(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ai(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var li={CARD_LABELS:"cardLabels",CARD_PRIMARY_VALUES:"cardPrimaryValues",CARD_SECONDARY_VALUES:"cardSecondaryValues",CARD_BODIES:"cardBodies",CARD_INDICATORS:"cardIndicators",CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS:"cardSecondaryValueWithIndicatorWrappers"},ci=ii(ii(ii(ii({},li.CARD_LABELS,"labelFontOptions"),li.CARD_PRIMARY_VALUES,"primaryValueFontOptions"),li.CARD_SECONDARY_VALUES,"secondaryValueFontOptions"),li.CARD_INDICATORS,"indicatorFontOptions");function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function si(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function fi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?di(Object(n),!0).forEach(function(e){pi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function pi(t,e,n){return(e=function(t){var e=function(t){if("object"!=ui(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ui(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ui(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}li.CARD_LABELS,li.CARD_PRIMARY_VALUES,li.CARD_SECONDARY_VALUES,li.CARD_INDICATORS,mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var mi=function(t,e,n,r,o,a){var i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=u.sliding,o=u.activeCardIndex,i=a.intervalAutoPlayId;r||e===o||(!n&&i&&(clearInterval(i),a.intervalAutoPlayId=null),u.sliding=!0,u.activeCardIndex=e,s.slider.classList.add(Wa),s.slider.style.transform="translate(-".concat(t*e,"px)"))},l=function(){a.intervalAutoPlayId=setInterval(function(){var t=a.tooltipInfo,e=a.autoPlayEnabled,n=u.sliding;!e||n||t.isVisible||i(u.activeCardIndex+1,!0)},3400)},c=o.activeCardIndex,u={activeCardIndex:a.activeCardIndex||c,sliding:!1},s={vizContainer:null,slider:null,clonedFirstCard:null,clonedLastCard:null,controlsContainer:null,prevArrowControl:null,nextArrowControl:null,textIndicator:null,activeCardTextIndicator:null};u.activeCardIndex>n&&(u.activeCardIndex=n);var d=30*n>t?Ja:"dot";return o.stackedAutoPlay&&l(),s.vizContainer=Et({tag:"div",classes:["stacked-container"],style:{width:"".concat(t,"px")}}),s.vizContainer.append(function(t,e,n,r,o,a,i){var l,c,u,s,d=y.FIRST_CARD_INDEX,f=30*r>n?Ja:"dot",p=function(){var a=t.activeCardIndex;e.slider.classList.remove(Wa),0===a?(a=r,e.slider.style.transform="translate(-".concat(n*a,"px)")):a===o.length+1&&(a=d,e.slider.style.transform="translate(-".concat(n*a,"px)")),t.activeCardIndex=a},m=function(){var n=t.activeCardIndex,r=e.activeCardTextIndicator;r&&(r.innerHTML="".concat(n))},h=function(){var n=t.activeCardIndex;e.controlsContainer.querySelector(".".concat(Xa)).classList.remove(Xa),document.getElementById("".concat(n).concat(ri)).classList.add(Xa)},v=function(t,e){[{selector:".card__label",componentPropertyName:li.CARD_LABELS},{selector:".card__primary-value",componentPropertyName:li.CARD_PRIMARY_VALUES},{selector:".card__body",componentPropertyName:li.CARD_BODIES},{selector:".card__trend-indicator",componentPropertyName:li.CARD_INDICATORS},{selector:".card__secondary-value",componentPropertyName:li.CARD_SECONDARY_VALUES}].forEach(function(n){var r=n.selector,o=n.componentPropertyName,i=t.querySelector(r);if(i){if(o===li.CARD_SECONDARY_VALUES){var l=a.components[o][e].secondaryValueData;i.secondaryValueData=l}a.components[o].push(i)}})};return c=t.activeCardIndex,u=n*(r+2),e.slider=e.vizContainer.appendChild(Et({tag:"section",classes:["slider"],style:{width:"".concat(u,"px")}})),e.clonedFirstCard=o[0].cloneNode(!0),v(e.clonedFirstCard,0),e.clonedLastCard=o[o.length-1].cloneNode(!0),v(e.clonedLastCard,o.length-1),(l=e.slider).append.apply(l,function(t){if(Array.isArray(t))return si(t)}(s=o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||function(t,e){if(t){if("string"==typeof t)return si(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?si(t,e):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.slider.insertAdjacentElement("afterbegin",e.clonedLastCard),e.slider.append(e.clonedFirstCard),e.slider.addEventListener("transitionend",function(){var e=t.activeCardIndex,n=a.autoPlayEnabled,r=a.intervalAutoPlayId;t.sliding=!1,p(),f===Ja?m():h(),a.activeCardIndex=e;var o=JSON.parse(a.getProperty(C));n||a.setProperty(C,JSON.stringify(fi(fi({},o),{},pi({},g.ACTIVE_CARD_INDEX.name,e))),{suppressData:!0,clientUndoRedoCallback:function(){return a.refresh()}}),n&&!r&&i()}),e.slider.style.transform="translate(-".concat(n*c,"px)"),e.slider}(u,s,t,n,r,a,l)),s.vizContainer.append(oi({sliderState:u,controlsLayout:d,vizHeight:e,cardWidth:t,cardsCount:n,elementRefs:s,properties:o,slideCard:i})),s.vizContainer};function hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var yi=function(t,e,n){var r=n.gridFixCardHeightEnabled,o=n.layoutType,a=n.cardAlignment,l=y.LAYOUT_TYPES,c=t.domNode,u=c.clientWidth,s=c.clientHeight,d=parseInt(o===l.GRID?4:0),f=e.length,p=vi(n,f),m=r?0:s,h=o===l.STACKED?u:u/p+d/p-d,v=gi(n,s,f,p,d,t);t.gridFixCardHeight=v,t.cardDimensions={cardWidth:h,cardHeight:v};var g=t.isComparisonMetricAdded,b=h>v||g,_=v>h,E=i(t.KPIType),C=x(t,E.TREND),I=g||C,A=function(t){var e,n=t.isTrendIndicatorOnTop,r=t.isComparisonMetricAdded,o=t.isCardVertical,a=t.showSecondaryValue?"with-secondary":"no-trend";return a=t.showTrendGraph?"with-trend":a,{cardAlignment:(e=t.cardAlignment,w(w(w({},y.CARD_ALIGNMENT.LEFT,"left-alignment"),y.CARD_ALIGNMENT.MIDDLE,"middle-alignment"),y.CARD_ALIGNMENT.RIGHT,"right-alignment")[e]),cardElementsModifier:a,indicatorPosition:n?"kpi-on-top":"kpi-on-bottom",comparisonIndicator:r?"with-comparison":"no-comparison",cardDirection:o?"vertical-card":"horizontal-card"}}({isTrendIndicatorOnTop:b,showSecondaryValue:I,showTrendGraph:C,cardAlignment:a,isComparisonMetricAdded:g,isCardVertical:_}),S={cssModifiers:A,isTrendIndicatorOnTop:b,cardAlignment:a,showSecondaryValue:I,isComparisonMetricAdded:g,isStackedLayout:o===l.STACKED};t.cardProperties=S,t.cardComponentReferences={};var T,O,N,D=e.map(function(e,r){return function(t,e,n,r){var o,a,i,l,c,u,s,d=null!==(o=null===(a=mstrmojo)||void 0===a||null===(i=a.chart)||void 0===i||null===(l=i.model)||void 0===l||null===(c=l.enums)||void 0===c||null===(u=c.EnumDSSBaseFormType)||void 0===u?void 0:u.DssBaseFormHTMLTag)&&void 0!==o?o:7,f=t.label,p=t.primaryValue,m=t.graphicModel,h=t.thresholdTarget,y=t.breakByAttributeFormType,v=t.metricFormType,g=e.showMetricName,b=e.primaryValueFontOptions,_=e.labelFontOptions,E=e.areaFillColor,C=e.areaFillOpacity,I=n.cardDimensions,A=I.cardWidth,S=I.cardHeight,T=n.cardProperties,w=T.cssModifiers,O=T.isStackedLayout,N=g?f.withMetricName:f.withoutMetricName,x=[],D=m.cardId,P=O?"".concat(A,"px"):"auto",L=h[7]?R(h[7].color,null!==(s=h[7].opacity)&&void 0!==s?s:100):R(E,C),j=Et(function(t,e,n,r){return{tag:"article",classes:["card"],style:{height:e,width:n,background:t,boxSizing:"border-box"},otherAttributes:{id:r}}}(L,"".concat(S,"px"),P,D));n.cardComponentReferences[D]={},j.addEventListener("click",function(t){return Sa(t,n,m)});var V=M(_,n),F=y?y===d:void 0!==v,k=Et(function(t,e,n,r){var o=r.indicatorPosition,a=r.cardAlignment,i=r.cardElementsModifier;return n[2]&&(t.color=n[2].color),{tag:"header",classes:["card__label","card__label--".concat(a),"card__label--".concat(o),"card__label--".concat(i)],content:e,style:t,otherAttributes:{title:e}}}(V,N,h,w),!0,F);x.push(k);var B,K,H,Y,U=Et((K=(B=w).indicatorPosition,H=B.cardAlignment,Y=B.cardElementsModifier,{tag:"div",classes:["card__body","card__body--".concat(K),"card__body--".concat(H),"card__body--".concat(Y)],content:null})),G=M(b,n),$=void 0!==v,z=Et(function(t,e,n,r){var o=r.cardElementsModifier,a=r.comparisonIndicator;return e.color&&(t.color=e.color),n[3]&&(t.color=n[3].color),{classes:["card__primary-value","card__primary-value--".concat(o),"card__primary-value--".concat(a)],content:e.formatted,style:t,otherAttributes:{title:e.formatted}}}(G,p,h,w),!0,$);U.append(z),x.push(U),n.components.cardBodies.push(U),n.components.cardLabels.push(k),n.components.cardPrimaryValues.push(z);var W=Et("div");return W.classList.add("overlay-fill"),n.isMobile||W.classList.add("overlay-fill--not-mobile"),x.push(W),j.append.apply(j,x),n.cardComponentReferences[D]=Ga(Ga({},n.cardComponentReferences[D]),{},{cardLabel:k,cardPrimaryValue:z,cardBody:U,cardComponent:j}),za(t,n,e,r),null!=t&&t.isCardOld&&j.classList.add("card--old-card"),j}(e,n,t,r)});if(o===l.STACKED&&f>1)T=mi(h,s,f,D,n,t);else{var P,L=["container"];o===l.HORIZONTAL?L.push("container--horizontal"):o===l.VERTICAL&&L.push("container--vertical"),(P=T=Et((O=m,{tag:"section",classes:L,style:{gridTemplateColumns:"repeat(".concat(p,", 1fr)"),minHeight:"".concat(O,"px")}}))).append.apply(P,function(t){if(Array.isArray(t))return hi(t)}(N=D)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(N)||function(t,e){if(t){if("string"==typeof t)return hi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hi(t,e):void 0}}(N)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return T},vi=function(t,e){var n=t.gridColumnCount,r=t.layoutType,o=y.LAYOUT_TYPES;switch(r){case o.GRID:return Math.min(e,n);case o.HORIZONTAL:return e;case o.VERTICAL:return 1}},gi=function(t,e,n,r,o,a){var i=y.LAYOUT_TYPES,l=t.gridFixCardHeight,c=t.gridFixCardHeightEnabled;switch(t.layoutType){case i.GRID:var u=Math.ceil(n/r);return c?l:Math.max((e-o*(u-1))/u,75);case i.HORIZONTAL:case i.STACKED:return e;case i.VERTICAL:return e/n-o*(n-1)/n}};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.requiresCls("mstrmojo.css","mstrmojo.VisUtility","mstrmojo.HTMLSanitizeUtil");var bi=function(t,e,n){var r=n.cardWidth,o=n.cardHeight,a=mstrmojo.css.getComputedStyle(t),i="width"===e||"maxWidth"===e?parseFloat(r):parseFloat(o);return function(t,e){if("none"!==t)return t.indexOf("px")>0?parseFloat(t):e*parseFloat(t)/100}(a[e],i-2)},_i=function(t,e,n,r){var o=t.containerWidth,a=t.containerHeight,i=Math.max(Math.min((a-2*r)/n.height,(o-2*r)/n.width),1);return Math.floor(e*i)},Ei=function(t,e){if(!e)return t;var n=t+e;return Math.max(n,0)};function Ci(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ii(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ii(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Ai=function(t,e,n){var r=e.trendIndicatorShape,o=t.cardDimensions,a=t.components,i=t.isComparisonMetricAdded,l=li.CARD_BODIES,c=li.CARD_INDICATORS,u=li.CARD_SECONDARY_VALUES,s=li.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,d=a.cardBodies,f=a.cardSecondaryValueWithIndicatorWrappers;K(d,"height","100%"),K(d,"width","100%"),K(f,"height","100%");for(var p=function(){var a=Ci(h[m],2),d=a[0],f=a[1];if([l,s].includes(d))return 0;if(!1===t.shouldFontBeChanged[d])return 0;var p=d===c,v=d===u;f.forEach(function(a){var l,u,s,f=p&&r===y.TREND_INDICATOR_SHAPE.ARROW,m=f&&null!==a.querySelector(".trend-indicator__icon"),h=!p||f||i?0:4,g=e[ci[d]].fontSteps;if(d===c&&i){var b=a.closest(".card").querySelector(".card__secondary-value").offsetWidth,_=o.cardWidth,E=.16*_,C=Math.floor((u=(l={partialValue:_-b-E,totalValue:_}).partialValue,s=l.totalValue,100*Math.abs(u/s)));a.style.width="".concat(C,"%"),a.style.maxWidth="".concat(C,"%")}if(function(t,e,n,r){var o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=11,s=e.textContent;t&&(e.style.fontSize="".concat(e.style.fontSize,"px"),u=parseInt(e.style.fontSize)),e.style.width="",e.style.height="",e.style.lineHeight="",e.style.fontSize="",e.style.left="",e.style.transform="",e.title="";var d=(null==i?void 0:i.properties).comparisonIndicatorEnabled;null!=i&&i.isComparisonKPI&&l&&null!=i&&i.isComparisonMetricAdded&&(d?(e.style.width="58%",e.style.maxWidth="58%"):(e.style.width="82%",e.style.maxWidth="82%"));var f=bi(e,"width",n),p=bi(e,"height",n);if(o=k(e,u),s){var m;if(!t&&(u=Ei(_i({containerWidth:f,containerHeight:p},11,o,a),r),c)){var h=F(u);u=Ei(_i({containerWidth:f-h,containerHeight:p},11,o,a),r)}e.style.fontSize="".concat(u,"px"),o=k(e,u);var y=null===(m=e.secondaryValueData)||void 0===m?void 0:m.labelTitle;if(l&&!t)if(o.width>f){var v,g,b=null===(v=e.secondaryValueData)||void 0===v?void 0:v.labelValue,_=null===(g=e.secondaryValueData)||void 0===g?void 0:g.shouldSanitizeSecondaryValue;if(!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&_){var E=bt(b,yt);b=_t(E,!1);var C=bt(y,yt);y=_t(C,!1)}var I=B(e,u);i.truncatedLabels.push(j({container:e,maxTextWidth:f,textData:{label:y,value:b,connector:": "},fontSize:u,fontStyle:I}).truncatedLabel)}else i.truncatedLabels.push("".concat(y,": "));!function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if("vi_icons"===t.style.fontFamily)t.style.width="".concat(e+8,"px");else{var a=bi(t,"width",r),i=t.textContent,l=n.width;if(l>a){var c=bi(t,"maxWidth",r);l<=c?t.style.width="".concat(l,"px"):(t.style.width="".concat(c||l+2*o,"px"),c&&(t.title=i))}else t.style.width="".concat(l+2*o,"px")}}(e,u,o,n,a),function(t,e,n){var r=e.height;n?(t.style.height="".concat(Math.ceil(r)+2*n,"px"),t.style.lineHeight="".concat(Math.ceil(r),"px")):(t.style.height="".concat(1.5*Math.ceil(r),"px"),t.style.lineHeight="".concat(1.5*Math.ceil(r),"px"))}(e,o,a)}}(n,a,o,g,h,t,v,m),m){var I=a.querySelector(".trend-indicator__icon"),A=F(a.style.fontSize),S=parseInt(a.style.width);I.style.width="".concat(A,"px"),I.style.height="".concat(A,"px"),a.style.padding=0,a.style.textAlign="left",a.style.width="".concat(S+A,"px")}})},m=0,h=Object.entries(a);m<h.length;m++)p();K(d,"height","auto"),K(d,"width","84%"),K(f,"height","auto")},Si=function(t){var e=t.cardDimensions,n=t.components,r=li.CARD_BODIES,o=li.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,a=li.CARD_PRIMARY_VALUES,i=li.CARD_LABELS,l=n.cardBodies,c=n.cardSecondaryValueWithIndicatorWrappers;K(l,"height","100%"),K(l,"width","100%"),K(c,"height","100%");for(var u={},s={},d=function(){var n,l,c=Ci(p[f],2),d=c[0],m=c[1];if([r,o].includes(d))return 0;var h=[];if(0===m.length)return 0;var y=bi(m[0],"width",e),v=bi(m[0],"height",e);if(s[d]={width:y,height:v},m.forEach(function(t){t.style.fontSize="".concat(t.style.fontSize,"px");var e=parseInt(t.style.fontSize),n=k(t,e);h.push(n.width),l||(l=n.height)}),h.sort(function(t,e){return t-e}),void 0===t.shouldFontBeChanged[d]&&0!==t.shouldFontBeChanged.length)return 0;n=d===a?h[h.length-1]:d===i?h[Math.ceil(.75*h.length)-1]:h.reduce(function(t,e){return t+e},0)/h.length,u[d]={width:n,height:l}},f=0,p=Object.entries(n);f<p.length;f++)d();return K(l,"height","auto"),K(l,"width","84%"),K(c,"height","auto"),{dimensionsOfText:u,dimensionsOfContainer:s}};function Ti(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||Oi(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Oi(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function Oi(t,e){if(t){if("string"==typeof t)return Ni(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ni(t,e):void 0}}function Ni(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var xi=function(t){var e,n=0,r=wi(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;n+=parseInt(o.style.fontSize)}}catch(t){r.e(t)}finally{r.f()}return n/t.length},Di=function(t){return Math.min.apply(Math,function(t){if(Array.isArray(t))return Ni(t)}(e=t.map(function(t){var e=t.style;return parseInt(e.fontSize)}))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||Oi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var e},Mi=function(t){var e=t.length,n=t.map(function(t){return t.textContent});n.sort(function(t,e){return t.length-e.length});var r=n[Math.ceil(.75*e)-1],o=t.find(function(t){return t.textContent===r});return parseInt(o.style.fontSize)},Pi=function(t,e){for(var n=t.components,r=li.CARD_BODIES,o=li.CARD_PRIMARY_VALUES,a=li.CARD_LABELS,i={},l=0,c=Object.entries(n);l<c.length;l++){var u=Ti(c[l],2),s=u[0],d=u[1];if(s!==r&&!1!==t.shouldFontBeChanged[s]){var f;f=s===o?Di(d):s===a?Mi(d):xi(d),i[s]=V(f);var p,m=wi(d);try{for(m.s();!(p=m.n()).done;)p.value.style.fontSize="".concat(f,"px")}catch(t){m.e(t)}finally{m.f()}}}return Ai(t,e,!0),i};function Ri(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Li(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Li(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var ji=function(t,e){var n=e.isSecondaryLabelUpdated;switch(t.textSizeType){case y.TEXT_SIZE_TYPE.FIXED:""===t.labelFontOptions.fontSize?(Ai(e,t,!1),Pi(e,t),e.componentsUnifiedFontSizesInPt=Pi(e,t)):Ai(e,t,!0);break;case y.TEXT_SIZE_TYPE.UNIFIED:0!==e.shouldFontBeChanged.length||n||(Ai(e,t,!1),Pi(e,t));var r={};r.oldDimensions=Si(e),Ai(e,t,!0),r.newDimensions=Si(e),Object.keys(r.newDimensions.dimensionsOfText).length!==Object.keys(r.oldDimensions.dimensionsOfText).length?Object.keys(r.newDimensions.dimensionsOfText).forEach(function(t){e.shouldFontBeChanged[t]=!0}):function(t){var e=t.oldDimensions,n=t.newDimensions,r=e.dimensionsOfText,o=n.dimensionsOfText,a=n.dimensionsOfContainer,i={};Object.values(o).forEach(function(t){if(r[t])if(o[t].width===r[t].width)i[t]=!1;else if(o[t].width>1*a[t].width)i[t]=!0;else if(o[t].width<=1*a[t].width&&o[t].width>=1*r[t].width)i[t]=!1;else{var e=Math.max(o[t].width/a[t].width*1,o[t].height/a[t].height*1);i[t]=!(e>=.9)}else i[t]=!0})}(r);var o=li.CARD_SECONDARY_VALUES;n&&(e.shouldFontBeChanged[o]=!0),!0===e.shouldFontBeChanged[o]&&(e.truncatedLabels=[]),Ai(e,t,!1),Pi(e,t);break;case y.TEXT_SIZE_TYPE.FIT_TO_CONTAINER:Ai(e,t,!1)}for(var a=e.components,i=0,l=Object.entries(a);i<l.length;i++){var c=Ri(l[i],2),u=c[0],s=c[1];[li.CARD_BODIES,li.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS].includes(u)||(K(s,"maxWidth","none"),s.forEach(function(t){k(t,t.style.fontSize).width<=parseInt(t.style.width)&&(t.style.overflow="visible")}))}};function Vi(t,e,n){var r=this;setTimeout(function(){r.savePropertyAndUpdateWidget(t,e,n)})}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Fi="second",ki="minute",Bi="hour",Ki="day",Hi={};Hi[Fi]=1e3,Hi[ki]=60*Hi[Fi],Hi[Bi]=60*Hi[ki],Hi[Ki]=24*Hi[Bi],Hi.week=7*Hi[Ki],Hi.month=30*Hi[Ki],Hi.year=365*Hi[Ki],mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});function Yi(t){return function(t){if(Array.isArray(t))return Ui(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ui(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ui(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.requiresCls("mstrmojo.CustomVisBase","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming");var Gi=function(t){var e=!1,n=t.updatedCategory,r=t.isBreakByAttributeAdded,o=t.isOnlyPrimaryValueRendered;t.parsedData.forEach(function(a,i){var l=a.graphicModel.cardId;(!r||a.breakByAttributeName===n)&&(function(t,e,n,r){var o=t.cardComponentReferences,a=t.isComparisonKPI,i=t.isComparisonMetricAdded,l=t.isTrendAttributeAdded,c=o[r],u=c.cardTrendGraphData,s=c.cardPrimaryValue,d=c.cardIndicator,f=u.isTrendIndicatorOnTop,p=u.referenceLine,m=u.properties,h=e.trendChartData,v=e.trend,g=e.indicator,b=e.trendComponentIndex,_=e.thresholdTarget;if(s.textContent=e.primaryValue.formatted,(l||a&&i)&&1!==h.length&&(function(t,e,n){var r,o,a=null!==(r=t.secondaryValueComponentIndex)&&void 0!==r?r:e,i=null===(o=t.secondaryValue)||void 0===o?void 0:o.value,l=n.components.cardSecondaryValues[a].secondaryValueData,c=l.labelTitle;l.labelValue=i,l.labelTitle=t.secondaryValue.label,n.isSecondaryLabelUpdated=c!==(null==l?void 0:l.labelTitle),n.secondaryMetricName=l.labelTitle,n.isComparisonMetricAdded&&(l.labelValue+=""),0===n.truncatedLabels.length&&(n.components.cardSecondaryValues[a].textContent="".concat(l.labelTitle,": ").concat(l.labelValue))}(e,n,t),function(t,e,n,r,o){var a=t.isComparisonKPI,i=t.isComparisonMetricAdded;(!a&&t.properties.trendIndicatorEnabled||a&&t.properties.comparisonIndicatorEnabled)&&(e.indicatorFontOptions.fontSize=n.style.fontSize,i?function(t,e,n,r){var o=n.trendIndicatorValueType,a=e.differenceBetweenPrimaryAndSecondary,i=e[o],l=Fa(a,n,i,r),c=l.indicatorColor,u=l.valueSign,s=o===y.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(u).concat(i,")"):"".concat(u).concat(i);t.textContent=s,t.style.color=c}(n,r,e,o):function(t,e,n){var r=n.trendIndicatorValueType,o=n.trendIndicatorShape,a=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,i=e.differenceBetweenPrimaryAndSecondary,l=mstrmojo.string.encodeHtmlString(e[r]),c=Fa(i,n,l,{}),u=c.arrowType,s=c.indicatorColor,d=c.valueSign;if(o===y.TREND_INDICATOR_SHAPE.ARROW){var f=u?Va(s,u,!0):"";t.firstChild.innerHTML=f,t.lastChild.textContent=r===a?"".concat(d).concat(l):"".concat(d," ").concat(l),t.style.color=s}else l=r===a?"".concat(d).concat(l):"".concat(d," ").concat(l),t.textContent=l,t.style.backgroundColor=s}(n,r,e))}(t,m,d,g,_),l)){var E=null!=b?b:n;!function(t,e,n,r,o,a,i,l){var c=i.trendShape,u=i.trendFillColor,s=i.trendFillOpacity,d=i.axisScale,f=l.minValue,p=l.maxValue,m=r.isBreakByAttributeAdded,h=r.updatedCategory,v=r.cardDetails;if(d!==y.AXIS_SCALE.GLOBAL){var g=d===y.AXIS_SCALE.SYNCED_ALL?r.parsedData:r.parsedData.filter(function(t){return t.metricId===n});f=Math.min.apply(Math,ga(g.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),p=Math.max.apply(Math,ga(g.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})))}m&&v.forEach(function(t){t.breakByAttributeName===h&&(t.trend[n]=l)});var b,_=Aa(r,e,o,s,c,a,{minValue:f,maxValue:p}),E=_.scales,C=_.graphData,I=_.trendFillOpacityFraction,A=_.trendWidth,S=_.trendVerticalMargin;b=c===Ea?function(t,e,n,r){var o=e.xScale,a=e.yScale,i=ta().curve(ca).x(function(t){return o(t.index)}).y(function(t){return a(t.value)});return t.selectAll(".trend-graph__tooltip-marker").remove(),t.select("path").datum(n).attr("d",i),ya(t,e,n,r)}(t,E,C,e):c===Ca?function(t,e,n,r,o,a){var i=e.xScale,l=e.yScale,c=ea().curve(ca).x(function(t){return i(t.index)}).y1(function(t){return l(t.value)}).y0(o>=0?l(o)+a:l(0));return t.selectAll(".trend-graph__tooltip-marker").remove(),t.selectAll("path").datum(n).attr("d",c),ya(t,e,n,r)}(t,E,C,e,f,S):function(t,e,n,r,o,a){var i=e.xBarScale,l=e.barYScale,c=e.heightScale,u=t.selectAll(".trend__bar").data(n);return u.enter().append("rect").attr("class","trend__bar").merge(u).style("fill",o).attr("fill-opacity",a).attr("stroke",o).attr("stroke-width",1.5).attr("x",function(t){return i(t.index)}).attr("width",i.bandwidth()).attr("y",function(t){return l(t.value)}).attr("height",function(t){return c(t.value)}),va(t,e,a,r)}(t,E,C,e,u,I),a&&function(t,e,n,r,o){var a=n.value,i=n.font,l=e.yScale;t.select("line").attr("x1",0).attr("x2",o).attr("y1",l(a)).attr("y2",l(a)).raise();var c=M(i,r),u=parseFloat(c.fontSize),s=l(a)-4,d=l(a)+4,f=s-u>0?s:d+u;t.select("text").attr("y",f).raise()}(t,E,a,r,A);var T=b,w=T.tooltipHandler,O=T.resetHighlight;t.on("tooltip",w).on("mouseout",function(){O(),r.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},r.hideTooltip(!1)})}(t.trendSVGs[E],h,e.metricId,t,f,p,m,v)}}(t,a,i,l),e=e||a.trendChartData.length>1&&a.primaryValue.formatted.length!==a.trendChartData.at(-2).formatted.length||!o&&function(t,e){var n,r,o,a,i,l,c=e.properties,u=e.truncatedLabels,s=e.isSecondaryLabelUpdated,d=e.components,f=c.trendIndicatorValueType,p=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,m=null===(n=t.secondaryValue)||void 0===n?void 0:n.value,h=f===p?null===(r=t.previousIndicator)||void 0===r?void 0:r.numericValue:null===(o=t.previousIndicator)||void 0===o?void 0:o.percentValue,v=f===p?null===(a=t.indicator)||void 0===a?void 0:a.numericValue:null===(i=t.indicator)||void 0===i?void 0:i.percentValue;return m&&(null===(l=t.previousSecondaryValue)||void 0===l?void 0:l.length)!==(null==m?void 0:m.length)||m&&s||(null==h?void 0:h.length)!==v.length||0===u.length||u.length!==d.cardSecondaryValues.length}(a,t)),a.isCardOld&&t.cardComponentReferences[l].cardComponent.classList.add("card--old-card")}),t.truncatedLabels.length>0&&t.truncatedLabels.length!==t.components.cardSecondaryValues.length&&(t.isSecondaryLabelUpdated=!0),e&&ji(t.properties,t),function(t){var e=t.parsedData,n=t.truncatedLabels,r=t.isBreakByAttributeAdded,o=t.updatedCategory,a=t.components;e.forEach(function(e,i){if(t.isComparisonMetricAdded&&(e.secondaryValue.value+=""),!(0===n.length||r&&e.breakByAttributeName!==o)){var l,c=null!==(l=e.secondaryValueComponentIndex)&&void 0!==l?l:i;a.cardSecondaryValues[c].textContent="".concat(n[c]).concat(e.secondaryValue.value)}})}(t)};function $i(t,e,n,r,o){var a=t.isComparisonMetricAdded,i=t.isTrendAttributeAdded,l=t.isBreakByAttributeAdded,c=t.isComparisonKPI,u=t.updatedCategory,s=t.metricFormattingRules,d=!i&&c?e.at(-1).v:function(t,e,n,r,o){var a=t.isComparisonMetricAdded,i=t.timeFilter,l=t.properties.secondaryMetricName,c=o.trend,u=o.trendChartData,s=o.primaryValue,d=Object.keys(n.metricSelector),f=new Date(r),p=ft(n.headers[0].attributeSelector,n.idValueMapping,d,o.metricId);u.push({raw:s.raw,formatted:s.formatted,graphicModel:p,timestamp:r,timestampDate:f}),!o.isMoreDataThanFilter&&u[0].timestampDate<=i.timeRangeStart&&(o.isMoreDataThanFilter=!0,o.cardSecondaryLabel=l);var m=zi(i,u);return o.trend=function(t,e,n,r){var o=n?Math.min(n.minValue,r):Math.min(r,t[0].raw),a=n?Math.max(n.maxValue,r):Math.max(r,t[0].raw);return{minValue:o=o===a&&o>0?0:o,maxValue:a}}(u,0,c,s.raw),o.trendChartData=m,a?e.at(-1).v:m[0].raw}(t,e,n,r,o);!function(t,e,n){var r=t.primaryValue.raw-e,o=D({partialValue:r,totalValue:e}),a=null!=t&&t.compareMetricId?t.compareMetricId:t.metricId,i={numericValue:tt(r,a,n).formattedValue,percentValue:o,differenceBetweenPrimaryAndSecondary:r};t.previousIndicator=t.indicator,t.indicator=i}(o,d,s),function(t,e,n,r){var o=t.trendChartData,a=n?tt(e,t.compareMetricId,r).formattedValue:o[0].formatted;t.secondaryValue?(t.previousSecondaryValue=t.secondaryValue.value,t.secondaryValue.value=a,t.previousSecondaryLabel=t.secondaryValue.label,t.secondaryValue.label=t.cardSecondaryLabel):t.secondaryValue={value:a,label:t.cardSecondaryLabel}}(o,d,a,s),l&&t.cardDetails.forEach(function(t){t.breakByAttributeName===u&&(t.cardSecondaryLabel=o.cardSecondaryLabel)})}function zi(t,e){var n;if(e[0].timestampDate>t.timeRangeStart)return e;t.isMoreDataThanFilter=!0;var r=null!==(n=t.firstIndexInFilterRange)&&void 0!==n?n:e.findIndex(function(e){return e.timestampDate>t.timeRangeStart});return e.slice(r)}function Wi(t,e){var n={breakByAttributeName:t.breakByAttributeName,cardSecondaryLabel:t.cardSecondaryLabel,firstTimestamp:t.trendChartData[0],trend:{}};return n.trend[t.metricId]=t.trend,n.isCardOld=!!e&&t.isCardOld,n.lastUpdateTimestamp=e?t.lastUpdateTimestamp:null,n}function Xi(t,e,n,r,o,a){0===e.length?function(t,e,n,r){t.forEach(function(t){if(r.find(function(e){return e.breakByAttributeName===t.breakByAttributeName}))r.forEach(function(e){e.breakByAttributeName===t.breakByAttributeName&&(e.trend[t.metricId]=t.trend)});else{var o;t.isCardOld=t.trendChartData.at(-1).timestampDate<n.timeRangeStart;var a=null!==(o=t.lastUpdateTimestamp)&&void 0!==o?o:e.at(-1).timestampDateFormat;t.lastUpdateTimestamp=t.isCardOld?a:null;var i=Wi(t,!0);r.push(i)}})}(t,r,n,e):function(t,e,n,r){var o=r.axisScale;t.forEach(function(a){var i=e.find(function(t){return t.breakByAttributeName===a.breakByAttributeName});if(i){var l;null!=a&&a.cardSecondaryLabel&&(a.cardSecondaryLabel=n?r.secondaryMetricName:i.cardSecondaryLabel,null!=a&&null!==(l=a.secondaryValue)&&void 0!==l&&l.label&&(a.secondaryValue.label=a.cardSecondaryLabel)),a.isCardOld=i.isCardOld,a.lastUpdateTimestamp=i.lastUpdateTimestamp,function(t,e,n,r){if(t===y.AXIS_SCALE.GLOBAL)n.trend=e.trend[n.metricId];else{var o=t===y.AXIS_SCALE.SYNCED_ALL?r:r.filter(function(t){return t.metricId===n.metricId}),a=Math.min.apply(Math,Yi(o.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),i=Math.max.apply(Math,Yi(o.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})));n.trend={minValue:a,maxValue:i}}}(o,i,a,t)}else{var c=Wi(a,!1);e.push(c)}})}(t,e,a,o)}function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Zi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ji(t,e,n){return(e=function(t){var e=function(t){if("object"!=qi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qi(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={});var Qi,tl,el,nl=mstrmojo,rl=nl.DEFAULT_CONTEXT_MENU,ol=nl.CUSTOM_CONTEXT_MENU,al=function(t){return[".card__label",".card__primary-value",".card__trend-indicator",".card__secondary-value",".card__reference-line-label"].map(function(e){return il(t,e)}).filter(function(t){return!!t}).join("\t")},il=function(t,e){var n=t.querySelector(e);return n&&(n.title||n.getAttribute("title")||n.textContent)};mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.plugins.ComparisonKPI||(mstrmojo.plugins.ComparisonKPI={}),mstrmojo.descriptors["KPI.1"]||mstrmojo.requiresDescsWPrefix("KPI.",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42),mstrmojo.requiresCls("mstrmojo.num","mstrmojo.CustomVisBase","mstrmojo.util.FontLoader","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming"),mstrmojo.plugins.ComparisonKPI.ComparisonKPI=mstrmojo.declare(mstrmojo.CustomVisBase,[mstrmojo.ui._HasScroller,mstrmojo._SupportRealtimeStreaming],{scriptClass:"mstrmojo.plugins.ComparisonKPI.ComparisonKPI",cssClass:"ComparisonKPI",errorMessage:mstrmojo.descP("KPI.","7","Either there is not enough data to display the visualization or the visualization configuration is incomplete."),errorDetails:(el=mstrmojo.descP("KPI.","9","Add 2 #metrics####"),el.replace(/####/g,"</span>").replace("#",'<span class="ghost-vis-txt-metric">')),useRichTooltip:!1,reuseDOMNode:!1,draggable:!0,supportNEE:!0,supportPagination:!0,isIOS:mstrApp.isDisplayOnMobile,isAndroid:/(android)/i.test(navigator.userAgent),isMobile:mstrApp.isDisplayOnMobile||/(android)/i.test(navigator.userAgent),isInChatbot:null===(Qi=(tl=mstrApp).isInAIBotOrAutoAnswer)||void 0===Qi?void 0:Qi.call(tl),isWSLocalMode:mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode(),isConsumption:!1,labelsEditState:{},components:{},componentsUnifiedFontSizesInPt:null,graphicModels:[],contextMenuCardsGraphicModels:[],selectedCardsGraphicModels:[],trendSVGs:[],autoPlayEnabled:!1,tooltipInfo:{isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},intervalAutoPlayId:null,KPIType:1,isComparisonKPI:!0,isSingleCardDisplayed:null,animationDuration:0,init:function(t){this._super(t);var e=this,n=window.mstrApp.isExporting;e.animationDuration=n?0:1500,function(t){t.savePropertyAndUpdateWidgetAsync=Vi}(e);var r,o=(r={},Object.values(g).forEach(function(t){var e=t.name,n=t.defaultValue;r[e]=n}),W({},C,JSON.stringify(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach(function(e){W(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},r))));e.setDefaultPropertyValues(o),e.selectedCardsGraphicModels=[],e.contextMenuCardsGraphicModels=[]},destroy:function(t){this.isWSLocalMode||function(t){var e,n,r,o,a,i;if(null!==(e=mstrApp)&&void 0!==e&&null!==(n=e.rootCtrl)&&void 0!==n&&null!==(r=n.docCtrl)&&void 0!==r&&null!==(o=r.model)&&void 0!==o&&o.bs&&null!==(a=t.model)&&void 0!==a&&a.data&&!t.isWSLocalMode&&!t.isConsumption){var l=t.dataInterface.data.gsi.mx.map(function(e){var n;return null!==(n=e.wdgstrs)&&void 0!==n&&n[u]?{act:d,nodeKey:t.k,skey:u,objectId:e.did,objectType:4}:null}).filter(function(t){return t});(null===(i=t.model.data.wdgstrs)||void 0===i?void 0:i[s])&&l.push({act:d,nodeKey:t.k,skey:s}),l.length&&function(t,e){var n={taskId:"mojoRWManipulation",params:JSON.stringify({actions:e,style:{params:{treesToRender:2},name:"RWIVEMojoStyle"}}),nodeKey:t.k,suppressData:!0,messageId:mstrApp.getMsgID(),styleName:"RWIVEMojoStyle",rwb:mstrApp.rootCtrl.docCtrl.model.bs};mstrApp.serverRequest(n)}(t,l)}}(this),this._super(t)},onmousemove:function(t){var e=this,n=e.tooltipInfo,r={x:t.e.pageX,y:t.e.pageY},o={graphicModel:void 0};if(Lr(t.getTarget().parentNode).dispatch("tooltip",{detail:{evt:t,returnObject:o}}),o.graphicModel){if(n.isPositionFixed&&e.tooltipWin.isVisible())return;e.tooltipInfo={isVisible:!0,isPositionFixed:!1,position:r,graphicModel:o.graphicModel},this.showTooltip(o.graphicModel,r)}else e.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},this.hideTooltip(!1)},oncontextmenu:function(t){var e=t.e.target;"container"!==e.className&&function(t,e,n){var r=n.closest(".card"),o=n.closest(".card__trend-graph"),a=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===r.id}),i=e.selectedCardsGraphicModels,l=e.contextMenuCardsGraphicModels;if(Da(e,i),null==l||l.forEach(function(t){var e=Oa(t);null==e||e.classList.remove("card--selected-context-menu")}),e.isIOS&&e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")}),e.isMobile&&o){e.contextMenuCardsGraphicModels=[];var c={graphicModel:void 0};Lr(o.querySelector("svg")).dispatch("tooltip",{detail:{evt:t,returnObject:c}}),e.handleContextMenuSelection(t,c.graphicModel)}else if(r.classList.contains("card--selected")&&i.length>1){e.clearSelections();var u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zi(Object(n),!0).forEach(function(e){Ji(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zi(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t);u.ctrlKey=!0,u.metaKey=!0;var s=[];i.forEach(function(t){e.handleSelection(u,t),s.push(t)}),e.contextMenuCardsGraphicModels=s,e.handleContextMenuSelection(t,a)}else e.clearSelections(),e.contextMenuCardsGraphicModels=[a],e.handleContextMenuSelection(t,a);e.contextMenuCardsGraphicModels.forEach(function(t){Oa(t).classList.add("card--selected-context-menu")})}(t,this,e)},getContextMenuConfig:function(){var t=function(t){if(0===t.contextMenuCardsGraphicModels.length)return{commonConfig:[],customConfig:[]};var e=i(t.KPIType);return{commonConfig:x(t,e.BREAK_BY)?[{type:rl.CHANGE_VISUALIZATION},{type:rl.COPY_PASTE_FORMAT},{type:rl.KEEP_ONLY},{type:rl.EXCLUDE},{type:rl.DRILL},{type:rl.GROUP},{type:rl.CALCULATION},{type:rl.SHOW_DATA},{type:rl.GO_TO_TARGETS}]:[{type:rl.CHANGE_VISUALIZATION},{type:rl.COPY_PASTE_FORMAT}],customConfig:[t.isMobile?{}:{type:ol.NORMAL,name:mstrmojo.descP("KPI.","12","Copy Text"),onClick:function(){!function(t){var e=t.map(function(t){return al(t)}).join("\n"),n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}(t.contextMenuCardsGraphicModels.map(function(t){return Oa(t)}))}}]}}(this);return{common:t.commonConfig,custom:t.customConfig}},getGraphicModelsBySelector:function(t,e){var n=this,r=[],o={attribute:mstrmojo.customviz.PICKED_TYPE.BOTH,metric:mstrmojo.customviz.PICKED_TYPE.BOTH},a=function(t){mstrmojo.array.forEach(n.getGraphicModels(),function(a){a.getSelector()&&n.canPickGraphicModel(t,e,a,o)&&r.push(a)})};return t.length>1?t.forEach(a):a(t),0===r.length&&(function(t,e){e.getGraphicModels().forEach(function(t){var e=Oa(t);e&&Na(e)})}(0,this),n.selectedCardsGraphicModels=[],n.contextMenuCardsGraphicModels=[]),r},updateHighlight:function(){var t=this,e=this,n=[];e.getGraphicModels().forEach(function(e){t.graphicNeedsHighlight(e,!1)&&n.push(e)}),e.contextMenuCardsGraphicModels.length||Da(e,n)},resetComponents:function(){this.components={cardLabels:[],cardPrimaryValues:[],cardBodies:[],cardSecondaryValues:[],cardSecondaryValueWithIndicatorWrappers:[],cardIndicators:[]}},clearDomNode:function(){this.domNode.innerHTML=""},addMojoScrollbar:function(){var t=this,e=t.domNode;t.containerNode=e.firstChild.firstChild,t.scrollNode=e.firstChild,t.isIOS?t.scrollbarHostNode=e.firstChild:t.scrollbarHostNode=e,t.scrollBarNodes={};var n=t.domNode.style,r=n.height,o=n.width;t.scrollNode.style.maxHeight=r,t.containerNode.style.maxHeight=r,t.containerNode.style.width=o,t.updateScrollbars(),t.addScrollNodeProperties()},plot:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this,o=r.isRealtimeStreamingEnabled&&r.isRealtimeStreamingEnabled();if(r.isConsumption=!(null!==(t=(e=mstrApp).supportFeature)&&void 0!==t&&t.call(e,"show-react-dossier-format")),!o&&function(t){var e=i(t.KPIType);return!(!x(t,e.BREAK_BY)||!t.dataInterface.data.gsi.mx.length)&&(0===t.KPIType?t.dataInterface.data.gts.row[0].es.length*t.dataInterface.data.gsi.mx.length:t.dataInterface.data.gts.row[0].es.length)>500}(r)){var a,c=(null===(a=r.dataInterface.data.gts.row[0])||void 0===a?void 0:a.n)||"";throw new Error(mstrmojo.descP("KPI.","49","The attribute ## has too many elements. Please filter the data to display the KPIs.").replace("##",c))}for(var u=Q(r.model.data.nf),s=!1,d=0;d<r.model.data.nf.length&&!s&&r.formattingModel;d++){var f;s=r.model.data.nf[d].id!==(null===(f=r.formattingModel.model[d])||void 0===f?void 0:f.id)||r.model.data.nf[d].nfs!==r.formattingModel.model[d].nfs}r.metricFormattingRules=u,r.formattingModel={model:r.model.data.nf,didMetricFormattingRuleChange:s},r.trendSVGs=[],r.shouldFontBeChanged=[],r.cardIds=[],r.graphicModels=[],r.truncatedLabels=[],r.isRealTime=o,r.isComparisonMetricAdded=Y(r);var p=i(r.KPIType);if(o&&(r.isBreakByAttributeAdded=x(r,p.BREAK_BY),r.isTrendAttributeAdded=x(r,p.TREND),function(t){var e,n,r=t.isBreakByAttributeAdded;r&&(n=0),t.isTrendAttributeAdded&&(e=r?1:0),t.timestampIndex=e,t.breakByIndex=n}(r)),!o||r.data&&r.data.length){r.currentInterval&&clearInterval(r.currentInterval);var m=function(){var t=function(t){var e=i(t.KPIType),n=!x(t,e.METRICS),r=mstrApp.isDisplayOnMobile||mstrApp.isDossier||/(android)/i.test(navigator.userAgent),o=!window.mstrApp.isExporting&&!r&&!window.mstrApp.features["show-react-dossier-format"],a=t.isComparisonKPI;if(o)throw t.errorMessage=a?mstrmojo.descP("KPI.","11","Comparison KPI is supported only on environments 11.3.1 or higher"):mstrmojo.descP("KPI.","10","Multi-Metric KPI is supported only on environments 11.3.1 or higher"),t.errorDetails="",new Error("No react-format-panel");if(n){var l=document.createElement("div");l.classList.add("warning-container");var c=document.createElement("div");c.classList.add("icon"),c.style.backgroundPosition=a?"0 -90px":"0 0";var u=t.domNode,s=u.clientWidth,d=u.clientHeight;(s<640||d<600)&&(c.style.width="60px",c.style.height="60px",c.style.backgroundPosition=a?"-90px -90px":"-90px 0"),l.appendChild(c);var f=document.createElement("div");f.classList.add("title");var p=document.createTextNode(a?mstrmojo.descP("KPI.","41","Comparison KPI"):mstrmojo.descP("KPI.","40","Multi-Metric KPI"));f.appendChild(p),l.appendChild(f);var m=document.createElement("div");m.classList.add("description"),m.innerHTML=a?mstrmojo.descP("KPI.","9","Add 2 #metrics####").replace("####","").replace("#","<svg class='metric-icon'></svg>"):mstrmojo.descP("KPI.","8","Add 2 or more #metrics####").replace("####","").replace("#","<svg class='metric-icon'></svg>"),l.appendChild(m),t.domNode.appendChild(l)}return o||n}(r);if(t)r.raiseEvent({name:"renderFinished",id:r.k});else{var e,o=r.intervalAutoPlayId;if(o&&clearInterval(o),r.addUseAsFilterMenuItem(),n)e=G(n,r);else{var a=JSON.parse(r.getProperty(C));e=G(a,r)}r.properties=e;var c=function(){var t,n,o=function(t,e){var n=t.model.data.nf,r=Q(n,!0),o=n.map(function(t){return t.id}),a={};return o.forEach(function(t){var n=e[t]||{},o=n.value,i=n.font;if(o&&!isNaN(o)){var l=tt(o,t,r).formattedValue;a[t]=e[t],a[t].formattedValue=l,a[t].font={fontColor:i.color,fontSize:i.size,fontFamily:i.fontFamily,fontStyle:i.style}}}),a}(r,e.createdReferenceLines);r.resetComponents(),r.trendSVGs=[],r.clearDomNode(),function(){var t=r.isRealTime,n=r.isBreakByAttributeAdded,a=r.isComparisonMetricAdded,c=r.cardsOrder,u=r.breakByIndex,s=r.timeFilter,d=r.data,f=t?d:function(t){var e=mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT.ROWS_ADV;return t.dataInterface.getRawData(e,{hasSelection:!0,hasTitleName:!0,minAttribute:0})}(r);t&&n&&c&&f.sort(function(t,e){return c.findIndex(function(e){return e===t.cells[u].v})-c.findIndex(function(t){return t===e.cells[u].v})});var p,m=function(t,e,n,r){var o,a,c=i(e.KPIType),u=function(t,e){var n=Q(e.model.data.nf);return t.forEach(function(t){t.forEach(function(t){var e=t.trendChartData[t.trendChartData.length-1].raw,r=t.trendChartData[t.trendChartData.length-1].formatted,o=tt(e,t.metricId,n).color;t.primaryValue={raw:e,formatted:r,color:o}})}),t}(ct(t,e,c),e),s=(o=function(t,e,n,r){if(!x(e,r.TREND))return[t];var o={min:null,max:null},a=e.isComparisonKPI,i=e.isRealTime,l=n.axisScale,c=n.axisScaleComparison;return a&&(l=c),t.forEach(function(t){var e=null,n=null,r=t.map(function(t){return t.trendChartData.map(function(t){return t.raw})});if(l!==y.AXIS_SCALE.GLOBAL){var a=r.flat();n=a.reduce(function(t,e){return Math.min(t,e)},0),e=a.reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),o.min=Math.min(0,o.min,n),o.max=Math.max(o.max,e)}t.forEach(function(t,o){if(t.trendChartData.length<=1)t.trend=null;else{var a,l=r[o].reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),c=null!==(a=e)&&void 0!==a?a:l,u=function(t,e,n,r,o){if(null!==r)return r;var a=e[n],i=t?a.reduce(function(t,e){return Math.min(t,e)},Number.POSITIVE_INFINITY):a.reduce(function(t,e){return Math.min(t,e)},0);return i>=0&&i===o?0:i}(i,r,o,n,c);t.trend={minValue:u,maxValue:c}}})}),[t,o]}(u,e,n,c),a=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(o,a)||it(o,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=s[0],f=s[1],p=function(t,e,n,r){var o=e.isComparisonKPI,a=e.isRealTime,i=e.isBreakByAttributeAdded,c=e.timeFilter,u=n.secondaryMetricName,s=x(e,r.TREND);e.isTrendAttributeAdded=s;var d=0===e.KPIType,f=o?x(e,r.COMPARE_WITH):null,p=x(e,r.METRICS)&&f;if(d&&!s||o&&!p&&!s)return t;var m=Q(e.model.data.nf);return e.metricFormattingRules=m,e.metricId=t[0][0].metricId,t.forEach(function(t){t.forEach(function(t){if(a&&(t.cardSecondaryLabel=function(t,e,n,r,o){if(t<=e.timeRangeStart||n||!r&&e.isMoreDataThanFilter)return o;var a=t.toTimeString().split(" ").shift();return"Compare to ".concat(a)}(t.trendChartData[0].timestampDate,c,p,i,u)),null!==t.trend||p){var e,n,r,o={label:a?t.cardSecondaryLabel:u};r=a?0:t.trendChartData.length-2,p?(o.value=t.compareMetricValue.formatted,e=t.compareMetricValue.raw,n=t.compareMetricId):(o.value=t.trendChartData[r].formatted,e=t.trendChartData[r].raw,n=t.metricId);var s=t.primaryValue.raw-e,d=y.TREND_INDICATOR_VALUE_TYPE,f=tt(s,n,m).formattedValue,h=at(at(at({},d.NUMERIC,f),d.PERCENT,[0,""].includes(e)?l:D({partialValue:s,totalValue:e})),"differenceBetweenPrimaryAndSecondary",s);t.secondaryValue=o,t.indicator=h}else t.secondaryValue=null,t.indicator=null})}),t}(d,e,n,c).flat(),m=function(t,e,n,r){var o=n.axisScale,a=n.axisScaleComparison;return r.isComparisonKPI&&(o=a),o===y.AXIS_SCALE.SYNCED_ALL?t.map(function(t){return t.trend={minValue:e.min,maxValue:e.max},t}):t}(dt(p,n,e.isTrendAttributeAdded),f,n,e);return function(t,e){return t.map(function(t){return t.referenceLine=e[t.metricId],t})}(m,r)}(f,r,e,o);m.forEach(function(t){r.graphicModels.push(t.graphicModel)}),t&&n&&(r.cardDetails=null!==(p=r.cardDetails)&&void 0!==p?p:[],Xi(m,r.cardDetails,s,d,e,a)),r.isSingleCardDisplayed=1===m.length||e.layoutType===y.LAYOUT_TYPES.STACKED,function(t,e){var n,r=i(t.KPIType),o=null===(n=t.gridData.gsi.sorts)||void 0===n?void 0:n[0],a=!(null==o||!o.length),l=x(t,r.BREAK_BY);if(a&&l&&e[0].graphicModel.getSelector().tid===o[0].key.split("!")[1]){var c={};e.forEach(function(t,e){t in c||(c[t.breakByAttributeName]=e)}),e.sort(function(t,e){return c[t.breakByAttributeName]-c[e.breakByAttributeName]})}}(r,m),r.parsedData=m}();var a=r.domNode,c=r.parsedData,u=r.isMobile,s=r.isInChatbot,d=a.appendChild(Et({},!1));d.appendChild(yi(r,c,e)),r.visualizationNode=d;var f=d.appendChild(document.createElement("div"));f.classList.add("font-size-measure-div"),ji(e,r),f.remove(),e.layoutType===y.LAYOUT_TYPES.GRID&&r.addMojoScrollbar(),u||s||e.layoutType===y.LAYOUT_TYPES.STACKED||function(t){var e,n,r,o,a=t.domNode,l=a.clientWidth,c=a.clientHeight,u=Lr(a),s=u.append("div").attr("class","selection-tool").style("visibility","hidden");u.call(function(){var t,e,n,r,o=Yr,a=Ur,i=Gr,l=$r,c={},u=ke("start","drag","end"),s=0,d=0;function f(t){t.on("mousedown.drag",p).filter(l).on("touchstart.drag",y).on("touchmove.drag",v,Vr).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(i,l){if(!r&&o.call(this,i,l)){var c=b(this,a.call(this,i,l),i,l,"mouse");c&&(Lr(i.view).on("mousemove.drag",m,Fr).on("mouseup.drag",h,Fr),function(t){var e=t.document.documentElement,n=Lr(t).on("dragstart.drag",Br,Fr);"onselectstart"in e?n.on("selectstart.drag",Br,Fr):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(i.view),kr(i),n=!1,t=i.clientX,e=i.clientY,c("start",i))}}function m(r){if(Br(r),!n){var o=r.clientX-t,a=r.clientY-e;n=o*o+a*a>d}c.mouse("drag",r)}function h(t){Lr(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,r=Lr(t).on("dragstart.drag",null);e&&(r.on("click.drag",Br,Fr),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),Br(t),c.mouse("end",t)}function y(t,e){if(o.call(this,t,e)){var n,r,i=t.changedTouches,l=a.call(this,t,e),c=i.length;for(n=0;n<c;++n)(r=b(this,l,t,e,i[n].identifier,i[n]))&&(kr(t),r("start",t,i[n]))}}function v(t){var e,n,r=t.changedTouches,o=r.length;for(e=0;e<o;++e)(n=c[r[e].identifier])&&(Br(t),n("drag",t,r[e]))}function g(t){var e,n,o=t.changedTouches,a=o.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<a;++e)(n=c[o[e].identifier])&&(kr(t),n("end",t,o[e]))}function b(t,e,n,r,o,a){var l,d,p,m=u.copy(),h=jr(a||n,e);if(null!=(p=i.call(t,new Hr("beforestart",{sourceEvent:n,target:f,identifier:o,active:s,x:h[0],y:h[1],dx:0,dy:0,dispatch:m}),r)))return l=p.x-h[0]||0,d=p.y-h[1]||0,function n(a,i,u){var y,v=h;switch(a){case"start":c[o]=n,y=s++;break;case"end":delete c[o],--s;case"drag":h=jr(u||i,e),y=s}m.call(a,t,new Hr(a,{sourceEvent:i,subject:p,target:f,identifier:o,active:y,x:h[0]+l,y:h[1]+d,dx:h[0]-v[0],dy:h[1]-v[1],dispatch:m}),r)}}return f.filter=function(t){return arguments.length?(o="function"==typeof t?t:Kr(!!t),f):o},f.container=function(t){return arguments.length?(a="function"==typeof t?t:Kr(t),f):a},f.subject=function(t){return arguments.length?(i="function"==typeof t?t:Kr(t),f):i},f.touchable=function(t){return arguments.length?(l="function"==typeof t?t:Kr(!!t),f):l},f.on=function(){var t=u.on.apply(u,arguments);return t===u?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f}().on("start",function(i){var l,c,d=t.tooltipInfo;o=i.sourceEvent.target,d.isVisible&&null!==(l=t.model)&&void 0!==l&&null!==(c=l.data)&&void 0!==c&&c.doslinkinfo&&(t.showTooltip(d.graphicModel,d.position,!0),d.isPositionFixed=!0),(r=u.selectAll("article")).each(function(t,e,n){n[e].style.pointerEvents="none"}),e=a.scrollTop;var f={y:i.y,x:i.x};n=f,s.style("visibility","visible").style("left","".concat(n.x,"px")).style("top","".concat(n.y+e,"px")).style("width","0px").style("height","0px")}).on("drag",function(t){var r={y:t.y,x:t.x},o=l-n.x-2,a=c-n.y-2,i=r.x-n.x,u=r.y-n.y;i<0&&(s.style("left","".concat(Math.max(0,r.x),"px")),o=n.x),u<0&&(s.style("top","".concat(Math.max(0,r.y+e),"px")),a=n.y);var d=Math.min(o,Math.abs(i)),f=Math.min(a,Math.abs(u));s.style("width","".concat(d,"px")).style("height","".concat(f,"px"))}).on("end",function(n){var a={xMin:parseInt(s.style("left")),xMax:parseInt(s.style("left"))+parseInt(s.style("width")),yMin:parseInt(s.style("top")),yMax:parseInt(s.style("top"))+parseInt(s.style("height"))};s.style("visibility","hidden");var l=function(t,e,n,r){var o=n.xMin,a=n.xMax,i=n.yMin,l=n.yMax,c=t.node().getBoundingClientRect(),u=c.x,s=c.y,d=[];return e.each(function(t,e,n){var c=n[e],f=c.getBoundingClientRect(),p=f.x,m=f.y,h=f.width,y=f.height,v=p-u,g=m-s+r;!(o>v+h||a<v||l<g||i>g+y)&&d.push(c)}),d}(u,r,a,e);(function(t,e,n,r){var o=!!e.contextMenuCardsGraphicModels.length;if(Ma(e),n.length>1){e.selectedCardsGraphicModels=n.map(function(t){return e.getGraphicModels().find(function(e){return mstrmojo.string.encodeHtmlString(e.cardId)===t.id})}),e.clearSelections(),Da(e);var a=i(e.KPIType),l=x(e,a.TREND),c=x(e,a.BREAK_BY);(l||c)&&e.applySelection(e.selectedCardsGraphicModels.map(function(t){return t.getSelector()}))}else if(1===n.length){var u=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===n[0].id});Sa(t,e,u,r)}else o||(e.selectedCardsGraphicModels=[],e.clearSelections(),Da(e),e.handleSelection(t))})(n,t,l,o),r.each(function(t,e,n){n[e].style.pointerEvents="auto"})}).filter(function(t){return!("mstrmojo-scrollbar vertical"===t.target.className||2===t.button)}))}(r),r.animationDuration=0,e.stackedAutoPlay?r.autoPlayEnabled=!0:r.autoPlayEnabled=!1;var p=null===(t=r.getSelectionCache)||void 0===t||null===(n=t.call(r))||void 0===n?void 0:n._viSelections;p&&r.highlight("att",p,!0),r.raiseEvent({name:"renderFinished",id:r.k})};!function(t,e,n,r){var o=[t.allFontOptions,t.labelFontOptions,t.primaryValueFontOptions,t.secondaryValueFontOptions,t.indicatorFontOptions].map(function(t){return{name:t.fontFamily,isItalic:t.fontStyle[1],isBold:t.fontStyle[0]}}).reduce(function(t,e){return t.find(function(t){return t.name===e.name&&t.isItalic===e.isItalic&&t.isBold===e.isBold})?t:t.concat([e])},[]);mstrmojo.util.FontLoader.load(e.id,o,{success:n,failure:r})&&n()}(e,r,c,c)}},h="".concat(r.cssClass,"stylesheet");if(mstrApp.isWorkstation&&!Yi(document.styleSheets).some(function(t){var e;return null===(e=t.href)||void 0===e?void 0:e.includes(r.cssClass)})){var v=document.getElementById(h);if(v){var g=v.onload;v.onload=function(){g(),m()}}else{var b=document.head,_=document.createElement("link");_.type="text/css",_.onload=m,_.id=h,_.rel="stylesheet",_.href="../plugins/".concat(r.cssClass,"/style/global.css"),b.appendChild(_)}}else m()}},renderRealtimeData:function(t){var e,n=this,r=n.timestampIndex,o=n.breakByIndex,a=n.isBreakByAttributeAdded,i=n.isTrendAttributeAdded;n.cardsOrder=null!==(e=n.cardsOrder)&&void 0!==e?e:[],a&&!n.cardsOrder.find(function(e){return e===t[0].cells[o].v})&&n.cardsOrder.push(t[0].cells[o].v),i&&(t[0].cells[r].v=t[0].cells[r].v.replace("T"," ").slice(0,-1),t[0].timestampDateFormat=new Date(t[0].cells[r].v)),n.data?n.data.push(t[0]):n.data=t,0===n.parsedData.length?(this.checkTimeFilter(),i&&(this.updateTimeFilterRanges(t[0].cells[r].v),this.timeFilter.isMoreDataThanFilter=!1),this.plot()):this.updateCardsAndRenderVisualization(t)},checkTimeFilter:function(){var t=this;t.updateFrequency=t.getRealtimeUpdateFrequency();var e=t.getRealtimeFilterInfo();if(t.timeFilter={},e){var n,r,o=e.curre,a=e.lastt,i=e.lastti,l=e.timef;if(t.timeFilter.typeOfTimeFilter=l,1===l)n=1===i?a:60*a;else{switch(o){case 1..KEY:n=1..TIME_IN_SECONDS;break;case 2..KEY:n=2..TIME_IN_SECONDS;break;case 3..KEY:n=3..TIME_IN_SECONDS;break;default:n=4..TIME_IN_SECONDS}t.timeFilter.currentSelection=o}r=n<=60?"".concat(n).concat("s"):n<=3600?"".concat(n/60).concat("mins"):n<=86400?"".concat(n/3600).concat("h"):"".concat(n/86400).concat("day"),t.timeFilter.filterTimeInSeconds=n,t.timeFilter.filterLabel=r}else{t.timeFilter={typeOfTimeFilter:1,filterTimeInSeconds:7200,filterLabel:"".concat(7200).concat("s")}}},updateTimeFilterRanges:function(t){var e=this.timeFilter,n="string"==typeof t?new Date(t):t;1===e.typeOfTimeFilter?e.timeRangeStart=new Date(n-e.filterTimeInSeconds*Hi[Fi]):2===e.typeOfTimeFilter&&(e.timeRangeStart=function(t,e){var n,r={year:(n=t).getFullYear(),month:n.getMonth(),day:n.getDate(),hour:n.getHours(),minute:n.getMinutes()},o=r.year,a=r.month,i=r.day,l=r.hour,c=r.minute;switch(e){case 1..KEY:return c<15?new Date(o,a,i,l,0):c<30?new Date(o,a,i,l,15):c<45?new Date(o,a,i,l,30):new Date(o,a,i,l,45);case 2..KEY:return c<30?new Date(o,a,i,l,0):new Date(o,a,i,l,30);case 3..KEY:return new Date(o,a,i,l,0);default:return new Date(o,a,i,0)}}(n,e.currentSelection))},applyFilterOnTrendData:zi,rerenderVisualization:function(t,e){var n=this;!function(t,e,n){var r=t.isComparisonMetricAdded,o=t.isTrendAttributeAdded,a=t.isBreakByAttributeAdded,i=t.isComparisonKPI,l=t.updatedCategory,c=t.metricFormattingRules,u=t.data.at(-1).cells,s=ut(u,t),d=!(o||i&&r);t.cardDataToUpdate=t.parsedData.find(function(t){return t.breakByAttributeName===l}),t.parsedData.forEach(function(r){if(!a||r.breakByAttributeName===l){var o=r.trendChartData,i=e[t.mappedIndexes[r.metricId]].v,f=tt(i,r.metricId,c).formattedValue;r.primaryValue.raw=i,r.primaryValue.formatted=f,d?o.push({raw:i,formatted:f}):$i(t,u,s,n,r)}})}(n,t,e),function(t){var e=t.isComparisonMetricAdded,n=t.isBreakByAttributeAdded,r=t.components,o=t.cardDataToUpdate,a=t.data,i=t.updatedCategory,l=t.properties,c=!e&&(!r.cardSecondaryValues[0]&&1!==a.length||n&&void 0===o.secondaryValueComponentIndex),u=e&&(!n&&2===a.length&&void 0===t.parsedData[0].trendComponentIndex||n&&void 0===o.trendComponentIndex);(c||u)&&t.parsedData.forEach(function(n,r){var o=null==n||!n.breakByAttributeName||n.breakByAttributeName===i;za(n,t,l,r,!e&&o,o)})}(n),Gi(n)},onRealtimeTopicChanged:function(){this.data=[],this.rawData=[],this.parsedData=[],this.trendSVGs=[]},updateCardsAndRenderVisualization:function(t){var e,n=this,r=n.isBreakByAttributeAdded,o=n.timestampIndex,a=n.breakByIndex,i=n.isTrendAttributeAdded;n.updatedCategory=r?t[0].cells[a].v:null,i?(e=t[0].cells[o].v,n.updateTimeFilterRanges(e),n.data=function(t){var e,n,r=t.timeFilter,o=t.data,a=t.breakByIndex,i=t.updatedCategory,l=t.isBreakByAttributeAdded,c=t.isComparisonMetricAdded;if(!l||c){var u=o.findIndex(function(t){return t.timestampDateFormat>r.timeRangeStart});e=o.slice(u),r.firstIndexInFilterRange=u}else e=o.filter(function(t){return t.cells[a].v!==i||t.timestampDateFormat>r.timeRangeStart});return!r.isMoreDataThanFilter&&o[0].timestampDateFormat<=r.timeRangeStart&&(r.isMoreDataThanFilter=!0,null!==(n=t.properties)&&void 0!==n&&n.secondaryMetricName&&function(t){var e=t.timeFilter,n=t.properties,r=t.components;if(2===e.typeOfTimeFilter){var o="Since ".concat(e.timeRangeStart.toLocaleTimeString());n.secondaryMetricName=o,r.cardSecondaryValues.forEach(function(t){t.secondaryValueData.labelTitle=o})}else{var a=G({secondaryMetricName:""},t);n.secondaryMetricName=a.secondaryMetricName}}(t)),e}(n)):e=t[0].timestamp;var l=n.parsedData.map(function(t){return t.breakByAttributeName}).filter(function(t){return t}),c=!!r&&function(t,e){var n=e.updateFrequency,r=e.updatedCategory,o=e.timeFilter,a=e.parsedData,i=new Date(t-n*Hi[Fi]),l=a.filter(function(t){var e=t.isCardOld&&t.breakByAttributeName!==r&&t.lastUpdateTimestamp<i,n=t.breakByAttributeName===r&&t.trendChartData.at(-1).timestampDate<=o.timeRangeStart;return e||n}),c=l.length>0;return c&&function(t,e){t.forEach(function(t){e.cardsOrder=t.breakByAttributeName!==e.updatedCategory?e.cardsOrder.filter(function(e){return e!==t.breakByAttributeName}):e.cardsOrder,e.data=e.data.filter(function(n){return n.cells[e.breakByIndex].v!==t.breakByAttributeName||n.cells[e.breakByIndex].v===e.updatedCategory}),e.cardDetails=e.cardDetails.filter(function(e){return e.breakByAttributeName!==t.breakByAttributeName})})}(l,e),function(t,e){var n=e.updatedCategory,r=e.timeFilter,o=e.parsedData,a=e.cardDetails;o.forEach(function(e){var o;e.isCardOld=e.trendChartData.at(-1).timestampDate<r.timeRangeStart&&e.breakByAttributeName!==n;var i=null!==(o=e.lastUpdateTimestamp)&&void 0!==o?o:t;e.lastUpdateTimestamp=e.isCardOld?i:null,a.forEach(function(t){t.breakByAttributeName===e.breakByAttributeName&&(t.isCardOld=e.isCardOld,t.lastUpdateTimestamp=e.lastUpdateTimestamp)})})}(t,e),c}(t[0].timestampDateFormat,n),u=!r&&1===n.data.length&&n.parsedData[0].trendChartData.length>1;if(c||u||0!==l.length&&t.some(function(t){return!l.includes(t.cells[a].v)}))this.plot();else{var s=n.dataInterface.data.realtimeQueryInfo.columns,d=[];t.forEach(function(t){s.forEach(function(e,n){-1===e.bfid&&d.push(t.cells[n])})}),this.rerenderVisualization(d,e)}}})})();