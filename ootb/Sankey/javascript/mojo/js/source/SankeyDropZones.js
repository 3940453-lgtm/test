(()=>{"use strict";mstrmojo.plugins.Sankey||(mstrmojo.plugins.Sankey={}),mstrmojo.plugins.Sankey||(mstrmojo.plugins.Sankey={}),mstrmojo.descriptors["Sankey.1"]||mstrmojo.requiresDescsWPrefix("Sankey.",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75),mstrmojo.requiresCls("mstrmojo.vi.models.CustomVisDropZones");var e=mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE,t=mstrmojo.descP("Sankey.","43","Levels"),o=mstrmojo.descP("Sankey.","44","Metric"),s=mstrmojo.descP("Sankey.","45","Tooltip");mstrmojo.plugins.Sankey.SankeyDropZones=mstrmojo.declare(mstrmojo.vi.models.CustomVisDropZones,null,{scriptClass:"mstrmojo.plugins.Sankey.SankeyDropZones",cssClass:"sankey-dropzones",getCustomDropZones:function(){return[{name:t,title:mstrmojo.descP("Sankey.","46","Drag attributes here"),allowObjectType:e.ATTRIBUTE,minCapacity:2},{name:o,title:mstrmojo.descP("Sankey.","47","Drag metric here"),maxCapacity:1,allowObjectType:e.METRIC},{name:s,isAdditionalInfo:!0,title:mstrmojo.descP("Sankey.","48","Drag metrics here"),allowObjectType:e.METRIC}]},getActionsForObjectsDropped:function(e,t){var r=[],n=this;return this.getDropZoneName(e)===s?mstrmojo.array.forEach(t,function(e){n.isObjectInZone(e,o)&&n.getRemoveDropZoneObjectsActions(r,o,e)}):this.getDropZoneName(e)===o&&mstrmojo.array.forEach(t,function(e){n.isObjectInZone(e,s)&&n.getRemoveDropZoneObjectsActions(r,s,e)}),r},getActionsForObjectsRemoved:function(e,o){if(this.getDropZoneName(e)===t){var s,r=this.getHost(),n=JSON.parse(r.getProperty("cachedNodesOrder")),i=JSON.parse(r.getProperty("nodeWidthByLevelData")),a=r.dataInterface.getRowTitles().titles.map(function(e){return{n:e.n,dssid:e.id}});o.forEach(function(e){var t=e.id;delete n[t],delete i[t],a=a.filter(function(e){return e.dssid!==t})}),JSON.parse(r.getProperty("isReverseGraphEnabled"))&&a.reverse(),r.setProperty("nodeWidthSelectedLevel",null===(s=a[0])||void 0===s?void 0:s.dssid,{suppressData:!0}),r.setProperty("cachedNodesOrder",JSON.stringify(n),{suppressData:!0}),r.setProperty("nodeWidthByLevelData",JSON.stringify(i),{suppressData:!0})}return[]},getActionsForDoubleClick:function(e){var t=this._super(e);return this.isMetric(e)&&(4===t[0].zoneId?this.isObjectInZone(e,s)&&this.getRemoveDropZoneObjectsActions(t,s,e):5===t[0].zoneId&&(t=[],this.isZoneEmpty(o)||this.isObjectInZone(e,o)||this.getReplaceDropZoneObjectsActions(t,o,e,0))),t},customDropZonesTransition:function(e,r){this.transitionObjectsToZone(t,e);var n=r.filter(function(e){return"AdditionalMetrics"!==e.fromZone});this.transitionObjectsToZone(o,n[0]);var i=r.findIndex(function(e){return e.did===n[0].did});r.splice(i,1),this.transitionObjectsToZone(s,r)}})})();