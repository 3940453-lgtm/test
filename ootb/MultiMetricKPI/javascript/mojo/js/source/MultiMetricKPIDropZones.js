(()=>{"use strict";mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});const e={LIGHT:{AREA:"#FFFFFF",TREND:"#D2D2D2",TREND_OPACITY:"40",FONT:"#35383A"},NIGHT:{AREA:"#313855",TREND:"#539CAE",TREND_OPACITY:"100",FONT:"#FFFFFF"},DESERT:{AREA:"#606060",TREND:"#FFD333",TREND_OPACITY:"100",FONT:"#FFFFFF"},OCEAN:{AREA:"#5181D7",TREND:"#83C8F4",TREND_OPACITY:"100",FONT:"#FFFFFF"}},t={INCREASE:"#83C962",DECREASE:"#DB6657",CONSTANT:"#606060"};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var l={TEXT_CONTENT_TYPE:{ALL:"all",LABEL:"label",PRIMARY_VALUE:"primaryValue",SECONDARY_VALUE:"secondaryValue",INDICATOR:"indicator"},TREND_SHAPE:{AREA:"area",BAR:"bar",LINE:"line"},AXIS_SCALE:{GLOBAL:"global",SYNCED_METRIC:"synced",SYNCED_ALL:"syncedAll"},CARD_ALIGNMENT:{LEFT:"left",MIDDLE:"middle",RIGHT:"right"},TREND_INDICATOR_SHAPE:{BADGE:"badge",ARROW:"arrow"},TREND_INDICATOR_VALUE_TYPE:{PERCENT:"percentValue",NUMERIC:"numericValue"},SELECTED_REFERENCE_LINE_SHAPE:{DOTTED_LINE_TYPE:"1pt dotted",DASHED_LINE_TYPE:"1pt dashed",THIN_LINE_TYPE:"1pt solid",THICK_LINE_TYPE:"2pt solid"},REFERENCE_LINE_DEFAULT_VALUES:{font:{fontFamily:"Open Sans",style:[!1,!1,!1,!1],size:9,color:"#35383A"},line:{shape:"1pt dashed",color:"#4D4D4D"}},LAYOUT_TYPES:{GRID:0,STACKED:1,HORIZONTAL:2,VERTICAL:3},TEXT_SIZE_TYPE:{UNIFIED:0,FIT_TO_CONTAINER:1,FIXED:2},FIRST_CARD_INDEX:1},E={fontFamily:"Open Sans",fontStyle:[!1,!1,!1,!1],fontSteps:0,fontSize:""},u={HIDEABLE_SECTION_TEMPLATE:{name:"hideableSectionTemplate",defaultValue:null},CARD_STYLE:{name:"cardStyle",defaultValue:0},HIDEABLE_SECTION_LAYOUT:{name:"hideableSectionLayout",defaultValue:null},LAYOUT_TYPE:{name:"layoutType",defaultValue:l.LAYOUT_TYPES.GRID},GRID_LAYOUT_PROPERTIES:{name:"gridLayoutProperties",defaultValue:null},GRID_COLUMN_COUNT:{name:"gridColumnCount",defaultValue:4},GRID_FIX_CARD_HEIGHT:{name:"gridFixCardHeight",defaultValue:null},GRID_FIX_CARD_HEIGHT_ENABLED:{name:"gridFixCardHeightEnabled",defaultValue:!1},STACKED_LAYOUT_PROPERTIES:{name:"stackedLayoutProperties",defaultValue:null},STACKED_AUTO_PLAY:{name:"stackedAutoPlay",defaultValue:!0},SHOW_METRIC_NAME:{name:"showMetricName",defaultValue:null},SECONDARY_VALUE_LAYOUT:{name:"secondaryValueLayout",defaultValue:null},SECONDARY_METRIC_NAME:{name:"secondaryMetricName",defaultValue:""},TREND_INDICATOR_LAYOUT:{name:"trendIndicatorLayout",defaultValue:null},TREND_INDICATOR_ENABLED:{name:"trendIndicatorEnabled",defaultValue:!0},TREND_INDICATOR_ENABLED_LABEL:{name:"trendIndicatorEnabledLabel",defaultValue:""},COMPARISON_INDICATOR_ENABLED:{name:"comparisonIndicatorEnabled",defaultValue:!0},COMPARISON_INDICATOR_ENABLED_LABEL:{name:"comparisonIndicatorEnabledLabel",defaultValue:""},TREND_INDICATOR_VALUE_TYPE:{name:"trendIndicatorValueType",defaultValue:l.TREND_INDICATOR_VALUE_TYPE.PERCENT},ENTIRE_CHART_SECTION:{name:"entireChartSection",defaultValue:null},TEXT_SIZE_TYPE:{name:"textSizeType",defaultValue:l.TEXT_SIZE_TYPE.UNIFIED},SHAPE_SECTION:{name:"shapeSection",defaultValue:null},SHAPE_TYPE:{name:"shapeType",defaultValue:0},SHAPE_TYPE_COMPARISON:{name:"shapeTypeComparison",defaultValue:0},SHAPE_TYPE_COMPARISON_NO_TREND:{name:"shapeTypeComparisonNoTrend",defaultValue:0},BACKGROUND_SHAPE_AREA_SECTION:{name:"backgroundShapeAreaSection",defaultValue:null},THRESHOLDS_SECTION:{name:"colorThresholdsSection",defaultValue:{thresholds:[]}},TEXT_CONTENT_TYPE:{name:"textContentType",defaultValue:l.TEXT_CONTENT_TYPE.ALL},TEXT_CONTENT_TYPE_COMPARISON:{name:"textContentTypeComparison",defaultValue:l.TEXT_CONTENT_TYPE.ALL},FONT_FAMILY:{name:"fontFamily",defaultValue:E.fontFamily},FONT_STYLE:{name:"fontStyle",defaultValue:[!1,!1,!1,!1]},FONT_STEPS:{name:"fontSteps",defaultValue:0},FONT_SIZE:{name:"fontSize",defaultValue:""},FONT_COLOR:{name:"fontColor",defaultValue:e.LIGHT.FONT},TEXT_ALL_FONT_OPTIONS:{name:"allFontOptions",defaultValue:o(o({},E),{},{fontColor:"INDETERMINATE"})},TEXT_LABEL_FONT_OPTIONS:{name:"labelFontOptions",defaultValue:o(o({},E),{},{fontColor:e.LIGHT.FONT})},TEXT_PRIMARY_VALUE_FONT_OPTIONS:{name:"primaryValueFontOptions",defaultValue:o(o({},E),{},{fontColor:e.LIGHT.FONT})},TEXT_SECONDARY_VALUE_FONT_OPTIONS:{name:"secondaryValueFontOptions",defaultValue:o(o({},E),{},{fontStyle:[!0,!0,!1,!1],fontColor:e.LIGHT.FONT})},TEXT_INDICATOR_FONT_OPTIONS:{name:"indicatorFontOptions",defaultValue:o(o({},E),{},{fontColor:e.NIGHT.FONT})},AREA_FILL_COLOR:{name:"areaFillColor",defaultValue:e.LIGHT.AREA},AREA_FILL_OPACITY:{name:"areaFillOpacity",defaultValue:100},TREND_FILL_COLOR:{name:"trendFillColor",defaultValue:e.LIGHT.TREND},TREND_FILL_OPACITY:{name:"trendFillOpacity",defaultValue:e.LIGHT.TREND_OPACITY},TREND_INCREASE_BACKGROUND_COLOR:{name:"trendIncreaseBackgroundColor",defaultValue:t.INCREASE},TREND_DECREASE_BACKGROUND_COLOR:{name:"trendDecreaseBackgroundColor",defaultValue:t.DECREASE},HIDEABLE_SECTION_TREND_SHAPE:{name:"hideableSectionTrendShape",defaultValue:null},TREND_SHAPE:{name:"trendShape",defaultValue:l.TREND_SHAPE.AREA},AXIS_SCALE:{name:"axisScale",defaultValue:l.AXIS_SCALE.GLOBAL},AXIS_SCALE_COMPARISON:{name:"axisScaleComparison",defaultValue:l.AXIS_SCALE.GLOBAL},EMPTY_VIZ_WARNING_MESSAGE:{name:"emptyVizWarningMessage",defaultValue:null},VIZ_FIRST_TAB_SECTION:{name:"vizFirstTabSection",defaultValue:null},VIZ_SECOND_TAB_SECTION:{name:"vizSecondTabSection",defaultValue:null},CARD_ALIGNMENT:{name:"cardAlignment",defaultValue:""},TREND_INDICATOR_SHAPE_LAYOUT:{name:"trendIndicatorShapeLayout",defaultValue:""},TREND_INDICATOR_SHAPE:{name:"trendIndicatorShape",defaultValue:l.TREND_INDICATOR_SHAPE.BADGE},TREND_CONSTANT_BACKGROUND_COLOR:{name:"trendConstantBackgroundColor",defaultValue:t.CONSTANT},DOSSIER_FONT:{name:"dossierFont",defaultValue:""},HIDEABLE_SECTION_REFERENCE_LINES:{name:"hideableSectionReferenceLines",defaultValue:null},SELECTED_REFERENCE_LINE:{name:"selectedReferenceLine",defaultValue:""},REFERENCE_LINE_CONSTANT_VALUE:{name:"referenceLineConstantValue",defaultValue:""},REFERENCE_LINE_LABEL:{name:"referenceLineLabel",defaultValue:""},CREATED_REFERENCE_LINES:{name:"createdReferenceLines",defaultValue:{}},REFERENCE_LINE_CONSTANT_VALUE_WARNING:{name:"referenceLineConstantValueWarning",defaultValue:null},REFERENCE_LINES_SECTION:{name:"referenceLinesSection",defaultValue:null},TEXT_AND_FORM_DROPDOWN_WITH_REFERENCE_LINES:{name:"textAndFormDropdownWithReferenceLines",defaultValue:0},TEXT_AND_FORM_DROPDOWN_WITHOUT_REFERENCE_LINES:{name:"textAndFormDropdownWithoutReferenceLines",defaultValue:0},SELECTED_REFERENCE_LINE_TEXT_AND_FORM:{name:"selectedReferenceLineTextAndForm",defaultValue:""},SELECTED_REFERENCE_LINE_FONT_NAME:{name:"selectedReferenceLineFontName",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.font.fontFamily},SELECTED_REFERENCE_LINE_FONT_STYLE:{name:"selectedReferenceLineFontStyle",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.font.style},SELECTED_REFERENCE_LINE_FONT_SIZE:{name:"selectedReferenceLineFontSize",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.font.size},SELECTED_REFERENCE_LINE_FONT_COLOR:{name:"selectedReferenceLineFontColor",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.font.color},SELECTED_REFERENCE_LINE_COLOR:{name:"selectedReferenceLineColor",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.line.color},SELECTED_REFERENCE_LINE_SHAPE:{name:"selectedReferenceLineShape",defaultValue:l.REFERENCE_LINE_DEFAULT_VALUES.line.shape},ACTIVE_CARD_INDEX:{name:"activeCardIndex",defaultValue:l.FIRST_CARD_INDEX},SECONDARY_METRIC_NAME_LABEL:{name:"secondaryMetricNameLabel",defaultValue:null},SECONDARY_METRIC_NAME_LABEL_COMPARISON:{name:"secondaryMetricNameLabelComparison",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL:{name:"trendIncreaseBackgroundColorLabel",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendIncreaseBackgroundColorLabelComparison",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL:{name:"trendDecreaseBackgroundColorLabel",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendDecreaseBackgroundColorLabelComparison",defaultValue:null}};function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var c={};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}Object.entries(u).forEach(function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,E=[],u=!0,i=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(E.push(r.value),E.length!==t);u=!0);}catch(e){i=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(i)throw o}}return E}}(t,n)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1].name;c[o]=a}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var T="properties",_=[T],m=function(e){"object"===s(e)?Object.values(e).forEach(function(e){m(e)}):Array.isArray(e)?e.forEach(function(e){m(e)}):_.push(e)};function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach(function(t){I(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function I(e,t,n){return(t=function(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}m(c),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var O=mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE,R=function(e,t,n){var r=JSON.parse(e.getProperty(T));e.setProperty(T,JSON.stringify(A(A({},r),{},I({},t,n))),{suppressData:!0})};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.descriptors["KPI.1"]||mstrmojo.requiresDescsWPrefix("KPI.",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42),mstrmojo.requiresCls("mstrmojo.vi.models.CustomVisDropZones");var C=mstrmojo.descP("KPI.","1","Metric"),L=mstrmojo.descP("KPI.","3","Break By"),D=mstrmojo.descP("KPI.","4","Trend"),S=mstrmojo.descP("KPI.","5","Drag attribute here"),p=mstrmojo.descP("KPI.","6","Drag metric here");mstrmojo.plugins.MultiMetricKPI.MultiMetricKPIDropZones=mstrmojo.declare(mstrmojo.vi.models.CustomVisDropZones,null,{scriptClass:"mstrmojo.plugins.MultiMetricKPI.MultiMetricKPIDropZones",cssClass:"MultiMetricKPI-dropzones",getCustomDropZones:function(){return[{name:C,title:p,minCapacity:1,allowObjectType:O.METRIC},{name:L,title:S,maxCapacity:1,allowObjectType:O.ATTRIBUTE},{name:D,title:S,maxCapacity:1,allowObjectType:O.ATTRIBUTE}]},shouldAllowObjectsInDropZone:function(e,t){var n=this;return{allowedItems:t.filter(function(t){return!!n.isMetric(t)||!n.getObjectDropzones(t).some(function(t){return t===e.n})})}},getObjectDropzones:function(e){var t=this;return[mstrmojo.descP("KPI.","1","Metric"),mstrmojo.descP("KPI.","2","Compare With"),mstrmojo.descP("KPI.","3","Break By"),mstrmojo.descP("KPI.","4","Trend")].filter(function(n){return t.isObjectInZone(e,n)})},findAddAction:function(e){return e.some(function(e){return"addDropZoneUnit"===e.act})},getActionsForDoubleClick:function(e){var t=this,n=this.isAttribute(e),r=this._super(e);if(!r.length)return[];var o=this.getObjectDropzones(e),a=this.getHost(),E=a.isComparisonKPI;if((n||E)&&this.findAddAction(r)&&o.forEach(function(n){t.getRemoveDropZoneObjectsActions(r,n,e)}),n){var u=this.getDropZones().zones,i=function(e,t){return t.find(function(t){return t.id===e})}(r[0].zoneId,u);this.getDropZoneName(i)===mstrmojo.descP("KPI.","4","Trend")&&R(a,c.CARD_ALIGNMENT,l.CARD_ALIGNMENT.LEFT)}else this.getObjectDropzones(e).length>1&&(r.length=0);return r},getActionsForObjectsDropped:function(e,t){var n,r,o=this,a=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,E=[],u=!0,i=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(E.push(r.value),E.length!==t);u=!0);}catch(e){i=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(i)throw o}}return E}}(n,r)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],E=[],u=this.getObjectDropzones(a),i=this.getHost(),s=i.isComparisonKPI;return(e.n!==mstrmojo.descP("KPI.","1","Metric")||s)&&u.forEach(function(e){o.getRemoveDropZoneObjectsActions(E,e,a)}),this.getDropZoneName(e)===mstrmojo.descP("KPI.","4","Trend")&&R(i,c.CARD_ALIGNMENT,l.CARD_ALIGNMENT.LEFT),E},getActionsForObjectsRemoved:function(e,t){var n=this.getHost();if(this.getDropZoneName(e)===mstrmojo.descP("KPI.","1","Metric")){var r=JSON.parse(n.getProperty(T))[c.CREATED_REFERENCE_LINES];t.forEach(function(e){var t=e.id;r[t]&&delete r[t]}),R(n,c.CREATED_REFERENCE_LINES,r)}else this.getDropZoneName(e)===mstrmojo.descP("KPI.","4","Trend")&&R(n,c.CARD_ALIGNMENT,l.CARD_ALIGNMENT.MIDDLE);return[]},getDefaultTooltipOrder:function(){return[[mstrmojo.descP("KPI.","3","Break By"),mstrmojo.descP("KPI.","4","Trend"),mstrmojo.descP("KPI.","1","Metric")]]}})})();