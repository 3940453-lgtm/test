(()=>{"use strict";mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});const t={LIGHT:{AREA:"#FFFFFF",TREND:"#D2D2D2",TREND_OPACITY:"40",FONT:"#35383A"},NIGHT:{AREA:"#313855",TREND:"#539CAE",TREND_OPACITY:"100",FONT:"#FFFFFF"},DESERT:{AREA:"#606060",TREND:"#FFD333",TREND_OPACITY:"100",FONT:"#FFFFFF"},OCEAN:{AREA:"#5181D7",TREND:"#83C8F4",TREND_OPACITY:"100",FONT:"#FFFFFF"}},e={INCREASE:"#83C962",DECREASE:"#DB6657",CONSTANT:"#606060"},n={LIGHT:"#FFFFFF",NIGHT:"#4D4D4D"},r="#CA3D40";mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var i={METRICS:0,BREAK_BY:1,TREND:2},a={METRICS:0,COMPARE_WITH:1,BREAK_BY:2,TREND:3},o=function(t){return 0===t?i:a};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var l="N/A",c="1",u="referenceLineLabel",s="previousValueLabel",d="removeWidgetString";function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach(function(e){m(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function m(t,e,n){return(e=function(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var y={TEXT_CONTENT_TYPE:{ALL:"all",LABEL:"label",PRIMARY_VALUE:"primaryValue",SECONDARY_VALUE:"secondaryValue",INDICATOR:"indicator"},TREND_SHAPE:{AREA:"area",BAR:"bar",LINE:"line"},AXIS_SCALE:{GLOBAL:"global",SYNCED_METRIC:"synced",SYNCED_ALL:"syncedAll"},CARD_ALIGNMENT:{LEFT:"left",MIDDLE:"middle",RIGHT:"right"},TREND_INDICATOR_SHAPE:{BADGE:"badge",ARROW:"arrow"},TREND_INDICATOR_VALUE_TYPE:{PERCENT:"percentValue",NUMERIC:"numericValue"},SELECTED_REFERENCE_LINE_SHAPE:{DOTTED_LINE_TYPE:"1pt dotted",DASHED_LINE_TYPE:"1pt dashed",THIN_LINE_TYPE:"1pt solid",THICK_LINE_TYPE:"2pt solid"},REFERENCE_LINE_DEFAULT_VALUES:{font:{fontFamily:"Open Sans",style:[!1,!1,!1,!1],size:9,color:"#35383A"},line:{shape:"1pt dashed",color:"#4D4D4D"}},LAYOUT_TYPES:{GRID:0,STACKED:1,HORIZONTAL:2,VERTICAL:3},TEXT_SIZE_TYPE:{UNIFIED:0,FIT_TO_CONTAINER:1,FIXED:2},FIRST_CARD_INDEX:1},v={fontFamily:"Open Sans",fontStyle:[!1,!1,!1,!1],fontSteps:0,fontSize:""},g={HIDEABLE_SECTION_TEMPLATE:{name:"hideableSectionTemplate",defaultValue:null},CARD_STYLE:{name:"cardStyle",defaultValue:0},HIDEABLE_SECTION_LAYOUT:{name:"hideableSectionLayout",defaultValue:null},LAYOUT_TYPE:{name:"layoutType",defaultValue:y.LAYOUT_TYPES.GRID},GRID_LAYOUT_PROPERTIES:{name:"gridLayoutProperties",defaultValue:null},GRID_COLUMN_COUNT:{name:"gridColumnCount",defaultValue:4},GRID_FIX_CARD_HEIGHT:{name:"gridFixCardHeight",defaultValue:null},GRID_FIX_CARD_HEIGHT_ENABLED:{name:"gridFixCardHeightEnabled",defaultValue:!1},STACKED_LAYOUT_PROPERTIES:{name:"stackedLayoutProperties",defaultValue:null},STACKED_AUTO_PLAY:{name:"stackedAutoPlay",defaultValue:!0},SHOW_METRIC_NAME:{name:"showMetricName",defaultValue:null},SECONDARY_VALUE_LAYOUT:{name:"secondaryValueLayout",defaultValue:null},SECONDARY_METRIC_NAME:{name:"secondaryMetricName",defaultValue:""},TREND_INDICATOR_LAYOUT:{name:"trendIndicatorLayout",defaultValue:null},TREND_INDICATOR_ENABLED:{name:"trendIndicatorEnabled",defaultValue:!0},TREND_INDICATOR_ENABLED_LABEL:{name:"trendIndicatorEnabledLabel",defaultValue:""},COMPARISON_INDICATOR_ENABLED:{name:"comparisonIndicatorEnabled",defaultValue:!0},COMPARISON_INDICATOR_ENABLED_LABEL:{name:"comparisonIndicatorEnabledLabel",defaultValue:""},TREND_INDICATOR_VALUE_TYPE:{name:"trendIndicatorValueType",defaultValue:y.TREND_INDICATOR_VALUE_TYPE.PERCENT},ENTIRE_CHART_SECTION:{name:"entireChartSection",defaultValue:null},TEXT_SIZE_TYPE:{name:"textSizeType",defaultValue:y.TEXT_SIZE_TYPE.UNIFIED},SHAPE_SECTION:{name:"shapeSection",defaultValue:null},SHAPE_TYPE:{name:"shapeType",defaultValue:0},SHAPE_TYPE_COMPARISON:{name:"shapeTypeComparison",defaultValue:0},SHAPE_TYPE_COMPARISON_NO_TREND:{name:"shapeTypeComparisonNoTrend",defaultValue:0},BACKGROUND_SHAPE_AREA_SECTION:{name:"backgroundShapeAreaSection",defaultValue:null},THRESHOLDS_SECTION:{name:"colorThresholdsSection",defaultValue:{thresholds:[]}},TEXT_CONTENT_TYPE:{name:"textContentType",defaultValue:y.TEXT_CONTENT_TYPE.ALL},TEXT_CONTENT_TYPE_COMPARISON:{name:"textContentTypeComparison",defaultValue:y.TEXT_CONTENT_TYPE.ALL},FONT_FAMILY:{name:"fontFamily",defaultValue:v.fontFamily},FONT_STYLE:{name:"fontStyle",defaultValue:[!1,!1,!1,!1]},FONT_STEPS:{name:"fontSteps",defaultValue:0},FONT_SIZE:{name:"fontSize",defaultValue:""},FONT_COLOR:{name:"fontColor",defaultValue:t.LIGHT.FONT},TEXT_ALL_FONT_OPTIONS:{name:"allFontOptions",defaultValue:p(p({},v),{},{fontColor:"INDETERMINATE"})},TEXT_LABEL_FONT_OPTIONS:{name:"labelFontOptions",defaultValue:p(p({},v),{},{fontColor:t.LIGHT.FONT})},TEXT_PRIMARY_VALUE_FONT_OPTIONS:{name:"primaryValueFontOptions",defaultValue:p(p({},v),{},{fontColor:t.LIGHT.FONT})},TEXT_SECONDARY_VALUE_FONT_OPTIONS:{name:"secondaryValueFontOptions",defaultValue:p(p({},v),{},{fontStyle:[!0,!0,!1,!1],fontColor:t.LIGHT.FONT})},TEXT_INDICATOR_FONT_OPTIONS:{name:"indicatorFontOptions",defaultValue:p(p({},v),{},{fontColor:t.NIGHT.FONT})},AREA_FILL_COLOR:{name:"areaFillColor",defaultValue:t.LIGHT.AREA},AREA_FILL_OPACITY:{name:"areaFillOpacity",defaultValue:100},TREND_FILL_COLOR:{name:"trendFillColor",defaultValue:t.LIGHT.TREND},TREND_FILL_OPACITY:{name:"trendFillOpacity",defaultValue:t.LIGHT.TREND_OPACITY},TREND_INCREASE_BACKGROUND_COLOR:{name:"trendIncreaseBackgroundColor",defaultValue:e.INCREASE},TREND_DECREASE_BACKGROUND_COLOR:{name:"trendDecreaseBackgroundColor",defaultValue:e.DECREASE},HIDEABLE_SECTION_TREND_SHAPE:{name:"hideableSectionTrendShape",defaultValue:null},TREND_SHAPE:{name:"trendShape",defaultValue:y.TREND_SHAPE.AREA},AXIS_SCALE:{name:"axisScale",defaultValue:y.AXIS_SCALE.GLOBAL},AXIS_SCALE_COMPARISON:{name:"axisScaleComparison",defaultValue:y.AXIS_SCALE.GLOBAL},EMPTY_VIZ_WARNING_MESSAGE:{name:"emptyVizWarningMessage",defaultValue:null},VIZ_FIRST_TAB_SECTION:{name:"vizFirstTabSection",defaultValue:null},VIZ_SECOND_TAB_SECTION:{name:"vizSecondTabSection",defaultValue:null},CARD_ALIGNMENT:{name:"cardAlignment",defaultValue:""},TREND_INDICATOR_SHAPE_LAYOUT:{name:"trendIndicatorShapeLayout",defaultValue:""},TREND_INDICATOR_SHAPE:{name:"trendIndicatorShape",defaultValue:y.TREND_INDICATOR_SHAPE.BADGE},TREND_CONSTANT_BACKGROUND_COLOR:{name:"trendConstantBackgroundColor",defaultValue:e.CONSTANT},DOSSIER_FONT:{name:"dossierFont",defaultValue:""},HIDEABLE_SECTION_REFERENCE_LINES:{name:"hideableSectionReferenceLines",defaultValue:null},SELECTED_REFERENCE_LINE:{name:"selectedReferenceLine",defaultValue:""},REFERENCE_LINE_CONSTANT_VALUE:{name:"referenceLineConstantValue",defaultValue:""},REFERENCE_LINE_LABEL:{name:"referenceLineLabel",defaultValue:""},CREATED_REFERENCE_LINES:{name:"createdReferenceLines",defaultValue:{}},REFERENCE_LINE_CONSTANT_VALUE_WARNING:{name:"referenceLineConstantValueWarning",defaultValue:null},REFERENCE_LINES_SECTION:{name:"referenceLinesSection",defaultValue:null},TEXT_AND_FORM_DROPDOWN_WITH_REFERENCE_LINES:{name:"textAndFormDropdownWithReferenceLines",defaultValue:0},TEXT_AND_FORM_DROPDOWN_WITHOUT_REFERENCE_LINES:{name:"textAndFormDropdownWithoutReferenceLines",defaultValue:0},SELECTED_REFERENCE_LINE_TEXT_AND_FORM:{name:"selectedReferenceLineTextAndForm",defaultValue:""},SELECTED_REFERENCE_LINE_FONT_NAME:{name:"selectedReferenceLineFontName",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.fontFamily},SELECTED_REFERENCE_LINE_FONT_STYLE:{name:"selectedReferenceLineFontStyle",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.style},SELECTED_REFERENCE_LINE_FONT_SIZE:{name:"selectedReferenceLineFontSize",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.size},SELECTED_REFERENCE_LINE_FONT_COLOR:{name:"selectedReferenceLineFontColor",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.font.color},SELECTED_REFERENCE_LINE_COLOR:{name:"selectedReferenceLineColor",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.line.color},SELECTED_REFERENCE_LINE_SHAPE:{name:"selectedReferenceLineShape",defaultValue:y.REFERENCE_LINE_DEFAULT_VALUES.line.shape},ACTIVE_CARD_INDEX:{name:"activeCardIndex",defaultValue:y.FIRST_CARD_INDEX},SECONDARY_METRIC_NAME_LABEL:{name:"secondaryMetricNameLabel",defaultValue:null},SECONDARY_METRIC_NAME_LABEL_COMPARISON:{name:"secondaryMetricNameLabelComparison",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL:{name:"trendIncreaseBackgroundColorLabel",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendIncreaseBackgroundColorLabelComparison",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL:{name:"trendDecreaseBackgroundColorLabel",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendDecreaseBackgroundColorLabelComparison",defaultValue:null}};function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var _={};function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}Object.entries(g).forEach(function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1].name;_[i]=a}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var I="properties",A=[I],S=function(t){"object"===E(t)?Object.values(t).forEach(function(t){S(t)}):Array.isArray(t)?t.forEach(function(t){S(t)}):A.push(t)};function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function T(t,e,n){return(e=function(t){var e=function(t){if("object"!=M(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==M(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t,e){if(t){if("string"==typeof t)return O(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}S(_),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var N=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length>0},x=function(t){var e=t.partialValue,n=t.totalValue;return mstrmojo.num.format(4,1,"",Math.abs(e/n))},D=function(t,e){var n=t.fontFamily,r=t.fontColor,i=t.fontSize,a=t.fontStyle,o=P(e),l=e.getProperty(g.DOSSIER_FONT.name),c=!1;l&&l!==o&&(c=!0);var u,s,d,f,h,p,m,y,v=c?o:n,b=e.isIOS&&"Open Sans"===v?"Helvetica":v,_="16px";return i&&"string"==typeof i&&i.indexOf("px")>0?_=i:i&&(_="".concat(L(i),"px")),function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach(function(e){T(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({fontSize:_,fontFamily:b,color:r},(y=4,u=function(t){if(Array.isArray(t))return t}(m=a)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(m,y)||w(m,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=u[0],d=u[1],f=u[2],h=u[3],p=[],f&&p.push("underline"),h&&p.push("line-through"),{fontWeight:s?"bold":"normal",fontStyle:d?"italic":"normal",textDecoration:p.join(" ")||"none currentcolor solid"}))},P=function(t){var e,n=null===(e=t.controller.model)||void 0===e?void 0:e.defmts.find(function(t){return"Text"===t.n});return(null==n?void 0:n.props.FormattingFont.Name)||t.getProperty(g.FONT_FAMILY.name)},R=function(t,e){var n=e<=1?e:e/100;return"rgba(".concat(parseInt(t.slice(1,3),16),",").concat(parseInt(t.slice(3,5),16),",").concat(parseInt(t.slice(5,7),16),", ").concat(n,")")},L=function(t){return 1.328147*t},j=function(t){var e=t.container,n=t.maxTextWidth,r=t.textData,i=t.fontSize,a=t.fontStyle,o=r.label,l=r.value,u=r.connector,s=o+u+l;if(e.title=s,e.style.fontSize="".concat(i,"px"),""===o)return e.textContent=l,{truncatedLabelAndValue:l,truncatedLabel:""};var d,f,h="...".concat(u);if(f=o[0]+h,mstrmojo.VisUtility.measureTextWidth(d+c,a,a.bonus)>=n)e.style.overflow="hidden",e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",e.textContent=l,f="";else{for(var p=2;p<o.length;p++)if(d=o.substring(0,p)+h+l,mstrmojo.VisUtility.measureTextWidth(d+c,a,a.bonus)>=n){f=o.substring(0,p-1)+h;break}d=f+l,e.textContent=d}return{truncatedLabelWithValue:e.textContent,truncatedLabel:f}},V=function(t){return.75292857248934*t},F=function(t){var e=parseInt(t)/Math.sqrt(2);return e+.1*e},k=function(t,e){var n=t.textContent,r=B(t,e);return mstrmojo.VisUtility.measureTextSize(n+c,r,0)},B=function(t,e){var n=mstrmojo.css.getComputedStyle(t);return{fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontSize:"".concat(parseInt(e),"px"),fontWeight:n.fontWeight,lineHeight:1,bonus:parseInt(n.paddingLeft)+parseInt(n.paddingRight)}},K=function(t,e,n){t.forEach(function(t){t.style[e]=n})},H=function(t){setTimeout(function(){var e,n;null===(e=(n=window).syncDossierFormatPanel)||void 0===e||e.call(n,t)},0)};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),_.EMPTY_VIZ_WARNING_MESSAGE;var Y=function(t){var e=o(t.KPIType);return t.isComparisonKPI&&N(t,e.COMPARE_WITH)};function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var G=function(t,e){for(var n={},r=function(){var r,l,c=(r=a[i],l=1,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(r,l)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(t,e):void 0}}(r,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],d=t[c],f=o(e.KPIType);switch(c){case g.SHOW_METRIC_NAME.name:if(null===d){var h=N(e,f.BREAK_BY),p=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length}(e,f.METRICS)>1;d=!h||p,e.showMetricName=d,H([c])}break;case g.CARD_ALIGNMENT.name:if(!d){var m=N(e,f.TREND);d=m?y.CARD_ALIGNMENT.LEFT:y.CARD_ALIGNMENT.MIDDLE,e.cardAlignment=d,H([c])}break;case g.SECONDARY_METRIC_NAME.name:var v,b,E=e.isComparisonKPI,I=e.isRealTime,A=e.timestampIndex,S=e.timeFilter,M=e.dataInterface,C=e.data,T=null==M||null===(v=M.data)||void 0===v||null===(b=v.wdgstrs)||void 0===b?void 0:b[s];if(d&&I&&E&&(N(e,f.COMPARE_WITH)||(d=null)),T&&!e.labelsEditState[c]&&(d=T,n[c]=d),!d){var w=E&&N(e,f.COMPARE_WITH),O=N(e,f.TREND);if(w){var x=I?M.data.gsi.mx[1].n:M.getColHeaders(0).getHeader(1).getName();d="".concat(mstrmojo.descP("KPI.","39","Compare with")," ").concat(x)}else if(O){var D=N(e,f.BREAK_BY)?1:0;if(I)if(S.isMoreDataThanFilter)d="".concat(S.filterLabel," ago");else{var P=new Date(C[0].cells[A].v).toTimeString().split(" ").shift();d="Compare to ".concat(P)}else d="".concat(mstrmojo.descP("KPI.","36","Previous")," ").concat(e.dataInterface.getRowTitles().getTitle(D).getName())}e.secondaryMetricName=d,H([c])}break;case g.CREATED_REFERENCE_LINES.name:if(!d)break;var R=function(t,e){var n=e[_.SELECTED_REFERENCE_LINE];if(!n){var r,i,a=null===(r=t.dataInterface.getColTitles().titles[0])||void 0===r?void 0:r.es.map(function(t){return{n:t.n,dssid:t.oid}});null!=a&&a.find(function(t){return t.dssid===n})&&!t.isComparisonKPI||(n=null==a||null===(i=a[0])||void 0===i?void 0:i.dssid)}return n}(e,t),L=g.REFERENCE_LINE_LABEL.name;Object.keys(d).forEach(function(r){var i=function(t,e,n){var r,i;return null===(r=t.model.data.gsi.mx.find(function(t){return t.did===e}))||void 0===r||null===(i=r.wdgstrs)||void 0===i?void 0:i[n]}(e,r,u);i&&!e.labelsEditState[r]&&(d[r].label=i,n[c]=d,R===r&&(t[L]=i,n[L]=i))})}t[c]=d},i=0,a=Object.entries(t);i<a.length;i++)r();return Object.keys(n).length&&function(t,e){var n=JSON.parse(t.getProperty(I));Object.keys(e).forEach(function(t){n[t]=e[t]}),t.getProperties()[I]=JSON.stringify(n)}(e,n),t};function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function W(t,e,n){return(e=function(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){if(t){if("string"==typeof t)return Z(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var J=function(t){if(!t)return!0;var e=t.color,n=t.range;return!(e||null!=n&&n.value)},Q=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return t.forEach(function(t){var r=t.nfs,i=t.id,a=(r||"General").split(";").map(function(t){return function(t){var e,n=["black","blue","cyan","green","magenta","red","white","yellow"],r={range:{check:function(t){return!0}},color:void 0,formatString:t.slice(t.lastIndexOf("]")+1)},i=(e=t.matchAll(/\[([A-Za-z0-9<>=-]+)\]/g),function(t){if(Array.isArray(t))return Z(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(t){return t[1]});return i&&i.forEach(function(t){if(n.includes(t.toLowerCase()))r.color=t.toLowerCase();else{var e=Number.parseFloat(t.split(/[^0-9-,.]/).join(""));r.range.value=e,0===t.search(">")?(r.range.compareType=0,1===t.search("=")?r.range.check=function(t){return t>=e}:r.range.check=function(t){return t>e}):0===t.search("<")?(r.range.compareType=1,1===t.search("=")?r.range.check=function(t){return t<=e}:r.range.check=function(t){return t<e}):0===t.search("=")&&(r.range.check=function(t){return t===e})}}),r}(t)}),o=i;!function(t){t.length>1&&void 0===t[0].range.value&&(t[0].range={value:0,check:function(t){return t>=0}},t[1]&&void 0===t[1].range.value&&(t[1].range={value:0,check:function(t){return t<0}}),t[2]&&void 0===t[2].range.value&&(t[2].range={value:0,check:function(t){return 0===t}},t[0].range={check:function(t){return t>0}}))}(a),a.forEach(function(t){t.rules=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=mstrmojo.locales.number,r=n.THOUSANDSEPARATOR,i={thousandSeparator:"",decimalSeparator:n.DECIMALSEPARATOR,minimalIntegerLength:1,maximalFractionLength:0,minimalFractionLength:0,divisor:1,prefix:"",suffix:"",shouldLeadingZeroBeOmitted:!1},a=/"(.*?)"/g.exec(t);if(a){var o=t.search(/[#0]/);if(0!==a.length){if(a.index<o){var l=X(a,2);i.prefix=l[1]}else{var c=X(a,2);i.suffix=c[1]}a.forEach(function(e){t=t.replace(e,"")})}}for("%"===t.slice(-1)&&(i.divisor*=.01,i.suffix+=e?"%":"pp",t=t.slice(0,-1));","===t.slice(-1);)i.divisor*=1e3,t=t.slice(0,-1);t.includes(",")&&(i.thousandSeparator=r),t.includes("(")&&t.includes(")")?(i.prefix="(".concat(i.prefix),i.suffix+=")","%)"===t.slice(-2)&&(t=t.slice(0,-2),t+=")",i.divisor*=.01,i.suffix+="pp")):t.includes("-")&&(i.prefix="-".concat(i.prefix));var u=t.split(".");if(2===u.length){var s=X(u,2),d=s[0],f=s[1],h=d.match(/[0]/g);h&&(i.minimalIntegerLength=h.length),i.maximalFractionLength=f.match(/[0#]/g).length;var p=f.match(/[0]/g);p&&(i.minimalFractionLength=p.length),1===d.length&&"#"===d&&(i.shouldLeadingZeroBeOmitted=!0)}return i}(t.formatString,e)}),n[o]=a}),n},tt=function(t,e,n){var r=Number.isNaN(Number(t))?0:Number(t);return function(t,e){var n=e.color,r=e.rules,i=r.maximalFractionLength,a=r.minimalIntegerLength,o=r.minimalFractionLength,l=r.thousandSeparator,c=r.decimalSeparator,u=r.prefix,s=r.suffix,d=r.shouldLeadingZeroBeOmitted,f=r.divisor,h=t<0,p=Math.abs(t)/f,m=function(t,e,n){if(e===n)return e;var r=parseFloat(Number(t).toFixed(n)).toString().split(".")[1];return r&&r.length>e?r.length:e}(t,o,i),y=p.toFixed(m);if(d&&p<1)y=y.slice(1);else{var v=Math.pow(10,a);p<v-1&&(y=(parseFloat(y)+v).toFixed(m).slice(1))}var g=y.split(".");return g[0]=g[0].replace(/\B(?=(\d{3})+(?!\d))/g,l),y=g.join(c),!h||r.prefix.includes("(")||r.prefix.includes("-")||(y="-".concat(y)),{formattedValue:"".concat(u).concat(y).concat(s),color:n}}(r,function(t,e){var n=e.filter(function(e){return e.range.check(t)});return n.length>1?function(t,e){if(t>=0)return!1;if(e.length<=1)return!1;var n=e.filter(function(t){return!J(t)});return n.length>0&&n.every(function(t){var e;return 1===(null===(e=t.range)||void 0===e?void 0:e.compareType)})}(t,n)?n.find(function(t){return!J(t)}):n.reduce(function(t,e){return e.range.value&&t.range.value?e.range.value>t.range.value?e:t:e.range.value?e:t}):n[0]}(r,n[e]))};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach(function(e){at(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function it(t){return function(t){if(Array.isArray(t))return lt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ot(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(t,e,n){return(e=function(t){var e=function(t){if("object"!=et(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ot(t,e){if(t){if("string"==typeof t)return lt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ct=function(t,e,n){if(e.isRealTime){t=t.map(function(t){return ut(t.cells,e)});var r=st(e);e.mappedIndexes=r}var i=N(e,n.TREND),a=N(e,n.BREAK_BY),o=t[0].values.map(function(){return a?new Map:[]}),l=e.isComparisonKPI,c=e.timestampIndex,u=e.isRealTime,s=e.model;return t.forEach(function(t,r){var d,f,h,p,m,y;if(!pt(t)){if(a){var v,g,b,_,E=t.headers[0];d=E.attributeSelector,f=d.eid,h=E.name,p=null==E||null===(v=E.headerObj)||void 0===v||null===(g=v.t)||void 0===g||null===(b=g.fs)||void 0===b||null===(_=b[0])||void 0===_?void 0:_.bftp}else if(i){var I=t.headers[0];d=I.attributeSelector}if(i){var A,S,M,C,T,w,O,N,x=t.headers;m=a?null===(A=x[1])||void 0===A||null===(S=A.headerObj)||void 0===S||null===(M=S.t)||void 0===M||null===(C=M.fs[0])||void 0===C?void 0:C.bftp:null===(T=x[0])||void 0===T||null===(w=T.headerObj)||void 0===w||null===(O=w.t)||void 0===O||null===(N=O.fs[0])||void 0===N?void 0:N.bftp}t.values.forEach(function(v,g){var b,_,E,I,A,S,M,C=v.name,T=v.rv,w=v.v,O=v.id;if(1!==g||!l){y=(null==s||null===(b=s.getFullObjectInfo)||void 0===b||null===(_=b.call(s,O))||void 0===_?void 0:_.mft)||(null==s||null===(E=s.docModel)||void 0===E||null===(I=E.getObjectInfo)||void 0===I||null===(A=I.call(E,O))||void 0===A?void 0:A.mft)||(null==s||null===(S=s.getObjectInfo)||void 0===S||null===(M=S.call(s,O))||void 0===M?void 0:M.mft);var N,x,D=a?o[g].get(f):o[g][0];if(l&&(x=(N=t.values[1]||null)?{raw:N.rv,formatted:N.v}:null),D){if(i){var P=Object.keys(t.metricSelector),R={raw:T,formatted:w,graphicModel:ft(d,t.idValueMapping,P,O)};u&&(R.timestamp=e.data[r].cells[c].v,R.timestampDate=new Date(R.timestamp)),D.trendChartData.push(R)}l&&(D.compareMetricValue=x)}else{var L;if(i){var j=Object.keys(t.metricSelector);L=[{raw:T,formatted:w,graphicModel:ft(d,t.idValueMapping,j,O)}],u&&(L[0].timestamp=e.data[r].cells[c].v,L[0].timestampDate=new Date(L[0].timestamp))}else L=[{raw:T,formatted:w}];var V,F={metricId:O,graphicModel:ht(d,O,e,t,n),label:{withMetricName:h?"".concat(C," - ").concat(h):C,withoutMetricName:h||""},trendChartData:L,breakByAttributeName:h,breakByAttributeFormType:p,trendAttributeFormType:m,metricFormType:y};l&&(F.compareMetricId=(null===(V=N)||void 0===V?void 0:V.id)||null,F.compareMetricValue=x),a?o[g].set(f,F):o[g].push(F)}}})}}),a?o.map(function(t){return function(t){return function(t){if(Array.isArray(t))return O(t)}(e=t.values())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e}(t)}):o},ut=function(t,e){var n=e.isComparisonKPI,r=e.dataInterface.data.realtimeQueryInfo.columns,i={};r.forEach(function(t,e){i[t.id]=e});var a=-1,l=[],c=[],u={},s={},d=o(e.KPIType);if(e.zonesModel.getDropZoneObjectsByIndex(d.TREND).forEach(function(e){var n=i[e.id];a=n,u[e.id]=t[n].v,s[e.id]={}}),e.zonesModel.getDropZoneObjectsByIndex(d.BREAK_BY).forEach(function(e){var n=i[e.id];a=n,u[e.id]=t[n].v,s[e.id]={}}),a>=0){var f=r[a].id,h=t[a].v,p="".concat(h,";").concat(f);l.push({name:h,attributeSelector:{n:h,tid:f,eid:p,isSelectAttr:!0}})}var m,y=e.zonesModel.getDropZoneObjectsByIndex(d.METRICS);return n&&Y(e)&&y.push(null===(m=e.zonesModel)||void 0===m?void 0:m.getDropZoneObjectsByIndex(d.COMPARE_WITH)[0]),e.getDocModel(),y.forEach(function(n,r){var a=i[n.id];u[n.id]=tt(t[a].v,n.id,e.metricFormattingRules).formattedValue;var o=e.dataInterface.data.gsi.mx[r].n;c.push({v:u[n.id],rv:t[a].v,id:n.id,name:o})}),{headers:l,values:c,idValueMapping:u,metricSelector:s}},st=function(t){var e=t.dataInterface.data.realtimeQueryInfo.columns,n=[];return e.forEach(function(t){-1===t.bfid&&n.push(t.id)}),Object.keys(n).reduce(function(t,e){return t[n[e]]=parseInt(e),t},{})},dt=function(t,e,n){var r=e.colorThresholdsSection.thresholds,i=it(t).sort(function(t,e){return t.primaryValue.raw-e.primaryValue.raw}),a=it(t).sort(function(t,e){return e.primaryValue.raw-t.primaryValue.raw}),o=r.map(function(t){t.skip=!1;var e=t.advancedThreshold;if(e&&2===e.thresholdType){var n,r=null!==(n=e.rank)&&void 0!==n?n:"0",o=2===e.rankOption?i:a,l=function(t,e){return"%"===t.slice(-1)?Number(t.slice(0,-1))*e*.01:Number(t)}(r,o.length);if(l<1)return rt(rt({},t),{},{skip:!0});var c=function(t,e,n){var r=[];return t.forEach(function(t,n){if(n<=e-1){var i=t.trendChartData;r.push(i[i.length-1].raw)}}),2===n?{minValue:r[0],maxValue:r[r.length-1]}:{minValue:r[r.length-1],maxValue:r[0]}}(o,l,e.rankOption),u=c.minValue,s=c.maxValue;return rt(rt({},t),{},{min:u,max:s})}return t.min||t.max?t:rt(rt({},t),{},{min:0,max:0})}),l=function(t){return"%"==="".concat(t).slice(-1)?.01*Number(t.slice(0,-1)):t},c=function(e,r){var i=at(at(at(at(at(at(at({},2,null),3,null),4,null),5,null),6,null),7,null),8,null);return o.filter(function(i){var a=i.enabled,o=i.skip,c=i.advancedThreshold;if(!a)return!1;if(c&&3===c.thresholdType)return function(e,r){if(!n)return!1;var i=function(e){return it(t).filter(function(t){if(t.indicator){var n=Math.sign(t.indicator.differenceBetweenPrimaryAndSecondary);return 1===e?n>0:n<0}return!1})}(e);return 0!==i.length&&i.some(function(t){return t.graphicModel.cardId===r})}(c.indicator,r);var u=parseFloat(l(i.min)||Number.NEGATIVE_INFINITY),s=parseFloat(l(i.max)||Number.POSITIVE_INFINITY);return u<=e&&s>=e&&!o}).reverse().forEach(function(t){var e=t.advancedThreshold,n=t.color;if(e){var r=e.selector,a=e.colors;1===r&&function(t,e,n,r){var i,a,o,l,c=void 0===n[1]||"INDETERMINATE"===n[1]?null:n[1];t[2]=rt(rt({},e),{},{color:null!==(i=null!=c?c:n[2])&&void 0!==i?i:r}),t[3]=rt(rt({},e),{},{color:null!==(a=null!=c?c:n[3])&&void 0!==a?a:r}),t[4]=rt(rt({},e),{},{color:null!==(o=null!=c?c:n[4])&&void 0!==o?o:r}),t[5]=rt(rt({},e),{},{color:null!==(l=null!=c?c:n[5])&&void 0!==l?l:r})}(i,t,void 0===a?{}:a,n),i[r]=t}else i[3]=t}),i};return t.map(function(t){var e=t.trendChartData,n=t.graphicModel,r=e[e.length-1].raw;return t.thresholdTarget=c(r,n.cardId),t})},ft=function(t,e,n,r){var i=new mstrmojo.customviz.GraphicModel,a=function(t,e){var n={};return Object.keys(t).filter(function(t){return e.includes(t)}).forEach(function(e){n[e]=t[e]}),n}(e,[].concat(it(n),[r]));return i.setSelector(t,t.isSelectAttr),i.idValueMapping=a,i},ht=function(t,e,n,r,i){n.cardsIds||(n.cardIds=[]);var a=new mstrmojo.customviz.GraphicModel;return t?(a.setSelector(t,t.isSelectAttr),a.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e,"-").concat(t.eid)}),a.setGroupOptions([r.headers[0]]),a.setDrillOptions(t,[{dropZoneIndex:i.BREAK_BY,keepParent:!1}]),n.cardIds.push("".concat(n.id,"-").concat(e,"-").concat(t.eid))):(n.metricId=e,a.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e)}),n.cardIds.push("".concat(n.id,"-").concat(e))),a.idValueMapping=mt(r.headers),a},pt=function(t){return t.headers.some(function(t){var e;return null===(e=t.headerObj)||void 0===e?void 0:e.h.stt})},mt=function(t){return Object.fromEntries(t.map(function(t){var e=t.attributeSelector;return[e.tid,e.n]}).slice(0,-1))};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var yt={SANITIZE_NAMED_PROPS:!0,RETURN_DOM_FRAGMENT:!0,ADD_ATTR:["target"]};function vt(t,e){if(t){if("string"==typeof t)return gt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(t,e):void 0}}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var bt=function(t,e){return window.DOMPurify?DOMPurify.sanitize(t,e):t},_t=function(t,e){var n="",r=function(t){"_blank"===t.getAttribute("target")&&t.setAttribute("rel","noopener noreferrer"),n+=t.outerHTML},i=function(t){var e;t.nodeType===Node.ELEMENT_NODE?"IMG"===(e=t).tagName?n+="":"A"===e.tagName?r(e):e.childNodes?e.childNodes.forEach(i):n+=e.textContent:a(t)},a=function(t){n+=e?mstrmojo.string.encodeHtmlString(t.textContent):t.textContent};return t instanceof Node&&(null==t||t.childNodes.forEach(i)),n},Et=function(t){var e,n,r,i=t.tag,a=void 0===i?"div":i,o=t.classes,l=void 0===o?[]:o,c=t.content,u=void 0===c?"":c,s=t.style,d=void 0===s?{}:s,f=t.otherAttributes,h=void 0===f?{}:f,p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],m=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=document.createElement(a);if((e=y.classList).add.apply(e,function(t){if(Array.isArray(t))return gt(t)}(r=l)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||vt(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&p&&m){var v=bt(u,yt);n=_t(v,p)}else n=p?mstrmojo.string.encodeHtmlString(u):u;return y.innerHTML=n,Object.assign(y.style,d),Object.entries(h).forEach(function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||vt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=e[0],r=e[1];y.setAttribute(n,mstrmojo.string.encodeHtmlString(r))}),y};function It(){}function At(t){return null==t?It:function(){return this.querySelector(t)}}function St(){return[]}function Mt(t){return null==t?St:function(){return this.querySelectorAll(t)}}function Ct(t){return function(){return this.matches(t)}}function Tt(t){return function(e){return e.matches(t)}}var wt=Array.prototype.find;function Ot(){return this.firstElementChild}var Nt=Array.prototype.filter;function xt(){return Array.from(this.children)}function Dt(t){return new Array(t.length)}function Pt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Rt(t,e,n,r,i,a){for(var o,l=0,c=e.length,u=a.length;l<u;++l)(o=e[l])?(o.__data__=a[l],r[l]=o):n[l]=new Pt(t,a[l]);for(;l<c;++l)(o=e[l])&&(i[l]=o)}function Lt(t,e,n,r,i,a,o){var l,c,u,s=new Map,d=e.length,f=a.length,h=new Array(d);for(l=0;l<d;++l)(c=e[l])&&(h[l]=u=o.call(c,c.__data__,l,e)+"",s.has(u)?i[l]=c:s.set(u,c));for(l=0;l<f;++l)u=o.call(t,a[l],l,a)+"",(c=s.get(u))?(r[l]=c,c.__data__=a[l],s.delete(u)):n[l]=new Pt(t,a[l]);for(l=0;l<d;++l)(c=e[l])&&s.get(h[l])===c&&(i[l]=c)}function jt(t){return t.__data__}function Vt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ft(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Pt.prototype={constructor:Pt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var kt="http://www.w3.org/1999/xhtml";const Bt={svg:"http://www.w3.org/2000/svg",xhtml:kt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kt(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Bt.hasOwnProperty(e)?{space:Bt[e],local:t}:t}function Ht(t){return function(){this.removeAttribute(t)}}function Yt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ut(t,e){return function(){this.setAttribute(t,e)}}function Gt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $t(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function zt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Wt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xt(t){return function(){this.style.removeProperty(t)}}function qt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Zt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Jt(t,e){return t.style.getPropertyValue(e)||Wt(t).getComputedStyle(t,null).getPropertyValue(e)}function Qt(t){return function(){delete this[t]}}function te(t,e){return function(){this[t]=e}}function ee(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ne(t){return t.trim().split(/^|\s+/)}function re(t){return t.classList||new ie(t)}function ie(t){this._node=t,this._names=ne(t.getAttribute("class")||"")}function ae(t,e){for(var n=re(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function oe(t,e){for(var n=re(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function le(t){return function(){ae(this,t)}}function ce(t){return function(){oe(this,t)}}function ue(t,e){return function(){(e.apply(this,arguments)?ae:oe)(this,t)}}function se(){this.textContent=""}function de(t){return function(){this.textContent=t}}function fe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function he(){this.innerHTML=""}function pe(t){return function(){this.innerHTML=t}}function me(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ye(){this.nextSibling&&this.parentNode.appendChild(this)}function ve(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ge(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===kt&&e.documentElement.namespaceURI===kt?e.createElement(t):e.createElementNS(n,t)}}function be(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _e(t){var e=Kt(t);return(e.local?be:ge)(e)}function Ee(){return null}function Ie(){var t=this.parentNode;t&&t.removeChild(this)}function Ae(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Se(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Me(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function Ce(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,l=i.length;o<l;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function Te(t,e,n){var r=Wt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function we(t,e){return function(){return Te(this,t,e)}}function Oe(t,e){return function(){return Te(this,t,e.apply(this,arguments))}}ie.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Ne=[null];function xe(t,e){this._groups=t,this._parents=e}function De(){return new xe([[document.documentElement]],Ne)}xe.prototype=De.prototype={constructor:xe,select:function(t){"function"!=typeof t&&(t=At(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,l=e[i],c=l.length,u=r[i]=new Array(c),s=0;s<c;++s)(a=l[s])&&(o=t.call(a,a.__data__,s,l))&&("__data__"in a&&(o.__data__=a.__data__),u[s]=o);return new xe(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):Mt(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,l=e[a],c=l.length,u=0;u<c;++u)(o=l[u])&&(r.push(t.call(o,o.__data__,u,l)),i.push(o));return new xe(r,i)},selectChild:function(t){return this.select(null==t?Ot:function(t){return function(){return wt.call(this.children,t)}}("function"==typeof t?t:Tt(t)))},selectChildren:function(t){return this.selectAll(null==t?xt:function(t){return function(){return Nt.call(this.children,t)}}("function"==typeof t?t:Tt(t)))},filter:function(t){"function"!=typeof t&&(t=Ct(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],l=o.length,c=r[i]=[],u=0;u<l;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new xe(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,jt);var n,r=e?Lt:Rt,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,l=new Array(o),c=new Array(o),u=new Array(o),s=0;s<o;++s){var d=i[s],f=a[s],h=f.length,p=Vt(t.call(d,d&&d.__data__,s,i)),m=p.length,y=c[s]=new Array(m),v=l[s]=new Array(m);r(d,f,y,v,u[s]=new Array(h),p,e);for(var g,b,_=0,E=0;_<m;++_)if(g=y[_]){for(_>=E&&(E=_+1);!(b=v[E])&&++E<m;);g._next=b||null}}return(l=new xe(l,i))._enter=c,l._exit=u,l},enter:function(){return new xe(this._enter||this._groups.map(Dt),this._parents)},exit:function(){return new xe(this._exit||this._groups.map(Dt),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),l=new Array(i),c=0;c<o;++c)for(var u,s=n[c],d=r[c],f=s.length,h=l[c]=new Array(f),p=0;p<f;++p)(u=s[p]||d[p])&&(h[p]=u);for(;c<i;++c)l[c]=n[c];return new xe(l,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ft);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,l=n[a],c=l.length,u=i[a]=new Array(c),s=0;s<c;++s)(o=l[s])&&(u[s]=o);u.sort(e)}return new xe(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,l=a.length;o<l;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=Kt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Yt:Ht:"function"==typeof e?n.local?zt:$t:n.local?Gt:Ut)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Xt:"function"==typeof e?Zt:qt)(t,e,null==n?"":n)):Jt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Qt:"function"==typeof e?ee:te)(t,e)):this.node()[t]},classed:function(t,e){var n=ne(t+"");if(arguments.length<2){for(var r=re(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?ue:e?le:ce)(n,e))},text:function(t){return arguments.length?this.each(null==t?se:("function"==typeof t?fe:de)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?he:("function"==typeof t?me:pe)(t)):this.node().innerHTML},raise:function(){return this.each(ye)},lower:function(){return this.each(ve)},append:function(t){var e="function"==typeof t?t:_e(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:_e(t),r=null==e?Ee:"function"==typeof e?e:At(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Ie)},clone:function(t){return this.select(t?Se:Ae)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=a.length;if(!(arguments.length<2)){for(l=e?Ce:Me,r=0;r<o;++r)this.each(l(a[r],e,n));return this}var l=this.node().__on;if(l)for(var c,u=0,s=l.length;u<s;++u)for(r=0,c=l[u];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?Oe:we)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const Pe=De;var Re={value:()=>{}};function Le(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new je(r)}function je(t){this._=t}function Ve(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Fe(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Re,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}je.prototype=Le.prototype={constructor:je,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,l=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<l;)if(n=(t=a[o]).type)i[n]=Fe(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Fe(i[n],t.name,null);return this}for(;++o<l;)if((n=(t=a[o]).type)&&(n=Ve(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new je(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const ke=Le;var Be,Ke,He=0,Ye=0,Ue=0,Ge=0,$e=0,ze=0,We="object"==typeof performance&&performance.now?performance:Date,Xe="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qe(){return $e||(Xe(Ze),$e=We.now()+ze)}function Ze(){$e=0}function Je(){this._call=this._time=this._next=null}function Qe(t,e,n){var r=new Je;return r.restart(t,e,n),r}function tn(){$e=(Ge=We.now())+ze,He=Ye=0;try{!function(){qe(),++He;for(var t,e=Be;e;)(t=$e-e._time)>=0&&e._call.call(void 0,t),e=e._next;--He}()}finally{He=0,function(){for(var t,e,n=Be,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Be=e);Ke=t,nn(r)}(),$e=0}}function en(){var t=We.now(),e=t-Ge;e>1e3&&(ze-=e,Ge=t)}function nn(t){He||(Ye&&(Ye=clearTimeout(Ye)),t-$e>24?(t<1/0&&(Ye=setTimeout(tn,t-We.now()-ze)),Ue&&(Ue=clearInterval(Ue))):(Ue||(Ge=We.now(),Ue=setInterval(en,1e3)),He=1,Xe(tn)))}function rn(t,e,n){var r=new Je;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}Je.prototype=Qe.prototype={constructor:Je,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?qe():+n)+(null==e?0:+e),this._next||Ke===this||(Ke?Ke._next=this:Be=this,Ke=this),this._call=t,this._time=n,nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,nn())}};var an=ke("start","end","cancel","interrupt"),on=[];function ln(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(c){var u,s,d,f;if(1!==n.state)return l();for(u in i)if((f=i[u]).name===n.name){if(3===f.state)return rn(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(rn(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),u=0,s=-1;u<d;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++s]=f);r.length=s+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Qe(function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:an,tween:on,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function cn(t,e){var n=sn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function un(t,e){var n=sn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function sn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function dn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var fn,hn=180/Math.PI,pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mn(t,e,n,r,i,a){var o,l,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*hn,skewX:Math.atan(c)*hn,scaleX:o,scaleY:l}}function yn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var l=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,l){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);l.push({i:c-4,x:dn(t,i)},{i:c-2,x:dn(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,l,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:dn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,l,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:dn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,l,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var l=a.push(i(a)+"scale(",null,",",null,")");o.push({i:l-4,x:dn(t,n)},{i:l-2,x:dn(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,l,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)l[(e=c[n]).i]=e.x(t);return l.join("")}}}var vn=yn(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?pn:mn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),gn=yn(function(t){return null==t?pn:(fn||(fn=document.createElementNS("http://www.w3.org/2000/svg","g")),fn.setAttribute("transform",t),(t=fn.transform.baseVal.consolidate())?mn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):pn)},", ",")",")");function bn(t,e){var n,r;return function(){var i=un(this,t),a=i.tween;if(a!==n)for(var o=0,l=(r=n=a).length;o<l;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function _n(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=un(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var l={name:e,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===e){i[c]=l;break}c===u&&i.push(l)}a.tween=i}}function En(t,e,n){var r=t._id;return t.each(function(){var t=un(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return sn(t,r).value[e]}}function In(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function An(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Sn(){}var Mn=.7,Cn=1/Mn,Tn="\\s*([+-]?\\d+)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",On="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nn=/^#([0-9a-f]{3,8})$/,xn=new RegExp(`^rgb\\(${Tn},${Tn},${Tn}\\)$`),Dn=new RegExp(`^rgb\\(${On},${On},${On}\\)$`),Pn=new RegExp(`^rgba\\(${Tn},${Tn},${Tn},${wn}\\)$`),Rn=new RegExp(`^rgba\\(${On},${On},${On},${wn}\\)$`),Ln=new RegExp(`^hsl\\(${wn},${On},${On}\\)$`),jn=new RegExp(`^hsla\\(${wn},${On},${On},${wn}\\)$`),Vn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fn(){return this.rgb().formatHex()}function kn(){return this.rgb().formatRgb()}function Bn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Nn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Kn(e):3===n?new Un(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Hn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Hn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=xn.exec(t))?new Un(e[1],e[2],e[3],1):(e=Dn.exec(t))?new Un(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Pn.exec(t))?Hn(e[1],e[2],e[3],e[4]):(e=Rn.exec(t))?Hn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ln.exec(t))?qn(e[1],e[2]/100,e[3]/100,1):(e=jn.exec(t))?qn(e[1],e[2]/100,e[3]/100,e[4]):Vn.hasOwnProperty(t)?Kn(Vn[t]):"transparent"===t?new Un(NaN,NaN,NaN,0):null}function Kn(t){return new Un(t>>16&255,t>>8&255,255&t,1)}function Hn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Un(t,e,n,r)}function Yn(t,e,n,r){return 1===arguments.length?((i=t)instanceof Sn||(i=Bn(i)),i?new Un((i=i.rgb()).r,i.g,i.b,i.opacity):new Un):new Un(t,e,n,null==r?1:r);var i}function Un(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Gn(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}`}function $n(){const t=zn(this.opacity);return`${1===t?"rgb(":"rgba("}${Wn(this.r)}, ${Wn(this.g)}, ${Wn(this.b)}${1===t?")":`, ${t})`}`}function zn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xn(t){return((t=Wn(t))<16?"0":"")+t.toString(16)}function qn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Jn(t,e,n,r)}function Zn(t){if(t instanceof Jn)return new Jn(t.h,t.s,t.l,t.opacity);if(t instanceof Sn||(t=Bn(t)),!t)return new Jn;if(t instanceof Jn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,l=a-i,c=(a+i)/2;return l?(o=e===a?(n-r)/l+6*(n<r):n===a?(r-e)/l+2:(e-n)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new Jn(o,l,c,t.opacity)}function Jn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qn(t){return(t=(t||0)%360)<0?t+360:t}function tr(t){return Math.max(0,Math.min(1,t||0))}function er(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function nr(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}In(Sn,Bn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Fn,formatHex:Fn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Zn(this).formatHsl()},formatRgb:kn,toString:kn}),In(Un,Yn,An(Sn,{brighter(t){return t=null==t?Cn:Math.pow(Cn,t),new Un(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Mn:Math.pow(Mn,t),new Un(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Un(Wn(this.r),Wn(this.g),Wn(this.b),zn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gn,formatHex:Gn,formatHex8:function(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}${Xn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:$n,toString:$n})),In(Jn,function(t,e,n,r){return 1===arguments.length?Zn(t):new Jn(t,e,n,null==r?1:r)},An(Sn,{brighter(t){return t=null==t?Cn:Math.pow(Cn,t),new Jn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Mn:Math.pow(Mn,t),new Jn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Un(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Jn(Qn(this.h),tr(this.s),tr(this.l),zn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=zn(this.opacity);return`${1===t?"hsl(":"hsla("}${Qn(this.h)}, ${100*tr(this.s)}%, ${100*tr(this.l)}%${1===t?")":`, ${t})`}`}}));const rr=t=>()=>t;function ir(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):rr(isNaN(t)?e:t)}const ar=function t(e){var n=function(t){return 1===(t=+t)?ir:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):rr(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Yn(t)).r,(e=Yn(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=ir(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function or(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),l=new Array(i);for(n=0;n<i;++n)r=Yn(e[n]),a[n]=r.r||0,o[n]=r.g||0,l[n]=r.b||0;return a=t(a),o=t(o),l=t(l),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=l(t),r+""}}}or(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,l=r<e-1?t[r+2]:2*a-i;return nr((n-r/e)*e,o,i,a,l)}}),or(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],l=t[(r+2)%e];return nr((n-r/e)*e,i,a,o,l)}});var lr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cr=new RegExp(lr.source,"g");function ur(t,e){var n,r,i,a=lr.lastIndex=cr.lastIndex=0,o=-1,l=[],c=[];for(t+="",e+="";(n=lr.exec(t))&&(r=cr.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,c.push({i:o,x:dn(n,r)})),a=cr.lastIndex;return a<e.length&&(i=e.slice(a),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)l[(n=c[r]).i]=n.x(t);return l.join("")})}function sr(t,e){var n;return("number"==typeof e?dn:e instanceof Bn?ar:(n=Bn(e))?(e=n,ar):ur)(t,e)}function dr(t){return function(){this.removeAttribute(t)}}function fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hr(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function pr(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function mr(t,e,n){var r,i,a;return function(){var o,l,c=n(this);if(null!=c)return(o=this.getAttribute(t))===(l=c+"")?null:o===r&&l===i?a:(i=l,a=e(r=o,c));this.removeAttribute(t)}}function yr(t,e,n){var r,i,a;return function(){var o,l,c=n(this);if(null!=c)return(o=this.getAttributeNS(t.space,t.local))===(l=c+"")?null:o===r&&l===i?a:(i=l,a=e(r=o,c));this.removeAttributeNS(t.space,t.local)}}function vr(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function gr(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function br(t,e){return function(){cn(this,t).delay=+e.apply(this,arguments)}}function _r(t,e){return e=+e,function(){cn(this,t).delay=e}}function Er(t,e){return function(){un(this,t).duration=+e.apply(this,arguments)}}function Ir(t,e){return e=+e,function(){un(this,t).duration=e}}var Ar=Pe.prototype.constructor;function Sr(t){return function(){this.style.removeProperty(t)}}var Mr=0;function Cr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Tr(){return++Mr}var wr=Pe.prototype;Cr.prototype=function(t){return Pe().transition(t)}.prototype={constructor:Cr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=At(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var l,c,u=r[o],s=u.length,d=a[o]=new Array(s),f=0;f<s;++f)(l=u[f])&&(c=t.call(l,l.__data__,f,u))&&("__data__"in l&&(c.__data__=l.__data__),d[f]=c,ln(d[f],e,n,f,d,sn(l,n)));return new Cr(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Mt(t));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var c,u=r[l],s=u.length,d=0;d<s;++d)if(c=u[d]){for(var f,h=t.call(c,c.__data__,d,u),p=sn(c,n),m=0,y=h.length;m<y;++m)(f=h[m])&&ln(f,e,n,m,h,p);a.push(h),o.push(c)}return new Cr(a,o,e,n)},selectChild:wr.selectChild,selectChildren:wr.selectChildren,filter:function(t){"function"!=typeof t&&(t=Ct(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],l=o.length,c=r[i]=[],u=0;u<l;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new Cr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),l=0;l<a;++l)for(var c,u=e[l],s=n[l],d=u.length,f=o[l]=new Array(d),h=0;h<d;++h)(c=u[h]||s[h])&&(f[h]=c);for(;l<r;++l)o[l]=e[l];return new Cr(o,this._parents,this._name,this._id)},selection:function(){return new Ar(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Tr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,l=r[a],c=l.length,u=0;u<c;++u)if(o=l[u]){var s=sn(o,e);ln(o,t,n,u,l,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new Cr(r,this._parents,t,n)},call:wr.call,nodes:wr.nodes,node:wr.node,size:wr.size,empty:wr.empty,each:wr.each,on:function(t,e){var n=this._id;return arguments.length<2?sn(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?cn:un;return function(){var o=a(this,t),l=o.on;l!==r&&(i=(r=l).copy()).on(e,n),o.on=i}}(n,t,e))},attr:function(t,e){var n=Kt(t),r="transform"===n?gn:sr;return this.attrTween(t,"function"==typeof e?(n.local?yr:mr)(n,r,En(this,"attr."+t,e)):null==e?(n.local?fr:dr)(n):(n.local?pr:hr)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Kt(t);return this.tween(n,(r.local?vr:gr)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?vn:sr;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=Jt(this,t),o=(this.style.removeProperty(t),Jt(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,Sr(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=Jt(this,t),l=n(this),c=l+"";return null==l&&(this.style.removeProperty(t),c=l=Jt(this,t)),o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,l))}}(t,r,En(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,l="end."+o;return function(){var c=un(this,t),u=c.on,s=null==c.value[o]?a||(a=Sr(e)):void 0;u===n&&i===s||(r=(n=u).copy()).on(l,i=s),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=Jt(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,a,n)),r}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(En(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=sn(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?bn:_n)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?br:_r)(e,t)):sn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Er:Ir)(e,t)):sn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){un(this,t).ease=e}}(e,t)):sn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;un(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var l={value:o},c={value:function(){0===--i&&a()}};n.each(function(){var n=un(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),n.on=e}),0===i&&a()})},[Symbol.iterator]:wr[Symbol.iterator]};var Or={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Nr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Pe.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}(this,t)})},Pe.prototype.transition=function(t){var e,n;t instanceof Cr?(e=t._id,t=t._name):(e=Tr(),(n=Or).time=qe(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,l=r[a],c=l.length,u=0;u<c;++u)(o=l[u])&&ln(o,t,e,u,l,n||Nr(o,e));return new Cr(r,this._parents,t,e)};const{abs:xr,max:Dr,min:Pr}=Math;function Rr(t){return{type:t}}function Lr(t){return"string"==typeof t?new xe([[document.querySelector(t)]],[document.documentElement]):new xe([[t]],Ne)}function jr(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Rr),["n","s"].map(Rr),["n","w","e","s","nw","ne","sw","se"].map(Rr);const Vr={passive:!1},Fr={capture:!0,passive:!1};function kr(t){t.stopImmediatePropagation()}function Br(t){t.preventDefault(),t.stopImmediatePropagation()}const Kr=t=>()=>t;function Hr(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:l,dx:c,dy:u,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:s}})}function Yr(t){return!t.ctrlKey&&!t.button}function Ur(){return this.parentNode}function Gr(t,e){return null==e?{x:t.x,y:t.y}:e}function $r(){return navigator.maxTouchPoints||"ontouchstart"in this}function zr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}Hr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};class Wr extends Map{constructor(t,e=qr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Xr(this,t))}has(t){return super.has(Xr(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}(this,t))}}function Xr({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function qr(t){return null!==t&&"object"==typeof t?t.valueOf():t}Set;const Zr=Symbol("implicit");function Jr(){var t=new Wr,e=[],n=[],r=Zr;function i(i){let a=t.get(i);if(void 0===a){if(r!==Zr)return r;t.set(i,a=e.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Wr;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Jr(e,n).unknown(r)},zr.apply(i,arguments),i}function Qr(){var t,e,n=Jr().unknown(void 0),r=n.domain,i=n.range,a=0,o=1,l=!1,c=0,u=0,s=.5;function d(){var n=r().length,d=o<a,f=d?o:a,h=d?a:o;t=(h-f)/Math.max(1,n-c+2*u),l&&(t=Math.floor(t)),f+=(h-f-t*(n-c))*s,e=t*(1-c),l&&(f=Math.round(f),e=Math.round(e));var p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(n).map(function(e){return f+t*e});return i(d?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),d()):r()},n.range=function(t){return arguments.length?([a,o]=t,a=+a,o=+o,d()):[a,o]},n.rangeRound=function(t){return[a,o]=t,a=+a,o=+o,l=!0,d()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(l=!!t,d()):l},n.padding=function(t){return arguments.length?(c=Math.min(1,u=+t),d()):c},n.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),d()):c},n.paddingOuter=function(t){return arguments.length?(u=+t,d()):u},n.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),d()):s},n.copy=function(){return Qr(r(),[a,o]).round(l).paddingInner(c).paddingOuter(u).align(s)},zr.apply(d(),arguments)}const ti=Math.sqrt(50),ei=Math.sqrt(10),ni=Math.sqrt(2);function ri(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=ti?10:a>=ei?5:a>=ni?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?ri(t,e,2*n):[l,c,u]}function ii(t,e,n){return ri(t=+t,e=+e,n=+n)[2]}function ai(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function oi(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function li(t){let e,n,r;function i(t,r,i=0,a=t.length){if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=ai,n=(e,n)=>ai(t(e),n),r=(e,n)=>t(e)-n):(e=t===ai||t===oi?t:ci,n=t,r=t),{left:i,center:function(t,e,n=0,a=t.length){const o=i(t,e,n,a-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r,i=0,a=t.length){if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function ci(){return 0}const ui=li(ai),si=ui.right,di=(ui.left,li(function(t){return null===t?NaN:+t}).center,si);function fi(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=yi(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function hi(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function pi(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=yi(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}function mi(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function yi(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?rr(e):("number"===i?dn:"string"===i?(n=Bn(e))?(e=n,ar):ur:e instanceof Bn?ar:e instanceof Date?hi:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?fi:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?pi:dn:mi))(t,e)}function vi(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function gi(t){return+t}var bi=[0,1];function _i(t){return t}function Ei(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ii(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=Ei(i,r),a=n(o,a)):(r=Ei(r,i),a=n(a,o)),function(t){return a(r(t))}}function Ai(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Ei(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=di(t,e,1,r)-1;return a[n](i[n](e))}}var Si,Mi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ci(t){if(!(e=Mi.exec(t)))throw new Error("invalid format: "+t);var e;return new Ti({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ti(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function wi(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Oi(t){return(t=wi(Math.abs(t)))?t[1]:NaN}function Ni(t,e){var n=wi(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Ci.prototype=Ti.prototype,Ti.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xi={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ni(100*t,e),r:Ni,s:function(t,e){var n=wi(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Si=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+wi(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Di(t){return t}var Pi,Ri,Li,ji=Array.prototype.map,Vi=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Fi(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,a,o]=r?ri(e,t,n):ri(t,e,n);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(r)if(o<0)for(let t=0;t<l;++t)c[t]=(a-t)/-o;else for(let t=0;t<l;++t)c[t]=(a-t)*o;else if(o<0)for(let t=0;t<l;++t)c[t]=(i+t)/-o;else for(let t=0;t<l;++t)c[t]=(i+t)*o;return c}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var i,a=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?ii(e,t,n):ii(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=Ci(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Oi(e)/3)))-Oi(Math.abs(t)))}(a,o))||(r.precision=i),Li(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Oi(e)-Oi(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Oi(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return Ri(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,l=a.length-1,c=a[o],u=a[l],s=10;for(u<c&&(i=c,c=u,u=i,i=o,o=l,l=i);s-- >0;){if((i=ii(c,u,n))===r)return a[o]=c,a[l]=u,e(a);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function ki(){var t=function(){var t,e,n,r,i,a,o=bi,l=bi,c=yi,u=_i;function s(){var t,e,n,c=Math.min(o.length,l.length);return u!==_i&&(t=o[0],e=o[c-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=c>2?Ai:Ii,i=a=null,d}function d(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),l,c)))(t(u(e)))}return d.invert=function(n){return u(e((a||(a=r(l,o.map(t),dn)))(n)))},d.domain=function(t){return arguments.length?(o=Array.from(t,gi),s()):o.slice()},d.range=function(t){return arguments.length?(l=Array.from(t),s()):l.slice()},d.rangeRound=function(t){return l=Array.from(t),c=vi,s()},d.clamp=function(t){return arguments.length?(u=!!t||_i,s()):u!==_i},d.interpolate=function(t){return arguments.length?(c=t,s()):c},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,s()}}()(_i,_i);return t.copy=function(){return e=t,ki().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},zr.apply(t,arguments),Fi(t)}function Bi(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ki(t){return function(){return t}}function Hi(t){this._context=t}function Yi(t){return new Hi(t)}Pi=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Di:(e=ji.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),a.push(t.substring(i-=l,i+l)),!((c+=l+1)>r));)l=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?Di:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(ji.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",s=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=Ci(t)).fill,n=t.align,d=t.sign,f=t.symbol,h=t.zero,p=t.width,m=t.comma,y=t.precision,v=t.trim,g=t.type;"n"===g?(m=!0,g="g"):xi[g]||(void 0===y&&(y=12),v=!0,g="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var b="$"===f?i:"#"===f&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",_="$"===f?a:/[%p]/.test(g)?c:"",E=xi[g],I=/[defgprs%]/.test(g);function A(t){var i,a,c,f=b,A=_;if("c"===g)A=E(t)+A,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?s:E(Math.abs(t),y),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==d&&(S=!1),f=(S?"("===d?d:u:"-"===d||"("===d?"":d)+f,A=("s"===g?Vi[8+Si/3]:"")+A+(S&&"("===d?")":""),I)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){A=(46===c?o+t.slice(i+1):t.slice(i))+A,t=t.slice(0,i);break}}m&&!h&&(t=r(t,1/0));var M=f.length+t.length+A.length,C=M<p?new Array(p-M+1).join(e):"";switch(m&&h&&(t=r(C+t,C.length?p-A.length:1/0),C=""),n){case"<":t=f+t+A+C;break;case"=":t=f+C+t+A;break;case"^":t=C.slice(0,M=C.length>>1)+f+t+A+C.slice(M);break;default:t=C+f+t+A}return l(t)}return y=void 0===y?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),A.toString=function(){return t+""},A}return{format:d,formatPrefix:function(t,e){var n=d(((t=Ci(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Oi(e)/3))),i=Math.pow(10,-r),a=Vi[8+r/3];return function(t){return n(i*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ri=Pi.format,Li=Pi.formatPrefix,Array.prototype.slice,Hi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const Ui=Math.PI,Gi=2*Ui,$i=1e-6,zi=Gi-$i;function Wi(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Xi{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Wi:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Wi;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,i,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+i},${this._y1=+a}`}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=n-t,c=r-e,u=a-t,s=o-e,d=u*u+s*s;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(d>$i)if(Math.abs(s*l-c*u)>$i&&i){let f=n-a,h=r-o,p=l*l+c*c,m=f*f+h*h,y=Math.sqrt(p),v=Math.sqrt(d),g=i*Math.tan((Ui-Math.acos((p+d-m)/(2*y*v)))/2),b=g/v,_=g/y;Math.abs(b-1)>$i&&this._append`L${t+b*u},${e+b*s}`,this._append`A${i},${i},0,0,${+(s*f>u*h)},${this._x1=t+_*l},${this._y1=e+_*c}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,i,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),l=n*Math.sin(r),c=t+o,u=e+l,s=1^a,d=a?r-i:i-r;null===this._x1?this._append`M${c},${u}`:(Math.abs(this._x1-c)>$i||Math.abs(this._y1-u)>$i)&&this._append`L${c},${u}`,n&&(d<0&&(d=d%Gi+Gi),d>zi?this._append`A${n},${n},0,1,${s},${t-o},${e-l}A${n},${n},0,1,${s},${this._x1=c},${this._y1=u}`:d>$i&&this._append`A${n},${n},0,${+(d>=Ui)},${s},${this._x1=t+n*Math.cos(i)},${this._y1=e+n*Math.sin(i)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function qi(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new Xi(e)}function Zi(t){return t[0]}function Ji(t){return t[1]}function Qi(t,e){var n=Ki(!0),r=null,i=Yi,a=null,o=qi(l);function l(l){var c,u,s,d=(l=Bi(l)).length,f=!1;for(null==r&&(a=i(s=o())),c=0;c<=d;++c)!(c<d&&n(u=l[c],c,l))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+t(u,c,l),+e(u,c,l));if(s)return a=null,s+""||null}return t="function"==typeof t?t:void 0===t?Zi:Ki(t),e="function"==typeof e?e:void 0===e?Ji:Ki(e),l.x=function(e){return arguments.length?(t="function"==typeof e?e:Ki(+e),l):t},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Ki(+t),l):e},l.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ki(!!t),l):n},l.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),l):i},l.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),l):r},l}function ta(t,e,n){var r=null,i=Ki(!0),a=null,o=Yi,l=null,c=qi(u);function u(u){var s,d,f,h,p,m=(u=Bi(u)).length,y=!1,v=new Array(m),g=new Array(m);for(null==a&&(l=o(p=c())),s=0;s<=m;++s){if(!(s<m&&i(h=u[s],s,u))===y)if(y=!y)d=s,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),f=s-1;f>=d;--f)l.point(v[f],g[f]);l.lineEnd(),l.areaEnd()}y&&(v[s]=+t(h,s,u),g[s]=+e(h,s,u),l.point(r?+r(h,s,u):v[s],n?+n(h,s,u):g[s]))}if(p)return l=null,p+""||null}function s(){return Qi().defined(i).curve(o).context(a)}return t="function"==typeof t?t:void 0===t?Zi:Ki(+t),e="function"==typeof e?e:Ki(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Ji:Ki(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:Ki(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:Ki(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Ki(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:Ki(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:Ki(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Ki(+t),u):n},u.lineX0=u.lineY0=function(){return s().x(t).y(e)},u.lineY1=function(){return s().x(t).y(n)},u.lineX1=function(){return s().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:Ki(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(l=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=l=null:l=o(a=t),u):a},u}function ea(t){return t<0?-1:1}function na(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),l=(a*i+o*r)/(r+i);return(ea(a)+ea(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function ra(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ia(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,l=(a-r)/3;t._context.bezierCurveTo(r+l,i+l*e,a-l,o-l*n,a,o)}function aa(t){this._context=t}function oa(t){this._context=t}function la(t){return new aa(t)}function ca(t,e,n){this.k=t,this.x=e,this.y=n}function ua(t){return ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ua(t)}function sa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function da(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sa(Object(n),!0).forEach(function(e){fa(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sa(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function fa(t,e,n){return(e=function(t){var e=function(t){if("object"!=ua(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ua(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}aa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ia(this,this._t0,ra(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ia(this,ra(this,n=na(this,t,e)),n);break;default:ia(this,this._t0,n=na(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(function(t){this._context=new oa(t)}.prototype=Object.create(aa.prototype)).point=function(t,e){aa.prototype.point.call(this,e,t)},oa.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},ca.prototype={constructor:ca,scale:function(t){return 1===t?this:new ca(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new ca(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new ca(1,0,0),ca.prototype,mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ha=function(t,e,n,r){var i=t.xScale,a=t.yScale,o=Qi().curve(la).x(function(t){return i(t.index)}).y(function(t){return a(t.value)});e.append("path").datum(n).attr("fill","none").attr("stroke",r).attr("stroke-width",1.5).attr("d",o)},pa=function(t,e,n){t.attr("width",0).transition().duration(n).attr("width",e)},ma=function(t,e,n,i){var a=e.xScale,o=e.yScale,l=t.append("circle").attr("class","trend-graph__tooltip-marker").attr("fill",r);return{tooltipHandler:function(t){var e,r=t.detail,c=r.evt,u=r.returnObject,s=c.e.offsetX||c.layerX||0,d=Math.round(a.invert(s));parseFloat(l.attr("cx"))!==a(d)&&l.attr("cx",a(d)).attr("cy",o(n[d].value)).attr("r",0).transition().duration(300).attr("r",5),u.graphicModel=null===(e=i[d])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){l.transition().duration(0).attr("r",0)}}};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ya=function(t,e,n,r){var i=e.xBarScale,a=t.selectAll(".trend__bar"),o=i.step();return{tooltipHandler:function(t){var e,i,l,c,u=t.detail,s=u.evt,d=u.returnObject,f=(c=(null===(l=(i=s).e)||void 0===l?void 0:l.offsetX)||i.layerX,Math.floor(c/o));a.attr("fill-opacity",n),Lr(a.nodes()[f]).attr("fill-opacity",.4*n),d.graphicModel=null===(e=r[f])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){a.attr("fill-opacity",n)}}};function va(t){return function(t){if(Array.isArray(t))return ga(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ga(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ga(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ga(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ba=y.TREND_SHAPE,_a=ba.LINE,Ea=ba.AREA,Ia=ba.BAR;var Aa=function(t,e,n,r,i,a,o){var l=t.cardDimensions,c=l.cardWidth,u=l.cardHeight,s=o.minValue,d=o.maxValue,f=r/100,h=(n?24:28)/100*(u-2),p=i===Ia?.01*h:5,m=c-2,y=null!=a&&a.value?Math.min(s,a.value):s,v=function(t,e,n,r,i,a){var o=ki().domain([0,t.length-1]).range([0,e]),l=ki().domain([n,r>=0?r:0]).range([i-a,a]),c=Qr().domain(t.map(function(t,e){return e})).range([0,e]).padding(.1).align(.5);return{xScale:o,yScale:l,xBarScale:c,heightScale:function(t){return Math.abs(l(0)-l(t))},barYScale:function(t){return l(t>=0?t:0)}}}(e,m,y,null!=a&&a.value?Math.max(d,a.value):d,h,p);return{scales:v,graphData:e.map(function(t,e){return{index:e,value:t.raw}}),trendFillOpacityFraction:f,trendWidth:m,scaledMinValue:y,trendVerticalMargin:p,SVGHeight:h}};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var Sa=function(t,e,n,r){var i=t.sourceEvent||t;if(!e.isAndroid||!i.target.classList.contains("trend__body")){xa(e);var a=e.selectedCardsGraphicModels;if(e.clearSelections(),e.isIOS&&(e.handleContextMenuSelection(i),e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")})),a=Oa(i,a,n),e.selectedCardsGraphicModels=a,Na(e),"A"===(null==r?void 0:r.tagName)&&window.open(r.href,"_blank"),a.length>0){var l=o(e.KPIType),c=N(e,l.TREND),u=N(e,l.BREAK_BY);(c||u)&&Ma(e,a)}else Ca(e,n)}},Ma=function(t,e){t.isIOS?e.forEach(function(t){var e=t.getSelector();e.messageType="selection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(e)}):t.applySelection(e.map(function(t){return t.getSelector()}))},Ca=function(t,e){if(t.isIOS){var n=e.getSelector();n.messageType="deselection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(n)}else t.clearSelections(),t.endSelections()},Ta=function(t){var e=t.cardId;return document.getElementById(mstrmojo.string.encodeHtmlString(e))},wa=function(t){null==t||t.classList.remove("card--selected"),null==t||t.classList.remove("card--unselected"),null==t||t.classList.remove("card--selected-no-hover")},Oa=function(t,e,n){var r=e.map(function(t){return t.cardId}),i=r.indexOf(n.cardId);if(!0===t.ctrlKey||!0===t.metaKey)-1!==i?e.splice(i,1):e.push(n);else{var a=-1===i||r.length>1&&-1!==i;e.length=0,a&&e.push(n)}return e},Na=function(t,e){var n=t.selectedCardsGraphicModels,r=t.isSingleCardDisplayed;if(null!=e&&e.length&&(n=e),t.getGraphicModels().forEach(function(t){var e=Ta(t);r?null==e||e.classList.add("card--no-hover"):null==e||e.classList.remove("card--no-hover")}),0!==n.length){var i=n.map(function(t){return t.cardId});t.getGraphicModels().forEach(function(t){var e=Ta(t);i.includes(t.cardId)?null!=e&&e.classList.contains("card--selected-context-menu")||function(t,e){null==t||t.classList.add(e?"card--selected-no-hover":"card--selected"),null==t||t.classList.remove("card--unselected")}(e,r):function(t,e){null==t||t.classList.remove("card--selected"),e||null==t||t.classList.add("card--unselected")}(e,r)})}else t.getGraphicModels().forEach(function(t){var e=Ta(t);wa(e)})},xa=function(t){t.contextMenuCardsGraphicModels.forEach(function(t){var e=Ta(t);null==e||e.classList.remove("card--selected-context-menu")}),t.contextMenuCardsGraphicModels=[]};function Da(t){return function(t){if(Array.isArray(t))return Pa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Pa(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pa(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var Ra=function(t,e){return{tag:"button",content:"",classes:["controls__dot-indicator"],style:{color:e},otherAttributes:{id:t}}},La=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{tag:"button",classes:["controls__".concat(t,"-arrow")].concat(Da(n),Da(r)),content:e}};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ja=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r='<path fill="'.concat(t,'" fill-rule="nonzero" d="M11.2180716,2.07107347 L4.91484044,2.07107347 C4.44372309,2.07107347 4.06183057,2.45296599 4.06183057,2.92408334 C4.06183057,3.39520069 4.44372309,3.77709321 4.91484044,3.77709321 L9.15869251,3.77709321 L2.32092272,10.6149056 C1.98777972,10.9480487 1.98777972,11.4881319 2.32092272,11.8212322 C2.65402308,12.1543326 3.19410628,12.1543752 3.52724928,11.8212322 L10.3650617,4.98341977 L10.3650617,9.22727184 C10.3650617,9.69838919 10.7469542,10.0802817 11.2180716,10.0802817 C11.6891889,10.0802817 12.0710815,9.69838919 12.0710815,9.22727184 L12.0710815,2.92408334 C12.0710815,2.45983272 11.6937952,2.07107347 11.2180716,2.07107347 Z" transform="translate(7.071073, 7.071073)\n\trotate(').concat(1===e?"-45.0":"135.0",') translate(-7.071073, -7.071073)"></path>');return n?r:'<svg class="trend-indicator__icon" width="14pt" height="14pt" viewBox="0 0 14 14">'.concat(r,"</svg>")},Va=function(t,e,n,r){var i,a=e.trendIncreaseBackgroundColor,o=e.trendDecreaseBackgroundColor,c=e.trendConstantBackgroundColor,u=e.trendIndicatorShape,s=e.trendIndicatorValueType,d=y.TREND_INDICATOR_SHAPE.BADGE,f=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,h=null===(i=r[5])||void 0===i?void 0:i.color;return 0===t?{indicatorColor:null!=h?h:c,valueSign:"",arrowType:null}:t<0?{indicatorColor:null!=h?h:o,valueSign:n===l||s===f?"":"-",arrowType:-1}:{indicatorColor:null!=h?h:a,valueSign:n===l||u!==d?"":"+",arrowType:1}};function Fa(t){return Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(t)}function ka(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ba(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ka(Object(n),!0).forEach(function(e){Ka(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ka(t,e,n){return(e=function(t){var e=function(t){if("object"!=Fa(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Fa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fa(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ha(t){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(t)}function Ya(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ua(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ya(Object(n),!0).forEach(function(e){Ga(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ya(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ga(t,e,n){return(e=function(t){var e=function(t){if("object"!=Ha(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ha(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ha(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var $a=function(t,e,n,r){var i,a,o,l,u,s,d,f,h,p,m,v,g,b,_,E=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],I=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],A=e.isComparisonKPI,S=e.isRealTime,M=e.cardProperties,C=t.secondaryValue,T=t.indicator,w=t.trend,O=t.trendChartData,N=t.graphicModel,x=t.referenceLine,P=t.thresholdTarget,L=t.trendAttributeFormType,V=t.metricFormType,F=n.secondaryValueFontOptions,k=n.trendIndicatorEnabled,B=n.comparisonIndicatorEnabled,K=M.cssModifiers,H=M.isTrendIndicatorOnTop,Y=M.showSecondaryValue,U=M.isComparisonMetricAdded,G=N.cardId,$=[];if(C&&Y&&E)if(a=function(t,e,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=t.label,c=t.value;i&&(c+="");var u=l?"".concat(l,": ").concat(c):c,s=D(n,r),d=Et(function(t,e,n,r){var i=n.cardElementsModifier,a=n.indicatorPosition,o=n.cardAlignment;return r[4]&&(t.color=r[4].color),{classes:["card__secondary-value","card__secondary-value--".concat(i),"card__secondary-value--".concat(a),"card__secondary-value--".concat(o)],content:e,style:t}}(s,u,e,a),!0,o);return d.secondaryValueData={labelTitle:l,labelValue:c,wholeLabel:u,shouldSanitizeSecondaryValue:o},d}(C,K,F,e,U,P,L===(null!==(p=null===(m=mstrmojo)||void 0===m||null===(v=m.chart)||void 0===v||null===(g=v.model)||void 0===g||null===(b=g.enums)||void 0===b||null===(_=b.EnumDSSBaseFormType)||void 0===_?void 0:_.DssBaseFormHTMLTag)&&void 0!==p?p:7)||void 0!==V),e.components.cardSecondaryValues.push(a),S&&(e.parsedData[r].secondaryValueComponentIndex=e.components.cardSecondaryValues.length-1,e.isSecondaryLabelUpdated=!0),U){var z=Et((s=(u=K).cardAlignment,d=u.cardDirection,{tag:"div",classes:["card__secondary-value-with-indicator-wrapper","card__secondary-value-with-indicator-wrapper--".concat(s),"card__secondary-value-with-indicator-wrapper--".concat(d)]}));z.append(a),$.push(z),e.components.cardSecondaryValueWithIndicatorWrappers.push(z),B&&(l=function(t,e,n,r){var i=e.indicatorFontOptions,a=e.trendIndicatorValueType,o=t.differenceBetweenPrimaryAndSecondary,l=t[a],c=Va(o,e,l,r),u=c.indicatorColor,s=c.valueSign,d=D(i,n),f=Et(function(t,e){return{tag:"div",classes:["card__comparison-indicator"],content:e,style:t}}(Ba(Ba({},d),{},{color:u}),a===y.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(s).concat(l,")"):"".concat(s).concat(l)));return f}(T,n,e,P),z.append(l),e.components.cardIndicators.push(l),e.cardComponentReferences[G].trendIndicator={cssModifiers:K,indicator:T})}else $.push(a),k&&(o=function(t,e,n,r,i){var a,o=n.trendIndicatorValueType,l=n.trendIndicatorShape,c=n.indicatorFontOptions,u=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,s=e.differenceBetweenPrimaryAndSecondary,d=mstrmojo.string.encodeHtmlString(e[o]),f=d,h=Va(s,n,f,{}),p=h.arrowType,m=h.indicatorColor,v=h.valueSign,g="",b=D(c,r),_=null===(a=i[8])||void 0===a?void 0:a.color;if(l===y.TREND_INDICATOR_SHAPE.ARROW){var E=p?ja(m,p):"";g=o===u?"".concat(E,' <span class="trend-indicator__value---with-icon">').concat(v).concat(d,"</span>"):"".concat(E,' <span class="trend-indicator__value---with-icon">').concat(v," ").concat(d,"</span>"),b.color=null!=_?_:m}else g=d=o===u?"".concat(v).concat(d):"".concat(v," ").concat(d),b.background=null!=_?_:m;return Et(function(t,e,n,r,i){var a=e.indicatorPosition,o=e.cardElementsModifier,l=e.cardAlignment;return i[5]&&(t.color=i[5].color),{classes:["card__trend-indicator","card__trend-indicator--".concat(o),"card__trend-indicator--".concat(a),"card__trend-indicator--".concat(l)],content:r,style:t,otherAttributes:{title:n}}}(b,t,f,g,i),!1)}(K,T,n,e,P),H?e.cardComponentReferences[G].cardBody.append(o):$.push(o),e.components.cardIndicators.push(o),S&&(e.parsedData[r].trendIndicatorComponentIndex=e.components.cardIndicators-1),e.cardComponentReferences[G].trendIndicator={cssModifiers:K,indicator:T});if(C&&w&&I){var W=function(t,e,n,r,i,a,o,l){var u,s=n.minValue,d=n.maxValue,f=a.trendShape,h=a.trendFillColor,p=a.trendFillOpacity;l[6]&&(h=l[6].color,p=null!==(u=l[6].opacity)&&void 0!==u?u:100);var m,v=Aa(o,e,r,p,f,i,{minValue:s,maxValue:d}),g=v.scales,b=v.graphData,_=v.trendFillOpacityFraction,E=v.trendWidth,I=v.scaledMinValue,A=v.trendVerticalMargin,S=v.SVGHeight,M=Lr(t).append("svg");switch(M.attr("width",E).attr("height",S),f){case _a:ha(g,M,b,R(h,p)),pa(M,E,o.animationDuration),m=ma(M,g,b,e);break;case Ea:!function(t,e,n,r,i,a,o){var l=t.xScale,c=t.yScale,u=ta().curve(la).x(function(t){return l(t.index)}).y1(function(t){return c(t.value)}).y0(a>=0?c(a)+o:c(0));e.append("path").datum(n).attr("fill",r).attr("fill-opacity",i).attr("stroke","none").attr("d",u)}(g,M,b,h,_,I,A),ha(g,M,b,h),pa(M,E,o.animationDuration),m=ma(M,g,b,e);break;case Ia:!function(t,e,n,r,i,a){var o=e.xBarScale,l=e.heightScale,c=e.barYScale;t.selectAll("bars").data(n).enter().append("rect").attr("class","trend__bar").attr("x",function(t){return o(t.index)}).attr("y",function(){return c(0)}).attr("width",o.bandwidth()).attr("fill",r).attr("fill-opacity",i).attr("stroke",r).attr("stroke-width",1.5).attr("height",0).transition().duration(a).attr("y",function(t){return c(t.value)}).attr("height",function(t){return l(t.value)})}(M,g,b,h,_,o.animationDuration),m=ya(M,g,_,e)}i&&function(t,e,n,r,i){var a,o=t.line,l=o.color,u=o.shape,s=t.value,d=t.formattedValue,f=t.label,h=t.font,p=D(h,i),m=e.yScale,v=y.SELECTED_REFERENCE_LINE_SHAPE,g=u===v.THICK_LINE_TYPE?2:1;switch(u){case v.DOTTED_LINE_TYPE:a="1 1";break;case v.DASHED_LINE_TYPE:a="3 3";break;case v.THIN_LINE_TYPE:case v.THICK_LINE_TYPE:a="1 0"}n.append("line").attr("stroke",l).attr("x1",0).attr("x2",r).attr("y1",m(s)).attr("y2",m(s)).attr("stroke-width",g).attr("stroke-dasharray",a);var b=f?"".concat(f," ").concat(d):d,_=mstrmojo.VisUtility.measureTextWidth(b+c,da(da({},p),{},{lineHeight:1})),E=parseFloat(p.fontSize),I=n.append("text").attr("x",Math.max(r-_-2,2)).attr("y",m(s)-4-E>0?m(s)-4:m(s)+4+E);I.attr("class","card__reference-line-label").text(b).attr("font-family",p.fontFamily).attr("fill",p.color).attr("font-weight",p.fontWeight).attr("font-style",p.fontStyle).attr("text-decoration",p.textDecoration).attr("font-size",p.fontSize);var A=document.createElement("span");if(_>r){var S=j({container:A,maxTextWidth:r-4,textData:{label:f,value:d,connector:" "},fontSize:parseInt(p.fontSize),fontStyle:p}).truncatedLabelWithValue;I.text(S)}A.remove()}(i,g,M,E,o),M.append("rect").attr("x",0).attr("y",0).attr("height",S).attr("width",E).style("fill","transparent").attr("class","trend__body");var C=m,T=C.tooltipHandler,w=C.resetHighlight;return M.on("tooltip",T).on("mouseout",function(){w(),o.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},o.hideTooltip(!1)}),M}(f=Et((h=K.indicatorPosition,{classes:["card__trend-graph","card__trend-graph--".concat(h)]})),O,w,H,x,n,e,P);e.trendSVGs.push(W),$.push(f),S&&(e.parsedData[r].trendComponentIndex=e.trendSVGs.length-1)}var X=Et("div");return X.classList.add("overlay-fill"),e.isMobile||X.classList.add("overlay-fill--not-mobile"),$.push(X),(i=e.cardComponentReferences[G].cardComponent).append.apply(i,$),E&&(o=A&&U?l:o,e.cardComponentReferences[G]=Ua(Ua({},e.cardComponentReferences[G]),{},{cardSecondaryValue:a,cardIndicator:o})),I&&(e.cardComponentReferences[G]=Ua(Ua({},e.cardComponentReferences[G]),{},{cardTrendGraph:f,cardTrendGraphData:{trendChartData:[],trend:w,isTrendIndicatorOnTop:H,referenceLine:x,properties:n}})),e.cardComponentReferences[G].cardComponent};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var za="slider--sliding",Wa="controls__dot-indicator--active",Xa="prev",qa="next",Za="arrow",Ja=["ArrowLeft","ArrowRight","Delete","Enter","Backspace","End","Home"],Qa="small",to="medium",eo="large",no="-dot-indicator";mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var ro=function(t){var e=t.sliderState,r=t.controlsLayout,i=t.vizHeight,a=t.cardWidth,o=t.cardsCount,l=t.elementRefs,c=t.properties,u=t.slideCard,s=1===c.cardStyle?n.LIGHT:n.NIGHT;return l.controlsContainer=Et({classes:["controls"]}),r===Za?function(t,e,n,r,i,a,o){var l=function(t){return t===qa?'<svg width="18" height="16" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(a,'" points="5 16 13 9 5 2"></polygon></svg>'):'\n\t\t\t<svg width="18px" height="16px" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(a,'" transform="translate(9.000000, 9.000000) scale(-1, 1) translate(-9.000000, -9.000000) " points="5 16 13 9 5 2"></polygon></svg>\n\t\t')},c=n<150||e<100?Qa:n>300&&e>300?eo:to;c===eo?i.controlsContainer.classList.add("controls--arrow-indicators"):i.controlsContainer.classList.add("controls--smaller");var u=["controls__arrow"];c!==eo&&u.push("controls__arrow--smaller");var s=c===Qa?["controls__prev-arrow--smaller"]:[];i.prevArrowControl=i.controlsContainer.appendChild(Et(La(Xa,l(Xa),u,s),!1)),c!==Qa&&function(t,e,n,r,i,a){var o=function(t){var e=t.target,r=t.key,i=e.textContent,a=n.toString().length;"ENTER"===r?e.blur():i.length>a&&(e.textContent=i.substring(0,a))},l=t.activeCardIndex,c=["controls__text-indicators"];e===to&&c.push("controls__text-indicators--smaller"),r.textIndicator=r.controlsContainer.appendChild(Et({classes:c,style:{color:i}})),r.activeCardTextIndicator=r.textIndicator.appendChild(Et({classes:["controls__active-card"],content:l,style:{borderBottom:"1px solid ".concat(i)},otherAttributes:{contentEditable:""}})),r.activeCardTextIndicator.addEventListener("keydown",function(e){var n=t.sliding,r=e.key,i=e.shiftKey;isNaN(parseInt(r))&&!Ja.includes(r)||i||n?e.preventDefault():o(e)}),r.activeCardTextIndicator.addEventListener("keyup",o),r.activeCardTextIndicator.addEventListener("blur",function(e){var r=t.activeCardIndex,i=e.target,o=parseInt(i.textContent);o>n?i.textContent=r:a(o)}),r.textIndicator.appendChild(Et({classes:["controls__slash"],content:"/"})),r.textIndicator.appendChild(Et({classes:["controls__total-cards"],content:n}))}(t,c,r,i,a,o),i.nextArrowControl=i.controlsContainer.appendChild(Et(La(qa,l(qa),u),!1)),i.prevArrowControl.addEventListener("click",function(){return o(t.activeCardIndex-1)}),i.nextArrowControl.addEventListener("click",function(){return o(t.activeCardIndex+1)})}(e,i,a,o,l,s,u):function(t,e,n,r,i){var a=y.FIRST_CARD_INDEX,o=t.activeCardIndex;n.controlsContainer.classList.add("controls--dot-indicators");for(var l=a;l<=e;l++){var c="".concat(l).concat(no),u=n.controlsContainer.appendChild(Et(Ra(c,r)));l===o&&u.classList.add(Wa)}n.controlsContainer.addEventListener("click",function(e){var n=t.activeCardIndex,r=e.target;if(r.classList.contains("controls__dot-indicator")){var a=parseInt(r.id);if(a===n)return;i(a)}})}(e,o,l,s,u),l.controlsContainer};function io(t){return io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},io(t)}function ao(t,e,n){return(e=function(t){var e=function(t){if("object"!=io(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=io(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==io(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var oo={CARD_LABELS:"cardLabels",CARD_PRIMARY_VALUES:"cardPrimaryValues",CARD_SECONDARY_VALUES:"cardSecondaryValues",CARD_BODIES:"cardBodies",CARD_INDICATORS:"cardIndicators",CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS:"cardSecondaryValueWithIndicatorWrappers"},lo=ao(ao(ao(ao({},oo.CARD_LABELS,"labelFontOptions"),oo.CARD_PRIMARY_VALUES,"primaryValueFontOptions"),oo.CARD_SECONDARY_VALUES,"secondaryValueFontOptions"),oo.CARD_INDICATORS,"indicatorFontOptions");function co(t){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},co(t)}function uo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function so(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function fo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?so(Object(n),!0).forEach(function(e){ho(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):so(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ho(t,e,n){return(e=function(t){var e=function(t){if("object"!=co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==co(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}oo.CARD_LABELS,oo.CARD_PRIMARY_VALUES,oo.CARD_SECONDARY_VALUES,oo.CARD_INDICATORS,mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var po=function(t,e,n,r,i,a){var o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=u.sliding,i=u.activeCardIndex,o=a.intervalAutoPlayId;r||e===i||(!n&&o&&(clearInterval(o),a.intervalAutoPlayId=null),u.sliding=!0,u.activeCardIndex=e,s.slider.classList.add(za),s.slider.style.transform="translate(-".concat(t*e,"px)"))},l=function(){a.intervalAutoPlayId=setInterval(function(){var t=a.tooltipInfo,e=a.autoPlayEnabled,n=u.sliding;!e||n||t.isVisible||o(u.activeCardIndex+1,!0)},3400)},c=i.activeCardIndex,u={activeCardIndex:a.activeCardIndex||c,sliding:!1},s={vizContainer:null,slider:null,clonedFirstCard:null,clonedLastCard:null,controlsContainer:null,prevArrowControl:null,nextArrowControl:null,textIndicator:null,activeCardTextIndicator:null};u.activeCardIndex>n&&(u.activeCardIndex=n);var d=30*n>t?Za:"dot";return i.stackedAutoPlay&&l(),s.vizContainer=Et({tag:"div",classes:["stacked-container"],style:{width:"".concat(t,"px")}}),s.vizContainer.append(function(t,e,n,r,i,a,o){var l,c,u,s,d=y.FIRST_CARD_INDEX,f=30*r>n?Za:"dot",h=function(){var a=t.activeCardIndex;e.slider.classList.remove(za),0===a?(a=r,e.slider.style.transform="translate(-".concat(n*a,"px)")):a===i.length+1&&(a=d,e.slider.style.transform="translate(-".concat(n*a,"px)")),t.activeCardIndex=a},p=function(){var n=t.activeCardIndex,r=e.activeCardTextIndicator;r&&(r.innerHTML="".concat(n))},m=function(){var n=t.activeCardIndex;e.controlsContainer.querySelector(".".concat(Wa)).classList.remove(Wa),document.getElementById("".concat(n).concat(no)).classList.add(Wa)},v=function(t,e){[{selector:".card__label",componentPropertyName:oo.CARD_LABELS},{selector:".card__primary-value",componentPropertyName:oo.CARD_PRIMARY_VALUES},{selector:".card__body",componentPropertyName:oo.CARD_BODIES},{selector:".card__trend-indicator",componentPropertyName:oo.CARD_INDICATORS},{selector:".card__secondary-value",componentPropertyName:oo.CARD_SECONDARY_VALUES}].forEach(function(n){var r=n.selector,i=n.componentPropertyName,o=t.querySelector(r);if(o){if(i===oo.CARD_SECONDARY_VALUES){var l=a.components[i][e].secondaryValueData;o.secondaryValueData=l}a.components[i].push(o)}})};return c=t.activeCardIndex,u=n*(r+2),e.slider=e.vizContainer.appendChild(Et({tag:"section",classes:["slider"],style:{width:"".concat(u,"px")}})),e.clonedFirstCard=i[0].cloneNode(!0),v(e.clonedFirstCard,0),e.clonedLastCard=i[i.length-1].cloneNode(!0),v(e.clonedLastCard,i.length-1),(l=e.slider).append.apply(l,function(t){if(Array.isArray(t))return uo(t)}(s=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||function(t,e){if(t){if("string"==typeof t)return uo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uo(t,e):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.slider.insertAdjacentElement("afterbegin",e.clonedLastCard),e.slider.append(e.clonedFirstCard),e.slider.addEventListener("transitionend",function(){var e=t.activeCardIndex,n=a.autoPlayEnabled,r=a.intervalAutoPlayId;t.sliding=!1,h(),f===Za?p():m(),a.activeCardIndex=e;var i=JSON.parse(a.getProperty(I));n||a.setProperty(I,JSON.stringify(fo(fo({},i),{},ho({},g.ACTIVE_CARD_INDEX.name,e))),{suppressData:!0,clientUndoRedoCallback:function(){return a.refresh()}}),n&&!r&&o()}),e.slider.style.transform="translate(-".concat(n*c,"px)"),e.slider}(u,s,t,n,r,a,l)),s.vizContainer.append(ro({sliderState:u,controlsLayout:d,vizHeight:e,cardWidth:t,cardsCount:n,elementRefs:s,properties:i,slideCard:o})),s.vizContainer};function mo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var yo=function(t,e,n){var r=n.gridFixCardHeightEnabled,i=n.layoutType,a=n.cardAlignment,l=y.LAYOUT_TYPES,c=t.domNode,u=c.clientWidth,s=c.clientHeight,d=parseInt(i===l.GRID?4:0),f=e.length,h=vo(n,f),p=r?0:s,m=i===l.STACKED?u:u/h+d/h-d,v=go(n,s,f,h,d,t);t.gridFixCardHeight=v,t.cardDimensions={cardWidth:m,cardHeight:v};var g=t.isComparisonMetricAdded,b=m>v||g,_=v>m,E=o(t.KPIType),I=N(t,E.TREND),A=g||I,S=function(t){var e,n=t.isTrendIndicatorOnTop,r=t.isComparisonMetricAdded,i=t.isCardVertical,a=t.showSecondaryValue?"with-secondary":"no-trend";return a=t.showTrendGraph?"with-trend":a,{cardAlignment:(e=t.cardAlignment,T(T(T({},y.CARD_ALIGNMENT.LEFT,"left-alignment"),y.CARD_ALIGNMENT.MIDDLE,"middle-alignment"),y.CARD_ALIGNMENT.RIGHT,"right-alignment")[e]),cardElementsModifier:a,indicatorPosition:n?"kpi-on-top":"kpi-on-bottom",comparisonIndicator:r?"with-comparison":"no-comparison",cardDirection:i?"vertical-card":"horizontal-card"}}({isTrendIndicatorOnTop:b,showSecondaryValue:A,showTrendGraph:I,cardAlignment:a,isComparisonMetricAdded:g,isCardVertical:_}),M={cssModifiers:S,isTrendIndicatorOnTop:b,cardAlignment:a,showSecondaryValue:A,isComparisonMetricAdded:g,isStackedLayout:i===l.STACKED};t.cardProperties=M,t.cardComponentReferences={};var C,w,O,x=e.map(function(e,r){return function(t,e,n,r){var i,a,o,l,c,u,s,d=null!==(i=null===(a=mstrmojo)||void 0===a||null===(o=a.chart)||void 0===o||null===(l=o.model)||void 0===l||null===(c=l.enums)||void 0===c||null===(u=c.EnumDSSBaseFormType)||void 0===u?void 0:u.DssBaseFormHTMLTag)&&void 0!==i?i:7,f=t.label,h=t.primaryValue,p=t.graphicModel,m=t.thresholdTarget,y=t.breakByAttributeFormType,v=t.metricFormType,g=e.showMetricName,b=e.primaryValueFontOptions,_=e.labelFontOptions,E=e.areaFillColor,I=e.areaFillOpacity,A=n.cardDimensions,S=A.cardWidth,M=A.cardHeight,C=n.cardProperties,T=C.cssModifiers,w=C.isStackedLayout,O=g?f.withMetricName:f.withoutMetricName,N=[],x=p.cardId,P=w?"".concat(S,"px"):"auto",L=m[7]?R(m[7].color,null!==(s=m[7].opacity)&&void 0!==s?s:100):R(E,I),j=Et(function(t,e,n,r){return{tag:"article",classes:["card"],style:{height:e,width:n,background:t,boxSizing:"border-box"},otherAttributes:{id:r}}}(L,"".concat(M,"px"),P,x));n.cardComponentReferences[x]={},j.addEventListener("click",function(t){return Sa(t,n,p)});var V=D(_,n),F=y?y===d:void 0!==v,k=Et(function(t,e,n,r){var i=r.indicatorPosition,a=r.cardAlignment,o=r.cardElementsModifier;return n[2]&&(t.color=n[2].color),{tag:"header",classes:["card__label","card__label--".concat(a),"card__label--".concat(i),"card__label--".concat(o)],content:e,style:t,otherAttributes:{title:e}}}(V,O,m,T),!0,F);N.push(k);var B,K,H,Y,U=Et((K=(B=T).indicatorPosition,H=B.cardAlignment,Y=B.cardElementsModifier,{tag:"div",classes:["card__body","card__body--".concat(K),"card__body--".concat(H),"card__body--".concat(Y)],content:null})),G=D(b,n),$=void 0!==v,z=Et(function(t,e,n,r){var i=r.cardElementsModifier,a=r.comparisonIndicator;return e.color&&(t.color=e.color),n[3]&&(t.color=n[3].color),{classes:["card__primary-value","card__primary-value--".concat(i),"card__primary-value--".concat(a)],content:e.formatted,style:t,otherAttributes:{title:e.formatted}}}(G,h,m,T),!0,$);U.append(z),N.push(U),n.components.cardBodies.push(U),n.components.cardLabels.push(k),n.components.cardPrimaryValues.push(z);var W=Et("div");return W.classList.add("overlay-fill"),n.isMobile||W.classList.add("overlay-fill--not-mobile"),N.push(W),j.append.apply(j,N),n.cardComponentReferences[x]=Ua(Ua({},n.cardComponentReferences[x]),{},{cardLabel:k,cardPrimaryValue:z,cardBody:U,cardComponent:j}),$a(t,n,e,r),null!=t&&t.isCardOld&&j.classList.add("card--old-card"),j}(e,n,t,r)});if(i===l.STACKED&&f>1)C=po(m,s,f,x,n,t);else{var P,L=["container"];i===l.HORIZONTAL?L.push("container--horizontal"):i===l.VERTICAL&&L.push("container--vertical"),(P=C=Et((w=p,{tag:"section",classes:L,style:{gridTemplateColumns:"repeat(".concat(h,", 1fr)"),minHeight:"".concat(w,"px")}}))).append.apply(P,function(t){if(Array.isArray(t))return mo(t)}(O=x)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(O)||function(t,e){if(t){if("string"==typeof t)return mo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mo(t,e):void 0}}(O)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return C},vo=function(t,e){var n=t.gridColumnCount,r=t.layoutType,i=y.LAYOUT_TYPES;switch(r){case i.GRID:return Math.min(e,n);case i.HORIZONTAL:return e;case i.VERTICAL:return 1}},go=function(t,e,n,r,i,a){var o=y.LAYOUT_TYPES,l=t.gridFixCardHeight,c=t.gridFixCardHeightEnabled;switch(t.layoutType){case o.GRID:var u=Math.ceil(n/r);return c?l:Math.max((e-i*(u-1))/u,75);case o.HORIZONTAL:case o.STACKED:return e;case o.VERTICAL:return e/n-i*(n-1)/n}};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.requiresCls("mstrmojo.css","mstrmojo.VisUtility","mstrmojo.HTMLSanitizeUtil");var bo=function(t,e,n){var r=n.cardWidth,i=n.cardHeight,a=mstrmojo.css.getComputedStyle(t),o="width"===e||"maxWidth"===e?parseFloat(r):parseFloat(i);return function(t,e){if("none"!==t)return t.indexOf("px")>0?parseFloat(t):e*parseFloat(t)/100}(a[e],o-2)},_o=function(t,e,n,r){var i=t.containerWidth,a=t.containerHeight,o=Math.max(Math.min((a-2*r)/n.height,(i-2*r)/n.width),1);return Math.floor(e*o)},Eo=function(t,e){if(!e)return t;var n=t+e;return Math.max(n,0)};function Io(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ao(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var So=function(t,e,n){var r=e.trendIndicatorShape,i=t.cardDimensions,a=t.components,o=t.isComparisonMetricAdded,l=oo.CARD_BODIES,c=oo.CARD_INDICATORS,u=oo.CARD_SECONDARY_VALUES,s=oo.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,d=a.cardBodies,f=a.cardSecondaryValueWithIndicatorWrappers;K(d,"height","100%"),K(d,"width","100%"),K(f,"height","100%");for(var h=function(){var a=Io(m[p],2),d=a[0],f=a[1];if([l,s].includes(d))return 0;if(!1===t.shouldFontBeChanged[d])return 0;var h=d===c,v=d===u;f.forEach(function(a){var l,u,s,f=h&&r===y.TREND_INDICATOR_SHAPE.ARROW,p=f&&null!==a.querySelector(".trend-indicator__icon"),m=!h||f||o?0:4,g=e[lo[d]].fontSteps;if(d===c&&o){var b=a.closest(".card").querySelector(".card__secondary-value").offsetWidth,_=i.cardWidth,E=.16*_,I=Math.floor((u=(l={partialValue:_-b-E,totalValue:_}).partialValue,s=l.totalValue,100*Math.abs(u/s)));a.style.width="".concat(I,"%"),a.style.maxWidth="".concat(I,"%")}if(function(t,e,n,r){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=11,s=e.textContent;t&&(e.style.fontSize="".concat(e.style.fontSize,"px"),u=parseInt(e.style.fontSize)),e.style.width="",e.style.height="",e.style.lineHeight="",e.style.fontSize="",e.style.left="",e.style.transform="",e.title="";var d=(null==o?void 0:o.properties).comparisonIndicatorEnabled;null!=o&&o.isComparisonKPI&&l&&null!=o&&o.isComparisonMetricAdded&&(d?(e.style.width="58%",e.style.maxWidth="58%"):(e.style.width="82%",e.style.maxWidth="82%"));var f=bo(e,"width",n),h=bo(e,"height",n);if(i=k(e,u),s){var p;if(!t&&(u=Eo(_o({containerWidth:f,containerHeight:h},11,i,a),r),c)){var m=F(u);u=Eo(_o({containerWidth:f-m,containerHeight:h},11,i,a),r)}e.style.fontSize="".concat(u,"px"),i=k(e,u);var y=null===(p=e.secondaryValueData)||void 0===p?void 0:p.labelTitle;if(l&&!t)if(i.width>f){var v,g,b=null===(v=e.secondaryValueData)||void 0===v?void 0:v.labelValue,_=null===(g=e.secondaryValueData)||void 0===g?void 0:g.shouldSanitizeSecondaryValue;if(!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&_){var E=bt(b,yt);b=_t(E,!1);var I=bt(y,yt);y=_t(I,!1)}var A=B(e,u);o.truncatedLabels.push(j({container:e,maxTextWidth:f,textData:{label:y,value:b,connector:": "},fontSize:u,fontStyle:A}).truncatedLabel)}else o.truncatedLabels.push("".concat(y,": "));!function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if("vi_icons"===t.style.fontFamily)t.style.width="".concat(e+8,"px");else{var a=bo(t,"width",r),o=t.textContent,l=n.width;if(l>a){var c=bo(t,"maxWidth",r);l<=c?t.style.width="".concat(l,"px"):(t.style.width="".concat(c||l+2*i,"px"),c&&(t.title=o))}else t.style.width="".concat(l+2*i,"px")}}(e,u,i,n,a),function(t,e,n){var r=e.height;n?(t.style.height="".concat(Math.ceil(r)+2*n,"px"),t.style.lineHeight="".concat(Math.ceil(r),"px")):(t.style.height="".concat(1.5*Math.ceil(r),"px"),t.style.lineHeight="".concat(1.5*Math.ceil(r),"px"))}(e,i,a)}}(n,a,i,g,m,t,v,p),p){var A=a.querySelector(".trend-indicator__icon"),S=F(a.style.fontSize),M=parseInt(a.style.width);A.style.width="".concat(S,"px"),A.style.height="".concat(S,"px"),a.style.padding=0,a.style.textAlign="left",a.style.width="".concat(M+S,"px")}})},p=0,m=Object.entries(a);p<m.length;p++)h();K(d,"height","auto"),K(d,"width","84%"),K(f,"height","auto")},Mo=function(t){var e=t.cardDimensions,n=t.components,r=oo.CARD_BODIES,i=oo.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,a=oo.CARD_PRIMARY_VALUES,o=oo.CARD_LABELS,l=n.cardBodies,c=n.cardSecondaryValueWithIndicatorWrappers;K(l,"height","100%"),K(l,"width","100%"),K(c,"height","100%");for(var u={},s={},d=function(){var n,l,c=Io(h[f],2),d=c[0],p=c[1];if([r,i].includes(d))return 0;var m=[];if(0===p.length)return 0;var y=bo(p[0],"width",e),v=bo(p[0],"height",e);if(s[d]={width:y,height:v},p.forEach(function(t){t.style.fontSize="".concat(t.style.fontSize,"px");var e=parseInt(t.style.fontSize),n=k(t,e);m.push(n.width),l||(l=n.height)}),m.sort(function(t,e){return t-e}),void 0===t.shouldFontBeChanged[d]&&0!==t.shouldFontBeChanged.length)return 0;n=d===a?m[m.length-1]:d===o?m[Math.ceil(.75*m.length)-1]:m.reduce(function(t,e){return t+e},0)/m.length,u[d]={width:n,height:l}},f=0,h=Object.entries(n);f<h.length;f++)d();return K(l,"height","auto"),K(l,"width","84%"),K(c,"height","auto"),{dimensionsOfText:u,dimensionsOfContainer:s}};function Co(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||wo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function To(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=wo(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function wo(t,e){if(t){if("string"==typeof t)return Oo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oo(t,e):void 0}}function Oo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var No=function(t){var e,n=0,r=To(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=parseInt(i.style.fontSize)}}catch(t){r.e(t)}finally{r.f()}return n/t.length},xo=function(t){return Math.min.apply(Math,function(t){if(Array.isArray(t))return Oo(t)}(e=t.map(function(t){var e=t.style;return parseInt(e.fontSize)}))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||wo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var e},Do=function(t){var e=t.length,n=t.map(function(t){return t.textContent});n.sort(function(t,e){return t.length-e.length});var r=n[Math.ceil(.75*e)-1],i=t.find(function(t){return t.textContent===r});return parseInt(i.style.fontSize)},Po=function(t,e){for(var n=t.components,r=oo.CARD_BODIES,i=oo.CARD_PRIMARY_VALUES,a=oo.CARD_LABELS,o={},l=0,c=Object.entries(n);l<c.length;l++){var u=Co(c[l],2),s=u[0],d=u[1];if(s!==r&&!1!==t.shouldFontBeChanged[s]){var f;f=s===i?xo(d):s===a?Do(d):No(d),o[s]=V(f);var h,p=To(d);try{for(p.s();!(h=p.n()).done;)h.value.style.fontSize="".concat(f,"px")}catch(t){p.e(t)}finally{p.f()}}}return So(t,e,!0),o};function Ro(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Lo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var jo=function(t,e){var n=e.isSecondaryLabelUpdated;switch(t.textSizeType){case y.TEXT_SIZE_TYPE.FIXED:""===t.labelFontOptions.fontSize?(So(e,t,!1),Po(e,t),e.componentsUnifiedFontSizesInPt=Po(e,t)):So(e,t,!0);break;case y.TEXT_SIZE_TYPE.UNIFIED:0!==e.shouldFontBeChanged.length||n||(So(e,t,!1),Po(e,t));var r={};r.oldDimensions=Mo(e),So(e,t,!0),r.newDimensions=Mo(e),Object.keys(r.newDimensions.dimensionsOfText).length!==Object.keys(r.oldDimensions.dimensionsOfText).length?Object.keys(r.newDimensions.dimensionsOfText).forEach(function(t){e.shouldFontBeChanged[t]=!0}):function(t){var e=t.oldDimensions,n=t.newDimensions,r=e.dimensionsOfText,i=n.dimensionsOfText,a=n.dimensionsOfContainer,o={};Object.values(i).forEach(function(t){if(r[t])if(i[t].width===r[t].width)o[t]=!1;else if(i[t].width>1*a[t].width)o[t]=!0;else if(i[t].width<=1*a[t].width&&i[t].width>=1*r[t].width)o[t]=!1;else{var e=Math.max(i[t].width/a[t].width*1,i[t].height/a[t].height*1);o[t]=!(e>=.9)}else o[t]=!0})}(r);var i=oo.CARD_SECONDARY_VALUES;n&&(e.shouldFontBeChanged[i]=!0),!0===e.shouldFontBeChanged[i]&&(e.truncatedLabels=[]),So(e,t,!1),Po(e,t);break;case y.TEXT_SIZE_TYPE.FIT_TO_CONTAINER:So(e,t,!1)}for(var a=e.components,o=0,l=Object.entries(a);o<l.length;o++){var c=Ro(l[o],2),u=c[0],s=c[1];[oo.CARD_BODIES,oo.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS].includes(u)||(K(s,"maxWidth","none"),s.forEach(function(t){k(t,t.style.fontSize).width<=parseInt(t.style.width)&&(t.style.overflow="visible")}))}};function Vo(t,e,n){var r=this;setTimeout(function(){r.savePropertyAndUpdateWidget(t,e,n)})}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var Fo="second",ko="minute",Bo="hour",Ko="day",Ho={};Ho[Fo]=1e3,Ho[ko]=60*Ho[Fo],Ho[Bo]=60*Ho[ko],Ho[Ko]=24*Ho[Bo],Ho.week=7*Ho[Ko],Ho.month=30*Ho[Ko],Ho.year=365*Ho[Ko],mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});function Yo(t){return function(t){if(Array.isArray(t))return Uo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Uo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.requiresCls("mstrmojo.CustomVisBase","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming");var Go=function(t){var e=!1,n=t.updatedCategory,r=t.isBreakByAttributeAdded,i=t.isOnlyPrimaryValueRendered;t.parsedData.forEach(function(a,o){var l=a.graphicModel.cardId;(!r||a.breakByAttributeName===n)&&(function(t,e,n,r){var i=t.cardComponentReferences,a=t.isComparisonKPI,o=t.isComparisonMetricAdded,l=t.isTrendAttributeAdded,c=i[r],u=c.cardTrendGraphData,s=c.cardPrimaryValue,d=c.cardIndicator,f=u.isTrendIndicatorOnTop,h=u.referenceLine,p=u.properties,m=e.trendChartData,v=e.trend,g=e.indicator,b=e.trendComponentIndex,_=e.thresholdTarget;if(s.textContent=e.primaryValue.formatted,(l||a&&o)&&1!==m.length&&(function(t,e,n){var r,i,a=null!==(r=t.secondaryValueComponentIndex)&&void 0!==r?r:e,o=null===(i=t.secondaryValue)||void 0===i?void 0:i.value,l=n.components.cardSecondaryValues[a].secondaryValueData,c=l.labelTitle;l.labelValue=o,l.labelTitle=t.secondaryValue.label,n.isSecondaryLabelUpdated=c!==(null==l?void 0:l.labelTitle),n.secondaryMetricName=l.labelTitle,n.isComparisonMetricAdded&&(l.labelValue+=""),0===n.truncatedLabels.length&&(n.components.cardSecondaryValues[a].textContent="".concat(l.labelTitle,": ").concat(l.labelValue))}(e,n,t),function(t,e,n,r,i){var a=t.isComparisonKPI,o=t.isComparisonMetricAdded;(!a&&t.properties.trendIndicatorEnabled||a&&t.properties.comparisonIndicatorEnabled)&&(e.indicatorFontOptions.fontSize=n.style.fontSize,o?function(t,e,n,r){var i=n.trendIndicatorValueType,a=e.differenceBetweenPrimaryAndSecondary,o=e[i],l=Va(a,n,o,r),c=l.indicatorColor,u=l.valueSign,s=i===y.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(u).concat(o,")"):"".concat(u).concat(o);t.textContent=s,t.style.color=c}(n,r,e,i):function(t,e,n){var r=n.trendIndicatorValueType,i=n.trendIndicatorShape,a=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,o=e.differenceBetweenPrimaryAndSecondary,l=mstrmojo.string.encodeHtmlString(e[r]),c=Va(o,n,l,{}),u=c.arrowType,s=c.indicatorColor,d=c.valueSign;if(i===y.TREND_INDICATOR_SHAPE.ARROW){var f=u?ja(s,u,!0):"";t.firstChild.innerHTML=f,t.lastChild.textContent=r===a?"".concat(d).concat(l):"".concat(d," ").concat(l),t.style.color=s}else l=r===a?"".concat(d).concat(l):"".concat(d," ").concat(l),t.textContent=l,t.style.backgroundColor=s}(n,r,e))}(t,p,d,g,_),l)){var E=null!=b?b:n;!function(t,e,n,r,i,a,o,l){var c=o.trendShape,u=o.trendFillColor,s=o.trendFillOpacity,d=o.axisScale,f=l.minValue,h=l.maxValue,p=r.isBreakByAttributeAdded,m=r.updatedCategory,v=r.cardDetails;if(d!==y.AXIS_SCALE.GLOBAL){var g=d===y.AXIS_SCALE.SYNCED_ALL?r.parsedData:r.parsedData.filter(function(t){return t.metricId===n});f=Math.min.apply(Math,va(g.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),h=Math.max.apply(Math,va(g.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})))}p&&v.forEach(function(t){t.breakByAttributeName===m&&(t.trend[n]=l)});var b,_=Aa(r,e,i,s,c,a,{minValue:f,maxValue:h}),E=_.scales,I=_.graphData,A=_.trendFillOpacityFraction,S=_.trendWidth,M=_.trendVerticalMargin;b=c===_a?function(t,e,n,r){var i=e.xScale,a=e.yScale,o=Qi().curve(la).x(function(t){return i(t.index)}).y(function(t){return a(t.value)});return t.selectAll(".trend-graph__tooltip-marker").remove(),t.select("path").datum(n).attr("d",o),ma(t,e,n,r)}(t,E,I,e):c===Ea?function(t,e,n,r,i,a){var o=e.xScale,l=e.yScale,c=ta().curve(la).x(function(t){return o(t.index)}).y1(function(t){return l(t.value)}).y0(i>=0?l(i)+a:l(0));return t.selectAll(".trend-graph__tooltip-marker").remove(),t.selectAll("path").datum(n).attr("d",c),ma(t,e,n,r)}(t,E,I,e,f,M):function(t,e,n,r,i,a){var o=e.xBarScale,l=e.barYScale,c=e.heightScale,u=t.selectAll(".trend__bar").data(n);return u.enter().append("rect").attr("class","trend__bar").merge(u).style("fill",i).attr("fill-opacity",a).attr("stroke",i).attr("stroke-width",1.5).attr("x",function(t){return o(t.index)}).attr("width",o.bandwidth()).attr("y",function(t){return l(t.value)}).attr("height",function(t){return c(t.value)}),ya(t,e,a,r)}(t,E,I,e,u,A),a&&function(t,e,n,r,i){var a=n.value,o=n.font,l=e.yScale;t.select("line").attr("x1",0).attr("x2",i).attr("y1",l(a)).attr("y2",l(a)).raise();var c=D(o,r),u=parseFloat(c.fontSize),s=l(a)-4,d=l(a)+4,f=s-u>0?s:d+u;t.select("text").attr("y",f).raise()}(t,E,a,r,S);var C=b,T=C.tooltipHandler,w=C.resetHighlight;t.on("tooltip",T).on("mouseout",function(){w(),r.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},r.hideTooltip(!1)})}(t.trendSVGs[E],m,e.metricId,t,f,h,p,v)}}(t,a,o,l),e=e||a.trendChartData.length>1&&a.primaryValue.formatted.length!==a.trendChartData.at(-2).formatted.length||!i&&function(t,e){var n,r,i,a,o,l,c=e.properties,u=e.truncatedLabels,s=e.isSecondaryLabelUpdated,d=e.components,f=c.trendIndicatorValueType,h=y.TREND_INDICATOR_VALUE_TYPE.NUMERIC,p=null===(n=t.secondaryValue)||void 0===n?void 0:n.value,m=f===h?null===(r=t.previousIndicator)||void 0===r?void 0:r.numericValue:null===(i=t.previousIndicator)||void 0===i?void 0:i.percentValue,v=f===h?null===(a=t.indicator)||void 0===a?void 0:a.numericValue:null===(o=t.indicator)||void 0===o?void 0:o.percentValue;return p&&(null===(l=t.previousSecondaryValue)||void 0===l?void 0:l.length)!==(null==p?void 0:p.length)||p&&s||(null==m?void 0:m.length)!==v.length||0===u.length||u.length!==d.cardSecondaryValues.length}(a,t)),a.isCardOld&&t.cardComponentReferences[l].cardComponent.classList.add("card--old-card")}),t.truncatedLabels.length>0&&t.truncatedLabels.length!==t.components.cardSecondaryValues.length&&(t.isSecondaryLabelUpdated=!0),e&&jo(t.properties,t),function(t){var e=t.parsedData,n=t.truncatedLabels,r=t.isBreakByAttributeAdded,i=t.updatedCategory,a=t.components;e.forEach(function(e,o){if(t.isComparisonMetricAdded&&(e.secondaryValue.value+=""),!(0===n.length||r&&e.breakByAttributeName!==i)){var l,c=null!==(l=e.secondaryValueComponentIndex)&&void 0!==l?l:o;a.cardSecondaryValues[c].textContent="".concat(n[c]).concat(e.secondaryValue.value)}})}(t)};function $o(t,e,n,r,i){var a=t.isComparisonMetricAdded,o=t.isTrendAttributeAdded,l=t.isBreakByAttributeAdded,c=t.isComparisonKPI,u=t.updatedCategory,s=t.metricFormattingRules,d=!o&&c?e.at(-1).v:function(t,e,n,r,i){var a=t.isComparisonMetricAdded,o=t.timeFilter,l=t.properties.secondaryMetricName,c=i.trend,u=i.trendChartData,s=i.primaryValue,d=Object.keys(n.metricSelector),f=new Date(r),h=ft(n.headers[0].attributeSelector,n.idValueMapping,d,i.metricId);u.push({raw:s.raw,formatted:s.formatted,graphicModel:h,timestamp:r,timestampDate:f}),!i.isMoreDataThanFilter&&u[0].timestampDate<=o.timeRangeStart&&(i.isMoreDataThanFilter=!0,i.cardSecondaryLabel=l);var p=zo(o,u);return i.trend=function(t,e,n,r){var i=n?Math.min(n.minValue,r):Math.min(r,t[0].raw),a=n?Math.max(n.maxValue,r):Math.max(r,t[0].raw);return{minValue:i=i===a&&i>0?0:i,maxValue:a}}(u,0,c,s.raw),i.trendChartData=p,a?e.at(-1).v:p[0].raw}(t,e,n,r,i);!function(t,e,n){var r=t.primaryValue.raw-e,i=x({partialValue:r,totalValue:e}),a=null!=t&&t.compareMetricId?t.compareMetricId:t.metricId,o={numericValue:tt(r,a,n).formattedValue,percentValue:i,differenceBetweenPrimaryAndSecondary:r};t.previousIndicator=t.indicator,t.indicator=o}(i,d,s),function(t,e,n,r){var i=t.trendChartData,a=n?tt(e,t.compareMetricId,r).formattedValue:i[0].formatted;t.secondaryValue?(t.previousSecondaryValue=t.secondaryValue.value,t.secondaryValue.value=a,t.previousSecondaryLabel=t.secondaryValue.label,t.secondaryValue.label=t.cardSecondaryLabel):t.secondaryValue={value:a,label:t.cardSecondaryLabel}}(i,d,a,s),l&&t.cardDetails.forEach(function(t){t.breakByAttributeName===u&&(t.cardSecondaryLabel=i.cardSecondaryLabel)})}function zo(t,e){var n;if(e[0].timestampDate>t.timeRangeStart)return e;t.isMoreDataThanFilter=!0;var r=null!==(n=t.firstIndexInFilterRange)&&void 0!==n?n:e.findIndex(function(e){return e.timestampDate>t.timeRangeStart});return e.slice(r)}function Wo(t,e){var n={breakByAttributeName:t.breakByAttributeName,cardSecondaryLabel:t.cardSecondaryLabel,firstTimestamp:t.trendChartData[0],trend:{}};return n.trend[t.metricId]=t.trend,n.isCardOld=!!e&&t.isCardOld,n.lastUpdateTimestamp=e?t.lastUpdateTimestamp:null,n}function Xo(t,e,n,r,i,a){0===e.length?function(t,e,n,r){t.forEach(function(t){if(r.find(function(e){return e.breakByAttributeName===t.breakByAttributeName}))r.forEach(function(e){e.breakByAttributeName===t.breakByAttributeName&&(e.trend[t.metricId]=t.trend)});else{var i;t.isCardOld=t.trendChartData.at(-1).timestampDate<n.timeRangeStart;var a=null!==(i=t.lastUpdateTimestamp)&&void 0!==i?i:e.at(-1).timestampDateFormat;t.lastUpdateTimestamp=t.isCardOld?a:null;var o=Wo(t,!0);r.push(o)}})}(t,r,n,e):function(t,e,n,r){var i=r.axisScale;t.forEach(function(a){var o=e.find(function(t){return t.breakByAttributeName===a.breakByAttributeName});if(o){var l;null!=a&&a.cardSecondaryLabel&&(a.cardSecondaryLabel=n?r.secondaryMetricName:o.cardSecondaryLabel,null!=a&&null!==(l=a.secondaryValue)&&void 0!==l&&l.label&&(a.secondaryValue.label=a.cardSecondaryLabel)),a.isCardOld=o.isCardOld,a.lastUpdateTimestamp=o.lastUpdateTimestamp,function(t,e,n,r){if(t===y.AXIS_SCALE.GLOBAL)n.trend=e.trend[n.metricId];else{var i=t===y.AXIS_SCALE.SYNCED_ALL?r:r.filter(function(t){return t.metricId===n.metricId}),a=Math.min.apply(Math,Yo(i.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),o=Math.max.apply(Math,Yo(i.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})));n.trend={minValue:a,maxValue:o}}}(i,o,a,t)}else{var c=Wo(a,!1);e.push(c)}})}(t,e,a,i)}function qo(t){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(t)}function Zo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Jo(t,e,n){return(e=function(t){var e=function(t){if("object"!=qo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qo(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={});var Qo,tl,el,nl=mstrmojo,rl=nl.DEFAULT_CONTEXT_MENU,il=nl.CUSTOM_CONTEXT_MENU,al=function(t){return[".card__label",".card__primary-value",".card__trend-indicator",".card__secondary-value",".card__reference-line-label"].map(function(e){return ol(t,e)}).filter(function(t){return!!t}).join("\t")},ol=function(t,e){var n=t.querySelector(e);return n&&(n.title||n.getAttribute("title")||n.textContent)};mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.plugins.MultiMetricKPI||(mstrmojo.plugins.MultiMetricKPI={}),mstrmojo.descriptors["KPI.1"]||mstrmojo.requiresDescsWPrefix("KPI.",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42),mstrmojo.requiresCls("mstrmojo.num","mstrmojo.CustomVisBase","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming"),mstrmojo.plugins.MultiMetricKPI.MultiMetricKPI=mstrmojo.declare(mstrmojo.CustomVisBase,[mstrmojo.ui._HasScroller,mstrmojo._SupportRealtimeStreaming],{scriptClass:"mstrmojo.plugins.MultiMetricKPI.MultiMetricKPI",cssClass:"MultiMetricKPI",errorMessage:mstrmojo.descP("KPI.","7","Either there is not enough data to display the visualization or the visualization configuration is incomplete."),errorDetails:(el=mstrmojo.descP("KPI.","8","Add 2 or more #metrics####"),el.replace(/####/g,"</span>").replace("#",'<span class="ghost-vis-txt-metric">')),useRichTooltip:!1,reuseDOMNode:!1,draggable:!0,supportNEE:!0,supportPagination:!0,isIOS:mstrApp.isDisplayOnMobile,isAndroid:/(android)/i.test(navigator.userAgent),isMobile:mstrApp.isDisplayOnMobile||/(android)/i.test(navigator.userAgent),isInChatbot:null===(Qo=(tl=mstrApp).isInAIBotOrAutoAnswer)||void 0===Qo?void 0:Qo.call(tl),isWSLocalMode:mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode(),isConsumption:!1,labelsEditState:{},components:{},componentsUnifiedFontSizesInPt:null,graphicModels:[],contextMenuCardsGraphicModels:[],selectedCardsGraphicModels:[],trendSVGs:[],autoPlayEnabled:!1,tooltipInfo:{isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},intervalAutoPlayId:null,KPIType:0,isSingleCardDisplayed:null,isComparisonKPI:!1,animationDuration:0,iterator:0,init:function(t){this._super(t);var e=this,n=window.mstrApp.isExporting;e.animationDuration=n?0:1500,function(t){t.savePropertyAndUpdateWidgetAsync=Vo}(e);var r,i=(r={},Object.values(g).forEach(function(t){var e=t.name,n=t.defaultValue;r[e]=n}),W({},I,JSON.stringify(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach(function(e){W(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},r))));e.setDefaultPropertyValues(i),e.selectedCardsGraphicModels=[],e.contextMenuCardsGraphicModels=[]},destroy:function(t){this.isWSLocalMode||function(t){var e,n,r,i,a,o;if(null!==(e=mstrApp)&&void 0!==e&&null!==(n=e.rootCtrl)&&void 0!==n&&null!==(r=n.docCtrl)&&void 0!==r&&null!==(i=r.model)&&void 0!==i&&i.bs&&null!==(a=t.model)&&void 0!==a&&a.data&&!t.isWSLocalMode&&!t.isConsumption){var l=t.dataInterface.data.gsi.mx.map(function(e){var n;return null!==(n=e.wdgstrs)&&void 0!==n&&n[u]?{act:d,nodeKey:t.k,skey:u,objectId:e.did,objectType:4}:null}).filter(function(t){return t});(null===(o=t.model.data.wdgstrs)||void 0===o?void 0:o[s])&&l.push({act:d,nodeKey:t.k,skey:s}),l.length&&function(t,e){var n={taskId:"mojoRWManipulation",params:JSON.stringify({actions:e,style:{params:{treesToRender:2},name:"RWIVEMojoStyle"}}),nodeKey:t.k,suppressData:!0,messageId:mstrApp.getMsgID(),styleName:"RWIVEMojoStyle",rwb:mstrApp.rootCtrl.docCtrl.model.bs};mstrApp.serverRequest(n)}(t,l)}}(this),this._super(t)},onmousemove:function(t){var e=this,n=e.tooltipInfo,r={x:t.e.pageX,y:t.e.pageY},i={graphicModel:void 0};if(Lr(t.getTarget().parentNode).dispatch("tooltip",{detail:{evt:t,returnObject:i}}),i.graphicModel){if(n.isPositionFixed&&e.tooltipWin.isVisible())return;e.tooltipInfo={isVisible:!0,isPositionFixed:!1,position:r,graphicModel:i.graphicModel},this.showTooltip(i.graphicModel,r)}else e.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},this.hideTooltip(!1)},oncontextmenu:function(t){var e=t.e.target;"container"!==e.className&&function(t,e,n){var r=n.closest(".card"),i=n.closest(".card__trend-graph"),a=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===r.id}),o=e.selectedCardsGraphicModels,l=e.contextMenuCardsGraphicModels;if(Na(e,o),null==l||l.forEach(function(t){var e=Ta(t);null==e||e.classList.remove("card--selected-context-menu")}),e.isIOS&&e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")}),e.isMobile&&i){e.contextMenuCardsGraphicModels=[];var c={graphicModel:void 0};Lr(i.querySelector("svg")).dispatch("tooltip",{detail:{evt:t,returnObject:c}}),e.handleContextMenuSelection(t,c.graphicModel)}else if(r.classList.contains("card--selected")&&o.length>1){e.clearSelections();var u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zo(Object(n),!0).forEach(function(e){Jo(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zo(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t);u.ctrlKey=!0,u.metaKey=!0;var s=[];o.forEach(function(t){e.handleSelection(u,t),s.push(t)}),e.contextMenuCardsGraphicModels=s,e.handleContextMenuSelection(t,a)}else e.clearSelections(),e.contextMenuCardsGraphicModels=[a],e.handleContextMenuSelection(t,a);e.contextMenuCardsGraphicModels.forEach(function(t){Ta(t).classList.add("card--selected-context-menu")})}(t,this,e)},getContextMenuConfig:function(){var t=function(t){if(0===t.contextMenuCardsGraphicModels.length)return{commonConfig:[],customConfig:[]};var e=o(t.KPIType);return{commonConfig:N(t,e.BREAK_BY)?[{type:rl.CHANGE_VISUALIZATION},{type:rl.COPY_PASTE_FORMAT},{type:rl.KEEP_ONLY},{type:rl.EXCLUDE},{type:rl.DRILL},{type:rl.GROUP},{type:rl.CALCULATION},{type:rl.SHOW_DATA},{type:rl.GO_TO_TARGETS}]:[{type:rl.CHANGE_VISUALIZATION},{type:rl.COPY_PASTE_FORMAT}],customConfig:[t.isMobile?{}:{type:il.NORMAL,name:mstrmojo.descP("KPI.","12","Copy Text"),onClick:function(){!function(t){var e=t.map(function(t){return al(t)}).join("\n"),n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}(t.contextMenuCardsGraphicModels.map(function(t){return Ta(t)}))}}]}}(this);return{common:t.commonConfig,custom:t.customConfig}},getGraphicModelsBySelector:function(t,e){var n=this,r=[],i={attribute:mstrmojo.customviz.PICKED_TYPE.BOTH,metric:mstrmojo.customviz.PICKED_TYPE.BOTH},a=function(t){mstrmojo.array.forEach(n.getGraphicModels(),function(a){a.getSelector()&&n.canPickGraphicModel(t,e,a,i)&&r.push(a)})};return t.length>1?t.forEach(a):a(t),0===r.length&&(function(t,e){e.getGraphicModels().forEach(function(t){var e=Ta(t);e&&wa(e)})}(0,this),n.selectedCardsGraphicModels=[],n.contextMenuCardsGraphicModels=[]),r},updateHighlight:function(){var t=this,e=this,n=[];e.getGraphicModels().forEach(function(e){t.graphicNeedsHighlight(e,!1)&&n.push(e)}),e.contextMenuCardsGraphicModels.length||Na(e,n)},resetComponents:function(){this.components={cardLabels:[],cardPrimaryValues:[],cardBodies:[],cardSecondaryValues:[],cardSecondaryValueWithIndicatorWrappers:[],cardIndicators:[]}},clearDomNode:function(){this.domNode.innerHTML=""},addMojoScrollbar:function(){var t=this,e=t.domNode;t.containerNode=e.firstChild.firstChild,t.scrollNode=e.firstChild,t.isIOS?t.scrollbarHostNode=e.firstChild:t.scrollbarHostNode=e,t.scrollBarNodes={};var n=t.domNode.style,r=n.height,i=n.width;t.scrollNode.style.maxHeight=r,t.containerNode.style.maxHeight=r,t.containerNode.style.width=i,t.updateScrollbars(),t.addScrollNodeProperties()},rerenderVisualization:function(t,e){var n=this;!function(t,e,n){var r=t.isComparisonMetricAdded,i=t.isTrendAttributeAdded,a=t.isBreakByAttributeAdded,o=t.isComparisonKPI,l=t.updatedCategory,c=t.metricFormattingRules,u=t.data.at(-1).cells,s=ut(u,t),d=!(i||o&&r);t.cardDataToUpdate=t.parsedData.find(function(t){return t.breakByAttributeName===l}),t.parsedData.forEach(function(r){if(!a||r.breakByAttributeName===l){var i=r.trendChartData,o=e[t.mappedIndexes[r.metricId]].v,f=tt(o,r.metricId,c).formattedValue;r.primaryValue.raw=o,r.primaryValue.formatted=f,d?i.push({raw:o,formatted:f}):$o(t,u,s,n,r)}})}(n,t,e),function(t){var e=t.isComparisonMetricAdded,n=t.isBreakByAttributeAdded,r=t.components,i=t.cardDataToUpdate,a=t.data,o=t.updatedCategory,l=t.properties,c=!e&&(!r.cardSecondaryValues[0]&&1!==a.length||n&&void 0===i.secondaryValueComponentIndex),u=e&&(!n&&2===a.length&&void 0===t.parsedData[0].trendComponentIndex||n&&void 0===i.trendComponentIndex);(c||u)&&t.parsedData.forEach(function(n,r){var i=null==n||!n.breakByAttributeName||n.breakByAttributeName===o;$a(n,t,l,r,!e&&i,i)})}(n),Go(n)},checkTimeFilter:function(){var t=this;t.updateFrequency=t.getRealtimeUpdateFrequency();var e=t.getRealtimeFilterInfo();if(t.timeFilter={},e){var n,r,i=e.curre,a=e.lastt,o=e.lastti,l=e.timef;if(t.timeFilter.typeOfTimeFilter=l,1===l)n=1===o?a:60*a;else{switch(i){case 1..KEY:n=1..TIME_IN_SECONDS;break;case 2..KEY:n=2..TIME_IN_SECONDS;break;case 3..KEY:n=3..TIME_IN_SECONDS;break;default:n=4..TIME_IN_SECONDS}t.timeFilter.currentSelection=i}r=n<=60?"".concat(n).concat("s"):n<=3600?"".concat(n/60).concat("mins"):n<=86400?"".concat(n/3600).concat("h"):"".concat(n/86400).concat("day"),t.timeFilter.filterTimeInSeconds=n,t.timeFilter.filterLabel=r}else{t.timeFilter={typeOfTimeFilter:1,filterTimeInSeconds:7200,filterLabel:"".concat(7200).concat("s")}}},updateTimeFilterRanges:function(t){var e=this.timeFilter,n="string"==typeof t?new Date(t):t;1===e.typeOfTimeFilter?e.timeRangeStart=new Date(n-e.filterTimeInSeconds*Ho[Fo]):2===e.typeOfTimeFilter&&(e.timeRangeStart=function(t,e){var n,r={year:(n=t).getFullYear(),month:n.getMonth(),day:n.getDate(),hour:n.getHours(),minute:n.getMinutes()},i=r.year,a=r.month,o=r.day,l=r.hour,c=r.minute;switch(e){case 1..KEY:return c<15?new Date(i,a,o,l,0):c<30?new Date(i,a,o,l,15):c<45?new Date(i,a,o,l,30):new Date(i,a,o,l,45);case 2..KEY:return c<30?new Date(i,a,o,l,0):new Date(i,a,o,l,30);case 3..KEY:return new Date(i,a,o,l,0);default:return new Date(i,a,o,0)}}(n,e.currentSelection))},applyFilterOnTrendData:zo,plot:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this,i=r.isRealtimeStreamingEnabled&&r.isRealtimeStreamingEnabled();if(r.isConsumption=!(null!==(t=(e=mstrApp).supportFeature)&&void 0!==t&&t.call(e,"show-react-dossier-format")),!i&&function(t){var e=o(t.KPIType);return!(!N(t,e.BREAK_BY)||!t.dataInterface.data.gsi.mx.length)&&(0===t.KPIType?t.dataInterface.data.gts.row[0].es.length*t.dataInterface.data.gsi.mx.length:t.dataInterface.data.gts.row[0].es.length)>500}(r)){var a,c=(null===(a=r.dataInterface.data.gts.row[0])||void 0===a?void 0:a.n)||"";throw new Error(mstrmojo.descP("KPI.","49","The attribute ## has too many elements. Please filter the data to display the KPIs.").replace("##",c))}for(var u=Q(r.model.data.nf),s=!1,d=0;d<r.model.data.nf.length&&!s&&r.formattingModel;d++){var f;s=r.model.data.nf[d].id!==(null===(f=r.formattingModel.model[d])||void 0===f?void 0:f.id)||r.model.data.nf[d].nfs!==r.formattingModel.model[d].nfs}r.metricFormattingRules=u,r.formattingModel={model:r.model.data.nf,didMetricFormattingRuleChange:s},r.trendSVGs=[],r.shouldFontBeChanged=[],r.cardIds=[],r.graphicModels=[],r.truncatedLabels=[],r.isRealTime=i,r.isComparisonMetricAdded=Y(r);var h=o(r.KPIType);if(i&&(r.isBreakByAttributeAdded=N(r,h.BREAK_BY),r.isTrendAttributeAdded=N(r,h.TREND),function(t){var e,n,r=t.isBreakByAttributeAdded;r&&(n=0),t.isTrendAttributeAdded&&(e=r?1:0),t.timestampIndex=e,t.breakByIndex=n}(r)),!i||r.data&&r.data.length){r.currentInterval&&clearInterval(r.currentInterval);var p=function(){var t=function(t){var e=o(t.KPIType),n=!N(t,e.METRICS),r=mstrApp.isDisplayOnMobile||mstrApp.isDossier||/(android)/i.test(navigator.userAgent),i=!window.mstrApp.isExporting&&!r&&!window.mstrApp.features["show-react-dossier-format"],a=t.isComparisonKPI;if(i)throw t.errorMessage=a?mstrmojo.descP("KPI.","11","Comparison KPI is supported only on environments 11.3.1 or higher"):mstrmojo.descP("KPI.","10","Multi-Metric KPI is supported only on environments 11.3.1 or higher"),t.errorDetails="",new Error("No react-format-panel");if(n){var l=document.createElement("div");l.classList.add("warning-container");var c=document.createElement("div");c.classList.add("icon"),c.style.backgroundPosition=a?"0 -90px":"0 0";var u=t.domNode,s=u.clientWidth,d=u.clientHeight;(s<640||d<600)&&(c.style.width="60px",c.style.height="60px",c.style.backgroundPosition=a?"-90px -90px":"-90px 0"),l.appendChild(c);var f=document.createElement("div");f.classList.add("title");var h=document.createTextNode(a?mstrmojo.descP("KPI.","41","Comparison KPI"):mstrmojo.descP("KPI.","40","Multi-Metric KPI"));f.appendChild(h),l.appendChild(f);var p=document.createElement("div");p.classList.add("description"),p.innerHTML=a?mstrmojo.descP("KPI.","9","Add 2 #metrics####").replace("####","").replace("#","<svg class='metric-icon'></svg>"):mstrmojo.descP("KPI.","8","Add 2 or more #metrics####").replace("####","").replace("#","<svg class='metric-icon'></svg>"),l.appendChild(p),t.domNode.appendChild(l)}return i||n}(r);if(t)r.raiseEvent({name:"renderFinished",id:r.k});else{var e,i=r.intervalAutoPlayId;if(i&&clearInterval(i),r.addUseAsFilterMenuItem(),n)e=G(n,r);else{var a=JSON.parse(r.getProperty(I));e=G(a,r)}r.properties=e;var c=function(){var t,n,i=function(t,e){var n=t.model.data.nf,r=Q(n,!0),i=n.map(function(t){return t.id}),a={};return i.forEach(function(t){var n=e[t]||{},i=n.value,o=n.font;if(i&&!isNaN(i)){var l=tt(i,t,r).formattedValue;a[t]=e[t],a[t].formattedValue=l,a[t].font={fontColor:o.color,fontSize:o.size,fontFamily:o.fontFamily,fontStyle:o.style}}}),a}(r,e.createdReferenceLines);r.resetComponents(),r.trendSVGs=[],r.clearDomNode(),function(){var t=r.isRealTime,n=r.isBreakByAttributeAdded,a=r.isComparisonMetricAdded,c=r.cardsOrder,u=r.breakByIndex,s=r.timeFilter,d=r.data,f=t?d:function(t){var e=mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT.ROWS_ADV;return t.dataInterface.getRawData(e,{hasSelection:!0,hasTitleName:!0,minAttribute:0})}(r);t&&n&&c&&f.sort(function(t,e){return c.findIndex(function(e){return e===t.cells[u].v})-c.findIndex(function(t){return t===e.cells[u].v})});var h,p=function(t,e,n,r){var i,a,c=o(e.KPIType),u=function(t,e){var n=Q(e.model.data.nf);return t.forEach(function(t){t.forEach(function(t){var e=t.trendChartData[t.trendChartData.length-1].raw,r=t.trendChartData[t.trendChartData.length-1].formatted,i=tt(e,t.metricId,n).color;t.primaryValue={raw:e,formatted:r,color:i}})}),t}(ct(t,e,c),e),s=(i=function(t,e,n,r){if(!N(e,r.TREND))return[t];var i={min:null,max:null},a=e.isComparisonKPI,o=e.isRealTime,l=n.axisScale,c=n.axisScaleComparison;return a&&(l=c),t.forEach(function(t){var e=null,n=null,r=t.map(function(t){return t.trendChartData.map(function(t){return t.raw})});if(l!==y.AXIS_SCALE.GLOBAL){var a=r.flat();n=a.reduce(function(t,e){return Math.min(t,e)},0),e=a.reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),i.min=Math.min(0,i.min,n),i.max=Math.max(i.max,e)}t.forEach(function(t,i){if(t.trendChartData.length<=1)t.trend=null;else{var a,l=r[i].reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),c=null!==(a=e)&&void 0!==a?a:l,u=function(t,e,n,r,i){if(null!==r)return r;var a=e[n],o=t?a.reduce(function(t,e){return Math.min(t,e)},Number.POSITIVE_INFINITY):a.reduce(function(t,e){return Math.min(t,e)},0);return o>=0&&o===i?0:o}(o,r,i,n,c);t.trend={minValue:u,maxValue:c}}})}),[t,i]}(u,e,n,c),a=2,function(t){if(Array.isArray(t))return t}(i)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(i,a)||ot(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=s[0],f=s[1],h=function(t,e,n,r){var i=e.isComparisonKPI,a=e.isRealTime,o=e.isBreakByAttributeAdded,c=e.timeFilter,u=n.secondaryMetricName,s=N(e,r.TREND);e.isTrendAttributeAdded=s;var d=0===e.KPIType,f=i?N(e,r.COMPARE_WITH):null,h=N(e,r.METRICS)&&f;if(d&&!s||i&&!h&&!s)return t;var p=Q(e.model.data.nf);return e.metricFormattingRules=p,e.metricId=t[0][0].metricId,t.forEach(function(t){t.forEach(function(t){if(a&&(t.cardSecondaryLabel=function(t,e,n,r,i){if(t<=e.timeRangeStart||n||!r&&e.isMoreDataThanFilter)return i;var a=t.toTimeString().split(" ").shift();return"Compare to ".concat(a)}(t.trendChartData[0].timestampDate,c,h,o,u)),null!==t.trend||h){var e,n,r,i={label:a?t.cardSecondaryLabel:u};r=a?0:t.trendChartData.length-2,h?(i.value=t.compareMetricValue.formatted,e=t.compareMetricValue.raw,n=t.compareMetricId):(i.value=t.trendChartData[r].formatted,e=t.trendChartData[r].raw,n=t.metricId);var s=t.primaryValue.raw-e,d=y.TREND_INDICATOR_VALUE_TYPE,f=tt(s,n,p).formattedValue,m=at(at(at({},d.NUMERIC,f),d.PERCENT,[0,""].includes(e)?l:x({partialValue:s,totalValue:e})),"differenceBetweenPrimaryAndSecondary",s);t.secondaryValue=i,t.indicator=m}else t.secondaryValue=null,t.indicator=null})}),t}(d,e,n,c).flat(),p=function(t,e,n,r){var i=n.axisScale,a=n.axisScaleComparison;return r.isComparisonKPI&&(i=a),i===y.AXIS_SCALE.SYNCED_ALL?t.map(function(t){return t.trend={minValue:e.min,maxValue:e.max},t}):t}(dt(h,n,e.isTrendAttributeAdded),f,n,e);return function(t,e){return t.map(function(t){return t.referenceLine=e[t.metricId],t})}(p,r)}(f,r,e,i);p.forEach(function(t){r.graphicModels.push(t.graphicModel)}),t&&n&&(r.cardDetails=null!==(h=r.cardDetails)&&void 0!==h?h:[],Xo(p,r.cardDetails,s,d,e,a)),r.isSingleCardDisplayed=1===p.length||e.layoutType===y.LAYOUT_TYPES.STACKED,function(t,e){var n,r=o(t.KPIType),i=null===(n=t.gridData.gsi.sorts)||void 0===n?void 0:n[0],a=!(null==i||!i.length),l=N(t,r.BREAK_BY);if(a&&l&&e[0].graphicModel.getSelector().tid===i[0].key.split("!")[1]){var c={};e.forEach(function(t,e){t in c||(c[t.breakByAttributeName]=e)}),e.sort(function(t,e){return c[t.breakByAttributeName]-c[e.breakByAttributeName]})}}(r,p),r.parsedData=p}();var a=r.domNode,c=r.parsedData,u=r.isMobile,s=r.isInChatbot,d=a.appendChild(Et({},!1));d.appendChild(yo(r,c,e)),r.visualizationNode=d;var f=d.appendChild(document.createElement("div"));f.classList.add("font-size-measure-div"),jo(e,r),f.remove(),e.layoutType===y.LAYOUT_TYPES.GRID&&r.addMojoScrollbar(),u||s||e.layoutType===y.LAYOUT_TYPES.STACKED||function(t){var e,n,r,i,a=t.domNode,l=a.clientWidth,c=a.clientHeight,u=Lr(a),s=u.append("div").attr("class","selection-tool").style("visibility","hidden");u.call(function(){var t,e,n,r,i=Yr,a=Ur,o=Gr,l=$r,c={},u=ke("start","drag","end"),s=0,d=0;function f(t){t.on("mousedown.drag",h).filter(l).on("touchstart.drag",y).on("touchmove.drag",v,Vr).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(o,l){if(!r&&i.call(this,o,l)){var c=b(this,a.call(this,o,l),o,l,"mouse");c&&(Lr(o.view).on("mousemove.drag",p,Fr).on("mouseup.drag",m,Fr),function(t){var e=t.document.documentElement,n=Lr(t).on("dragstart.drag",Br,Fr);"onselectstart"in e?n.on("selectstart.drag",Br,Fr):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(o.view),kr(o),n=!1,t=o.clientX,e=o.clientY,c("start",o))}}function p(r){if(Br(r),!n){var i=r.clientX-t,a=r.clientY-e;n=i*i+a*a>d}c.mouse("drag",r)}function m(t){Lr(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,r=Lr(t).on("dragstart.drag",null);e&&(r.on("click.drag",Br,Fr),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),Br(t),c.mouse("end",t)}function y(t,e){if(i.call(this,t,e)){var n,r,o=t.changedTouches,l=a.call(this,t,e),c=o.length;for(n=0;n<c;++n)(r=b(this,l,t,e,o[n].identifier,o[n]))&&(kr(t),r("start",t,o[n]))}}function v(t){var e,n,r=t.changedTouches,i=r.length;for(e=0;e<i;++e)(n=c[r[e].identifier])&&(Br(t),n("drag",t,r[e]))}function g(t){var e,n,i=t.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<a;++e)(n=c[i[e].identifier])&&(kr(t),n("end",t,i[e]))}function b(t,e,n,r,i,a){var l,d,h,p=u.copy(),m=jr(a||n,e);if(null!=(h=o.call(t,new Hr("beforestart",{sourceEvent:n,target:f,identifier:i,active:s,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),r)))return l=h.x-m[0]||0,d=h.y-m[1]||0,function n(a,o,u){var y,v=m;switch(a){case"start":c[i]=n,y=s++;break;case"end":delete c[i],--s;case"drag":m=jr(u||o,e),y=s}p.call(a,t,new Hr(a,{sourceEvent:o,subject:h,target:f,identifier:i,active:y,x:m[0]+l,y:m[1]+d,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:p}),r)}}return f.filter=function(t){return arguments.length?(i="function"==typeof t?t:Kr(!!t),f):i},f.container=function(t){return arguments.length?(a="function"==typeof t?t:Kr(t),f):a},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:Kr(t),f):o},f.touchable=function(t){return arguments.length?(l="function"==typeof t?t:Kr(!!t),f):l},f.on=function(){var t=u.on.apply(u,arguments);return t===u?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f}().on("start",function(o){var l,c,d=t.tooltipInfo;i=o.sourceEvent.target,d.isVisible&&null!==(l=t.model)&&void 0!==l&&null!==(c=l.data)&&void 0!==c&&c.doslinkinfo&&(t.showTooltip(d.graphicModel,d.position,!0),d.isPositionFixed=!0),(r=u.selectAll("article")).each(function(t,e,n){n[e].style.pointerEvents="none"}),e=a.scrollTop;var f={y:o.y,x:o.x};n=f,s.style("visibility","visible").style("left","".concat(n.x,"px")).style("top","".concat(n.y+e,"px")).style("width","0px").style("height","0px")}).on("drag",function(t){var r={y:t.y,x:t.x},i=l-n.x-2,a=c-n.y-2,o=r.x-n.x,u=r.y-n.y;o<0&&(s.style("left","".concat(Math.max(0,r.x),"px")),i=n.x),u<0&&(s.style("top","".concat(Math.max(0,r.y+e),"px")),a=n.y);var d=Math.min(i,Math.abs(o)),f=Math.min(a,Math.abs(u));s.style("width","".concat(d,"px")).style("height","".concat(f,"px"))}).on("end",function(n){var a={xMin:parseInt(s.style("left")),xMax:parseInt(s.style("left"))+parseInt(s.style("width")),yMin:parseInt(s.style("top")),yMax:parseInt(s.style("top"))+parseInt(s.style("height"))};s.style("visibility","hidden");var l=function(t,e,n,r){var i=n.xMin,a=n.xMax,o=n.yMin,l=n.yMax,c=t.node().getBoundingClientRect(),u=c.x,s=c.y,d=[];return e.each(function(t,e,n){var c=n[e],f=c.getBoundingClientRect(),h=f.x,p=f.y,m=f.width,y=f.height,v=h-u,g=p-s+r;!(i>v+m||a<v||l<g||o>g+y)&&d.push(c)}),d}(u,r,a,e);(function(t,e,n,r){var i=!!e.contextMenuCardsGraphicModels.length;if(xa(e),n.length>1){e.selectedCardsGraphicModels=n.map(function(t){return e.getGraphicModels().find(function(e){return mstrmojo.string.encodeHtmlString(e.cardId)===t.id})}),e.clearSelections(),Na(e);var a=o(e.KPIType),l=N(e,a.TREND),c=N(e,a.BREAK_BY);(l||c)&&e.applySelection(e.selectedCardsGraphicModels.map(function(t){return t.getSelector()}))}else if(1===n.length){var u=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===n[0].id});Sa(t,e,u,r)}else i||(e.selectedCardsGraphicModels=[],e.clearSelections(),Na(e),e.handleSelection(t))})(n,t,l,i),r.each(function(t,e,n){n[e].style.pointerEvents="auto"})}).filter(function(t){return!("mstrmojo-scrollbar vertical"===t.target.className||2===t.button)}))}(r),r.animationDuration=0,e.stackedAutoPlay?r.autoPlayEnabled=!0:r.autoPlayEnabled=!1;var h=null===(t=r.getSelectionCache)||void 0===t||null===(n=t.call(r))||void 0===n?void 0:n._viSelections;h&&r.highlight("att",h,!0),r.raiseEvent({name:"renderFinished",id:r.k})};!function(t,e,n,r){var i=[t.allFontOptions,t.labelFontOptions,t.primaryValueFontOptions,t.secondaryValueFontOptions,t.indicatorFontOptions].map(function(t){return{name:t.fontFamily,isItalic:t.fontStyle[1],isBold:t.fontStyle[0]}}).reduce(function(t,e){return t.find(function(t){return t.name===e.name&&t.isItalic===e.isItalic&&t.isBold===e.isBold})?t:t.concat([e])},[]);mstrmojo.util.FontLoader.load(e.id,i,{success:n,failure:r})&&n()}(e,r,c,c)}},m="".concat(r.cssClass,"stylesheet");if(mstrApp.isWorkstation&&!Yo(document.styleSheets).some(function(t){var e;return null===(e=t.href)||void 0===e?void 0:e.includes(r.cssClass)})){var v=document.getElementById(m);if(v){var g=v.onload;v.onload=function(){g(),p()}}else{var b=document.head,_=document.createElement("link");_.type="text/css",_.onload=p,_.id=m,_.rel="stylesheet",_.href="../plugins/".concat(r.cssClass,"/style/global.css"),b.appendChild(_)}}else p()}},renderRealtimeData:function(t){var e,n=this,r=n.timestampIndex,i=n.breakByIndex,a=n.isBreakByAttributeAdded,o=n.isTrendAttributeAdded;n.cardsOrder=null!==(e=n.cardsOrder)&&void 0!==e?e:[],a&&!n.cardsOrder.find(function(e){return e===t[0].cells[i].v})&&n.cardsOrder.push(t[0].cells[i].v),o&&(t[0].cells[r].v=t[0].cells[r].v.replace("T"," ").slice(0,-1),t[0].timestampDateFormat=new Date(t[0].cells[r].v)),n.data?n.data.push(t[0]):n.data=t,0===n.parsedData.length?(this.checkTimeFilter(),o&&(this.updateTimeFilterRanges(t[0].cells[r].v),this.timeFilter.isMoreDataThanFilter=!1),this.plot()):this.updateCardsAndRenderVisualization(t)},onRealtimeTopicChanged:function(){this.data=[],this.rawData=[],this.parsedData=[],this.trendSVGs=[]},updateCardsAndRenderVisualization:function(t){var e,n=this,r=n.isBreakByAttributeAdded,i=n.timestampIndex,a=n.breakByIndex,o=n.isTrendAttributeAdded;n.updatedCategory=r?t[0].cells[a].v:null,o?(e=t[0].cells[i].v,n.updateTimeFilterRanges(e),n.data=function(t){var e,n,r=t.timeFilter,i=t.data,a=t.breakByIndex,o=t.updatedCategory,l=t.isBreakByAttributeAdded,c=t.isComparisonMetricAdded;if(!l||c){var u=i.findIndex(function(t){return t.timestampDateFormat>r.timeRangeStart});e=i.slice(u),r.firstIndexInFilterRange=u}else e=i.filter(function(t){return t.cells[a].v!==o||t.timestampDateFormat>r.timeRangeStart});return!r.isMoreDataThanFilter&&i[0].timestampDateFormat<=r.timeRangeStart&&(r.isMoreDataThanFilter=!0,null!==(n=t.properties)&&void 0!==n&&n.secondaryMetricName&&function(t){var e=t.timeFilter,n=t.properties,r=t.components;if(2===e.typeOfTimeFilter){var i="Since ".concat(e.timeRangeStart.toLocaleTimeString());n.secondaryMetricName=i,r.cardSecondaryValues.forEach(function(t){t.secondaryValueData.labelTitle=i})}else{var a=G({secondaryMetricName:""},t);n.secondaryMetricName=a.secondaryMetricName}}(t)),e}(n)):e=t[0].timestamp;var l=n.parsedData.map(function(t){return t.breakByAttributeName}).filter(function(t){return t}),c=!!r&&function(t,e){var n=e.updateFrequency,r=e.updatedCategory,i=e.timeFilter,a=e.parsedData,o=new Date(t-n*Ho[Fo]),l=a.filter(function(t){var e=t.isCardOld&&t.breakByAttributeName!==r&&t.lastUpdateTimestamp<o,n=t.breakByAttributeName===r&&t.trendChartData.at(-1).timestampDate<=i.timeRangeStart;return e||n}),c=l.length>0;return c&&function(t,e){t.forEach(function(t){e.cardsOrder=t.breakByAttributeName!==e.updatedCategory?e.cardsOrder.filter(function(e){return e!==t.breakByAttributeName}):e.cardsOrder,e.data=e.data.filter(function(n){return n.cells[e.breakByIndex].v!==t.breakByAttributeName||n.cells[e.breakByIndex].v===e.updatedCategory}),e.cardDetails=e.cardDetails.filter(function(e){return e.breakByAttributeName!==t.breakByAttributeName})})}(l,e),function(t,e){var n=e.updatedCategory,r=e.timeFilter,i=e.parsedData,a=e.cardDetails;i.forEach(function(e){var i;e.isCardOld=e.trendChartData.at(-1).timestampDate<r.timeRangeStart&&e.breakByAttributeName!==n;var o=null!==(i=e.lastUpdateTimestamp)&&void 0!==i?i:t;e.lastUpdateTimestamp=e.isCardOld?o:null,a.forEach(function(t){t.breakByAttributeName===e.breakByAttributeName&&(t.isCardOld=e.isCardOld,t.lastUpdateTimestamp=e.lastUpdateTimestamp)})})}(t,e),c}(t[0].timestampDateFormat,n),u=!r&&1===n.data.length&&n.parsedData[0].trendChartData.length>1;if(c||u||0!==l.length&&t.some(function(t){return!l.includes(t.cells[a].v)}))this.plot();else{var s=n.dataInterface.data.realtimeQueryInfo.columns,d=[];t.forEach(function(t){s.forEach(function(e,n){-1===e.bfid&&d.push(t.cells[n])})}),this.rerenderVisualization(d,e)}}})})();