(()=>{"use strict";mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});const t={LIGHT:{AREA:"AUTO",TREND:"AUTO",TREND_OPACITY:"40",FONT:"#35383A",AREA_FILL_OPACITY:10,IMG_FILL_COLOR:"AUTO",IMG_FILL_OPACITY:100,SECONDARY_VALUE_FONT_COLOR:"#5D5D66"},NIGHT:{AREA:"#313855",TREND:"#539CAE",TREND_OPACITY:"100",FONT:"#FFFFFF"},DESERT:{AREA:"#606060",TREND:"#FFD333",TREND_OPACITY:"100",FONT:"#FFFFFF"},OCEAN:{AREA:"#5181D7",TREND:"#83C8F4",TREND_OPACITY:"100",FONT:"#FFFFFF"}},e={INCREASE:"#83C962",DECREASE:"#DB6657",CONSTANT:"#606060"},n={LIGHT:"#FFFFFF",NIGHT:"#4D4D4D"},r="#CA3D40",a="#A9ADB1";mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var i={METRICS:0,TREND:1},o={METRICS:0,COMPARE_WITH:1,BREAK_BY:2,TREND:3},l=function(t){return 0===t?i:o};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var c="N/A",u="1",s="referenceLineLabel",d="previousValueLabel",f="removeWidgetString";function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach(function(e){y(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function y(t,e,n){return(e=function(t){var e=function(t){if("object"!=h(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var g={TEXT_CONTENT_TYPE:{ALL:"all",LABEL:"label",PRIMARY_VALUE:"primaryValue",SECONDARY_VALUE:"secondaryValue",INDICATOR:"indicator"},TREND_SHAPE:{AREA:"area",BAR:"bar",LINE:"line"},AXIS_SCALE:{GLOBAL:"global",SYNCED_METRIC:"synced",SYNCED_ALL:"syncedAll"},CARD_ALIGNMENT:{LEFT:"left",MIDDLE:"middle",RIGHT:"right"},TREND_INDICATOR_SHAPE:{BADGE:"badge",ARROW:"arrow"},TREND_INDICATOR_VALUE_TYPE:{PERCENT:"percentValue",NUMERIC:"numericValue"},SELECTED_REFERENCE_LINE_SHAPE:{DOTTED_LINE_TYPE:"1pt dotted",DASHED_LINE_TYPE:"1pt dashed",THIN_LINE_TYPE:"1pt solid",THICK_LINE_TYPE:"2pt solid"},REFERENCE_LINE_DEFAULT_VALUES:{font:{fontFamily:"Open Sans",style:[!1,!1,!1,!1],size:9,color:"#35383A"},line:{shape:"1pt dashed",color:"#4D4D4D"}},LAYOUT_TYPES:{GRID:0,STACKED:1,HORIZONTAL:2,VERTICAL:3},TEXT_SIZE_TYPE:{UNIFIED:0,FIT_TO_CONTAINER:1,FIXED:2},FIRST_CARD_INDEX:1},v={fontFamily:"Open Sans",fontStyle:[!1,!1,!1,!1],fontSteps:0,fontSize:""},E={HIDEABLE_SECTION_TEMPLATE:{name:"hideableSectionTemplate",defaultValue:null},CARD_STYLE:{name:"cardStyle",defaultValue:0},HIDEABLE_SECTION_LAYOUT:{name:"hideableSectionLayout",defaultValue:null},LAYOUT_TYPE:{name:"layoutType",defaultValue:g.LAYOUT_TYPES.GRID},GRID_LAYOUT_PROPERTIES:{name:"gridLayoutProperties",defaultValue:null},GRID_COLUMN_COUNT:{name:"gridColumnCount",defaultValue:4},GRID_FIX_CARD_HEIGHT:{name:"gridFixCardHeight",defaultValue:null},GRID_FIX_CARD_HEIGHT_ENABLED:{name:"gridFixCardHeightEnabled",defaultValue:!1},STACKED_LAYOUT_PROPERTIES:{name:"stackedLayoutProperties",defaultValue:null},STACKED_AUTO_PLAY:{name:"stackedAutoPlay",defaultValue:!0},SHOW_METRIC_NAME:{name:"showMetricName",defaultValue:null},SECONDARY_VALUE_LAYOUT:{name:"secondaryValueLayout",defaultValue:null},SECONDARY_METRIC_NAME:{name:"secondaryMetricName",defaultValue:""},TREND_INDICATOR_LAYOUT:{name:"trendIndicatorLayout",defaultValue:null},TREND_INDICATOR_ENABLED:{name:"trendIndicatorEnabled",defaultValue:!0},TREND_INDICATOR_ENABLED_LABEL:{name:"trendIndicatorEnabledLabel",defaultValue:""},COMPARISON_INDICATOR_ENABLED:{name:"comparisonIndicatorEnabled",defaultValue:!0},COMPARISON_INDICATOR_ENABLED_LABEL:{name:"comparisonIndicatorEnabledLabel",defaultValue:""},TREND_INDICATOR_VALUE_TYPE:{name:"trendIndicatorValueType",defaultValue:g.TREND_INDICATOR_VALUE_TYPE.PERCENT},ENTIRE_CHART_SECTION:{name:"entireKPIChartSection",defaultValue:null},TEXT_SIZE_TYPE:{name:"textSizeType",defaultValue:g.TEXT_SIZE_TYPE.UNIFIED},SHAPE_SECTION:{name:"shapeSection",defaultValue:null},SHAPE_TYPE:{name:"shapeType",defaultValue:0},SHAPE_TYPE_COMPARISON:{name:"shapeTypeComparison",defaultValue:0},SHAPE_TYPE_COMPARISON_NO_TREND:{name:"shapeTypeComparisonNoTrend",defaultValue:0},BACKGROUND_SHAPE_AREA_SECTION:{name:"backgroundShapeAreaSection",defaultValue:null},THRESHOLDS_SECTION:{name:"colorThresholdsSection",defaultValue:{thresholds:[]}},TEXT_CONTENT_TYPE:{name:"textContentType",defaultValue:g.TEXT_CONTENT_TYPE.ALL},TEXT_CONTENT_TYPE_COMPARISON:{name:"textContentTypeComparison",defaultValue:g.TEXT_CONTENT_TYPE.ALL},FONT_FAMILY:{name:"fontFamily",defaultValue:v.fontFamily},FONT_STYLE:{name:"fontStyle",defaultValue:[!1,!1,!1,!1]},FONT_STEPS:{name:"fontSteps",defaultValue:0},FONT_SIZE:{name:"fontSize",defaultValue:""},FONT_COLOR:{name:"fontColor",defaultValue:t.LIGHT.FONT},TEXT_ALL_FONT_OPTIONS:{name:"allFontOptions",defaultValue:p(p({},v),{},{fontColor:"INDETERMINATE"})},TEXT_LABEL_FONT_OPTIONS:{name:"labelFontOptions",defaultValue:p(p({},v),{},{fontColor:t.LIGHT.FONT,fontWeight:500})},TEXT_PRIMARY_VALUE_FONT_OPTIONS:{name:"primaryValueFontOptions",defaultValue:p(p({},v),{},{fontColor:t.LIGHT.FONT,fontWeight:500})},TEXT_SECONDARY_VALUE_FONT_OPTIONS:{name:"secondaryValueFontOptions",defaultValue:p(p({},v),{},{fontStyle:[!1,!1,!1,!1],fontColor:t.LIGHT.SECONDARY_VALUE_FONT_COLOR})},TEXT_INDICATOR_FONT_OPTIONS:{name:"indicatorFontOptions",defaultValue:p({},v)},AREA_FILL_COLOR:{name:"areaFillColor",defaultValue:t.LIGHT.AREA},AREA_FILL_COLOR_WITH_TREND:{name:"areaFillColorWithTrend",defaultValue:t.LIGHT.AREA},AREA_FILL_COLOR_WITH_NO_TREND:{name:"areaFillColorWithNoTrend",defaultValue:t.LIGHT.AREA},AREA_FILL_OPACITY:{name:"areaFillOpacity",defaultValue:t.LIGHT.AREA_FILL_OPACITY},TREND_FILL_COLOR:{name:"trendFillColor",defaultValue:t.LIGHT.TREND},TREND_FILL_OPACITY:{name:"trendFillOpacity",defaultValue:t.LIGHT.TREND_OPACITY},TREND_INCREASE_BACKGROUND_COLOR:{name:"trendIncreaseBackgroundColor",defaultValue:e.INCREASE},TREND_DECREASE_BACKGROUND_COLOR:{name:"trendDecreaseBackgroundColor",defaultValue:e.DECREASE},HIDEABLE_SECTION_TREND_SHAPE:{name:"hideableSectionTrendShape",defaultValue:null},TREND_SHAPE:{name:"trendShape",defaultValue:g.TREND_SHAPE.AREA},AXIS_SCALE:{name:"axisScale",defaultValue:g.AXIS_SCALE.GLOBAL},AXIS_SCALE_COMPARISON:{name:"axisScaleComparison",defaultValue:g.AXIS_SCALE.GLOBAL},EMPTY_VIZ_WARNING_MESSAGE:{name:"emptyVizWarningMessage",defaultValue:null},VIZ_FIRST_TAB_SECTION:{name:"vizFirstTabSection",defaultValue:null},VIZ_SECOND_TAB_SECTION:{name:"vizSecondTabSection",defaultValue:null},CARD_ALIGNMENT:{name:"cardAlignment",defaultValue:""},TREND_INDICATOR_SHAPE_LAYOUT:{name:"trendIndicatorShapeLayout",defaultValue:""},TREND_INDICATOR_SHAPE:{name:"trendIndicatorShape",defaultValue:g.TREND_INDICATOR_SHAPE.BADGE},TREND_CONSTANT_BACKGROUND_COLOR:{name:"trendConstantBackgroundColor",defaultValue:e.CONSTANT},DOSSIER_FONT:{name:"dossierFont",defaultValue:""},HIDEABLE_SECTION_REFERENCE_LINES:{name:"hideableSectionReferenceLines",defaultValue:null},SELECTED_REFERENCE_LINE:{name:"selectedReferenceLine",defaultValue:""},REFERENCE_LINE_CONSTANT_VALUE:{name:"referenceLineConstantValue",defaultValue:""},REFERENCE_LINE_LABEL:{name:"referenceLineLabel",defaultValue:""},CREATED_REFERENCE_LINES:{name:"createdReferenceLines",defaultValue:{}},REFERENCE_LINE_CONSTANT_VALUE_WARNING:{name:"referenceLineConstantValueWarning",defaultValue:null},REFERENCE_LINES_SECTION:{name:"referenceLinesSection",defaultValue:null},TEXT_AND_FORM_DROPDOWN_WITH_REFERENCE_LINES:{name:"textAndFormDropdownWithReferenceLines",defaultValue:0},TEXT_AND_FORM_DROPDOWN_WITHOUT_REFERENCE_LINES:{name:"textAndFormDropdownWithoutReferenceLines",defaultValue:0},SELECTED_REFERENCE_LINE_TEXT_AND_FORM:{name:"selectedReferenceLineTextAndForm",defaultValue:""},SELECTED_REFERENCE_LINE_FONT_NAME:{name:"selectedReferenceLineFontName",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.font.fontFamily},SELECTED_REFERENCE_LINE_FONT_STYLE:{name:"selectedReferenceLineFontStyle",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.font.style},SELECTED_REFERENCE_LINE_FONT_SIZE:{name:"selectedReferenceLineFontSize",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.font.size},SELECTED_REFERENCE_LINE_FONT_COLOR:{name:"selectedReferenceLineFontColor",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.font.color},SELECTED_REFERENCE_LINE_COLOR:{name:"selectedReferenceLineColor",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.line.color},SELECTED_REFERENCE_LINE_SHAPE:{name:"selectedReferenceLineShape",defaultValue:g.REFERENCE_LINE_DEFAULT_VALUES.line.shape},ACTIVE_CARD_INDEX:{name:"activeCardIndex",defaultValue:g.FIRST_CARD_INDEX},SECONDARY_METRIC_NAME_LABEL:{name:"secondaryMetricNameLabel",defaultValue:null},SECONDARY_METRIC_NAME_LABEL_COMPARISON:{name:"secondaryMetricNameLabelComparison",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL:{name:"trendIncreaseBackgroundColorLabel",defaultValue:null},TREND_INCREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendIncreaseBackgroundColorLabelComparison",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL:{name:"trendDecreaseBackgroundColorLabel",defaultValue:null},TREND_DECREASE_BACKGROUND_COLOR_LABEL_COMPARISON:{name:"trendDecreaseBackgroundColorLabelComparison",defaultValue:null},HIDEABLE_SECTION_IMAGE:{name:"hideableSectionImage",defaultValue:null},IMAGE_PROP_GALLERY:{name:"gallery",defaultValue:null},IMAGE_PROP_BROWSE:{name:"browse",defaultValue:null},IMAGE_PROP_BROWSE_DISABLED:{name:"browseDisabled",defaultValue:null},IMAGE_PROP_NAME:{name:"imageName",defaultValue:""},IMAGE_PROP_URL:{name:"imageSrc",defaultValue:""},IMAGE_FILL_COLOR:{name:"imgFillColor",defaultValue:t.LIGHT.IMG_FILL_COLOR},IMAGE_FILL_OPACITY:{name:"imgFillOpacity",defaultValue:t.LIGHT.IMG_FILL_OPACITY},IMAGE_SEARCH_ICON:{name:"searchIcon",defaultValue:null}};function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var b={};function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}Object.entries(E).forEach(function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],i=r[1].name;b[a]=i}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var A="properties",S=[A],C=function(t){"object"===I(t)?Object.values(t).forEach(function(t){C(t)}):Array.isArray(t)?t.forEach(function(t){C(t)}):S.push(t)};function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function O(t,e,n){return(e=function(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||M(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){if(t){if("string"==typeof t)return x(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}C(b),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var D=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length>0},R=function(t){var e=t.partialValue,n=t.totalValue;return mstrmojo.num.format(4,1,"",Math.abs(e/n))},P=function(t,e){var n=t.fontFamily,r=t.fontColor,a=t.fontSize,i=t.fontStyle,o=L(e),l=e.getProperty(E.DOSSIER_FONT.name),c=!1;l&&l!==o&&(c=!0);var u,s,d,f,h,m,p=c?o:n,y=e.isIOS&&"Open Sans"===p?"Helvetica":p,g="16px";return a&&"string"==typeof a&&a.indexOf("px")>0?g=a:a&&(g="".concat(V(a),"px")),function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach(function(e){O(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({fontSize:g,fontFamily:y,color:r},(s=(u=N(i,4))[0],d=u[1],f=u[2],h=u[3],m=[],f&&m.push("underline"),h&&m.push("line-through"),{fontWeight:s?"bold":"normal",fontStyle:d?"italic":"normal",textDecoration:m.join(" ")||"none currentcolor solid"}))},L=function(t){var e,n=null===(e=t.controller.model)||void 0===e?void 0:e.defmts.find(function(t){return"Text"===t.n});return(null==n?void 0:n.props.FormattingFont.Name)||t.getProperty(E.FONT_FAMILY.name)},j=function(t,e){var n=e<=1?e:e/100;return"rgba(".concat(parseInt(t.slice(1,3),16),",").concat(parseInt(t.slice(3,5),16),",").concat(parseInt(t.slice(5,7),16),", ").concat(n,")")},V=function(t){return 1.328147*t},F=function(t){var e=t.container,n=t.maxTextWidth,r=t.textData,a=t.fontSize,i=t.fontStyle,o=r.label,l=r.value,c=r.connector,s=o+c+l;if(e.title=s,e.style.fontSize="".concat(a,"px"),""===o)return e.textContent=l,{truncatedLabelAndValue:l,truncatedLabel:""};var d,f,h="...".concat(c);if(f=o[0]+h,mstrmojo.VisUtility.measureTextWidth(d+u,i,i.bonus)>=n)e.style.overflow="hidden",e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",e.textContent=l,f="";else{for(var m=2;m<o.length;m++)if(d=o.substring(0,m)+h+l,mstrmojo.VisUtility.measureTextWidth(d+u,i,i.bonus)>=n){f=o.substring(0,m-1)+h;break}d=f+l,e.textContent=d}return{truncatedLabelWithValue:e.textContent,truncatedLabel:f}},k=function(t){return.75292857248934*t},B=function(t){var e=parseInt(t)/Math.sqrt(2);return e+.1*e},K=function(t,e){var n=t.textContent,r=H(t,e);return mstrmojo.VisUtility.measureTextSize(n+u,r,0)},H=function(t,e){var n=mstrmojo.css.getComputedStyle(t);return{fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontSize:"".concat(parseInt(e),"px"),fontWeight:n.fontWeight,lineHeight:1,bonus:parseInt(n.paddingLeft)+parseInt(n.paddingRight)}},U=function(t,e,n){t.forEach(function(t){t.style[e]=n})},Y=function(t){setTimeout(function(){var e,n;null===(e=(n=window).syncDossierFormatPanel)||void 0===e||e.call(n,t)},0)},G=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=t.replace("#",""),r=3===n.length?n.split("").map(function(t){return t+t}).join(""):n,a=N([0,2,4].map(function(t){return parseInt(r.substr(t,2),16)}),3),i=a[0],o=a[1],l=a[2],c=parseFloat(e.toString().replace("%",""))/100;return"rgba(".concat(i,", ").concat(o,", ").concat(l,", ").concat(c,")")},z=/images\/material-symbols\/400\/rounded\//;mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),b.EMPTY_VIZ_WARNING_MESSAGE;var W=function(t){var e=l(t.KPIType);return t.isComparisonKPI&&D(t,e.COMPARE_WITH)};function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var X=function(t,e){for(var n={},r=function(){var r,o,c=(r=i[a],o=1,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(r,o)||function(t,e){if(t){if("string"==typeof t)return $(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(t,e):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],u=t[c],f=l(e.KPIType);switch(c){case E.SHOW_METRIC_NAME.name:if(null===u){var h=D(e,f.BREAK_BY),m=function(t,e){return t.zonesModel.getDropZoneObjectsByIndex(e).length}(e,f.METRICS)>1;u=!h||m,e.showMetricName=u,Y([c])}break;case E.CARD_ALIGNMENT.name:if(!u){var p=D(e,f.TREND);u=p?g.CARD_ALIGNMENT.LEFT:g.CARD_ALIGNMENT.MIDDLE,e.cardAlignment=u,Y([c])}break;case E.SECONDARY_METRIC_NAME.name:var y,v,_=e.isComparisonKPI,I=e.isRealTime,A=e.timestampIndex,S=e.timeFilter,C=e.dataInterface,T=e.data,w=null==C||null===(y=C.data)||void 0===y||null===(v=y.wdgstrs)||void 0===v?void 0:v[d];if(u&&I&&_&&(D(e,f.COMPARE_WITH)||(u=null)),w&&!e.labelsEditState[c]&&(u=w,n[c]=u),!u){var O=_&&D(e,f.COMPARE_WITH),N=D(e,f.TREND);if(O){var M=I?C.data.gsi.mx[1].n:C.getColHeaders(0).getHeader(1).getName();u="".concat(mstrmojo.descP("IMGKPI.","39","Compare with")," ").concat(M)}else if(N){var x=D(e,f.BREAK_BY)?1:0;if(I)if(S.isMoreDataThanFilter)u="".concat(S.filterLabel," ago");else{var R=new Date(T[0].cells[A].v).toTimeString().split(" ").shift();u="Compare to ".concat(R)}else u="".concat(mstrmojo.descP("IMGKPI.","36","Previous")," ").concat(e.dataInterface.getRowTitles().getTitle(x).getName())}e.secondaryMetricName=u,Y([c])}break;case E.CREATED_REFERENCE_LINES.name:if(!u)break;var P=function(t,e){var n=e[b.SELECTED_REFERENCE_LINE];if(!n){var r,a,i=null===(r=t.dataInterface.getColTitles().titles[0])||void 0===r?void 0:r.es.map(function(t){return{n:t.n,dssid:t.oid}});null!=i&&i.find(function(t){return t.dssid===n})&&!t.isComparisonKPI||(n=null==i||null===(a=i[0])||void 0===a?void 0:a.dssid)}return n}(e,t),L=E.REFERENCE_LINE_LABEL.name;Object.keys(u).forEach(function(r){var a=function(t,e,n){var r,a;return null===(r=t.model.data.gsi.mx.find(function(t){return t.did===e}))||void 0===r||null===(a=r.wdgstrs)||void 0===a?void 0:a[n]}(e,r,s);a&&!e.labelsEditState[r]&&(u[r].label=a,n[c]=u,P===r&&(t[L]=a,n[L]=a))})}t[c]=u},a=0,i=Object.entries(t);a<i.length;a++)r();return Object.keys(n).length&&function(t,e){var n=JSON.parse(t.getProperty(A));Object.keys(e).forEach(function(t){n[t]=e[t]}),t.getProperties()[A]=JSON.stringify(n)}(e,n),t};function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Q(t,e,n){return(e=function(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});function J(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){if(t){if("string"==typeof t)return et(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var nt=function(t){if(!t)return!0;var e=t.color,n=t.range;return!(e||null!=n&&n.value)},rt=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return t.forEach(function(t){var r=t.nfs,a=t.id,i=(r||"General").split(";").map(function(t){return function(t){var e,n=["black","blue","cyan","green","magenta","red","white","yellow"],r={range:{check:function(t){return!0}},color:void 0,formatString:t.slice(t.lastIndexOf("]")+1)},a=(e=t.matchAll(/\[([A-Za-z0-9<>=-]+)\]/g),function(t){if(Array.isArray(t))return et(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||tt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(t){return t[1]});return a&&a.forEach(function(t){if(n.includes(t.toLowerCase()))r.color=t.toLowerCase();else{var e=Number.parseFloat(t.split(/[^0-9-,.]/).join(""));r.range.value=e,0===t.search(">")?(r.range.compareType=0,1===t.search("=")?r.range.check=function(t){return t>=e}:r.range.check=function(t){return t>e}):0===t.search("<")?(r.range.compareType=1,1===t.search("=")?r.range.check=function(t){return t<=e}:r.range.check=function(t){return t<e}):0===t.search("=")&&(r.range.check=function(t){return t===e})}}),r}(t)}),o=a;!function(t){t.length>1&&void 0===t[0].range.value&&(t[0].range={value:0,check:function(t){return t>=0}},t[1]&&void 0===t[1].range.value&&(t[1].range={value:0,check:function(t){return t<0}}),t[2]&&void 0===t[2].range.value&&(t[2].range={value:0,check:function(t){return 0===t}},t[0].range={check:function(t){return t>0}}))}(i),i.forEach(function(t){t.rules=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=mstrmojo.locales.number,r=n.THOUSANDSEPARATOR,a={thousandSeparator:"",decimalSeparator:n.DECIMALSEPARATOR,minimalIntegerLength:1,maximalFractionLength:0,minimalFractionLength:0,divisor:1,prefix:"",suffix:"",shouldLeadingZeroBeOmitted:!1},i=/"(.*?)"/g.exec(t);if(i){var o=t.search(/[#0]/);if(0!==i.length){if(i.index<o){var l=J(i,2);a.prefix=l[1]}else{var c=J(i,2);a.suffix=c[1]}i.forEach(function(e){t=t.replace(e,"")})}}for("%"===t.slice(-1)&&(a.divisor*=.01,a.suffix+=e?"%":"pp",t=t.slice(0,-1));","===t.slice(-1);)a.divisor*=1e3,t=t.slice(0,-1);t.includes(",")&&(a.thousandSeparator=r),t.includes("(")&&t.includes(")")?(a.prefix="(".concat(a.prefix),a.suffix+=")","%)"===t.slice(-2)&&(t=t.slice(0,-2),t+=")",a.divisor*=.01,a.suffix+="pp")):t.includes("-")&&(a.prefix="-".concat(a.prefix));var u=t.split(".");if(2===u.length){var s=J(u,2),d=s[0],f=s[1],h=d.match(/[0]/g);h&&(a.minimalIntegerLength=h.length),a.maximalFractionLength=f.match(/[0#]/g).length;var m=f.match(/[0]/g);m&&(a.minimalFractionLength=m.length),1===d.length&&"#"===d&&(a.shouldLeadingZeroBeOmitted=!0)}return a}(t.formatString,e)}),n[o]=i}),n},at=function(t,e,n){var r=Number.isNaN(Number(t))?0:Number(t);return function(t,e){var n=e.color,r=e.rules,a=r.maximalFractionLength,i=r.minimalIntegerLength,o=r.minimalFractionLength,l=r.thousandSeparator,c=r.decimalSeparator,u=r.prefix,s=r.suffix,d=r.shouldLeadingZeroBeOmitted,f=r.divisor,h=t<0,m=Math.abs(t)/f,p=function(t,e,n){if(e===n)return e;var r=parseFloat(Number(t).toFixed(n)).toString().split(".")[1];return r&&r.length>e?r.length:e}(t,o,a),y=m.toFixed(p);if(d&&m<1)y=y.slice(1);else{var g=Math.pow(10,i);m<g-1&&(y=(parseFloat(y)+g).toFixed(p).slice(1))}var v=y.split(".");return v[0]=v[0].replace(/\B(?=(\d{3})+(?!\d))/g,l),y=v.join(c),!h||r.prefix.includes("(")||r.prefix.includes("-")||(y="-".concat(y)),{formattedValue:"".concat(u).concat(y).concat(s),color:n}}(r,function(t,e){var n=e.filter(function(e){return e.range.check(t)});return n.length>1?function(t,e){if(t>=0)return!1;if(e.length<=1)return!1;var n=e.filter(function(t){return!nt(t)});return n.length>0&&n.every(function(t){var e;return 1===(null===(e=t.range)||void 0===e?void 0:e.compareType)})}(t,n)?n.find(function(t){return!nt(t)}):n.reduce(function(t,e){return e.range.value&&t.range.value?e.range.value>t.range.value?e:t:e.range.value?e:t}):n[0]}(r,n[e]))};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach(function(e){ut(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ct(t){return function(t){if(Array.isArray(t))return dt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||st(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(t,e,n){return(e=function(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=it(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function st(t,e){if(t){if("string"==typeof t)return dt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dt(t,e):void 0}}function dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var ft=function(t,e,n){if(e.isRealTime){t=t.map(function(t){return ht(t.cells,e)});var r=mt(e);e.mappedIndexes=r}var a=D(e,n.TREND),i=D(e,n.BREAK_BY),o=t[0].values.map(function(){return i?new Map:[]}),l=e.isComparisonKPI,c=e.timestampIndex,u=e.isRealTime,s=e.model;return t.forEach(function(t,r){var d,f,h,m,p,y;if(!vt(t)){if(i){var g,v,E,_,b=t.headers[0];d=b.attributeSelector,f=d.eid,h=b.name,m=null==b||null===(g=b.headerObj)||void 0===g||null===(v=g.t)||void 0===v||null===(E=v.fs)||void 0===E||null===(_=E[0])||void 0===_?void 0:_.bftp}else if(a){var I=t.headers[0];d=I.attributeSelector}if(a){var A,S,C,T,w,O,N,M,x=t.headers;p=i?null===(A=x[1])||void 0===A||null===(S=A.headerObj)||void 0===S||null===(C=S.t)||void 0===C||null===(T=C.fs[0])||void 0===T?void 0:T.bftp:null===(w=x[0])||void 0===w||null===(O=w.headerObj)||void 0===O||null===(N=O.t)||void 0===N||null===(M=N.fs[0])||void 0===M?void 0:M.bftp}t.values.forEach(function(g,v){var E,_,b,I,A,S,C,T=g.name,w=g.rv,O=g.v,N=g.id;if(1!==v||!l){y=(null==s||null===(E=s.getFullObjectInfo)||void 0===E||null===(_=E.call(s,N))||void 0===_?void 0:_.mft)||(null==s||null===(b=s.docModel)||void 0===b||null===(I=b.getObjectInfo)||void 0===I||null===(A=I.call(b,N))||void 0===A?void 0:A.mft)||(null==s||null===(S=s.getObjectInfo)||void 0===S||null===(C=S.call(s,N))||void 0===C?void 0:C.mft);var M,x,D=i?o[v].get(f):o[v][0];if(l&&(x=(M=t.values[1]||null)?{raw:M.rv,formatted:M.v}:null),D){if(a){var R=Object.keys(t.metricSelector),P={raw:w,formatted:O,graphicModel:yt(d,t.idValueMapping,R,N)};u&&(P.timestamp=e.data[r].cells[c].v,P.timestampDate=new Date(P.timestamp)),D.trendChartData.push(P)}l&&(D.compareMetricValue=x)}else{var L;if(a){var j=Object.keys(t.metricSelector);L=[{raw:w,formatted:O,graphicModel:yt(d,t.idValueMapping,j,N)}],u&&(L[0].timestamp=e.data[r].cells[c].v,L[0].timestampDate=new Date(L[0].timestamp))}else L=[{raw:w,formatted:O}];var V,F={metricId:N,graphicModel:gt(d,N,e,t,n),label:{withMetricName:h?"".concat(T," - ").concat(h):T,withoutMetricName:h||""},trendChartData:L,breakByAttributeName:h,breakByAttributeFormType:m,trendAttributeFormType:p,metricFormType:y};l&&(F.compareMetricId=(null===(V=M)||void 0===V?void 0:V.id)||null,F.compareMetricValue=x),i?o[v].set(f,F):o[v].push(F)}}})}}),i?o.map(function(t){return function(t){return function(t){if(Array.isArray(t))return x(t)}(e=t.values())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||M(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e}(t)}):o},ht=function(t,e){var n=e.isComparisonKPI,r=e.dataInterface.data.realtimeQueryInfo.columns,a={};r.forEach(function(t,e){a[t.id]=e});var i=-1,o=[],c=[],u={},s={},d=l(e.KPIType);if(e.zonesModel.getDropZoneObjectsByIndex(d.TREND).forEach(function(e){var n=a[e.id];i=n,u[e.id]=t[n].v,s[e.id]={}}),e.zonesModel.getDropZoneObjectsByIndex(d.BREAK_BY).forEach(function(e){var n=a[e.id];i=n,u[e.id]=t[n].v,s[e.id]={}}),i>=0){var f=r[i].id,h=t[i].v,m="".concat(h,";").concat(f);o.push({name:h,attributeSelector:{n:h,tid:f,eid:m,isSelectAttr:!0}})}var p,y=e.zonesModel.getDropZoneObjectsByIndex(d.METRICS);return n&&W(e)&&y.push(null===(p=e.zonesModel)||void 0===p?void 0:p.getDropZoneObjectsByIndex(d.COMPARE_WITH)[0]),e.getDocModel(),y.forEach(function(n,r){var i=a[n.id];u[n.id]=at(t[i].v,n.id,e.metricFormattingRules).formattedValue;var o=e.dataInterface.data.gsi.mx[r].n;c.push({v:u[n.id],rv:t[i].v,id:n.id,name:o})}),{headers:o,values:c,idValueMapping:u,metricSelector:s}},mt=function(t){var e=t.dataInterface.data.realtimeQueryInfo.columns,n=[];return e.forEach(function(t){-1===t.bfid&&n.push(t.id)}),Object.keys(n).reduce(function(t,e){return t[n[e]]=parseInt(e),t},{})},pt=function(t,e,n){var r=e.colorThresholdsSection.thresholds,a=ct(t).sort(function(t,e){return t.primaryValue.raw-e.primaryValue.raw}),i=ct(t).sort(function(t,e){return e.primaryValue.raw-t.primaryValue.raw}),o=r.map(function(t){t.skip=!1;var e=t.advancedThreshold;if(e&&2===e.thresholdType){var n,r=null!==(n=e.rank)&&void 0!==n?n:"0",o=2===e.rankOption?a:i,l=function(t,e){return"%"===t.slice(-1)?Number(t.slice(0,-1))*e*.01:Number(t)}(r,o.length);if(l<1)return lt(lt({},t),{},{skip:!0});var c=function(t,e,n){var r=[];return t.forEach(function(t,n){if(n<=e-1){var a=t.trendChartData;r.push(a[a.length-1].raw)}}),2===n?{minValue:r[0],maxValue:r[r.length-1]}:{minValue:r[r.length-1],maxValue:r[0]}}(o,l,e.rankOption),u=c.minValue,s=c.maxValue;return lt(lt({},t),{},{min:u,max:s})}return t.min||t.max?t:lt(lt({},t),{},{min:0,max:0})}),l=function(t){return"%"==="".concat(t).slice(-1)?.01*Number(t.slice(0,-1)):t},c=function(e,r){var a=ut(ut(ut(ut(ut(ut(ut({},2,null),3,null),4,null),5,null),6,null),7,null),8,null);return o.filter(function(a){var i=a.enabled,o=a.skip,c=a.advancedThreshold;if(!i)return!1;if(c&&3===c.thresholdType)return function(e,r){if(!n)return!1;var a=function(e){return ct(t).filter(function(t){if(t.indicator){var n=Math.sign(t.indicator.differenceBetweenPrimaryAndSecondary);return 1===e?n>0:n<0}return!1})}(e);return 0!==a.length&&a.some(function(t){return t.graphicModel.cardId===r})}(c.indicator,r);var u=parseFloat(l(a.min)||Number.NEGATIVE_INFINITY),s=parseFloat(l(a.max)||Number.POSITIVE_INFINITY);return u<=e&&s>=e&&!o}).reverse().forEach(function(t){var e=t.advancedThreshold,n=t.color;if(e){var r=e.selector,i=e.colors;1===r&&function(t,e,n,r){var a,i,o,l,c=void 0===n[1]||"INDETERMINATE"===n[1]?null:n[1];t[2]=lt(lt({},e),{},{color:null!==(a=null!=c?c:n[2])&&void 0!==a?a:r}),t[3]=lt(lt({},e),{},{color:null!==(i=null!=c?c:n[3])&&void 0!==i?i:r}),t[4]=lt(lt({},e),{},{color:null!==(o=null!=c?c:n[4])&&void 0!==o?o:r}),t[5]=lt(lt({},e),{},{color:null!==(l=null!=c?c:n[5])&&void 0!==l?l:r})}(a,t,void 0===i?{}:i,n),a[r]=t}else a[3]=t}),a};return t.map(function(t){var e=t.trendChartData,n=t.graphicModel,r=e[e.length-1].raw;return t.thresholdTarget=c(r,n.cardId),t})},yt=function(t,e,n,r){var a=new mstrmojo.customviz.GraphicModel,i=function(t,e){var n={};return Object.keys(t).filter(function(t){return e.includes(t)}).forEach(function(e){n[e]=t[e]}),n}(e,[].concat(ct(n),[r]));return a.setSelector(t,t.isSelectAttr),a.idValueMapping=i,a},gt=function(t,e,n,r,a){n.cardsIds||(n.cardIds=[]);var i=new mstrmojo.customviz.GraphicModel;return t?(i.setSelector(t,t.isSelectAttr),i.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e,"-").concat(t.eid)}),i.setGroupOptions([r.headers[0]]),i.setDrillOptions(t,[{dropZoneIndex:a.BREAK_BY,keepParent:!1}]),n.cardIds.push("".concat(n.id,"-").concat(e,"-").concat(t.eid))):(n.metricId=e,i.setCustomProperties({metricId:e,cardId:"".concat(n.id,"-").concat(e)}),n.cardIds.push("".concat(n.id,"-").concat(e))),i.idValueMapping=Et(r.headers),i},vt=function(t){return t.headers.some(function(t){var e;return null===(e=t.headerObj)||void 0===e?void 0:e.h.stt})},Et=function(t){return Object.fromEntries(t.map(function(t){var e=t.attributeSelector;return[e.tid,e.n]}).slice(0,-1))};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var _t={SANITIZE_NAMED_PROPS:!0,RETURN_DOM_FRAGMENT:!0,ADD_ATTR:["target"]};function bt(t,e){if(t){if("string"==typeof t)return It(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?It(t,e):void 0}}function It(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var At=function(t,e){return window.DOMPurify?DOMPurify.sanitize(t,e):t},St=function(t,e){var n="",r=function(t){"_blank"===t.getAttribute("target")&&t.setAttribute("rel","noopener noreferrer"),n+=t.outerHTML},a=function(t){var e;t.nodeType===Node.ELEMENT_NODE?"IMG"===(e=t).tagName?n+="":"A"===e.tagName?r(e):e.childNodes?e.childNodes.forEach(a):n+=e.textContent:i(t)},i=function(t){n+=e?mstrmojo.string.encodeHtmlString(t.textContent):t.textContent};return t instanceof Node&&(null==t||t.childNodes.forEach(a)),n},Ct=function(t){var e,n,r,a=t.tag,i=void 0===a?"div":a,o=t.classes,l=void 0===o?[]:o,c=t.content,u=void 0===c?"":c,s=t.style,d=void 0===s?{}:s,f=t.otherAttributes,h=void 0===f?{}:f,m=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],p=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=document.createElement(i);if((e=y.classList).add.apply(e,function(t){if(Array.isArray(t))return It(t)}(r=l)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||bt(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&m&&p){var g=At(u,_t);n=St(g,m)}else n=m?mstrmojo.string.encodeHtmlString(u):u;return y.innerHTML=n,Object.assign(y.style,d),Object.entries(h).forEach(function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||bt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=e[0],r=e[1];y.setAttribute(n,mstrmojo.string.encodeHtmlString(r))}),y};function Tt(){}function wt(t){return null==t?Tt:function(){return this.querySelector(t)}}function Ot(){return[]}function Nt(t){return null==t?Ot:function(){return this.querySelectorAll(t)}}function Mt(t){return function(){return this.matches(t)}}function xt(t){return function(e){return e.matches(t)}}var Dt=Array.prototype.find;function Rt(){return this.firstElementChild}var Pt=Array.prototype.filter;function Lt(){return Array.from(this.children)}function jt(t){return new Array(t.length)}function Vt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ft(t,e,n,r,a,i){for(var o,l=0,c=e.length,u=i.length;l<u;++l)(o=e[l])?(o.__data__=i[l],r[l]=o):n[l]=new Vt(t,i[l]);for(;l<c;++l)(o=e[l])&&(a[l]=o)}function kt(t,e,n,r,a,i,o){var l,c,u,s=new Map,d=e.length,f=i.length,h=new Array(d);for(l=0;l<d;++l)(c=e[l])&&(h[l]=u=o.call(c,c.__data__,l,e)+"",s.has(u)?a[l]=c:s.set(u,c));for(l=0;l<f;++l)u=o.call(t,i[l],l,i)+"",(c=s.get(u))?(r[l]=c,c.__data__=i[l],s.delete(u)):n[l]=new Vt(t,i[l]);for(l=0;l<d;++l)(c=e[l])&&s.get(h[l])===c&&(a[l]=c)}function Bt(t){return t.__data__}function Kt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ht(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Vt.prototype={constructor:Vt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Ut="http://www.w3.org/1999/xhtml";const Yt={svg:"http://www.w3.org/2000/svg",xhtml:Ut,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Gt(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Yt.hasOwnProperty(e)?{space:Yt[e],local:t}:t}function zt(t){return function(){this.removeAttribute(t)}}function Wt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function $t(t,e){return function(){this.setAttribute(t,e)}}function Xt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Zt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function qt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Qt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Jt(t){return function(){this.style.removeProperty(t)}}function te(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ee(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ne(t,e){return t.style.getPropertyValue(e)||Qt(t).getComputedStyle(t,null).getPropertyValue(e)}function re(t){return function(){delete this[t]}}function ae(t,e){return function(){this[t]=e}}function ie(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function oe(t){return t.trim().split(/^|\s+/)}function le(t){return t.classList||new ce(t)}function ce(t){this._node=t,this._names=oe(t.getAttribute("class")||"")}function ue(t,e){for(var n=le(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function se(t,e){for(var n=le(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function de(t){return function(){ue(this,t)}}function fe(t){return function(){se(this,t)}}function he(t,e){return function(){(e.apply(this,arguments)?ue:se)(this,t)}}function me(){this.textContent=""}function pe(t){return function(){this.textContent=t}}function ye(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ge(){this.innerHTML=""}function ve(t){return function(){this.innerHTML=t}}function Ee(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function _e(){this.nextSibling&&this.parentNode.appendChild(this)}function be(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ie(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ut&&e.documentElement.namespaceURI===Ut?e.createElement(t):e.createElementNS(n,t)}}function Ae(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Se(t){var e=Gt(t);return(e.local?Ae:Ie)(e)}function Ce(){return null}function Te(){var t=this.parentNode;t&&t.removeChild(this)}function we(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Oe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ne(t){return function(){var e=this.__on;if(e){for(var n,r=0,a=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?e.length=a:delete this.__on}}}function Me(t,e,n){return function(){var r,a=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(a)for(var o=0,l=a.length;o<l;++o)if((r=a[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},a?a.push(r):this.__on=[r]}}function xe(t,e,n){var r=Qt(t),a=r.CustomEvent;"function"==typeof a?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function De(t,e){return function(){return xe(this,t,e)}}function Re(t,e){return function(){return xe(this,t,e.apply(this,arguments))}}ce.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Pe=[null];function Le(t,e){this._groups=t,this._parents=e}function je(){return new Le([[document.documentElement]],Pe)}Le.prototype=je.prototype={constructor:Le,select:function(t){"function"!=typeof t&&(t=wt(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o,l=e[a],c=l.length,u=r[a]=new Array(c),s=0;s<c;++s)(i=l[s])&&(o=t.call(i,i.__data__,s,l))&&("__data__"in i&&(o.__data__=i.__data__),u[s]=o);return new Le(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):Nt(t);for(var e=this._groups,n=e.length,r=[],a=[],i=0;i<n;++i)for(var o,l=e[i],c=l.length,u=0;u<c;++u)(o=l[u])&&(r.push(t.call(o,o.__data__,u,l)),a.push(o));return new Le(r,a)},selectChild:function(t){return this.select(null==t?Rt:function(t){return function(){return Dt.call(this.children,t)}}("function"==typeof t?t:xt(t)))},selectChildren:function(t){return this.selectAll(null==t?Lt:function(t){return function(){return Pt.call(this.children,t)}}("function"==typeof t?t:xt(t)))},filter:function(t){"function"!=typeof t&&(t=Mt(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o=e[a],l=o.length,c=r[a]=[],u=0;u<l;++u)(i=o[u])&&t.call(i,i.__data__,u,o)&&c.push(i);return new Le(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Bt);var n,r=e?kt:Ft,a=this._parents,i=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=i.length,l=new Array(o),c=new Array(o),u=new Array(o),s=0;s<o;++s){var d=a[s],f=i[s],h=f.length,m=Kt(t.call(d,d&&d.__data__,s,a)),p=m.length,y=c[s]=new Array(p),g=l[s]=new Array(p);r(d,f,y,g,u[s]=new Array(h),m,e);for(var v,E,_=0,b=0;_<p;++_)if(v=y[_]){for(_>=b&&(b=_+1);!(E=g[b])&&++b<p;);v._next=E||null}}return(l=new Le(l,a))._enter=c,l._exit=u,l},enter:function(){return new Le(this._enter||this._groups.map(jt),this._parents)},exit:function(){return new Le(this._exit||this._groups.map(jt),this._parents)},join:function(t,e,n){var r=this.enter(),a=this,i=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(a=e(a))&&(a=a.selection()),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,i=r.length,o=Math.min(a,i),l=new Array(a),c=0;c<o;++c)for(var u,s=n[c],d=r[c],f=s.length,h=l[c]=new Array(f),m=0;m<f;++m)(u=s[m]||d[m])&&(h[m]=u);for(;c<a;++c)l[c]=n[c];return new Le(l,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,a=t[e],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ht);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,l=n[i],c=l.length,u=a[i]=new Array(c),s=0;s<c;++s)(o=l[s])&&(u[s]=o);u.sort(e)}return new Le(a,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a,i=e[n],o=0,l=i.length;o<l;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this},attr:function(t,e){var n=Gt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Wt:zt:"function"==typeof e?n.local?qt:Zt:n.local?Xt:$t)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Jt:"function"==typeof e?ee:te)(t,e,null==n?"":n)):ne(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?re:"function"==typeof e?ie:ae)(t,e)):this.node()[t]},classed:function(t,e){var n=oe(t+"");if(arguments.length<2){for(var r=le(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof e?he:e?de:fe)(n,e))},text:function(t){return arguments.length?this.each(null==t?me:("function"==typeof t?ye:pe)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ge:("function"==typeof t?Ee:ve)(t)):this.node().innerHTML},raise:function(){return this.each(_e)},lower:function(){return this.each(be)},append:function(t){var e="function"==typeof t?t:Se(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Se(t),r=null==e?Ce:"function"==typeof e?e:wt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Te)},clone:function(t){return this.select(t?Oe:we)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,a,i=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=i.length;if(!(arguments.length<2)){for(l=e?Me:Ne,r=0;r<o;++r)this.each(l(i[r],e,n));return this}var l=this.node().__on;if(l)for(var c,u=0,s=l.length;u<s;++u)for(r=0,c=l[u];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?Re:De)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,a=t[e],i=0,o=a.length;i<o;++i)(r=a[i])&&(yield r)}};const Ve=je;var Fe={value:()=>{}};function ke(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Be(r)}function Be(t){this._=t}function Ke(t,e){for(var n,r=0,a=t.length;r<a;++r)if((n=t[r]).name===e)return n.value}function He(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=Fe,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Be.prototype=ke.prototype={constructor:Be,on:function(t,e){var n,r,a=this._,i=(r=a,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,l=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<l;)if(n=(t=i[o]).type)a[n]=He(a[n],t.name,e);else if(null==e)for(n in a)a[n]=He(a[n],t.name,null);return this}for(;++o<l;)if((n=(t=i[o]).type)&&(n=Ke(a[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Be(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,i=r.length;a<i;++a)r[a].value.apply(e,n)}};const Ue=ke;var Ye,Ge,ze=0,We=0,$e=0,Xe=0,Ze=0,qe=0,Qe="object"==typeof performance&&performance.now?performance:Date,Je="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tn(){return Ze||(Je(en),Ze=Qe.now()+qe)}function en(){Ze=0}function nn(){this._call=this._time=this._next=null}function rn(t,e,n){var r=new nn;return r.restart(t,e,n),r}function an(){Ze=(Xe=Qe.now())+qe,ze=We=0;try{!function(){tn(),++ze;for(var t,e=Ye;e;)(t=Ze-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ze}()}finally{ze=0,function(){for(var t,e,n=Ye,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ye=e);Ge=t,ln(r)}(),Ze=0}}function on(){var t=Qe.now(),e=t-Xe;e>1e3&&(qe-=e,Xe=t)}function ln(t){ze||(We&&(We=clearTimeout(We)),t-Ze>24?(t<1/0&&(We=setTimeout(an,t-Qe.now()-qe)),$e&&($e=clearInterval($e))):($e||(Xe=Qe.now(),$e=setInterval(on,1e3)),ze=1,Je(an)))}function cn(t,e,n){var r=new nn;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}nn.prototype=rn.prototype={constructor:nn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?tn():+n)+(null==e?0:+e),this._next||Ge===this||(Ge?Ge._next=this:Ye=this,Ge=this),this._call=t,this._time=n,ln()},stop:function(){this._call&&(this._call=null,this._time=1/0,ln())}};var un=Ue("start","end","cancel","interrupt"),sn=[];function dn(t,e,n,r,a,i){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,a=t.__transition;function i(c){var u,s,d,f;if(1!==n.state)return l();for(u in a)if((f=a[u]).name===n.name){if(3===f.state)return cn(i);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete a[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete a[u])}if(cn(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),u=0,s=-1;u<d;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++s]=f);r.length=s+1}}function o(e){for(var a=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,o=r.length;++i<o;)r[i].call(t,a);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete a[e],a)return;delete t.__transition}a[e]=n,n.timer=rn(function(t){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=t&&i(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:a,on:un,tween:sn,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function fn(t,e){var n=mn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function hn(t,e){var n=mn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function mn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function pn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var yn,gn=180/Math.PI,vn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function En(t,e,n,r,a,i){var o,l,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(e,t)*gn,skewX:Math.atan(c)*gn,scaleX:o,scaleY:l}}function _n(t,e,n,r){function a(t){return t.length?t.pop()+" ":""}return function(i,o){var l=[],c=[];return i=t(i),o=t(o),function(t,r,a,i,o,l){if(t!==a||r!==i){var c=o.push("translate(",null,e,null,n);l.push({i:c-4,x:pn(t,a)},{i:c-2,x:pn(r,i)})}else(a||i)&&o.push("translate("+a+e+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,l,c),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:pn(t,e)})):e&&n.push(a(n)+"rotate("+e+r)}(i.rotate,o.rotate,l,c),function(t,e,n,i){t!==e?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:pn(t,e)}):e&&n.push(a(n)+"skewX("+e+r)}(i.skewX,o.skewX,l,c),function(t,e,n,r,i,o){if(t!==n||e!==r){var l=i.push(a(i)+"scale(",null,",",null,")");o.push({i:l-4,x:pn(t,n)},{i:l-2,x:pn(e,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,l,c),i=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)l[(e=c[n]).i]=e.x(t);return l.join("")}}}var bn=_n(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?vn:En(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),In=_n(function(t){return null==t?vn:(yn||(yn=document.createElementNS("http://www.w3.org/2000/svg","g")),yn.setAttribute("transform",t),(t=yn.transform.baseVal.consolidate())?En((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):vn)},", ",")",")");function An(t,e){var n,r;return function(){var a=hn(this,t),i=a.tween;if(i!==n)for(var o=0,l=(r=n=i).length;o<l;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}a.tween=r}}function Sn(t,e,n){var r,a;if("function"!=typeof n)throw new Error;return function(){var i=hn(this,t),o=i.tween;if(o!==r){a=(r=o).slice();for(var l={name:e,value:n},c=0,u=a.length;c<u;++c)if(a[c].name===e){a[c]=l;break}c===u&&a.push(l)}i.tween=a}}function Cn(t,e,n){var r=t._id;return t.each(function(){var t=hn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return mn(t,r).value[e]}}function Tn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function wn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function On(){}var Nn=.7,Mn=1/Nn,xn="\\s*([+-]?\\d+)\\s*",Dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pn=/^#([0-9a-f]{3,8})$/,Ln=new RegExp(`^rgb\\(${xn},${xn},${xn}\\)$`),jn=new RegExp(`^rgb\\(${Rn},${Rn},${Rn}\\)$`),Vn=new RegExp(`^rgba\\(${xn},${xn},${xn},${Dn}\\)$`),Fn=new RegExp(`^rgba\\(${Rn},${Rn},${Rn},${Dn}\\)$`),kn=new RegExp(`^hsl\\(${Dn},${Rn},${Rn}\\)$`),Bn=new RegExp(`^hsla\\(${Dn},${Rn},${Rn},${Dn}\\)$`),Kn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Hn(){return this.rgb().formatHex()}function Un(){return this.rgb().formatRgb()}function Yn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Pn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Gn(e):3===n?new $n(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?zn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?zn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ln.exec(t))?new $n(e[1],e[2],e[3],1):(e=jn.exec(t))?new $n(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Vn.exec(t))?zn(e[1],e[2],e[3],e[4]):(e=Fn.exec(t))?zn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=kn.exec(t))?tr(e[1],e[2]/100,e[3]/100,1):(e=Bn.exec(t))?tr(e[1],e[2]/100,e[3]/100,e[4]):Kn.hasOwnProperty(t)?Gn(Kn[t]):"transparent"===t?new $n(NaN,NaN,NaN,0):null}function Gn(t){return new $n(t>>16&255,t>>8&255,255&t,1)}function zn(t,e,n,r){return r<=0&&(t=e=n=NaN),new $n(t,e,n,r)}function Wn(t,e,n,r){return 1===arguments.length?((a=t)instanceof On||(a=Yn(a)),a?new $n((a=a.rgb()).r,a.g,a.b,a.opacity):new $n):new $n(t,e,n,null==r?1:r);var a}function $n(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Xn(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}`}function Zn(){const t=qn(this.opacity);return`${1===t?"rgb(":"rgba("}${Qn(this.r)}, ${Qn(this.g)}, ${Qn(this.b)}${1===t?")":`, ${t})`}`}function qn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Qn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jn(t){return((t=Qn(t))<16?"0":"")+t.toString(16)}function tr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nr(t,e,n,r)}function er(t){if(t instanceof nr)return new nr(t.h,t.s,t.l,t.opacity);if(t instanceof On||(t=Yn(t)),!t)return new nr;if(t instanceof nr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,l=i-a,c=(i+a)/2;return l?(o=e===i?(n-r)/l+6*(n<r):n===i?(r-e)/l+2:(e-n)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new nr(o,l,c,t.opacity)}function nr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function rr(t){return(t=(t||0)%360)<0?t+360:t}function ar(t){return Math.max(0,Math.min(1,t||0))}function ir(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function or(t,e,n,r,a){var i=t*t,o=i*t;return((1-3*t+3*i-o)*e+(4-6*i+3*o)*n+(1+3*t+3*i-3*o)*r+o*a)/6}Tn(On,Yn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Hn,formatHex:Hn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return er(this).formatHsl()},formatRgb:Un,toString:Un}),Tn($n,Wn,wn(On,{brighter(t){return t=null==t?Mn:Math.pow(Mn,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Nn:Math.pow(Nn,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new $n(Qn(this.r),Qn(this.g),Qn(this.b),qn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xn,formatHex:Xn,formatHex8:function(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}${Jn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Zn,toString:Zn})),Tn(nr,function(t,e,n,r){return 1===arguments.length?er(t):new nr(t,e,n,null==r?1:r)},wn(On,{brighter(t){return t=null==t?Mn:Math.pow(Mn,t),new nr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Nn:Math.pow(Nn,t),new nr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new $n(ir(t>=240?t-240:t+120,a,r),ir(t,a,r),ir(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new nr(rr(this.h),ar(this.s),ar(this.l),qn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=qn(this.opacity);return`${1===t?"hsl(":"hsla("}${rr(this.h)}, ${100*ar(this.s)}%, ${100*ar(this.l)}%${1===t?")":`, ${t})`}`}}));const lr=t=>()=>t;function cr(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):lr(isNaN(t)?e:t)}const ur=function t(e){var n=function(t){return 1===(t=+t)?cr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):lr(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Wn(t)).r,(e=Wn(e)).r),a=n(t.g,e.g),i=n(t.b,e.b),o=cr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=a(e),t.b=i(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function sr(t){return function(e){var n,r,a=e.length,i=new Array(a),o=new Array(a),l=new Array(a);for(n=0;n<a;++n)r=Wn(e[n]),i[n]=r.r||0,o[n]=r.g||0,l[n]=r.b||0;return i=t(i),o=t(o),l=t(l),r.opacity=1,function(t){return r.r=i(t),r.g=o(t),r.b=l(t),r+""}}}sr(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],i=t[r+1],o=r>0?t[r-1]:2*a-i,l=r<e-1?t[r+2]:2*i-a;return or((n-r/e)*e,o,a,i,l)}}),sr(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],i=t[r%e],o=t[(r+1)%e],l=t[(r+2)%e];return or((n-r/e)*e,a,i,o,l)}});var dr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fr=new RegExp(dr.source,"g");function hr(t,e){var n,r,a,i=dr.lastIndex=fr.lastIndex=0,o=-1,l=[],c=[];for(t+="",e+="";(n=dr.exec(t))&&(r=fr.exec(e));)(a=r.index)>i&&(a=e.slice(i,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,c.push({i:o,x:pn(n,r)})),i=fr.lastIndex;return i<e.length&&(a=e.slice(i),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)l[(n=c[r]).i]=n.x(t);return l.join("")})}function mr(t,e){var n;return("number"==typeof e?pn:e instanceof Yn?ur:(n=Yn(e))?(e=n,ur):hr)(t,e)}function pr(t){return function(){this.removeAttribute(t)}}function yr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function gr(t,e,n){var r,a,i=n+"";return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function vr(t,e,n){var r,a,i=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function Er(t,e,n){var r,a,i;return function(){var o,l,c=n(this);if(null!=c)return(o=this.getAttribute(t))===(l=c+"")?null:o===r&&l===a?i:(a=l,i=e(r=o,c));this.removeAttribute(t)}}function _r(t,e,n){var r,a,i;return function(){var o,l,c=n(this);if(null!=c)return(o=this.getAttributeNS(t.space,t.local))===(l=c+"")?null:o===r&&l===a?i:(a=l,i=e(r=o,c));this.removeAttributeNS(t.space,t.local)}}function br(t,e){var n,r;function a(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,a)),n}return a._value=e,a}function Ir(t,e){var n,r;function a(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,a)),n}return a._value=e,a}function Ar(t,e){return function(){fn(this,t).delay=+e.apply(this,arguments)}}function Sr(t,e){return e=+e,function(){fn(this,t).delay=e}}function Cr(t,e){return function(){hn(this,t).duration=+e.apply(this,arguments)}}function Tr(t,e){return e=+e,function(){hn(this,t).duration=e}}var wr=Ve.prototype.constructor;function Or(t){return function(){this.style.removeProperty(t)}}var Nr=0;function Mr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function xr(){return++Nr}var Dr=Ve.prototype;Mr.prototype=function(t){return Ve().transition(t)}.prototype={constructor:Mr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=wt(t));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var l,c,u=r[o],s=u.length,d=i[o]=new Array(s),f=0;f<s;++f)(l=u[f])&&(c=t.call(l,l.__data__,f,u))&&("__data__"in l&&(c.__data__=l.__data__),d[f]=c,dn(d[f],e,n,f,d,mn(l,n)));return new Mr(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Nt(t));for(var r=this._groups,a=r.length,i=[],o=[],l=0;l<a;++l)for(var c,u=r[l],s=u.length,d=0;d<s;++d)if(c=u[d]){for(var f,h=t.call(c,c.__data__,d,u),m=mn(c,n),p=0,y=h.length;p<y;++p)(f=h[p])&&dn(f,e,n,p,h,m);i.push(h),o.push(c)}return new Mr(i,o,e,n)},selectChild:Dr.selectChild,selectChildren:Dr.selectChildren,filter:function(t){"function"!=typeof t&&(t=Mt(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o=e[a],l=o.length,c=r[a]=[],u=0;u<l;++u)(i=o[u])&&t.call(i,i.__data__,u,o)&&c.push(i);return new Mr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,a=n.length,i=Math.min(r,a),o=new Array(r),l=0;l<i;++l)for(var c,u=e[l],s=n[l],d=u.length,f=o[l]=new Array(d),h=0;h<d;++h)(c=u[h]||s[h])&&(f[h]=c);for(;l<r;++l)o[l]=e[l];return new Mr(o,this._parents,this._name,this._id)},selection:function(){return new wr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=xr(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o,l=r[i],c=l.length,u=0;u<c;++u)if(o=l[u]){var s=mn(o,e);dn(o,t,n,u,l,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new Mr(r,this._parents,t,n)},call:Dr.call,nodes:Dr.nodes,node:Dr.node,size:Dr.size,empty:Dr.empty,each:Dr.each,on:function(t,e){var n=this._id;return arguments.length<2?mn(this.node(),n).on.on(t):this.each(function(t,e,n){var r,a,i=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?fn:hn;return function(){var o=i(this,t),l=o.on;l!==r&&(a=(r=l).copy()).on(e,n),o.on=a}}(n,t,e))},attr:function(t,e){var n=Gt(t),r="transform"===n?In:mr;return this.attrTween(t,"function"==typeof e?(n.local?_r:Er)(n,r,Cn(this,"attr."+t,e)):null==e?(n.local?yr:pr)(n):(n.local?vr:gr)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Gt(t);return this.tween(n,(r.local?br:Ir)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?bn:mr;return null==e?this.styleTween(t,function(t,e){var n,r,a;return function(){var i=ne(this,t),o=(this.style.removeProperty(t),ne(this,t));return i===o?null:i===n&&o===r?a:a=e(n=i,r=o)}}(t,r)).on("end.style."+t,Or(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,a,i;return function(){var o=ne(this,t),l=n(this),c=l+"";return null==l&&(this.style.removeProperty(t),c=l=ne(this,t)),o===c?null:o===r&&c===a?i:(a=c,i=e(r=o,l))}}(t,r,Cn(this,"style."+t,e))).each(function(t,e){var n,r,a,i,o="style."+e,l="end."+o;return function(){var c=hn(this,t),u=c.on,s=null==c.value[o]?i||(i=Or(e)):void 0;u===n&&a===s||(r=(n=u).copy()).on(l,a=s),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,a,i=n+"";return function(){var o=ne(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,a;function i(){var i=e.apply(this,arguments);return i!==a&&(r=(a=i)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,i,n)),r}return i._value=e,i}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Cn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,a=mn(this.node(),n).tween,i=0,o=a.length;i<o;++i)if((r=a[i]).name===t)return r.value;return null}return this.each((null==e?An:Sn)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ar:Sr)(e,t)):mn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Cr:Tr)(e,t)):mn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){hn(this,t).ease=e}}(e,t)):mn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;hn(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,a=n.size();return new Promise(function(i,o){var l={value:o},c={value:function(){0===--a&&i()}};n.each(function(){var n=hn(this,r),a=n.on;a!==t&&((e=(t=a).copy())._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),n.on=e}),0===a&&i()})},[Symbol.iterator]:Dr[Symbol.iterator]};var Rr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Pr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Ve.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,r,a,i=t.__transition,o=!0;if(i){for(a in e=null==e?null:e+"",i)(n=i[a]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[a]):o=!1;o&&delete t.__transition}}(this,t)})},Ve.prototype.transition=function(t){var e,n;t instanceof Mr?(e=t._id,t=t._name):(e=xr(),(n=Rr).time=tn(),t=null==t?null:t+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o,l=r[i],c=l.length,u=0;u<c;++u)(o=l[u])&&dn(o,t,e,u,l,n||Pr(o,e));return new Mr(r,this._parents,t,e)};const{abs:Lr,max:jr,min:Vr}=Math;function Fr(t){return{type:t}}function kr(t){return"string"==typeof t?new Le([[document.querySelector(t)]],[document.documentElement]):new Le([[t]],Pe)}function Br(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Fr),["n","s"].map(Fr),["n","w","e","s","nw","ne","sw","se"].map(Fr);const Kr={passive:!1},Hr={capture:!0,passive:!1};function Ur(t){t.stopImmediatePropagation()}function Yr(t){t.preventDefault(),t.stopImmediatePropagation()}const Gr=t=>()=>t;function zr(t,{sourceEvent:e,subject:n,target:r,identifier:a,active:i,x:o,y:l,dx:c,dy:u,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:s}})}function Wr(t){return!t.ctrlKey&&!t.button}function $r(){return this.parentNode}function Xr(t,e){return null==e?{x:t.x,y:t.y}:e}function Zr(){return navigator.maxTouchPoints||"ontouchstart"in this}function qr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}zr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};class Qr extends Map{constructor(t,e=ta){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Jr(this,t))}has(t){return super.has(Jr(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}(this,t))}}function Jr({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function ta(t){return null!==t&&"object"==typeof t?t.valueOf():t}Set;const ea=Symbol("implicit");function na(){var t=new Qr,e=[],n=[],r=ea;function a(a){let i=t.get(a);if(void 0===i){if(r!==ea)return r;t.set(a,i=e.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Qr;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return a},a.range=function(t){return arguments.length?(n=Array.from(t),a):n.slice()},a.unknown=function(t){return arguments.length?(r=t,a):r},a.copy=function(){return na(e,n).unknown(r)},qr.apply(a,arguments),a}function ra(){var t,e,n=na().unknown(void 0),r=n.domain,a=n.range,i=0,o=1,l=!1,c=0,u=0,s=.5;function d(){var n=r().length,d=o<i,f=d?o:i,h=d?i:o;t=(h-f)/Math.max(1,n-c+2*u),l&&(t=Math.floor(t)),f+=(h-f-t*(n-c))*s,e=t*(1-c),l&&(f=Math.round(f),e=Math.round(e));var m=function(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),i=new Array(a);++r<a;)i[r]=t+r*n;return i}(n).map(function(e){return f+t*e});return a(d?m.reverse():m)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),d()):r()},n.range=function(t){return arguments.length?([i,o]=t,i=+i,o=+o,d()):[i,o]},n.rangeRound=function(t){return[i,o]=t,i=+i,o=+o,l=!0,d()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(l=!!t,d()):l},n.padding=function(t){return arguments.length?(c=Math.min(1,u=+t),d()):c},n.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),d()):c},n.paddingOuter=function(t){return arguments.length?(u=+t,d()):u},n.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),d()):s},n.copy=function(){return ra(r(),[i,o]).round(l).paddingInner(c).paddingOuter(u).align(s)},qr.apply(d(),arguments)}const aa=Math.sqrt(50),ia=Math.sqrt(10),oa=Math.sqrt(2);function la(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),o=i>=aa?10:i>=ia?5:i>=oa?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?la(t,e,2*n):[l,c,u]}function ca(t,e,n){return la(t=+t,e=+e,n=+n)[2]}function ua(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sa(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function da(t){let e,n,r;function a(t,r,a=0,i=t.length){if(a<i){if(0!==e(r,r))return i;do{const e=a+i>>>1;n(t[e],r)<0?a=e+1:i=e}while(a<i)}return a}return 2!==t.length?(e=ua,n=(e,n)=>ua(t(e),n),r=(e,n)=>t(e)-n):(e=t===ua||t===sa?t:fa,n=t,r=t),{left:a,center:function(t,e,n=0,i=t.length){const o=a(t,e,n,i-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r,a=0,i=t.length){if(a<i){if(0!==e(r,r))return i;do{const e=a+i>>>1;n(t[e],r)<=0?a=e+1:i=e}while(a<i)}return a}}}function fa(){return 0}const ha=da(ua),ma=ha.right,pa=(ha.left,da(function(t){return null===t?NaN:+t}).center,ma);function ya(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=_a(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<a;++n)o[n]=i[n](t);return o}}function ga(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function va(t,e){var n,r={},a={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=_a(t[n],e[n]):a[n]=e[n];return function(t){for(n in r)a[n]=r[n](t);return a}}function Ea(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(i){for(n=0;n<r;++n)a[n]=t[n]*(1-i)+e[n]*i;return a}}function _a(t,e){var n,r,a=typeof e;return null==e||"boolean"===a?lr(e):("number"===a?pn:"string"===a?(n=Yn(e))?(e=n,ur):hr:e instanceof Yn?ur:e instanceof Date?ga:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?ya:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?va:pn:Ea))(t,e)}function ba(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Ia(t){return+t}var Aa=[0,1];function Sa(t){return t}function Ca(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ta(t,e,n){var r=t[0],a=t[1],i=e[0],o=e[1];return a<r?(r=Ca(a,r),i=n(o,i)):(r=Ca(r,a),i=n(i,o)),function(t){return i(r(t))}}function wa(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),i=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)a[o]=Ca(t[o],t[o+1]),i[o]=n(e[o],e[o+1]);return function(e){var n=pa(t,e,1,r)-1;return i[n](a[n](e))}}var Oa,Na=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ma(t){if(!(e=Na.exec(t)))throw new Error("invalid format: "+t);var e;return new xa({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function xa(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Da(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Ra(t){return(t=Da(Math.abs(t)))?t[1]:NaN}function Pa(t,e){var n=Da(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Ma.prototype=xa.prototype,xa.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const La={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Pa(100*t,e),r:Pa,s:function(t,e){var n=Da(t,e);if(!n)return t+"";var r=n[0],a=n[1],i=a-(Oa=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Da(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ja(t){return t}var Va,Fa,ka,Ba=Array.prototype.map,Ka=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ha(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[a,i,o]=r?la(e,t,n):la(t,e,n);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(r)if(o<0)for(let t=0;t<l;++t)c[t]=(i-t)/-o;else for(let t=0;t<l;++t)c[t]=(i-t)*o;else if(o<0)for(let t=0;t<l;++t)c[t]=(a+t)/-o;else for(let t=0;t<l;++t)c[t]=(a+t)*o;return c}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var a,i=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),a=r?ca(e,t,n):ca(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}(t,e,n);switch((r=Ma(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(a=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ra(e)/3)))-Ra(Math.abs(t)))}(i,o))||(r.precision=a),ka(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ra(e)-Ra(t))+1}(i,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(t){return Math.max(0,-Ra(Math.abs(t)))}(i))||(r.precision=a-2*("%"===r.type))}return Fa(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,a,i=e(),o=0,l=i.length-1,c=i[o],u=i[l],s=10;for(u<c&&(a=c,c=u,u=a,a=o,o=l,l=a);s-- >0;){if((a=ca(c,u,n))===r)return i[o]=c,i[l]=u,e(i);if(a>0)c=Math.floor(c/a)*a,u=Math.ceil(u/a)*a;else{if(!(a<0))break;c=Math.ceil(c*a)/a,u=Math.floor(u*a)/a}r=a}return t},t}function Ua(){var t=function(){var t,e,n,r,a,i,o=Aa,l=Aa,c=_a,u=Sa;function s(){var t,e,n,c=Math.min(o.length,l.length);return u!==Sa&&(t=o[0],e=o[c-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=c>2?wa:Ta,a=i=null,d}function d(e){return null==e||isNaN(e=+e)?n:(a||(a=r(o.map(t),l,c)))(t(u(e)))}return d.invert=function(n){return u(e((i||(i=r(l,o.map(t),pn)))(n)))},d.domain=function(t){return arguments.length?(o=Array.from(t,Ia),s()):o.slice()},d.range=function(t){return arguments.length?(l=Array.from(t),s()):l.slice()},d.rangeRound=function(t){return l=Array.from(t),c=ba,s()},d.clamp=function(t){return arguments.length?(u=!!t||Sa,s()):u!==Sa},d.interpolate=function(t){return arguments.length?(c=t,s()):c},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,s()}}()(Sa,Sa);return t.copy=function(){return e=t,Ua().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},qr.apply(t,arguments),Ha(t)}function Ya(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ga(t){return function(){return t}}function za(t){this._context=t}function Wa(t){return new za(t)}Va=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ja:(e=Ba.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var a=t.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),i.push(t.substring(a-=l,a+l)),!((c+=l+1)>r));)l=e[o=(o+1)%e.length];return i.reverse().join(n)}),a=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?ja:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Ba.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",s=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=Ma(t)).fill,n=t.align,d=t.sign,f=t.symbol,h=t.zero,m=t.width,p=t.comma,y=t.precision,g=t.trim,v=t.type;"n"===v?(p=!0,v="g"):La[v]||(void 0===y&&(y=12),g=!0,v="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var E="$"===f?a:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_="$"===f?i:/[%p]/.test(v)?c:"",b=La[v],I=/[defgprs%]/.test(v);function A(t){var a,i,c,f=E,A=_;if("c"===v)A=b(t)+A,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?s:b(Math.abs(t),y),g&&(t=function(t){t:for(var e,n=t.length,r=1,a=-1;r<n;++r)switch(t[r]){case".":a=e=r;break;case"0":0===a&&(a=r),e=r;break;default:if(!+t[r])break t;a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==d&&(S=!1),f=(S?"("===d?d:u:"-"===d||"("===d?"":d)+f,A=("s"===v?Ka[8+Oa/3]:"")+A+(S&&"("===d?")":""),I)for(a=-1,i=t.length;++a<i;)if(48>(c=t.charCodeAt(a))||c>57){A=(46===c?o+t.slice(a+1):t.slice(a))+A,t=t.slice(0,a);break}}p&&!h&&(t=r(t,1/0));var C=f.length+t.length+A.length,T=C<m?new Array(m-C+1).join(e):"";switch(p&&h&&(t=r(T+t,T.length?m-A.length:1/0),T=""),n){case"<":t=f+t+A+T;break;case"=":t=f+T+t+A;break;case"^":t=T.slice(0,C=T.length>>1)+f+t+A+T.slice(C);break;default:t=T+f+t+A}return l(t)}return y=void 0===y?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),A.toString=function(){return t+""},A}return{format:d,formatPrefix:function(t,e){var n=d(((t=Ma(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Ra(e)/3))),a=Math.pow(10,-r),i=Ka[8+r/3];return function(t){return n(a*t)+i}}}}({thousands:",",grouping:[3],currency:["$",""]}),Fa=Va.format,ka=Va.formatPrefix,Array.prototype.slice,za.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const $a=Math.PI,Xa=2*$a,Za=1e-6,qa=Xa-Za;function Qa(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Ja{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Qa:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Qa;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,a,i){this._append`C${+t},${+e},${+n},${+r},${this._x1=+a},${this._y1=+i}`}arcTo(t,e,n,r,a){if(t=+t,e=+e,n=+n,r=+r,(a=+a)<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,l=n-t,c=r-e,u=i-t,s=o-e,d=u*u+s*s;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(d>Za)if(Math.abs(s*l-c*u)>Za&&a){let f=n-i,h=r-o,m=l*l+c*c,p=f*f+h*h,y=Math.sqrt(m),g=Math.sqrt(d),v=a*Math.tan(($a-Math.acos((m+d-p)/(2*y*g)))/2),E=v/g,_=v/y;Math.abs(E-1)>Za&&this._append`L${t+E*u},${e+E*s}`,this._append`A${a},${a},0,0,${+(s*f>u*h)},${this._x1=t+_*l},${this._y1=e+_*c}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,a,i){if(t=+t,e=+e,i=!!i,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),l=n*Math.sin(r),c=t+o,u=e+l,s=1^i,d=i?r-a:a-r;null===this._x1?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Za||Math.abs(this._y1-u)>Za)&&this._append`L${c},${u}`,n&&(d<0&&(d=d%Xa+Xa),d>qa?this._append`A${n},${n},0,1,${s},${t-o},${e-l}A${n},${n},0,1,${s},${this._x1=c},${this._y1=u}`:d>Za&&this._append`A${n},${n},0,${+(d>=$a)},${s},${this._x1=t+n*Math.cos(a)},${this._y1=e+n*Math.sin(a)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function ti(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new Ja(e)}function ei(t){return t[0]}function ni(t){return t[1]}function ri(t,e){var n=Ga(!0),r=null,a=Wa,i=null,o=ti(l);function l(l){var c,u,s,d=(l=Ya(l)).length,f=!1;for(null==r&&(i=a(s=o())),c=0;c<=d;++c)!(c<d&&n(u=l[c],c,l))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+t(u,c,l),+e(u,c,l));if(s)return i=null,s+""||null}return t="function"==typeof t?t:void 0===t?ei:Ga(t),e="function"==typeof e?e:void 0===e?ni:Ga(e),l.x=function(e){return arguments.length?(t="function"==typeof e?e:Ga(+e),l):t},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Ga(+t),l):e},l.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ga(!!t),l):n},l.curve=function(t){return arguments.length?(a=t,null!=r&&(i=a(r)),l):a},l.context=function(t){return arguments.length?(null==t?r=i=null:i=a(r=t),l):r},l}function ai(t,e,n){var r=null,a=Ga(!0),i=null,o=Wa,l=null,c=ti(u);function u(u){var s,d,f,h,m,p=(u=Ya(u)).length,y=!1,g=new Array(p),v=new Array(p);for(null==i&&(l=o(m=c())),s=0;s<=p;++s){if(!(s<p&&a(h=u[s],s,u))===y)if(y=!y)d=s,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),f=s-1;f>=d;--f)l.point(g[f],v[f]);l.lineEnd(),l.areaEnd()}y&&(g[s]=+t(h,s,u),v[s]=+e(h,s,u),l.point(r?+r(h,s,u):g[s],n?+n(h,s,u):v[s]))}if(m)return l=null,m+""||null}function s(){return ri().defined(a).curve(o).context(i)}return t="function"==typeof t?t:void 0===t?ei:Ga(+t),e="function"==typeof e?e:Ga(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?ni:Ga(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:Ga(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:Ga(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Ga(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:Ga(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:Ga(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Ga(+t),u):n},u.lineX0=u.lineY0=function(){return s().x(t).y(e)},u.lineY1=function(){return s().x(t).y(n)},u.lineX1=function(){return s().x(r).y(e)},u.defined=function(t){return arguments.length?(a="function"==typeof t?t:Ga(!!t),u):a},u.curve=function(t){return arguments.length?(o=t,null!=i&&(l=o(i)),u):o},u.context=function(t){return arguments.length?(null==t?i=l=null:l=o(i=t),u):i},u}function ii(t){return t<0?-1:1}function oi(t,e,n){var r=t._x1-t._x0,a=e-t._x1,i=(t._y1-t._y0)/(r||a<0&&-0),o=(n-t._y1)/(a||r<0&&-0),l=(i*a+o*r)/(r+a);return(ii(i)+ii(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function li(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ci(t,e,n){var r=t._x0,a=t._y0,i=t._x1,o=t._y1,l=(i-r)/3;t._context.bezierCurveTo(r+l,a+l*e,i-l,o-l*n,i,o)}function ui(t){this._context=t}function si(t){this._context=t}function di(t){return new ui(t)}function fi(t,e,n){this.k=t,this.x=e,this.y=n}function hi(t){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hi(t)}function mi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function pi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mi(Object(n),!0).forEach(function(e){yi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mi(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function yi(t,e,n){return(e=function(t){var e=function(t){if("object"!=hi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==hi(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ui.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ci(this,this._t0,li(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ci(this,li(this,n=oi(this,t,e)),n);break;default:ci(this,this._t0,n=oi(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(function(t){this._context=new si(t)}.prototype=Object.create(ui.prototype)).point=function(t,e){ui.prototype.point.call(this,e,t)},si.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,i){this._context.bezierCurveTo(e,t,r,n,i,a)}},fi.prototype={constructor:fi,scale:function(t){return 1===t?this:new fi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new fi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new fi(1,0,0),fi.prototype,mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var gi=function(t,e,n,r){var a=t.xScale,i=t.yScale,o=ri().curve(di).x(function(t){return a(t.index)}).y(function(t){return i(t.value)});e.append("path").datum(n).attr("fill","none").attr("stroke",r).attr("stroke-width",1.5).attr("d",o)},vi=function(t,e,n){t.attr("width",0).transition().duration(n).attr("width",e)},Ei=function(t,e,n,a){var i=e.xScale,o=e.yScale,l=t.append("circle").attr("class","trend-graph__tooltip-marker").attr("fill",r);return{tooltipHandler:function(t){var e,r=t.detail,c=r.evt,u=r.returnObject,s=c.e.offsetX||c.layerX||0,d=Math.round(i.invert(s));parseFloat(l.attr("cx"))!==i(d)&&l.attr("cx",i(d)).attr("cy",o(n[d].value)).attr("r",0).transition().duration(300).attr("r",5),u.graphicModel=null===(e=a[d])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){l.transition().duration(0).attr("r",0)}}};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var _i=function(t,e,n,r){var a=e.xBarScale,i=t.selectAll(".trend__bar"),o=a.step();return{tooltipHandler:function(t){var e,a,l,c,u=t.detail,s=u.evt,d=u.returnObject,f=(c=(null===(l=(a=s).e)||void 0===l?void 0:l.offsetX)||a.layerX,Math.floor(c/o));i.attr("fill-opacity",n),kr(i.nodes()[f]).attr("fill-opacity",.4*n),d.graphicModel=null===(e=r[f])||void 0===e?void 0:e.graphicModel},resetHighlight:function(){i.attr("fill-opacity",n)}}};function bi(t){return function(t){if(Array.isArray(t))return Ii(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ii(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ii(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Ai=g.TREND_SHAPE,Si=Ai.LINE,Ci=Ai.AREA,Ti=Ai.BAR;var wi=function(t,e,n,r,a,i,o){var l=t.cardDimensions,c=l.cardWidth,u=l.cardHeight,s=o.minValue,d=o.maxValue,f=r/100,h=(n?24:28)/100*(u-2),m=a===Ti?.01*h:5,p=c-2,y=null!=i&&i.value?Math.min(s,i.value):s,g=function(t,e,n,r,a,i){var o=Ua().domain([0,t.length-1]).range([0,e]),l=Ua().domain([n,r>=0?r:0]).range([a-i,i]),c=ra().domain(t.map(function(t,e){return e})).range([0,e]).padding(.1).align(.5);return{xScale:o,yScale:l,xBarScale:c,heightScale:function(t){return Math.abs(l(0)-l(t))},barYScale:function(t){return l(t>=0?t:0)}}}(e,p,y,null!=i&&i.value?Math.max(d,i.value):d,h,m);return{scales:g,graphData:e.map(function(t,e){return{index:e,value:t.raw}}),trendFillOpacityFraction:f,trendWidth:p,scaledMinValue:y,trendVerticalMargin:m,SVGHeight:h}};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Oi=function(t,e,n,r){var a=t.sourceEvent||t;if(!e.isAndroid||!a.target.classList.contains("trend__body")){Li(e);var i=e.selectedCardsGraphicModels;if(e.clearSelections(),e.isIOS&&(e.handleContextMenuSelection(a),e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")})),i=Ri(a,i,n),e.selectedCardsGraphicModels=i,Pi(e),"A"===(null==r?void 0:r.tagName)&&window.open(r.href,"_blank"),i.length>0){var o=l(e.KPIType),c=D(e,o.TREND),u=D(e,o.BREAK_BY);(c||u)&&Ni(e,i)}else Mi(e,n)}},Ni=function(t,e){t.isIOS?e.forEach(function(t){var e=t.getSelector();e.messageType="selection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(e)}):t.applySelection(e.map(function(t){return t.getSelector()}))},Mi=function(t,e){if(t.isIOS){var n=e.getSelector();n.messageType="deselection",window.webkit.messageHandlers.selectionDataJSONString.postMessage(n)}else t.clearSelections(),t.endSelections()},xi=function(t){var e=t.cardId;return document.getElementById(mstrmojo.string.encodeHtmlString(e))},Di=function(t){null==t||t.classList.remove("card--selected"),null==t||t.classList.remove("card--unselected"),null==t||t.classList.remove("card--selected-no-hover")},Ri=function(t,e,n){var r=e.map(function(t){return t.cardId}),a=r.indexOf(n.cardId);if(!0===t.ctrlKey||!0===t.metaKey)-1!==a?e.splice(a,1):e.push(n);else{var i=-1===a||r.length>1&&-1!==a;e.length=0,i&&e.push(n)}return e},Pi=function(t,e){var n=t.selectedCardsGraphicModels,r=t.isSingleCardDisplayed;if(null!=e&&e.length&&(n=e),t.getGraphicModels().forEach(function(t){var e=xi(t);r?null==e||e.classList.add("card--no-hover"):null==e||e.classList.remove("card--no-hover")}),0!==n.length){var a=n.map(function(t){return t.cardId});t.getGraphicModels().forEach(function(t){var e=xi(t);a.includes(t.cardId)?null!=e&&e.classList.contains("card--selected-context-menu")||function(t,e){null==t||t.classList.add(e?"card--selected-no-hover":"card--selected"),null==t||t.classList.remove("card--unselected")}(e,r):function(t,e){null==t||t.classList.remove("card--selected"),e||null==t||t.classList.add("card--unselected")}(e,r)})}else t.getGraphicModels().forEach(function(t){var e=xi(t);Di(e)})},Li=function(t){t.contextMenuCardsGraphicModels.forEach(function(t){var e=xi(t);null==e||e.classList.remove("card--selected-context-menu")}),t.contextMenuCardsGraphicModels=[]};function ji(t){return function(t){if(Array.isArray(t))return Vi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Vi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Fi=function(t,e){return{tag:"button",content:"",classes:["controls__dot-indicator"],style:{color:e},otherAttributes:{id:t}}},ki=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{tag:"button",classes:["controls__".concat(t,"-arrow")].concat(ji(n),ji(r)),content:e}};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Bi=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r='<path fill="'.concat(t,'" fill-rule="nonzero" d="M11.2180716,2.07107347 L4.91484044,2.07107347 C4.44372309,2.07107347 4.06183057,2.45296599 4.06183057,2.92408334 C4.06183057,3.39520069 4.44372309,3.77709321 4.91484044,3.77709321 L9.15869251,3.77709321 L2.32092272,10.6149056 C1.98777972,10.9480487 1.98777972,11.4881319 2.32092272,11.8212322 C2.65402308,12.1543326 3.19410628,12.1543752 3.52724928,11.8212322 L10.3650617,4.98341977 L10.3650617,9.22727184 C10.3650617,9.69838919 10.7469542,10.0802817 11.2180716,10.0802817 C11.6891889,10.0802817 12.0710815,9.69838919 12.0710815,9.22727184 L12.0710815,2.92408334 C12.0710815,2.45983272 11.6937952,2.07107347 11.2180716,2.07107347 Z" transform="translate(7.071073, 7.071073)\n\trotate(').concat(1===e?"-45.0":"135.0",') translate(-7.071073, -7.071073)"></path>');return n?r:'<svg class="trend-indicator__icon" width="14pt" height="14pt" viewBox="0 0 14 14">'.concat(r,"</svg>")},Ki=function(t,e,n,r){var a,i=e.trendIncreaseBackgroundColor,o=e.trendDecreaseBackgroundColor,l=e.trendConstantBackgroundColor,u=e.trendIndicatorShape,s=e.trendIndicatorValueType,d=g.TREND_INDICATOR_SHAPE.BADGE,f=g.TREND_INDICATOR_VALUE_TYPE.NUMERIC,h=null===(a=r[5])||void 0===a?void 0:a.color;return 0===t?{indicatorColor:null!=h?h:l,valueSign:"",arrowType:null}:t<0?{indicatorColor:null!=h?h:o,valueSign:n===c||s===f?"":"-",arrowType:-1}:{indicatorColor:null!=h?h:i,valueSign:n===c||u!==d?"":"+",arrowType:1}};function Hi(t){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(t)}function Ui(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Yi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ui(Object(n),!0).forEach(function(e){Gi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ui(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Gi(t,e,n){return(e=function(t){var e=function(t){if("object"!=Hi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Hi(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var zi="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjMiIHZpZXdCb3g9IjAgMCAyMyAyMyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMS44NjEzNyIgeT0iMS41ODA3MyIgd2lkdGg9IjE5Ljg0IiBoZWlnaHQ9IjE5Ljg0IiByeD0iMi44OCIgc3Ryb2tlPSIjQTlBREIxIiBzdHJva2Utd2lkdGg9IjEuOTIiLz4KPHBhdGggZD0iTTE1Ljg1NDcgMTAuMDMzOEMxNi42MzA4IDkuNDA0ODIgMTcuNzQxNSA5LjQzMzU5IDE4LjQ4NDQgMTAuMTAyNEwyMi42NjE0IDEzLjg2NDFWMTguNTQwN0MyMi42NjE0IDIwLjY2MTUgMjAuOTQyMSAyMi4zODA3IDE4LjgyMTQgMjIuMzgwN0g0Ljc0MTM3QzIuNjIwNTkgMjIuMzgwNyAwLjkwMTM2NyAyMC42NjE1IDAuOTAxMzY3IDE4LjU0MDdWMTYuNjIwOEw0LjgyMDY2IDEzLjE0ODNDNS40MTExNSAxMi42MjUyIDYuMjQ1NzcgMTIuNDkxMSA2Ljk2NjkxIDEyLjgwMzlMOC42NTQ5NiAxMy41MzcyQzkuODA3NzQgMTQuMDM3NiAxMS4xMzk0IDEzLjg1NDYgMTIuMTE4NyAxMy4wNjA5TDE1Ljg1NDcgMTAuMDMzOFoiIGZpbGw9IiNBOUFEQjEiLz4KPGNpcmNsZSBjeD0iNy4zMDA4NiIgY3k9IjYuMzgwNzQiIHI9IjEuOTIiIGZpbGw9IiNBOUFEQjEiLz4KPC9zdmc+Cg==";function Wi(t){return Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wi(t)}function $i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Xi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$i(Object(n),!0).forEach(function(e){Zi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$i(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Zi(t,e,n){return(e=function(t){var e=function(t){if("object"!=Wi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Wi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wi(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var qi=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=document.createElement("div");i.classList.add("card__img-wrapper");var o=document.createElement("div");o.classList.add("card__img-container"),i.appendChild(o);var l=document.createElement("div");l.classList.add("icon-img");var c,u,s=t||zi;return u=s,z.test(u)?s="".concat(mstrmojo.getStyleRoot(),"/..").concat(s):null!==(e=s)&&void 0!==e&&e.startsWith("http")||(c=s)&&(c.startsWith("data:image/svg+xml;base64,")||c.startsWith("data:image/png;base64,")||c.startsWith("data:image/jpeg;base64,")||c.startsWith("data:image/gif;base64,")||c.startsWith("data:image/webp;base64,")||c.startsWith("data:image/bmp;base64,"))||(s="".concat(mstrmojo.getStyleRoot(),"/../images/material-symbols/400/rounded/").concat(s)),function(t){return!!t&&(t.endsWith(".svg")||function(t){if(!t)return!1;if(t.endsWith(".svg"))return!0;if(t.startsWith("data:image/svg+xml;base64,"))return!0;if(t.match(/^data:image\/(jpeg|jpg|png|gif|webp|bmp);base64,/))return!1;try{var e=t.replace(/^data:image\/[^;]+;base64,/,""),n=atob(e).trim().toLowerCase();return n.startsWith("<svg")||n.includes("<svg")}catch(t){return!1}}(t))}(s)?(l.style.maskImage="url(".concat(s,")"),l.style.maskSize="contain",l.style.maskRepeat="no-repeat",l.style.maskPosition="center",l.style.backgroundColor=s===zi?G(a,100):G(n,r)):(l.style.background="url(".concat(s,")"),l.style.backgroundSize="contain",l.style.backgroundRepeat="no-repeat",l.style.backgroundPosition="center"),o.appendChild(l),i},Qi=function(t,e,n,r){var a,i,o,l,c,s,d,f,h,m,p,y,v,E,_=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],b=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],I=e.isComparisonKPI,A=e.isRealTime,S=e.cardProperties,C=t.secondaryValue,T=t.indicator,w=t.trend,O=t.trendChartData,N=t.graphicModel,M=t.referenceLine,x=t.thresholdTarget,D=t.trendAttributeFormType,R=t.metricFormType,L=n.secondaryValueFontOptions,V=n.trendIndicatorEnabled,k=n.comparisonIndicatorEnabled,B=S.cssModifiers,K=S.isTrendIndicatorOnTop,H=S.showSecondaryValue,U=S.isComparisonMetricAdded,Y=N.cardId,G=[];if(C&&H&&_)if(i=function(t,e,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=t.label,c=t.value;a&&(c+="");var u=l?"".concat(l,": ").concat(c):c,s=P(n,r),d=Ct(function(t,e,n,r){var a=n.cardElementsModifier,i=n.indicatorPosition,o=n.cardAlignment,l=n.cardDirection;return r[4]&&(t.color=r[4].color),{classes:["card__secondary-value","card__secondary-value--".concat(a),"card__secondary-value--".concat(i),"card__secondary-value--".concat(o),"card__secondary-value--".concat(l)],content:e,style:t}}(s,u,e,i),!0,o);return d.secondaryValueData={labelTitle:l,labelValue:c,wholeLabel:u,shouldSanitizeSecondaryValue:o},d}(C,B,L,e,U,x,D===(null!==(h=null===(m=mstrmojo)||void 0===m||null===(p=m.chart)||void 0===p||null===(y=p.model)||void 0===y||null===(v=y.enums)||void 0===v||null===(E=v.EnumDSSBaseFormType)||void 0===E?void 0:E.DssBaseFormHTMLTag)&&void 0!==h?h:7)||void 0!==R),e.components.cardSecondaryValues.push(i),A&&(e.parsedData[r].secondaryValueComponentIndex=e.components.cardSecondaryValues.length-1,e.isSecondaryLabelUpdated=!0),U){var z=Ct((s=(c=B).cardAlignment,d=c.cardDirection,{tag:"div",classes:["card__secondary-value-with-indicator-wrapper","card__secondary-value-with-indicator-wrapper--".concat(s),"card__secondary-value-with-indicator-wrapper--".concat(d)]}));z.append(i),G.push(z),e.components.cardSecondaryValueWithIndicatorWrappers.push(z),k&&(l=function(t,e,n,r){var a=e.indicatorFontOptions,i=e.trendIndicatorValueType,o=t.differenceBetweenPrimaryAndSecondary,l=t[i],c=Ki(o,e,l,r),u=c.indicatorColor,s=c.valueSign,d=P(a,n),f=Ct(function(t,e){return{tag:"div",classes:["card__comparison-indicator"],content:e,style:t}}(Yi(Yi({},d),{},{color:u}),i===g.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(s).concat(l,")"):"".concat(s).concat(l)));return f}(T,n,e,x),z.append(l),e.components.cardIndicators.push(l),e.cardComponentReferences[Y].trendIndicator={cssModifiers:B,indicator:T})}else if(G.push(i),V){o=function(t,e,n,r,a){var i,o=n.trendIndicatorValueType,l=n.trendIndicatorShape,c=n.indicatorFontOptions,u=g.TREND_INDICATOR_VALUE_TYPE.NUMERIC,s=e.differenceBetweenPrimaryAndSecondary,d=mstrmojo.string.encodeHtmlString(e[o]),f=d,h=Ki(s,n,f,{}),m=h.arrowType,p=h.indicatorColor,y=h.valueSign,v="",E=P(c,r),_=null===(i=a[8])||void 0===i?void 0:i.color;if(l===g.TREND_INDICATOR_SHAPE.ARROW){var b=m?Bi(p,m):"";v=o===u?"".concat(b,' <span class="trend-indicator__value---with-icon">').concat(y).concat(d,"</span>"):"".concat(b,' <span class="trend-indicator__value---with-icon">').concat(y," ").concat(d,"</span>"),E.color=null!=_?_:p}else v=d=o===u?"".concat(y).concat(d):"".concat(y," ").concat(d),E.background=null!=_?_:p;return Ct(function(t,e,n,r,a){var i=e.indicatorPosition,o=e.cardElementsModifier,l=e.cardAlignment,c=e.cardDirection;return a[5]&&(t.color=a[5].color),{classes:["card__trend-indicator","card__trend-indicator--".concat(o),"card__trend-indicator--".concat(i),"card__trend-indicator--".concat(l),"card__trend-indicator--".concat(c)],content:r,style:t,otherAttributes:{title:n}}}(E,t,f,v,a),!1)}(B,T,n,e,x);var W="horizontal-card"===B.cardDirection;K&&!W?e.cardComponentReferences[Y].cardBody.append(o):G.push(o),e.components.cardIndicators.push(o),A&&(e.parsedData[r].trendIndicatorComponentIndex=e.components.cardIndicators-1),e.cardComponentReferences[Y].trendIndicator={cssModifiers:B,indicator:T}}if(C&&w&&b){f=Ct(function(t){var e=t.indicatorPosition,n=t.cardDirection;return{classes:["card__trend-graph","card__trend-graph--".concat(e),"card__trend-graph--".concat(n)]}}(B));var $=function(t,e,n,r,a,i,o,l){var c,s=n.minValue,d=n.maxValue,f=i.trendShape,h=i.trendFillColor,m=i.trendFillOpacity;l[6]&&(h=l[6].color,m=null!==(c=l[6].opacity)&&void 0!==c?c:100);var p,y=wi(o,e,r,m,f,a,{minValue:s,maxValue:d}),v=y.scales,E=y.graphData,_=y.trendFillOpacityFraction,b=y.trendWidth,I=y.scaledMinValue,A=y.trendVerticalMargin,S=y.SVGHeight,C=kr(t).append("svg");switch(C.attr("width",b).attr("height",S),f){case Si:gi(v,C,E,j(h,m)),vi(C,b,o.animationDuration),p=Ei(C,v,E,e);break;case Ci:!function(t,e,n,r,a,i,o){var l=t.xScale,c=t.yScale,u="area-gradient-".concat(Math.random().toString(36).substring(7)),s=e.append("defs").append("linearGradient").attr("id",u).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");s.append("stop").attr("offset","0%").attr("stop-color",r).attr("stop-opacity",a),s.append("stop").attr("offset","100%").attr("stop-color",r).attr("stop-opacity","0");var d=ai().curve(di).x(function(t){return l(t.index)}).y1(function(t){return c(t.value)}).y0(i>=0?c(i)+o:c(0));e.append("path").datum(n).attr("fill","url(#".concat(u,")")).attr("stroke","none").attr("d",d)}(v,C,E,h,_,I,A),gi(v,C,E,h),vi(C,b,o.animationDuration),p=Ei(C,v,E,e);break;case Ti:!function(t,e,n,r,a,i){var o=e.xBarScale,l=e.heightScale,c=e.barYScale;t.selectAll("bars").data(n).enter().append("rect").attr("class","trend__bar").attr("x",function(t){return o(t.index)}).attr("y",function(){return c(0)}).attr("width",o.bandwidth()).attr("fill",r).attr("fill-opacity",a).attr("stroke",r).attr("stroke-width",1.5).attr("height",0).transition().duration(i).attr("y",function(t){return c(t.value)}).attr("height",function(t){return l(t.value)})}(C,v,E,h,_,o.animationDuration),p=_i(C,v,_,e)}a&&function(t,e,n,r,a){var i,o=t.line,l=o.color,c=o.shape,s=t.value,d=t.formattedValue,f=t.label,h=t.font,m=P(h,a),p=e.yScale,y=g.SELECTED_REFERENCE_LINE_SHAPE,v=c===y.THICK_LINE_TYPE?2:1;switch(c){case y.DOTTED_LINE_TYPE:i="1 1";break;case y.DASHED_LINE_TYPE:i="3 3";break;case y.THIN_LINE_TYPE:case y.THICK_LINE_TYPE:i="1 0"}n.append("line").attr("stroke",l).attr("x1",0).attr("x2",r).attr("y1",p(s)).attr("y2",p(s)).attr("stroke-width",v).attr("stroke-dasharray",i);var E=f?"".concat(f," ").concat(d):d,_=mstrmojo.VisUtility.measureTextWidth(E+u,pi(pi({},m),{},{lineHeight:1})),b=parseFloat(m.fontSize),I=n.append("text").attr("x",Math.max(r-_-2,2)).attr("y",p(s)-4-b>0?p(s)-4:p(s)+4+b);I.attr("class","card__reference-line-label").text(E).attr("font-family",m.fontFamily).attr("fill",m.color).attr("font-weight",m.fontWeight).attr("font-style",m.fontStyle).attr("text-decoration",m.textDecoration).attr("font-size",m.fontSize);var A=document.createElement("span");if(_>r){var S=F({container:A,maxTextWidth:r-4,textData:{label:f,value:d,connector:" "},fontSize:parseInt(m.fontSize),fontStyle:m}).truncatedLabelWithValue;I.text(S)}A.remove()}(a,v,C,b,o),C.append("rect").attr("x",0).attr("y",0).attr("height",S).attr("width",b).style("fill","transparent").attr("class","trend__body");var T=p,w=T.tooltipHandler,O=T.resetHighlight;return C.on("tooltip",w).on("mouseout",function(){O(),o.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},o.hideTooltip(!1)}),C}(f,O,w,K,M,n,e,x);e.trendSVGs.push($),G.push(f),A&&(e.parsedData[r].trendComponentIndex=e.trendSVGs.length-1)}var X=Ct("div");return X.classList.add("overlay-fill"),e.isMobile||X.classList.add("overlay-fill--not-mobile"),G.push(X),(a=e.cardComponentReferences[Y].cardComponent).append.apply(a,G),_&&(o=I&&U?l:o,e.cardComponentReferences[Y]=Xi(Xi({},e.cardComponentReferences[Y]),{},{cardSecondaryValue:i,cardIndicator:o})),b&&(e.cardComponentReferences[Y]=Xi(Xi({},e.cardComponentReferences[Y]),{},{cardTrendGraph:f,cardTrendGraphData:{trendChartData:[],trend:w,isTrendIndicatorOnTop:K,referenceLine:M,properties:n}})),e.cardComponentReferences[Y].cardComponent};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Ji="slider--sliding",to="controls__dot-indicator--active",eo="prev",no="next",ro="arrow",ao=["ArrowLeft","ArrowRight","Delete","Enter","Backspace","End","Home"],io="small",oo="medium",lo="large",co="-dot-indicator";mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var uo=function(t){var e=t.sliderState,r=t.controlsLayout,a=t.vizHeight,i=t.cardWidth,o=t.cardsCount,l=t.elementRefs,c=t.properties,u=t.slideCard,s=1===c.cardStyle?n.LIGHT:n.NIGHT;return l.controlsContainer=Ct({classes:["controls"]}),r===ro?function(t,e,n,r,a,i,o){var l=function(t){return t===no?'<svg width="18" height="16" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(i,'" points="5 16 13 9 5 2"></polygon></svg>'):'\n\t\t\t<svg width="18px" height="16px" viewBox="0 0 18 16"><polygon id="Fill-3" fill="'.concat(i,'" transform="translate(9.000000, 9.000000) scale(-1, 1) translate(-9.000000, -9.000000) " points="5 16 13 9 5 2"></polygon></svg>\n\t\t')},c=n<150||e<100?io:n>300&&e>300?lo:oo;c===lo?a.controlsContainer.classList.add("controls--arrow-indicators"):a.controlsContainer.classList.add("controls--smaller");var u=["controls__arrow"];c!==lo&&u.push("controls__arrow--smaller");var s=c===io?["controls__prev-arrow--smaller"]:[];a.prevArrowControl=a.controlsContainer.appendChild(Ct(ki(eo,l(eo),u,s),!1)),c!==io&&function(t,e,n,r,a,i){var o=function(t){var e=t.target,r=t.key,a=e.textContent,i=n.toString().length;"ENTER"===r?e.blur():a.length>i&&(e.textContent=a.substring(0,i))},l=t.activeCardIndex,c=["controls__text-indicators"];e===oo&&c.push("controls__text-indicators--smaller"),r.textIndicator=r.controlsContainer.appendChild(Ct({classes:c,style:{color:a}})),r.activeCardTextIndicator=r.textIndicator.appendChild(Ct({classes:["controls__active-card"],content:l,style:{borderBottom:"1px solid ".concat(a)},otherAttributes:{contentEditable:""}})),r.activeCardTextIndicator.addEventListener("keydown",function(e){var n=t.sliding,r=e.key,a=e.shiftKey;isNaN(parseInt(r))&&!ao.includes(r)||a||n?e.preventDefault():o(e)}),r.activeCardTextIndicator.addEventListener("keyup",o),r.activeCardTextIndicator.addEventListener("blur",function(e){var r=t.activeCardIndex,a=e.target,o=parseInt(a.textContent);o>n?a.textContent=r:i(o)}),r.textIndicator.appendChild(Ct({classes:["controls__slash"],content:"/"})),r.textIndicator.appendChild(Ct({classes:["controls__total-cards"],content:n}))}(t,c,r,a,i,o),a.nextArrowControl=a.controlsContainer.appendChild(Ct(ki(no,l(no),u),!1)),a.prevArrowControl.addEventListener("click",function(){return o(t.activeCardIndex-1)}),a.nextArrowControl.addEventListener("click",function(){return o(t.activeCardIndex+1)})}(e,a,i,o,l,s,u):function(t,e,n,r,a){var i=g.FIRST_CARD_INDEX,o=t.activeCardIndex;n.controlsContainer.classList.add("controls--dot-indicators");for(var l=i;l<=e;l++){var c="".concat(l).concat(co),u=n.controlsContainer.appendChild(Ct(Fi(c,r)));l===o&&u.classList.add(to)}n.controlsContainer.addEventListener("click",function(e){var n=t.activeCardIndex,r=e.target;if(r.classList.contains("controls__dot-indicator")){var i=parseInt(r.id);if(i===n)return;a(i)}})}(e,o,l,s,u),l.controlsContainer};function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}function fo(t,e,n){return(e=function(t){var e=function(t){if("object"!=so(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=so(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==so(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var ho={CARD_LABELS:"cardLabels",CARD_PRIMARY_VALUES:"cardPrimaryValues",CARD_SECONDARY_VALUES:"cardSecondaryValues",CARD_BODIES:"cardBodies",CARD_INDICATORS:"cardIndicators",CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS:"cardSecondaryValueWithIndicatorWrappers"},mo=fo(fo(fo(fo({},ho.CARD_LABELS,"labelFontOptions"),ho.CARD_PRIMARY_VALUES,"primaryValueFontOptions"),ho.CARD_SECONDARY_VALUES,"secondaryValueFontOptions"),ho.CARD_INDICATORS,"indicatorFontOptions");function po(t){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},po(t)}function yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function go(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function vo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?go(Object(n),!0).forEach(function(e){Eo(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):go(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Eo(t,e,n){return(e=function(t){var e=function(t){if("object"!=po(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=po(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==po(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ho.CARD_LABELS,ho.CARD_PRIMARY_VALUES,ho.CARD_SECONDARY_VALUES,ho.CARD_INDICATORS,mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var _o=function(t,e,n,r,a,i){var o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=u.sliding,a=u.activeCardIndex,o=i.intervalAutoPlayId;r||e===a||(!n&&o&&(clearInterval(o),i.intervalAutoPlayId=null),u.sliding=!0,u.activeCardIndex=e,s.slider.classList.add(Ji),s.slider.style.transform="translate(-".concat(t*e,"px)"))},l=function(){i.intervalAutoPlayId=setInterval(function(){var t=i.tooltipInfo,e=i.autoPlayEnabled,n=u.sliding;!e||n||t.isVisible||o(u.activeCardIndex+1,!0)},3400)},c=a.activeCardIndex,u={activeCardIndex:i.activeCardIndex||c,sliding:!1},s={vizContainer:null,slider:null,clonedFirstCard:null,clonedLastCard:null,controlsContainer:null,prevArrowControl:null,nextArrowControl:null,textIndicator:null,activeCardTextIndicator:null};u.activeCardIndex>n&&(u.activeCardIndex=n);var d=30*n>t?ro:"dot";return a.stackedAutoPlay&&l(),s.vizContainer=Ct({tag:"div",classes:["stacked-container"],style:{width:"".concat(t,"px")}}),s.vizContainer.append(function(t,e,n,r,a,i,o){var l,c,u,s,d=g.FIRST_CARD_INDEX,f=30*r>n?ro:"dot",h=function(){var i=t.activeCardIndex;e.slider.classList.remove(Ji),0===i?(i=r,e.slider.style.transform="translate(-".concat(n*i,"px)")):i===a.length+1&&(i=d,e.slider.style.transform="translate(-".concat(n*i,"px)")),t.activeCardIndex=i},m=function(){var n=t.activeCardIndex,r=e.activeCardTextIndicator;r&&(r.innerHTML="".concat(n))},p=function(){var n=t.activeCardIndex;e.controlsContainer.querySelector(".".concat(to)).classList.remove(to),document.getElementById("".concat(n).concat(co)).classList.add(to)},y=function(t,e){[{selector:".card__label",componentPropertyName:ho.CARD_LABELS},{selector:".card__primary-value",componentPropertyName:ho.CARD_PRIMARY_VALUES},{selector:".card__body",componentPropertyName:ho.CARD_BODIES},{selector:".card__trend-indicator",componentPropertyName:ho.CARD_INDICATORS},{selector:".card__secondary-value",componentPropertyName:ho.CARD_SECONDARY_VALUES}].forEach(function(n){var r=n.selector,a=n.componentPropertyName,o=t.querySelector(r);if(o){if(a===ho.CARD_SECONDARY_VALUES){var l=i.components[a][e].secondaryValueData;o.secondaryValueData=l}i.components[a].push(o)}})};return c=t.activeCardIndex,u=n*(r+2),e.slider=e.vizContainer.appendChild(Ct({tag:"section",classes:["slider"],style:{width:"".concat(u,"px")}})),e.clonedFirstCard=a[0].cloneNode(!0),y(e.clonedFirstCard,0),e.clonedLastCard=a[a.length-1].cloneNode(!0),y(e.clonedLastCard,a.length-1),(l=e.slider).append.apply(l,function(t){if(Array.isArray(t))return yo(t)}(s=a)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||function(t,e){if(t){if("string"==typeof t)return yo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yo(t,e):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.slider.insertAdjacentElement("afterbegin",e.clonedLastCard),e.slider.append(e.clonedFirstCard),e.slider.addEventListener("transitionend",function(){var e=t.activeCardIndex,n=i.autoPlayEnabled,r=i.intervalAutoPlayId;t.sliding=!1,h(),f===ro?m():p(),i.activeCardIndex=e;var a=JSON.parse(i.getProperty(A));n||i.setProperty(A,JSON.stringify(vo(vo({},a),{},Eo({},E.ACTIVE_CARD_INDEX.name,e))),{suppressData:!0,clientUndoRedoCallback:function(){return i.refresh()}}),n&&!r&&o()}),e.slider.style.transform="translate(-".concat(n*c,"px)"),e.slider}(u,s,t,n,r,i,l)),s.vizContainer.append(uo({sliderState:u,controlsLayout:d,vizHeight:e,cardWidth:t,cardsCount:n,elementRefs:s,properties:a,slideCard:o})),s.vizContainer};function bo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Io=function(t,e,n){var r=n.gridFixCardHeightEnabled,a=n.layoutType,i=n.cardAlignment,o=g.LAYOUT_TYPES,c=t.domNode,u=c.clientWidth,s=c.clientHeight,d=parseInt(a===o.GRID?4:0),f=e.length,h=Ao(n,f),m=r?0:s,p=a===o.STACKED?u:u/h+d/h-d,y=So(n,s,f,h,d,t);t.gridFixCardHeight=y,t.cardDimensions={cardWidth:p,cardHeight:y};var v,E,_=t.isComparisonMetricAdded,b=p>y||_,I=y>p,A=l(t.KPIType),S=D(t,A.TREND),C=_||S,T={cssModifiers:(E=(v={isTrendIndicatorOnTop:b,showSecondaryValue:C,showTrendGraph:S,cardAlignment:i,isComparisonMetricAdded:_,isCardVertical:I}).showSecondaryValue?"with-secondary":"no-trend",{cardAlignment:"left-alignment",cardElementsModifier:E=v.showTrendGraph?"with-trend":E,indicatorPosition:v.isTrendIndicatorOnTop?"kpi-on-top":"kpi-on-bottom",comparisonIndicator:v.isComparisonMetricAdded?"with-comparison":"no-comparison",cardDirection:v.isCardVertical?"vertical-card":"horizontal-card"}),isTrendIndicatorOnTop:b,cardAlignment:i,showSecondaryValue:C,isComparisonMetricAdded:_,isStackedLayout:a===o.STACKED};t.cardProperties=T,t.cardComponentReferences={};var w,O,N,M=e.map(function(e,r){return function(t,e,n,r){var a,i,o,l,c,u,s,d,f,h,m,p=null!==(a=null===(i=mstrmojo)||void 0===i||null===(o=i.chart)||void 0===o||null===(l=o.model)||void 0===l||null===(c=l.enums)||void 0===c||null===(u=c.EnumDSSBaseFormType)||void 0===u?void 0:u.DssBaseFormHTMLTag)&&void 0!==a?a:7,y=t.label,g=t.primaryValue,v=t.graphicModel,E=t.thresholdTarget,_=t.breakByAttributeFormType,b=t.metricFormType,I=t.trend,A=e.showMetricName,S=e.primaryValueFontOptions,C=e.labelFontOptions,T=e.imageSrc,w=e.searchIcon,O=n.cardDimensions,N=O.cardWidth,M=O.cardHeight,x=n.cardProperties,D=x.cssModifiers,R=x.isStackedLayout,L=!I,V=mstrmojo.color.decodeColor(null==n||null===(s=n.model)||void 0===s||null===(d=s.docModel)||void 0===d||null===(f=d.plt)||void 0===f||null===(h=f.colors)||void 0===h?void 0:h[0]),F=Xi({},e);"AUTO"===F.imgFillColor&&(F.imgFillColor=V),"AUTO"===F.areaFillColor&&L&&(F.areaFillColor=V),"AUTO"===F.trendFillColor&&(F.trendFillColor=V);var k=qi(T||w,F.imgFillColor,F.imgFillOpacity),B=A?y.withMetricName:y.withoutMetricName,K=[],H=v.cardId,U=R?"".concat(N,"px"):"auto",Y=E[7]?j(E[7].color,null!==(m=E[7].opacity)&&void 0!==m?m:100):j(F.areaFillColor,F.areaFillOpacity),G=Ct(function(t,e,n,r){return{tag:"article",classes:["card"],style:{height:e,width:n,background:t,boxSizing:"border-box"},otherAttributes:{id:r}}}(Y,"".concat(M,"px"),U,H));n.cardComponentReferences[H]={},G.addEventListener("click",function(t){return Oi(t,n,v)});var z=P(C,n),W=_?_===p:void 0!==b,$=Ct(function(t,e,n,r){var a=r.indicatorPosition,i=r.cardAlignment,o=r.cardElementsModifier,l=r.cardDirection;return n[2]&&(t.color=n[2].color),{tag:"header",classes:["card__label","card__label--".concat(i),"card__label--".concat(a),"card__label--".concat(o),"card__label--".concat(l)],content:e,style:t,otherAttributes:{title:e}}}(z,B,E,D),!0,W);k.classList.add("card__img-wrapper--".concat(D.cardDirection)),L?k.classList.add("card__img-wrapper--no-trend"):k.classList.add("card__img-wrapper--with-trend");var X,Z,q,Q,J,tt=Ct((Z=(X=D).indicatorPosition,q=X.cardAlignment,Q=X.cardElementsModifier,J=X.cardDirection,{tag:"div",classes:["card__body","card__body--".concat(Z),"card__body--".concat(q),"card__body--".concat(Q),"card__body--".concat(J)],content:null})),et=P(S,n),nt=void 0!==b,rt=Ct(function(t,e,n,r){var a=r.cardElementsModifier,i=r.comparisonIndicator,o=r.cardDirection;return e.color&&(t.color=e.color),n[3]&&(t.color=n[3].color),{classes:["card__primary-value","card__primary-value--".concat(a),"card__primary-value--".concat(i),"card__primary-value--".concat(o)],content:e.formatted,style:t,otherAttributes:{title:e.formatted}}}(et,g,E,D),!0,nt);if(tt.append(rt),L&&"horizontal-card"===D.cardDirection){var at=document.createElement("div");at.classList.add("card__content-wrapper"),at.style.width="100%",at.style.height="100%",at.style.display="flex",at.style.alignItems="center",G.appendChild(at),at.appendChild(k),k.style.height="unset",k.style.position="static",k.style.transform="none",k.style.flex=1;var it=document.createElement("div");it.classList.add("card__label-body-wrapper"),it.style.width="100%",it.style.height="100%",it.style.display="flex",it.style.flexDirection="column",it.style.justifyContent="center",it.style.flex=1.2,$.style.height="unset",$.style.lineHeight="unset",$.style.transform="none",$.style.position="unset",tt.style.transform="none",tt.style.position="unset",it.appendChild($),it.appendChild(tt),at.appendChild(it),K.push(at),G.style.display="flex",G.style.alignItems="center"}else K.push(k),K.push($),K.push(tt);n.components.cardBodies.push(tt),n.components.cardLabels.push($),n.components.cardPrimaryValues.push(rt);var ot=Ct("div");return ot.classList.add("overlay-fill"),n.isMobile||ot.classList.add("overlay-fill--not-mobile"),K.push(ot),G.append.apply(G,K),n.cardComponentReferences[H]=Xi(Xi({},n.cardComponentReferences[H]),{},{cardLabel:$,cardPrimaryValue:rt,cardBody:tt,cardComponent:G,cardImgWrapper:k}),Qi(t,n,F,r),null!=t&&t.isCardOld&&G.classList.add("card--old-card"),G}(e,n,t,r)});if(a===o.STACKED&&f>1)w=_o(p,s,f,M,n,t);else{var x,R=["container"];a===o.HORIZONTAL?R.push("container--horizontal"):a===o.VERTICAL&&R.push("container--vertical"),(x=w=Ct((O=m,{tag:"section",classes:R,style:{gridTemplateColumns:"repeat(".concat(h,", 1fr)"),minHeight:"".concat(O,"px")}}))).append.apply(x,function(t){if(Array.isArray(t))return bo(t)}(N=M)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(N)||function(t,e){if(t){if("string"==typeof t)return bo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bo(t,e):void 0}}(N)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return w},Ao=function(t,e){var n=t.gridColumnCount,r=t.layoutType,a=g.LAYOUT_TYPES;switch(r){case a.GRID:return Math.min(e,n);case a.HORIZONTAL:return e;case a.VERTICAL:return 1}},So=function(t,e,n,r,a,i){var o=g.LAYOUT_TYPES,l=t.gridFixCardHeight,c=t.gridFixCardHeightEnabled;switch(t.layoutType){case o.GRID:var u=Math.ceil(n/r);return c?l:Math.max((e-a*(u-1))/u,75);case o.HORIZONTAL:case o.STACKED:return e;case o.VERTICAL:return e/n-a*(n-1)/n}};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.requiresCls("mstrmojo.css","mstrmojo.VisUtility","mstrmojo.HTMLSanitizeUtil");var Co=function(t,e,n){var r=n.cardWidth,a=n.cardHeight,i=mstrmojo.css.getComputedStyle(t),o="width"===e||"maxWidth"===e?parseFloat(r):parseFloat(a);return function(t,e){if("none"!==t)return t.indexOf("px")>0?parseFloat(t):e*parseFloat(t)/100}(i[e],o-2)},To=function(t,e,n,r){var a=t.containerWidth,i=t.containerHeight,o=Math.max(Math.min((i-2*r)/n.height,(a-2*r)/n.width),1);return Math.floor(e*o)},wo=function(t,e){if(!e)return t;var n=t+e;return Math.max(n,0)};function Oo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return No(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?No(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function No(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Mo=function(t,e,n){var r=e.trendIndicatorShape,a=t.cardDimensions,i=t.components,o=t.isComparisonMetricAdded,l=ho.CARD_BODIES,c=ho.CARD_INDICATORS,u=ho.CARD_SECONDARY_VALUES,s=ho.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,d=i.cardBodies,f=i.cardSecondaryValueWithIndicatorWrappers;U(d,"height","100%"),U(d,"width","100%"),U(f,"height","100%");for(var h=function(){var i=Oo(p[m],2),d=i[0],f=i[1];if([l,s].includes(d))return 0;if(!1===t.shouldFontBeChanged[d])return 0;var h=d===c,y=d===u;f.forEach(function(i){var l,u,s,f=h&&r===g.TREND_INDICATOR_SHAPE.ARROW,m=f&&null!==i.querySelector(".trend-indicator__icon"),p=!h||f||o?0:4,v=e[mo[d]].fontSteps;if(d===c&&o){var E=i.closest(".card").querySelector(".card__secondary-value").offsetWidth,_=a.cardWidth,b=.16*_,I=Math.floor((u=(l={partialValue:_-E-b,totalValue:_}).partialValue,s=l.totalValue,100*Math.abs(u/s)));i.style.width="".concat(I,"%"),i.style.maxWidth="".concat(I,"%")}if(function(t,e,n,r){var a,i,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=11,d=e.textContent;t&&(e.style.fontSize="".concat(e.style.fontSize,"px"),s=parseInt(e.style.fontSize)),e.style.width="",e.style.height="",e.style.lineHeight="",e.style.fontSize="",e.style.left="",e.style.transform="",e.title="";var f=(null==l?void 0:l.properties).comparisonIndicatorEnabled,h=l.cardProperties,m="horizontal-card"===(null==h||null===(a=h.cssModifiers)||void 0===a?void 0:a.cardDirection);null!=l&&l.isComparisonKPI&&c&&null!=l&&l.isComparisonMetricAdded?f?(e.style.width="58%",e.style.maxWidth="58%"):(e.style.width="82%",e.style.maxWidth="82%"):m&&c&&(e.style.width="30%",e.style.maxWidth="30%");var p=Co(e,"width",n),y=Co(e,"height",n);if(i=K(e,s),d){var g;if(!t&&(s=wo(To({containerWidth:p,containerHeight:y},11,i,o),r),u)){var v=B(s);s=wo(To({containerWidth:p-v,containerHeight:y},11,i,o),r)}e.style.fontSize="".concat(s,"px"),i=K(e,s);var E=null===(g=e.secondaryValueData)||void 0===g?void 0:g.labelTitle;if(c&&!t)if(i.width>p){var _,b,I=null===(_=e.secondaryValueData)||void 0===_?void 0:_.labelValue,A=null===(b=e.secondaryValueData)||void 0===b?void 0:b.shouldSanitizeSecondaryValue;if(!mstrmojo.HTMLSanitizeUtil.shouldEncodeHtmlContent()&&A){var S=At(I,_t);I=St(S,!1);var C=At(E,_t);E=St(C,!1)}var T=H(e,s);l.truncatedLabels.push(F({container:e,maxTextWidth:p,textData:{label:E,value:I,connector:": "},fontSize:s,fontStyle:T}).truncatedLabel)}else l.truncatedLabels.push("".concat(E,": "));!function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if("vi_icons"===t.style.fontFamily)t.style.width="".concat(e+8,"px");else{var i=Co(t,"width",r),o=t.textContent,l=n.width;if(l>i){var c=Co(t,"maxWidth",r);l<=c?t.style.width="".concat(l,"px"):(t.style.width="".concat(c||l+2*a,"px"),c&&(t.title=o))}else t.style.width="".concat(l+2*a,"px")}}(e,s,i,n,o),function(t,e,n){var r=e.height;n?(t.style.height="".concat(Math.ceil(r)+2*n,"px"),t.style.lineHeight="".concat(Math.ceil(r),"px")):(t.style.height="".concat(1.5*Math.ceil(r),"px"),t.style.lineHeight="".concat(1.5*Math.ceil(r),"px"))}(e,i,o)}}(n,i,a,v,p,t,y,m),m){var A=i.querySelector(".trend-indicator__icon"),S=B(i.style.fontSize),C=parseInt(i.style.width);A.style.width="".concat(S,"px"),A.style.height="".concat(S,"px"),i.style.padding=0,i.style.textAlign="left",i.style.width="".concat(C+S,"px")}})},m=0,p=Object.entries(i);m<p.length;m++)h();U(d,"height","auto"),U(d,"width","84%"),U(f,"height","auto")},xo=function(t){var e=t.cardDimensions,n=t.components,r=ho.CARD_BODIES,a=ho.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS,i=ho.CARD_PRIMARY_VALUES,o=ho.CARD_LABELS,l=n.cardBodies,c=n.cardSecondaryValueWithIndicatorWrappers;U(l,"height","100%"),U(l,"width","100%"),U(c,"height","100%");for(var u={},s={},d=function(){var n,l,c=Oo(h[f],2),d=c[0],m=c[1];if([r,a].includes(d))return 0;var p=[];if(0===m.length)return 0;var y=Co(m[0],"width",e),g=Co(m[0],"height",e);if(s[d]={width:y,height:g},m.forEach(function(t){t.style.fontSize="".concat(t.style.fontSize,"px");var e=parseInt(t.style.fontSize),n=K(t,e);p.push(n.width),l||(l=n.height)}),p.sort(function(t,e){return t-e}),void 0===t.shouldFontBeChanged[d]&&0!==t.shouldFontBeChanged.length)return 0;n=d===i?p[p.length-1]:d===o?p[Math.ceil(.75*p.length)-1]:p.reduce(function(t,e){return t+e},0)/p.length,u[d]={width:n,height:l}},f=0,h=Object.entries(n);f<h.length;f++)d();return U(l,"height","auto"),U(l,"width","84%"),U(c,"height","auto"),{dimensionsOfText:u,dimensionsOfContainer:s}};function Do(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||Po(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Po(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function Po(t,e){if(t){if("string"==typeof t)return Lo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(t,e):void 0}}function Lo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var jo=function(t){var e,n=0,r=Ro(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;n+=parseInt(a.style.fontSize)}}catch(t){r.e(t)}finally{r.f()}return n/t.length},Vo=function(t){return Math.min.apply(Math,function(t){if(Array.isArray(t))return Lo(t)}(e=t.map(function(t){var e=t.style;return parseInt(e.fontSize)}))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||Po(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var e},Fo=function(t){var e=t.length,n=t.map(function(t){return t.textContent});n.sort(function(t,e){return t.length-e.length});var r=n[Math.ceil(.75*e)-1],a=t.find(function(t){return t.textContent===r});return parseInt(a.style.fontSize)},ko=function(t,e){for(var n=t.components,r=ho.CARD_BODIES,a=ho.CARD_PRIMARY_VALUES,i=ho.CARD_LABELS,o=ho.CARD_INDICATORS,l=ho.CARD_SECONDARY_VALUES,c={},u=null,s=0,d=Object.entries(n);s<d.length;s++){var f=Do(d[s],2),h=f[0],m=f[1];if(h!==r&&!1!==t.shouldFontBeChanged[h]){var p=void 0;h===a?p=Vo(m):h===i?p=Fo(m):h===l?u=p=jo(m):p=h===o&&null!==u?u:jo(m),c[h]=k(p);var y,g=Ro(m);try{for(g.s();!(y=g.n()).done;)y.value.style.fontSize="".concat(p,"px")}catch(t){g.e(t)}finally{g.f()}}}if(n[o]&&n[l]&&null===u){var v=n[l];if(v&&v.length>0){var E,_=jo(v),b=Ro(n[o]);try{for(b.s();!(E=b.n()).done;)E.value.style.fontSize="".concat(_,"px")}catch(t){b.e(t)}finally{b.f()}c[o]=k(_)}}return Mo(t,e,!0),c};function Bo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ko(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ko(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ko(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Ho=function(t,e){var n,r,a,i,o=e.isSecondaryLabelUpdated;switch(t.textSizeType){case g.TEXT_SIZE_TYPE.FIXED:""===t.labelFontOptions.fontSize?(Mo(e,t,!1),ko(e,t),e.componentsUnifiedFontSizesInPt=ko(e,t)):Mo(e,t,!0);break;case g.TEXT_SIZE_TYPE.UNIFIED:0!==e.shouldFontBeChanged.length||o||(Mo(e,t,!1),ko(e,t));var l={};l.oldDimensions=xo(e),Mo(e,t,!0),l.newDimensions=xo(e),Object.keys(l.newDimensions.dimensionsOfText).length!==Object.keys(l.oldDimensions.dimensionsOfText).length?Object.keys(l.newDimensions.dimensionsOfText).forEach(function(t){e.shouldFontBeChanged[t]=!0}):function(t){var e=t.oldDimensions,n=t.newDimensions,r=e.dimensionsOfText,a=n.dimensionsOfText,i=n.dimensionsOfContainer,o={};Object.values(a).forEach(function(t){if(r[t])if(a[t].width===r[t].width)o[t]=!1;else if(a[t].width>1*i[t].width)o[t]=!0;else if(a[t].width<=1*i[t].width&&a[t].width>=1*r[t].width)o[t]=!1;else{var e=Math.max(a[t].width/i[t].width*1,a[t].height/i[t].height*1);o[t]=!(e>=.9)}else o[t]=!0})}(l);var c=ho.CARD_SECONDARY_VALUES;o&&(e.shouldFontBeChanged[c]=!0),!0===e.shouldFontBeChanged[c]&&(e.truncatedLabels=[]),Mo(e,t,!1),ko(e,t);break;case g.TEXT_SIZE_TYPE.FIT_TO_CONTAINER:Mo(e,t,!1)}for(var u=e.components,s=0,d=Object.entries(u);s<d.length;s++){var f=Bo(d[s],2),h=f[0],m=f[1];[ho.CARD_BODIES,ho.CARD_SECONDARY_VALUE_WITH_INDICATOR_WRAPPERS].includes(h)||(U(m,"maxWidth","none"),m.forEach(function(t){K(t,t.style.fontSize).width<=parseInt(t.style.width)&&(t.style.overflow="visible")}))}"horizontal-card"===(null===(n=e.cardProperties)||void 0===n||null===(r=n.cssModifiers)||void 0===r?void 0:r.cardDirection)&&Object.keys(e.cardComponentReferences).forEach(function(t){var n=e.cardComponentReferences[t];n&&n.cardImgWrapper&&function(t,e){var n=e.cardComponentReferences[t];if(n){var r=n.cardLabel,a=n.cardPrimaryValue,i=n.cardImgWrapper,o=n.cardBody;if(r&&a&&i){var l,c,u=r.getBoundingClientRect(),s=a.getBoundingClientRect(),d=n.cardComponent.getBoundingClientRect(),f=(u.top-d.top)/d.height*100,h=(s.bottom-d.top)/d.height*100-f;l=35,c=1.2;var m=Math.min(h*c,l);i.style.width="".concat(m,"%"),i.style.height="".concat(m,"%"),i.style.left="4%",i.style.top="".concat(f+(h-m)/2,"%"),i.style.transform="none",i.style.position="absolute";var p=4+m+2,y=96-p;r.style.left="".concat(p,"%"),r.style.width="".concat(y,"%"),r.style.textAlign="left",o&&(o.style.left="".concat(p,"%"),o.style.width="".concat(y,"%"))}}}(t,e)}),"vertical-card"===(null===(a=e.cardProperties)||void 0===a||null===(i=a.cssModifiers)||void 0===i?void 0:i.cardDirection)&&Object.keys(e.cardComponentReferences).forEach(function(t){var n,r,a=e.cardComponentReferences[t];a&&a.cardImgWrapper&&a.cardLabel&&("no-trend"!==(null===(n=e.cardProperties)||void 0===n||null===(r=n.cssModifiers)||void 0===r?void 0:r.cardElementsModifier)?function(t,e){var n;if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){var r=e.cardComponentReferences[t];if(!r||!r.cardImgWrapper||!r.cardLabel)return}var a=e.cardComponentReferences[t].cardComponent,i=e.cardComponentReferences[t].cardImgWrapper,o=e.cardComponentReferences[t].cardLabel;if(a&&i&&o){var l=null===(n=e.cardProperties)||void 0===n?void 0:n.cssModifiers,c="vertical-card"===(null==l?void 0:l.cardDirection),u=null==l?void 0:l.isHidingTrend;if(c&&!u){var s=a.getBoundingClientRect(),d=o.getBoundingClientRect();if(0!==s.height&&0!==d.height){var f=(d.top-s.top)/s.height*100+d.height/s.height*100/2;i.style.position="absolute",i.style.top="".concat(f,"%"),i.style.transform="translateY(-50%)";var h=parseFloat(i.style.width)||15,m=(parseFloat(i.style.left)||8)+h+2;m>28&&(o.style.left="".concat(m,"%"),o.style.width="".concat(96-m,"%"))}}}}(t,e,!1):function(t,e){var n;if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){var r=e.cardComponentReferences[t];if(!r||!r.cardImgWrapper||!r.cardLabel)return}var a=e.cardComponentReferences[t].cardComponent,i=e.cardComponentReferences[t].cardImgWrapper,o=e.cardComponentReferences[t].cardLabel,l=e.cardComponentReferences[t].cardBody;if(a&&i&&o){var c=null===(n=e.cardProperties)||void 0===n?void 0:n.cssModifiers,u="vertical-card"===(null==c?void 0:c.cardDirection),s="no-trend"===(null==c?void 0:c.cardElementsModifier);u&&s&&(a.style.display="flex",a.style.flexDirection="column",a.style.justifyContent="space-evenly",a.style.alignItems="center",l.firstChild.style.height="auto")}}(t,e,!1))})};function Uo(t,e,n){var r=this;setTimeout(function(){r.savePropertyAndUpdateWidget(t,e,n)})}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var Yo="second",Go="minute",zo="hour",Wo="day",$o={};$o[Yo]=1e3,$o[Go]=60*$o[Yo],$o[zo]=60*$o[Go],$o[Wo]=24*$o[zo],$o.week=7*$o[Wo],$o.month=30*$o[Wo],$o.year=365*$o[Wo],mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});function Xo(t){return function(t){if(Array.isArray(t))return Zo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Zo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.requiresCls("mstrmojo.CustomVisBase","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming");var qo=function(t){var e=!1,n=t.updatedCategory,r=t.isBreakByAttributeAdded,a=t.isOnlyPrimaryValueRendered;t.parsedData.forEach(function(i,o){var l=i.graphicModel.cardId;(!r||i.breakByAttributeName===n)&&(function(t,e,n,r){var a=t.cardComponentReferences,i=t.isComparisonKPI,o=t.isComparisonMetricAdded,l=t.isTrendAttributeAdded,c=a[r],u=c.cardTrendGraphData,s=c.cardPrimaryValue,d=c.cardIndicator,f=u.isTrendIndicatorOnTop,h=u.referenceLine,m=u.properties,p=e.trendChartData,y=e.trend,v=e.indicator,E=e.trendComponentIndex,_=e.thresholdTarget;if(s.textContent=e.primaryValue.formatted,(l||i&&o)&&1!==p.length&&(function(t,e,n){var r,a,i=null!==(r=t.secondaryValueComponentIndex)&&void 0!==r?r:e,o=null===(a=t.secondaryValue)||void 0===a?void 0:a.value,l=n.components.cardSecondaryValues[i].secondaryValueData,c=l.labelTitle;l.labelValue=o,l.labelTitle=t.secondaryValue.label,n.isSecondaryLabelUpdated=c!==(null==l?void 0:l.labelTitle),n.secondaryMetricName=l.labelTitle,n.isComparisonMetricAdded&&(l.labelValue+=""),0===n.truncatedLabels.length&&(n.components.cardSecondaryValues[i].textContent="".concat(l.labelTitle,": ").concat(l.labelValue))}(e,n,t),function(t,e,n,r,a){var i=t.isComparisonKPI,o=t.isComparisonMetricAdded;(!i&&t.properties.trendIndicatorEnabled||i&&t.properties.comparisonIndicatorEnabled)&&(e.indicatorFontOptions.fontSize=n.style.fontSize,o?function(t,e,n,r){var a=n.trendIndicatorValueType,i=e.differenceBetweenPrimaryAndSecondary,o=e[a],l=Ki(i,n,o,r),c=l.indicatorColor,u=l.valueSign,s=a===g.TREND_INDICATOR_VALUE_TYPE.PERCENT?"(".concat(u).concat(o,")"):"".concat(u).concat(o);t.textContent=s,t.style.color=c}(n,r,e,a):function(t,e,n){var r=n.trendIndicatorValueType,a=n.trendIndicatorShape,i=g.TREND_INDICATOR_VALUE_TYPE.NUMERIC,o=e.differenceBetweenPrimaryAndSecondary,l=mstrmojo.string.encodeHtmlString(e[r]),c=Ki(o,n,l,{}),u=c.arrowType,s=c.indicatorColor,d=c.valueSign;if(a===g.TREND_INDICATOR_SHAPE.ARROW){var f=u?Bi(s,u,!0):"";t.firstChild.innerHTML=f,t.lastChild.textContent=r===i?"".concat(d).concat(l):"".concat(d," ").concat(l),t.style.color=s}else l=r===i?"".concat(d).concat(l):"".concat(d," ").concat(l),t.textContent=l,t.style.backgroundColor=s}(n,r,e))}(t,m,d,v,_),l)){var b=null!=E?E:n;!function(t,e,n,r,a,i,o,l){var c=o.trendShape,u=o.trendFillColor,s=o.trendFillOpacity,d=o.axisScale,f=l.minValue,h=l.maxValue,m=r.isBreakByAttributeAdded,p=r.updatedCategory,y=r.cardDetails;if(d!==g.AXIS_SCALE.GLOBAL){var v=d===g.AXIS_SCALE.SYNCED_ALL?r.parsedData:r.parsedData.filter(function(t){return t.metricId===n});f=Math.min.apply(Math,bi(v.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),h=Math.max.apply(Math,bi(v.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})))}m&&y.forEach(function(t){t.breakByAttributeName===p&&(t.trend[n]=l)});var E,_=wi(r,e,a,s,c,i,{minValue:f,maxValue:h}),b=_.scales,I=_.graphData,A=_.trendFillOpacityFraction,S=_.trendWidth,C=_.trendVerticalMargin;E=c===Si?function(t,e,n,r){var a=e.xScale,i=e.yScale,o=ri().curve(di).x(function(t){return a(t.index)}).y(function(t){return i(t.value)});return t.selectAll(".trend-graph__tooltip-marker").remove(),t.select("path").datum(n).attr("d",o),Ei(t,e,n,r)}(t,b,I,e):c===Ci?function(t,e,n,r,a,i){var o=e.xScale,l=e.yScale,c=ai().curve(di).x(function(t){return o(t.index)}).y1(function(t){return l(t.value)}).y0(a>=0?l(a)+i:l(0));return t.selectAll(".trend-graph__tooltip-marker").remove(),t.selectAll("path").datum(n).attr("d",c),Ei(t,e,n,r)}(t,b,I,e,f,C):function(t,e,n,r,a,i){var o=e.xBarScale,l=e.barYScale,c=e.heightScale,u=t.selectAll(".trend__bar").data(n);return u.enter().append("rect").attr("class","trend__bar").merge(u).style("fill",a).attr("fill-opacity",i).attr("stroke",a).attr("stroke-width",1.5).attr("x",function(t){return o(t.index)}).attr("width",o.bandwidth()).attr("y",function(t){return l(t.value)}).attr("height",function(t){return c(t.value)}),_i(t,e,i,r)}(t,b,I,e,u,A),i&&function(t,e,n,r,a){var i=n.value,o=n.font,l=e.yScale;t.select("line").attr("x1",0).attr("x2",a).attr("y1",l(i)).attr("y2",l(i)).raise();var c=P(o,r),u=parseFloat(c.fontSize),s=l(i)-4,d=l(i)+4,f=s-u>0?s:d+u;t.select("text").attr("y",f).raise()}(t,b,i,r,S);var T=E,w=T.tooltipHandler,O=T.resetHighlight;t.on("tooltip",w).on("mouseout",function(){O(),r.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},r.hideTooltip(!1)})}(t.trendSVGs[b],p,e.metricId,t,f,h,m,y)}}(t,i,o,l),e=e||i.trendChartData.length>1&&i.primaryValue.formatted.length!==i.trendChartData.at(-2).formatted.length||!a&&function(t,e){var n,r,a,i,o,l,c=e.properties,u=e.truncatedLabels,s=e.isSecondaryLabelUpdated,d=e.components,f=c.trendIndicatorValueType,h=g.TREND_INDICATOR_VALUE_TYPE.NUMERIC,m=null===(n=t.secondaryValue)||void 0===n?void 0:n.value,p=f===h?null===(r=t.previousIndicator)||void 0===r?void 0:r.numericValue:null===(a=t.previousIndicator)||void 0===a?void 0:a.percentValue,y=f===h?null===(i=t.indicator)||void 0===i?void 0:i.numericValue:null===(o=t.indicator)||void 0===o?void 0:o.percentValue;return m&&(null===(l=t.previousSecondaryValue)||void 0===l?void 0:l.length)!==(null==m?void 0:m.length)||m&&s||(null==p?void 0:p.length)!==y.length||0===u.length||u.length!==d.cardSecondaryValues.length}(i,t)),i.isCardOld&&t.cardComponentReferences[l].cardComponent.classList.add("card--old-card")}),t.truncatedLabels.length>0&&t.truncatedLabels.length!==t.components.cardSecondaryValues.length&&(t.isSecondaryLabelUpdated=!0),e&&Ho(t.properties,t),function(t){var e=t.parsedData,n=t.truncatedLabels,r=t.isBreakByAttributeAdded,a=t.updatedCategory,i=t.components;e.forEach(function(e,o){if(t.isComparisonMetricAdded&&(e.secondaryValue.value+=""),!(0===n.length||r&&e.breakByAttributeName!==a)){var l,c=null!==(l=e.secondaryValueComponentIndex)&&void 0!==l?l:o;i.cardSecondaryValues[c].textContent="".concat(n[c]).concat(e.secondaryValue.value)}})}(t)};function Qo(t,e,n,r,a){var i=t.isComparisonMetricAdded,o=t.isTrendAttributeAdded,l=t.isBreakByAttributeAdded,c=t.isComparisonKPI,u=t.updatedCategory,s=t.metricFormattingRules,d=!o&&c?e.at(-1).v:function(t,e,n,r,a){var i=t.isComparisonMetricAdded,o=t.timeFilter,l=t.properties.secondaryMetricName,c=a.trend,u=a.trendChartData,s=a.primaryValue,d=Object.keys(n.metricSelector),f=new Date(r),h=yt(n.headers[0].attributeSelector,n.idValueMapping,d,a.metricId);u.push({raw:s.raw,formatted:s.formatted,graphicModel:h,timestamp:r,timestampDate:f}),!a.isMoreDataThanFilter&&u[0].timestampDate<=o.timeRangeStart&&(a.isMoreDataThanFilter=!0,a.cardSecondaryLabel=l);var m=Jo(o,u);return a.trend=function(t,e,n,r){var a=n?Math.min(n.minValue,r):Math.min(r,t[0].raw),i=n?Math.max(n.maxValue,r):Math.max(r,t[0].raw);return{minValue:a=a===i&&a>0?0:a,maxValue:i}}(u,0,c,s.raw),a.trendChartData=m,i?e.at(-1).v:m[0].raw}(t,e,n,r,a);!function(t,e,n){var r=t.primaryValue.raw-e,a=R({partialValue:r,totalValue:e}),i=null!=t&&t.compareMetricId?t.compareMetricId:t.metricId,o={numericValue:at(r,i,n).formattedValue,percentValue:a,differenceBetweenPrimaryAndSecondary:r};t.previousIndicator=t.indicator,t.indicator=o}(a,d,s),function(t,e,n,r){var a=t.trendChartData,i=n?at(e,t.compareMetricId,r).formattedValue:a[0].formatted;t.secondaryValue?(t.previousSecondaryValue=t.secondaryValue.value,t.secondaryValue.value=i,t.previousSecondaryLabel=t.secondaryValue.label,t.secondaryValue.label=t.cardSecondaryLabel):t.secondaryValue={value:i,label:t.cardSecondaryLabel}}(a,d,i,s),l&&t.cardDetails.forEach(function(t){t.breakByAttributeName===u&&(t.cardSecondaryLabel=a.cardSecondaryLabel)})}function Jo(t,e){var n;if(e[0].timestampDate>t.timeRangeStart)return e;t.isMoreDataThanFilter=!0;var r=null!==(n=t.firstIndexInFilterRange)&&void 0!==n?n:e.findIndex(function(e){return e.timestampDate>t.timeRangeStart});return e.slice(r)}function tl(t,e){var n={breakByAttributeName:t.breakByAttributeName,cardSecondaryLabel:t.cardSecondaryLabel,firstTimestamp:t.trendChartData[0],trend:{}};return n.trend[t.metricId]=t.trend,n.isCardOld=!!e&&t.isCardOld,n.lastUpdateTimestamp=e?t.lastUpdateTimestamp:null,n}function el(t,e,n,r,a,i){0===e.length?function(t,e,n,r){t.forEach(function(t){if(r.find(function(e){return e.breakByAttributeName===t.breakByAttributeName}))r.forEach(function(e){e.breakByAttributeName===t.breakByAttributeName&&(e.trend[t.metricId]=t.trend)});else{var a;t.isCardOld=t.trendChartData.at(-1).timestampDate<n.timeRangeStart;var i=null!==(a=t.lastUpdateTimestamp)&&void 0!==a?a:e.at(-1).timestampDateFormat;t.lastUpdateTimestamp=t.isCardOld?i:null;var o=tl(t,!0);r.push(o)}})}(t,r,n,e):function(t,e,n,r){var a=r.axisScale;t.forEach(function(i){var o=e.find(function(t){return t.breakByAttributeName===i.breakByAttributeName});if(o){var l;null!=i&&i.cardSecondaryLabel&&(i.cardSecondaryLabel=n?r.secondaryMetricName:o.cardSecondaryLabel,null!=i&&null!==(l=i.secondaryValue)&&void 0!==l&&l.label&&(i.secondaryValue.label=i.cardSecondaryLabel)),i.isCardOld=o.isCardOld,i.lastUpdateTimestamp=o.lastUpdateTimestamp,function(t,e,n,r){if(t===g.AXIS_SCALE.GLOBAL)n.trend=e.trend[n.metricId];else{var a=t===g.AXIS_SCALE.SYNCED_ALL?r:r.filter(function(t){return t.metricId===n.metricId}),i=Math.min.apply(Math,Xo(a.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.minValue)||t.trendChartData[0].raw}))),o=Math.max.apply(Math,Xo(a.map(function(t){var e;return(null===(e=t.trend)||void 0===e?void 0:e.maxValue)||t.trendChartData[0].raw})));n.trend={minValue:i,maxValue:o}}}(a,o,i,t)}else{var c=tl(i,!1);e.push(c)}})}(t,e,i,a)}function nl(t){return nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(t)}function rl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function al(t,e,n){return(e=function(t){var e=function(t){if("object"!=nl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=nl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nl(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={});var il,ol,ll,cl=mstrmojo,ul=cl.DEFAULT_CONTEXT_MENU,sl=cl.CUSTOM_CONTEXT_MENU,dl=function(t){return[".card__label",".card__primary-value",".card__trend-indicator",".card__secondary-value",".card__reference-line-label"].map(function(e){return fl(t,e)}).filter(function(t){return!!t}).join("\t")},fl=function(t,e){var n=t.querySelector(e);return n&&(n.title||n.getAttribute("title")||n.textContent)};mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.plugins.ImageEnhancedKPI||(mstrmojo.plugins.ImageEnhancedKPI={}),mstrmojo.descriptors["IMGKPI.1"]||mstrmojo.requiresDescsWPrefix("IMGKPI.",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42),mstrmojo.requiresCls("mstrmojo.num","mstrmojo.CustomVisBase","mstrmojo.ui._HasScroller","mstrmojo._SupportRealtimeStreaming","mstrmojo.func"),mstrmojo.plugins.ImageEnhancedKPI.ImageEnhancedKPI=mstrmojo.declare(mstrmojo.CustomVisBase,[mstrmojo.ui._HasScroller,mstrmojo._SupportRealtimeStreaming],{scriptClass:"mstrmojo.plugins.ImageEnhancedKPI.ImageEnhancedKPI",cssClass:"ImageEnhancedKPI",errorMessage:mstrmojo.descP("IMGKPI.","7","Either there is not enough data to display the visualization or the visualization configuration is incomplete."),errorDetails:(ll=mstrmojo.descP("IMGKPI.","56","Add 1 #metric####"),ll.replace(/####/g,"</span>").replace("#",'<span class="ghost-vis-txt-metric">')),useRichTooltip:!1,reuseDOMNode:!1,draggable:!0,supportNEE:!0,supportPagination:!0,isIOS:mstrApp.isDisplayOnMobile,isAndroid:/(android)/i.test(navigator.userAgent),isMobile:mstrApp.isDisplayOnMobile||/(android)/i.test(navigator.userAgent),isInChatbot:null===(il=(ol=mstrApp).isInAIBotOrAutoAnswer)||void 0===il?void 0:il.call(ol),isWSLocalMode:mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode(),isConsumption:!1,labelsEditState:{},components:{},componentsUnifiedFontSizesInPt:null,graphicModels:[],contextMenuCardsGraphicModels:[],selectedCardsGraphicModels:[],trendSVGs:[],autoPlayEnabled:!1,tooltipInfo:{isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},intervalAutoPlayId:null,KPIType:0,isSingleCardDisplayed:null,isComparisonKPI:!1,animationDuration:0,iterator:0,init:function(t){this._super(t);var e=this,n=window.mstrApp.isExporting;e.animationDuration=n?0:1500,function(t){t.savePropertyAndUpdateWidgetAsync=Uo}(e);var r,a=(r={},Object.values(E).forEach(function(t){var e=t.name,n=t.defaultValue;r[e]=n}),Q({},A,JSON.stringify(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach(function(e){Q(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},r))));e.setDefaultPropertyValues(a),e.selectedCardsGraphicModels=[],e.contextMenuCardsGraphicModels=[]},destroy:function(t){this.isWSLocalMode||function(t){var e,n,r,a,i,o;if(null!==(e=mstrApp)&&void 0!==e&&null!==(n=e.rootCtrl)&&void 0!==n&&null!==(r=n.docCtrl)&&void 0!==r&&null!==(a=r.model)&&void 0!==a&&a.bs&&null!==(i=t.model)&&void 0!==i&&i.data&&!t.isWSLocalMode&&!t.isConsumption){var l=t.dataInterface.data.gsi.mx.map(function(e){var n;return null!==(n=e.wdgstrs)&&void 0!==n&&n[s]?{act:f,nodeKey:t.k,skey:s,objectId:e.did,objectType:4}:null}).filter(function(t){return t});(null===(o=t.model.data.wdgstrs)||void 0===o?void 0:o[d])&&l.push({act:f,nodeKey:t.k,skey:d}),l.length&&function(t,e){var n={taskId:"mojoRWManipulation",params:JSON.stringify({actions:e,style:{params:{treesToRender:2},name:"RWIVEMojoStyle"}}),nodeKey:t.k,suppressData:!0,messageId:mstrApp.getMsgID(),styleName:"RWIVEMojoStyle",rwb:mstrApp.rootCtrl.docCtrl.model.bs};mstrApp.serverRequest(n)}(t,l)}}(this),this._super(t)},onmousemove:function(t){var e=this,n=e.tooltipInfo,r={x:t.e.pageX,y:t.e.pageY},a={graphicModel:void 0};if(kr(t.getTarget().parentNode).dispatch("tooltip",{detail:{evt:t,returnObject:a}}),a.graphicModel){if(n.isPositionFixed&&e.tooltipWin.isVisible())return;e.tooltipInfo={isVisible:!0,isPositionFixed:!1,position:r,graphicModel:a.graphicModel},this.showTooltip(a.graphicModel,r)}else e.tooltipInfo={isVisible:!1,isPositionFixed:!1,position:{},graphicModel:{}},this.hideTooltip(!1)},oncontextmenu:function(t){var e=t.e.target;"container"!==e.className&&function(t,e,n){var r=n.closest(".card"),a=n.closest(".card__trend-graph"),i=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===r.id}),o=e.selectedCardsGraphicModels,l=e.contextMenuCardsGraphicModels;if(Pi(e,o),null==l||l.forEach(function(t){var e=xi(t);null==e||e.classList.remove("card--selected-context-menu")}),e.isIOS&&e.trendSVGs.forEach(function(t){return t.dispatch("mouseout")}),e.isMobile&&a){e.contextMenuCardsGraphicModels=[];var c={graphicModel:void 0};kr(a.querySelector("svg")).dispatch("tooltip",{detail:{evt:t,returnObject:c}}),e.handleContextMenuSelection(t,c.graphicModel)}else if(r.classList.contains("card--selected")&&o.length>1){e.clearSelections();var u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rl(Object(n),!0).forEach(function(e){al(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rl(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t);u.ctrlKey=!0,u.metaKey=!0;var s=[];o.forEach(function(t){e.handleSelection(u,t),s.push(t)}),e.contextMenuCardsGraphicModels=s,e.handleContextMenuSelection(t,i)}else e.clearSelections(),e.contextMenuCardsGraphicModels=[i],e.handleContextMenuSelection(t,i);e.contextMenuCardsGraphicModels.forEach(function(t){xi(t).classList.add("card--selected-context-menu")})}(t,this,e)},getContextMenuConfig:function(){var t=function(t){if(0===t.contextMenuCardsGraphicModels.length)return{commonConfig:[],customConfig:[]};var e=l(t.KPIType);return{commonConfig:D(t,e.BREAK_BY)?[{type:ul.CHANGE_VISUALIZATION},{type:ul.COPY_PASTE_FORMAT},{type:ul.KEEP_ONLY},{type:ul.EXCLUDE},{type:ul.DRILL},{type:ul.GROUP},{type:ul.CALCULATION},{type:ul.SHOW_DATA},{type:ul.GO_TO_TARGETS}]:[{type:ul.CHANGE_VISUALIZATION},{type:ul.COPY_PASTE_FORMAT}],customConfig:[t.isMobile?{}:{type:sl.NORMAL,name:mstrmojo.descP("IMGKPI.","12","Copy Text"),onClick:function(){!function(t){var e=t.map(function(t){return dl(t)}).join("\n"),n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}(t.contextMenuCardsGraphicModels.map(function(t){return xi(t)}))}}]}}(this);return{common:t.commonConfig,custom:t.customConfig}},getGraphicModelsBySelector:function(t,e){var n=this,r=[],a={attribute:mstrmojo.customviz.PICKED_TYPE.BOTH,metric:mstrmojo.customviz.PICKED_TYPE.BOTH},i=function(t){mstrmojo.array.forEach(n.getGraphicModels(),function(i){i.getSelector()&&n.canPickGraphicModel(t,e,i,a)&&r.push(i)})};return t.length>1?t.forEach(i):i(t),0===r.length&&(function(t,e){e.getGraphicModels().forEach(function(t){var e=xi(t);e&&Di(e)})}(0,this),n.selectedCardsGraphicModels=[],n.contextMenuCardsGraphicModels=[]),r},updateHighlight:function(){var t=this,e=this,n=[];e.getGraphicModels().forEach(function(e){t.graphicNeedsHighlight(e,!1)&&n.push(e)}),e.contextMenuCardsGraphicModels.length||Pi(e,n)},resetComponents:function(){this.components={cardLabels:[],cardPrimaryValues:[],cardBodies:[],cardSecondaryValues:[],cardSecondaryValueWithIndicatorWrappers:[],cardIndicators:[]}},clearDomNode:function(){this.domNode.innerHTML=""},addMojoScrollbar:function(){var t=this,e=t.domNode;t.containerNode=e.firstChild.firstChild,t.scrollNode=e.firstChild,t.isIOS?t.scrollbarHostNode=e.firstChild:t.scrollbarHostNode=e,t.scrollBarNodes={};var n=t.domNode.style,r=n.height,a=n.width;t.scrollNode.style.maxHeight=r,t.containerNode.style.maxHeight=r,t.containerNode.style.width=a,t.updateScrollbars(),t.addScrollNodeProperties()},rerenderVisualization:function(t,e){var n=this;!function(t,e,n){var r=t.isComparisonMetricAdded,a=t.isTrendAttributeAdded,i=t.isBreakByAttributeAdded,o=t.isComparisonKPI,l=t.updatedCategory,c=t.metricFormattingRules,u=t.data.at(-1).cells,s=ht(u,t),d=!(a||o&&r);t.cardDataToUpdate=t.parsedData.find(function(t){return t.breakByAttributeName===l}),t.parsedData.forEach(function(r){if(!i||r.breakByAttributeName===l){var a=r.trendChartData,o=e[t.mappedIndexes[r.metricId]].v,f=at(o,r.metricId,c).formattedValue;r.primaryValue.raw=o,r.primaryValue.formatted=f,d?a.push({raw:o,formatted:f}):Qo(t,u,s,n,r)}})}(n,t,e),function(t){var e=t.isComparisonMetricAdded,n=t.isBreakByAttributeAdded,r=t.components,a=t.cardDataToUpdate,i=t.data,o=t.updatedCategory,l=t.properties,c=!e&&(!r.cardSecondaryValues[0]&&1!==i.length||n&&void 0===a.secondaryValueComponentIndex),u=e&&(!n&&2===i.length&&void 0===t.parsedData[0].trendComponentIndex||n&&void 0===a.trendComponentIndex);(c||u)&&t.parsedData.forEach(function(n,r){var a=null==n||!n.breakByAttributeName||n.breakByAttributeName===o;Qi(n,t,l,r,!e&&a,a)})}(n),qo(n)},checkTimeFilter:function(){var t=this;t.updateFrequency=t.getRealtimeUpdateFrequency();var e=t.getRealtimeFilterInfo();if(t.timeFilter={},e){var n,r,a=e.curre,i=e.lastt,o=e.lastti,l=e.timef;if(t.timeFilter.typeOfTimeFilter=l,1===l)n=1===o?i:60*i;else{switch(a){case 1..KEY:n=1..TIME_IN_SECONDS;break;case 2..KEY:n=2..TIME_IN_SECONDS;break;case 3..KEY:n=3..TIME_IN_SECONDS;break;default:n=4..TIME_IN_SECONDS}t.timeFilter.currentSelection=a}r=n<=60?"".concat(n).concat("s"):n<=3600?"".concat(n/60).concat("mins"):n<=86400?"".concat(n/3600).concat("h"):"".concat(n/86400).concat("day"),t.timeFilter.filterTimeInSeconds=n,t.timeFilter.filterLabel=r}else{t.timeFilter={typeOfTimeFilter:1,filterTimeInSeconds:7200,filterLabel:"".concat(7200).concat("s")}}},updateTimeFilterRanges:function(t){var e=this.timeFilter,n="string"==typeof t?new Date(t):t;1===e.typeOfTimeFilter?e.timeRangeStart=new Date(n-e.filterTimeInSeconds*$o[Yo]):2===e.typeOfTimeFilter&&(e.timeRangeStart=function(t,e){var n,r={year:(n=t).getFullYear(),month:n.getMonth(),day:n.getDate(),hour:n.getHours(),minute:n.getMinutes()},a=r.year,i=r.month,o=r.day,l=r.hour,c=r.minute;switch(e){case 1..KEY:return c<15?new Date(a,i,o,l,0):c<30?new Date(a,i,o,l,15):c<45?new Date(a,i,o,l,30):new Date(a,i,o,l,45);case 2..KEY:return c<30?new Date(a,i,o,l,0):new Date(a,i,o,l,30);case 3..KEY:return new Date(a,i,o,l,0);default:return new Date(a,i,o,0)}}(n,e.currentSelection))},applyFilterOnTrendData:Jo,plot:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this,a=r.isRealtimeStreamingEnabled&&r.isRealtimeStreamingEnabled();if(r.isConsumption=!(null!==(t=(e=mstrApp).supportFeature)&&void 0!==t&&t.call(e,"show-react-dossier-format")),!a&&function(t){var e=l(t.KPIType);return!(!D(t,e.BREAK_BY)||!t.dataInterface.data.gsi.mx.length)&&(0===t.KPIType?t.dataInterface.data.gts.row[0].es.length*t.dataInterface.data.gsi.mx.length:t.dataInterface.data.gts.row[0].es.length)>500}(r)){var i,o=(null===(i=r.dataInterface.data.gts.row[0])||void 0===i?void 0:i.n)||"";throw new Error(mstrmojo.descP("IMGKPI.","49","The attribute ## has too many elements. Please filter the data to display the KPIs.").replace("##",o))}for(var u=rt(r.model.data.nf),s=!1,d=0;d<r.model.data.nf.length&&!s&&r.formattingModel;d++){var f;s=r.model.data.nf[d].id!==(null===(f=r.formattingModel.model[d])||void 0===f?void 0:f.id)||r.model.data.nf[d].nfs!==r.formattingModel.model[d].nfs}r.metricFormattingRules=u,r.formattingModel={model:r.model.data.nf,didMetricFormattingRuleChange:s},r.trendSVGs=[],r.shouldFontBeChanged=[],r.cardIds=[],r.graphicModels=[],r.truncatedLabels=[],r.isRealTime=a,r.isComparisonMetricAdded=W(r);var h=l(r.KPIType);if(a&&(r.isBreakByAttributeAdded=D(r,h.BREAK_BY),r.isTrendAttributeAdded=D(r,h.TREND),function(t){var e,n,r=t.isBreakByAttributeAdded;r&&(n=0),t.isTrendAttributeAdded&&(e=r?1:0),t.timestampIndex=e,t.breakByIndex=n}(r)),!a||r.data&&r.data.length){r.currentInterval&&clearInterval(r.currentInterval);var m=function(){var t=function(t){var e=l(t.KPIType),n=!D(t,e.METRICS),r=mstrApp.isDisplayOnMobile||mstrApp.isDossier||/(android)/i.test(navigator.userAgent),a=!window.mstrApp.isExporting&&!r&&!window.mstrApp.features["show-react-dossier-format"],i=t.isComparisonKPI;if(a)throw t.errorMessage=i?mstrmojo.descP("IMGKPI.","11","Comparison KPI is supported only on environments 11.3.1 or higher"):mstrmojo.descP("IMGKPI.","10","Multi-Metric KPI is supported only on environments 11.3.1 or higher"),t.errorDetails="",new Error("No react-format-panel");if(n){var o=document.createElement("div");o.classList.add("warning-container");var c=document.createElement("div");c.classList.add("icon"),c.style.backgroundPosition=i?"0 -90px":"unset";var u=t.domNode,s=u.clientWidth,d=u.clientHeight;(s<640||d<600)&&(c.style.width="60px",c.style.height="60px",c.style.backgroundPosition=i?"-90px -90px":"unset"),o.appendChild(c);var f=document.createElement("div");f.classList.add("title");var h=document.createTextNode(i?mstrmojo.descP("IMGKPI.","41","Comparison KPI"):mstrmojo.descP("IMGKPI.","50","Enhanced KPI"));f.appendChild(h),o.appendChild(f);var m=document.createElement("div");m.classList.add("description"),m.innerHTML=i?mstrmojo.descP("IMGKPI.","9","Add 2 #metrics####").replace("####","").replace("#","<svg class='metric-icon'></svg>"):mstrmojo.descP("IMGKPI.","56","Add 1 #metric####").replace("####","").replace("#","<svg class='metric-icon'></svg>"),o.appendChild(m),t.domNode.appendChild(o)}return a||n}(r);if(t)r.raiseEvent({name:"renderFinished",id:r.k});else{var e,a=r.intervalAutoPlayId;if(a&&clearInterval(a),r.addUseAsFilterMenuItem(),n)e=X(n,r);else{var i=JSON.parse(r.getProperty(A));e=X(i,r)}r.properties=e;var o=function(){var t,n,a=function(t,e){var n=t.model.data.nf,r=rt(n,!0),a=n.map(function(t){return t.id}),i={};return a.forEach(function(t){var n=e[t]||{},a=n.value,o=n.font;if(a&&!isNaN(a)){var l=at(a,t,r).formattedValue;i[t]=e[t],i[t].formattedValue=l,i[t].font={fontColor:o.color,fontSize:o.size,fontFamily:o.fontFamily,fontStyle:o.style}}}),i}(r,e.createdReferenceLines);r.resetComponents(),r.trendSVGs=[],r.clearDomNode(),function(){var t=r.isRealTime,n=r.isBreakByAttributeAdded,i=r.isComparisonMetricAdded,o=r.cardsOrder,u=r.breakByIndex,s=r.timeFilter,d=r.data,f=t?d:function(t){var e=mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT.ROWS_ADV;return t.dataInterface.getRawData(e,{hasSelection:!0,hasTitleName:!0,minAttribute:0})}(r);t&&n&&o&&f.sort(function(t,e){return o.findIndex(function(e){return e===t.cells[u].v})-o.findIndex(function(t){return t===e.cells[u].v})});var h,m=function(t,e,n,r){var a,i,o=l(e.KPIType),u=function(t,e){var n=rt(e.model.data.nf);return t.forEach(function(t){t.forEach(function(t){var e=t.trendChartData[t.trendChartData.length-1].raw,r=t.trendChartData[t.trendChartData.length-1].formatted,a=at(e,t.metricId,n).color;t.primaryValue={raw:e,formatted:r,color:a}})}),t}(ft(t,e,o),e),s=(a=function(t,e,n,r){if(!D(e,r.TREND))return[t];var a={min:null,max:null},i=e.isComparisonKPI,o=e.isRealTime,l=n.axisScale,c=n.axisScaleComparison;return i&&(l=c),t.forEach(function(t){var e=null,n=null,r=t.map(function(t){return t.trendChartData.map(function(t){return t.raw})});if(l!==g.AXIS_SCALE.GLOBAL){var i=r.flat();n=i.reduce(function(t,e){return Math.min(t,e)},0),e=i.reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),a.min=Math.min(0,a.min,n),a.max=Math.max(a.max,e)}t.forEach(function(t,a){if(t.trendChartData.length<=1)t.trend=null;else{var i,l=r[a].reduce(function(t,e){return Math.max(t,e)},Number.NEGATIVE_INFINITY),c=null!==(i=e)&&void 0!==i?i:l,u=function(t,e,n,r,a){if(null!==r)return r;var i=e[n],o=t?i.reduce(function(t,e){return Math.min(t,e)},Number.POSITIVE_INFINITY):i.reduce(function(t,e){return Math.min(t,e)},0);return o>=0&&o===a?0:o}(o,r,a,n,c);t.trend={minValue:u,maxValue:c}}})}),[t,a]}(u,e,n,o),i=2,function(t){if(Array.isArray(t))return t}(a)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(a,i)||st(a,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=s[0],f=s[1],h=function(t,e,n,r){var a=e.isComparisonKPI,i=e.isRealTime,o=e.isBreakByAttributeAdded,l=e.timeFilter,u=n.secondaryMetricName,s=D(e,r.TREND);e.isTrendAttributeAdded=s;var d=0===e.KPIType,f=a?D(e,r.COMPARE_WITH):null,h=D(e,r.METRICS)&&f;if(d&&!s||a&&!h&&!s)return t;var m=rt(e.model.data.nf);return e.metricFormattingRules=m,e.metricId=t[0][0].metricId,t.forEach(function(t){t.forEach(function(t){if(i&&(t.cardSecondaryLabel=function(t,e,n,r,a){if(t<=e.timeRangeStart||n||!r&&e.isMoreDataThanFilter)return a;var i=t.toTimeString().split(" ").shift();return"Compare to ".concat(i)}(t.trendChartData[0].timestampDate,l,h,o,u)),null!==t.trend||h){var e,n,r,a={label:i?t.cardSecondaryLabel:u};r=i?0:t.trendChartData.length-2,h?(a.value=t.compareMetricValue.formatted,e=t.compareMetricValue.raw,n=t.compareMetricId):(a.value=t.trendChartData[r].formatted,e=t.trendChartData[r].raw,n=t.metricId);var s=t.primaryValue.raw-e,d=g.TREND_INDICATOR_VALUE_TYPE,f=at(s,n,m).formattedValue,p=ut(ut(ut({},d.NUMERIC,f),d.PERCENT,[0,""].includes(e)?c:R({partialValue:s,totalValue:e})),"differenceBetweenPrimaryAndSecondary",s);t.secondaryValue=a,t.indicator=p}else t.secondaryValue=null,t.indicator=null})}),t}(d,e,n,o).flat(),m=function(t,e,n,r){var a=n.axisScale,i=n.axisScaleComparison;return r.isComparisonKPI&&(a=i),a===g.AXIS_SCALE.SYNCED_ALL?t.map(function(t){return t.trend={minValue:e.min,maxValue:e.max},t}):t}(pt(h,n,e.isTrendAttributeAdded),f,n,e);return function(t,e){return t.map(function(t){return t.referenceLine=e[t.metricId],t})}(m,r)}(f,r,e,a);m.forEach(function(t){r.graphicModels.push(t.graphicModel)}),t&&n&&(r.cardDetails=null!==(h=r.cardDetails)&&void 0!==h?h:[],el(m,r.cardDetails,s,d,e,i)),r.isSingleCardDisplayed=1===m.length||e.layoutType===g.LAYOUT_TYPES.STACKED,function(t,e){var n,r=l(t.KPIType),a=null===(n=t.gridData.gsi.sorts)||void 0===n?void 0:n[0],i=!(null==a||!a.length),o=D(t,r.BREAK_BY);if(i&&o&&e[0].graphicModel.getSelector().tid===a[0].key.split("!")[1]){var c={};e.forEach(function(t,e){t in c||(c[t.breakByAttributeName]=e)}),e.sort(function(t,e){return c[t.breakByAttributeName]-c[e.breakByAttributeName]})}}(r,m),r.parsedData=m}();var i=r.domNode,o=r.parsedData,u=r.isMobile,s=r.isInChatbot,d=i.appendChild(Ct({},!1));d.appendChild(Io(r,o,e)),r.visualizationNode=d;var f=d.appendChild(document.createElement("div"));f.classList.add("font-size-measure-div"),Ho(e,r),f.remove(),e.layoutType===g.LAYOUT_TYPES.GRID&&r.addMojoScrollbar(),u||s||e.layoutType===g.LAYOUT_TYPES.STACKED||function(t){var e,n,r,a,i=t.domNode,o=i.clientWidth,c=i.clientHeight,u=kr(i),s=u.append("div").attr("class","selection-tool").style("visibility","hidden");u.call(function(){var t,e,n,r,a=Wr,i=$r,o=Xr,l=Zr,c={},u=Ue("start","drag","end"),s=0,d=0;function f(t){t.on("mousedown.drag",h).filter(l).on("touchstart.drag",y).on("touchmove.drag",g,Kr).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(o,l){if(!r&&a.call(this,o,l)){var c=E(this,i.call(this,o,l),o,l,"mouse");c&&(kr(o.view).on("mousemove.drag",m,Hr).on("mouseup.drag",p,Hr),function(t){var e=t.document.documentElement,n=kr(t).on("dragstart.drag",Yr,Hr);"onselectstart"in e?n.on("selectstart.drag",Yr,Hr):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(o.view),Ur(o),n=!1,t=o.clientX,e=o.clientY,c("start",o))}}function m(r){if(Yr(r),!n){var a=r.clientX-t,i=r.clientY-e;n=a*a+i*i>d}c.mouse("drag",r)}function p(t){kr(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,r=kr(t).on("dragstart.drag",null);e&&(r.on("click.drag",Yr,Hr),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),Yr(t),c.mouse("end",t)}function y(t,e){if(a.call(this,t,e)){var n,r,o=t.changedTouches,l=i.call(this,t,e),c=o.length;for(n=0;n<c;++n)(r=E(this,l,t,e,o[n].identifier,o[n]))&&(Ur(t),r("start",t,o[n]))}}function g(t){var e,n,r=t.changedTouches,a=r.length;for(e=0;e<a;++e)(n=c[r[e].identifier])&&(Yr(t),n("drag",t,r[e]))}function v(t){var e,n,a=t.changedTouches,i=a.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<i;++e)(n=c[a[e].identifier])&&(Ur(t),n("end",t,a[e]))}function E(t,e,n,r,a,i){var l,d,h,m=u.copy(),p=Br(i||n,e);if(null!=(h=o.call(t,new zr("beforestart",{sourceEvent:n,target:f,identifier:a,active:s,x:p[0],y:p[1],dx:0,dy:0,dispatch:m}),r)))return l=h.x-p[0]||0,d=h.y-p[1]||0,function n(i,o,u){var y,g=p;switch(i){case"start":c[a]=n,y=s++;break;case"end":delete c[a],--s;case"drag":p=Br(u||o,e),y=s}m.call(i,t,new zr(i,{sourceEvent:o,subject:h,target:f,identifier:a,active:y,x:p[0]+l,y:p[1]+d,dx:p[0]-g[0],dy:p[1]-g[1],dispatch:m}),r)}}return f.filter=function(t){return arguments.length?(a="function"==typeof t?t:Gr(!!t),f):a},f.container=function(t){return arguments.length?(i="function"==typeof t?t:Gr(t),f):i},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:Gr(t),f):o},f.touchable=function(t){return arguments.length?(l="function"==typeof t?t:Gr(!!t),f):l},f.on=function(){var t=u.on.apply(u,arguments);return t===u?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f}().on("start",function(o){var l,c,d=t.tooltipInfo;a=o.sourceEvent.target,d.isVisible&&null!==(l=t.model)&&void 0!==l&&null!==(c=l.data)&&void 0!==c&&c.doslinkinfo&&(t.showTooltip(d.graphicModel,d.position,!0),d.isPositionFixed=!0),(r=u.selectAll("article")).each(function(t,e,n){n[e].style.pointerEvents="none"}),e=i.scrollTop;var f={y:o.y,x:o.x};n=f,s.style("visibility","visible").style("left","".concat(n.x,"px")).style("top","".concat(n.y+e,"px")).style("width","0px").style("height","0px")}).on("drag",function(t){var r={y:t.y,x:t.x},a=o-n.x-2,i=c-n.y-2,l=r.x-n.x,u=r.y-n.y;l<0&&(s.style("left","".concat(Math.max(0,r.x),"px")),a=n.x),u<0&&(s.style("top","".concat(Math.max(0,r.y+e),"px")),i=n.y);var d=Math.min(a,Math.abs(l)),f=Math.min(i,Math.abs(u));s.style("width","".concat(d,"px")).style("height","".concat(f,"px"))}).on("end",function(n){var i={xMin:parseInt(s.style("left")),xMax:parseInt(s.style("left"))+parseInt(s.style("width")),yMin:parseInt(s.style("top")),yMax:parseInt(s.style("top"))+parseInt(s.style("height"))};s.style("visibility","hidden");var o=function(t,e,n,r){var a=n.xMin,i=n.xMax,o=n.yMin,l=n.yMax,c=t.node().getBoundingClientRect(),u=c.x,s=c.y,d=[];return e.each(function(t,e,n){var c=n[e],f=c.getBoundingClientRect(),h=f.x,m=f.y,p=f.width,y=f.height,g=h-u,v=m-s+r;!(a>g+p||i<g||l<v||o>v+y)&&d.push(c)}),d}(u,r,i,e);(function(t,e,n,r){var a=!!e.contextMenuCardsGraphicModels.length;if(Li(e),n.length>1){e.selectedCardsGraphicModels=n.map(function(t){return e.getGraphicModels().find(function(e){return mstrmojo.string.encodeHtmlString(e.cardId)===t.id})}),e.clearSelections(),Pi(e);var i=l(e.KPIType),o=D(e,i.TREND),c=D(e,i.BREAK_BY);(o||c)&&e.applySelection(e.selectedCardsGraphicModels.map(function(t){return t.getSelector()}))}else if(1===n.length){var u=e.getGraphicModels().find(function(t){return mstrmojo.string.encodeHtmlString(t.cardId)===n[0].id});Oi(t,e,u,r)}else a||(e.selectedCardsGraphicModels=[],e.clearSelections(),Pi(e),e.handleSelection(t))})(n,t,o,a),r.each(function(t,e,n){n[e].style.pointerEvents="auto"})}).filter(function(t){return!("mstrmojo-scrollbar vertical"===t.target.className||2===t.button)}))}(r),r.animationDuration=0,e.stackedAutoPlay?r.autoPlayEnabled=!0:r.autoPlayEnabled=!1;var h=null===(t=r.getSelectionCache)||void 0===t||null===(n=t.call(r))||void 0===n?void 0:n._viSelections;h&&r.highlight("att",h,!0),r.raiseEvent({name:"renderFinished",id:r.k})};!function(t,e,n,r){var a=[t.allFontOptions,t.labelFontOptions,t.primaryValueFontOptions,t.secondaryValueFontOptions,t.indicatorFontOptions].map(function(t){return{name:t.fontFamily,isItalic:t.fontStyle[1],isBold:t.fontStyle[0]}}).reduce(function(t,e){return t.find(function(t){return t.name===e.name&&t.isItalic===e.isItalic&&t.isBold===e.isBold})?t:t.concat([e])},[]);mstrmojo.util.FontLoader.load(e.id,a,{success:n,failure:r})&&n()}(e,r,o,o)}},p="".concat(r.cssClass,"stylesheet");if(mstrApp.isWorkstation&&!Xo(document.styleSheets).some(function(t){var e;return null===(e=t.href)||void 0===e?void 0:e.includes(r.cssClass)})){var y=document.getElementById(p);if(y){var v=y.onload;y.onload=function(){v(),m()}}else{var E=document.head,_=document.createElement("link");_.type="text/css",_.onload=m,_.id=p,_.rel="stylesheet",_.href="../plugins/".concat(r.cssClass,"/style/global.css"),E.appendChild(_)}}else m()}},renderRealtimeData:function(t){var e,n=this,r=n.timestampIndex,a=n.breakByIndex,i=n.isBreakByAttributeAdded,o=n.isTrendAttributeAdded;n.cardsOrder=null!==(e=n.cardsOrder)&&void 0!==e?e:[],i&&!n.cardsOrder.find(function(e){return e===t[0].cells[a].v})&&n.cardsOrder.push(t[0].cells[a].v),o&&(t[0].cells[r].v=t[0].cells[r].v.replace("T"," ").slice(0,-1),t[0].timestampDateFormat=new Date(t[0].cells[r].v)),n.data?n.data.push(t[0]):n.data=t,0===n.parsedData.length?(this.checkTimeFilter(),o&&(this.updateTimeFilterRanges(t[0].cells[r].v),this.timeFilter.isMoreDataThanFilter=!1),this.plot()):this.updateCardsAndRenderVisualization(t)},onRealtimeTopicChanged:function(){this.data=[],this.rawData=[],this.parsedData=[],this.trendSVGs=[]},updateCardsAndRenderVisualization:function(t){var e,n=this,r=n.isBreakByAttributeAdded,a=n.timestampIndex,i=n.breakByIndex,o=n.isTrendAttributeAdded;n.updatedCategory=r?t[0].cells[i].v:null,o?(e=t[0].cells[a].v,n.updateTimeFilterRanges(e),n.data=function(t){var e,n,r=t.timeFilter,a=t.data,i=t.breakByIndex,o=t.updatedCategory,l=t.isBreakByAttributeAdded,c=t.isComparisonMetricAdded;if(!l||c){var u=a.findIndex(function(t){return t.timestampDateFormat>r.timeRangeStart});e=a.slice(u),r.firstIndexInFilterRange=u}else e=a.filter(function(t){return t.cells[i].v!==o||t.timestampDateFormat>r.timeRangeStart});return!r.isMoreDataThanFilter&&a[0].timestampDateFormat<=r.timeRangeStart&&(r.isMoreDataThanFilter=!0,null!==(n=t.properties)&&void 0!==n&&n.secondaryMetricName&&function(t){var e=t.timeFilter,n=t.properties,r=t.components;if(2===e.typeOfTimeFilter){var a="Since ".concat(e.timeRangeStart.toLocaleTimeString());n.secondaryMetricName=a,r.cardSecondaryValues.forEach(function(t){t.secondaryValueData.labelTitle=a})}else{var i=X({secondaryMetricName:""},t);n.secondaryMetricName=i.secondaryMetricName}}(t)),e}(n)):e=t[0].timestamp;var l=n.parsedData.map(function(t){return t.breakByAttributeName}).filter(function(t){return t}),c=!!r&&function(t,e){var n=e.updateFrequency,r=e.updatedCategory,a=e.timeFilter,i=e.parsedData,o=new Date(t-n*$o[Yo]),l=i.filter(function(t){var e=t.isCardOld&&t.breakByAttributeName!==r&&t.lastUpdateTimestamp<o,n=t.breakByAttributeName===r&&t.trendChartData.at(-1).timestampDate<=a.timeRangeStart;return e||n}),c=l.length>0;return c&&function(t,e){t.forEach(function(t){e.cardsOrder=t.breakByAttributeName!==e.updatedCategory?e.cardsOrder.filter(function(e){return e!==t.breakByAttributeName}):e.cardsOrder,e.data=e.data.filter(function(n){return n.cells[e.breakByIndex].v!==t.breakByAttributeName||n.cells[e.breakByIndex].v===e.updatedCategory}),e.cardDetails=e.cardDetails.filter(function(e){return e.breakByAttributeName!==t.breakByAttributeName})})}(l,e),function(t,e){var n=e.updatedCategory,r=e.timeFilter,a=e.parsedData,i=e.cardDetails;a.forEach(function(e){var a;e.isCardOld=e.trendChartData.at(-1).timestampDate<r.timeRangeStart&&e.breakByAttributeName!==n;var o=null!==(a=e.lastUpdateTimestamp)&&void 0!==a?a:t;e.lastUpdateTimestamp=e.isCardOld?o:null,i.forEach(function(t){t.breakByAttributeName===e.breakByAttributeName&&(t.isCardOld=e.isCardOld,t.lastUpdateTimestamp=e.lastUpdateTimestamp)})})}(t,e),c}(t[0].timestampDateFormat,n),u=!r&&1===n.data.length&&n.parsedData[0].trendChartData.length>1;if(c||u||0!==l.length&&t.some(function(t){return!l.includes(t.cells[i].v)}))this.plot();else{var s=n.dataInterface.data.realtimeQueryInfo.columns,d=[];t.forEach(function(t){s.forEach(function(e,n){-1===e.bfid&&d.push(t.cells[n])})}),this.rerenderVisualization(d,e)}},localImageAdded:function(t){var e=this,n=JSON.parse(e.getProperty(A));n[E.IMAGE_PROP_NAME.name]=t.imageName,n[E.IMAGE_PROP_URL.name]=t.base64Str,e.savePropertyAndUpdateWidgetAsync(A,JSON.stringify(n)),e.plot(n)},urlImageAdded:function(t){var e=this,n=JSON.parse(e.getProperty(A)),r=function(t){e.savePropertyAndUpdateWidgetAsync(A,JSON.stringify(n)),mstrmojo.alert(t?mstrmojo.desc(25021,"Only HTTPS URL schemes are allowed."):mstrmojo.desc(20905,"Please ensure that the URL points to a valid image file."),null,mstrmojo.desc(12068,"Invalid URL"))};mstrmojo.imageUtils.isURLValid(t)?(mstrApp.showWait({message:mstrmojo.desc(1212,"Processing...")}),mstrmojo.imageUtils.isImageAccessible(t,{success:function(){mstrApp.hideWait(),n[E.IMAGE_PROP_NAME.name]=t,n[E.IMAGE_PROP_URL.name]=t,e.savePropertyAndUpdateWidgetAsync(A,JSON.stringify(n)),e.plot(n)},failure:function(){mstrApp.hideWait(),r(!1)}})):r(!0)}})})();